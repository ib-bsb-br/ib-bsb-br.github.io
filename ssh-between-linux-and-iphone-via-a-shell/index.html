<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    
      SSH between Linux and iPhone via a-Shell — infoBAG
    
  </title>
  <meta name="title" content="SSH between Linux and iPhone via a-Shell">
  <meta name="description" content="can't steer unless already moving">

  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="SSH between Linux and iPhone via a-Shell — infoBAG">
  <meta property="og:description" content="can't steer unless already moving">
  <meta property="og:url" content="https://ib.bsb.br/ssh-between-linux-and-iphone-via-a-shell/">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="infoBAG">
  

  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="SSH between Linux and iPhone via a-Shell — infoBAG">
  <meta name="twitter:description" content="can't steer unless already moving">
  

  <link rel="canonical" href="https://ib.bsb.br/ssh-between-linux-and-iphone-via-a-shell/">
  <link rel="alternate" type="application/rss+xml" title="infoBAG" href="https://ib.bsb.br/rss.xml">

  
    <meta name="keywords" content="linux,,iphone">
    
      <meta property="article:tag" content="linux,">
    
      <meta property="article:tag" content="iphone">
    
  

  <!-- Favicons and Icons -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  

  <link href="/style.css" rel="stylesheet">
</head>
<body class="post-content-body">
  <header class="header-container">
    <nav aria-label="Main navigation" class="header-content">
      <a href="/" aria-label="Home">
        <img src="/favicon.ico" alt="Home" class="favicon search-link" width="45" height="45" loading="lazy">
      </a>
      <a href="/tags" aria-label="Tags">
        <img src="/assets/Label.gif" alt="Tags" class="favicon search-link" width="45" height="45" loading="lazy">
      </a>
      <a href="/events" aria-label="Events">
        <img src="/assets/Paralyse_Rune.gif" alt="Events" class="favicon search-link" width="45" height="45" loading="lazy">
      </a>
      <a href="/archive" aria-label="Archive">
        <img src="/assets/Loose_Stone_Pile.gif" alt="Archive" class="favicon search-link" width="45" height="45" loading="lazy">
      </a>
    </nav>
    <h1 class="post-title">SSH between Linux and iPhone via a-Shell</h1>
    <div class="post-meta">
      <time datetime="2024-10-26T00:00:00+00:00" class="post-date">
        26 Oct 2024
      </time>
      
        <span class="post-updated">
          ↣
          <time datetime="2024-10-26T21:04:13+00:00">26 Oct 2024</time>
        </span>
      
      
        <p class="post-slug">
          Slug: <a href="https://ib.bsb.br/ssh-between-linux-and-iphone-via-a-shell" class="tag">ssh-between-linux-and-iphone-via-a-shell</a>
        </p>
      
      
        <p class="post-tags">
          Tags:
          
            <a href="https://ib.bsb.br/tags/#linux" class="tag">linux,</a>
            
          
            <a href="https://ib.bsb.br/tags/#iphone" class="tag">iphone</a>
            
          
        </p>
      
    </div>
    <div class="post-actions">
      <div class="page-stats mt-3" role="status" aria-label="Page statistics">
        <span class="badge bg-primary">
          26967 characters
        </span>
        <span class="separator mx-2" aria-hidden="true">•</span>
        <span class="badge bg-primary">
          2166 words
        </span>
      </div>
      <div class="action-buttons d-flex flex-wrap gap-2">
        
          
            <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/edit/main/_posts/2024-10-26-ssh-between-linux-and-iphone-via-a-shell.md"
                  method="GET"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="d-inline-block">
              <button type="submit" class="btn btn-danger" aria-label="Edit page content">
                <span class="button-text">Improve this page?</span>
                <span class="info-text">aberto.</span>
              </button>
            </form>
          
          <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/commits/main/_posts/2024-10-26-ssh-between-linux-and-iphone-via-a-shell.md"
                method="GET"
                target="_blank"
                rel="noopener noreferrer"
                class="d-inline-block">
            <button type="submit" class="btn btn-danger" aria-label="View page revision history">
              View revision history
            </button>
          </form>
        
      </div>
    </div>
  </header>
  <main class="content">
    <article class="post-wrapper">
      <div class="post-content-body">
        
<ul><li><a href="#analysis">analysis</a></li><li><a href="#organized_information">organized_information</a></li><li><a href="#data">data</a></li><li><a href="#documentation">documentation</a><ul><li><a href="#secure-ssh-connection-between-debian-and-iphone-using-a-shell"><strong>Secure SSH Connection Between Debian and iPhone Using a-Shell</strong></a><ul><li><a href="#1-update-and-secure-debian-system"><strong>1. Update and Secure Debian System</strong></a><ul><li><a href="#11-update-system-packages"><strong>1.1 Update System Packages</strong></a></li><li><a href="#12-install-openssh-server"><strong>1.2 Install OpenSSH Server</strong></a></li><li><a href="#13-verify-ssh-service"><strong>1.3 Verify SSH Service</strong></a></li></ul></li><li><a href="#2-configure-ssh-server-with-security-best-practices"><strong>2. Configure SSH Server with Security Best Practices</strong></a><ul><li><a href="#21-backup-ssh-configuration"><strong>2.1 Backup SSH Configuration</strong></a></li><li><a href="#22-edit-ssh-configuration"><strong>2.2 Edit SSH Configuration</strong></a></li><li><a href="#23-restart-ssh-service"><strong>2.3 Restart SSH Service</strong></a></li></ul></li><li><a href="#3-create-a-non-root-user-account"><strong>3. Create a Non-Root User Account</strong></a><ul><li><a href="#31-add-new-user"><strong>3.1 Add New User</strong></a></li><li><a href="#32-grant-sudo-privileges-optional"><strong>3.2 Grant Sudo Privileges (Optional)</strong></a></li></ul></li><li><a href="#4-set-up-ssh-access-for-the-new-user"><strong>4. Set Up SSH Access for the New User</strong></a><ul><li><a href="#41-switch-to-new-user"><strong>4.1 Switch to New User</strong></a></li><li><a href="#42-create-ssh-directory"><strong>4.2 Create <code class="language-plaintext highlighter-rouge">.ssh</code> Directory</strong></a></li><li><a href="#43-create-authorized_keys-file"><strong>4.3 Create <code class="language-plaintext highlighter-rouge">authorized_keys</code> File</strong></a></li></ul></li><li><a href="#5-generate-ssh-key-pair-on-iphone-a-shell"><strong>5. Generate SSH Key Pair on iPhone a-Shell</strong></a><ul><li><a href="#51-generate-ssh-keys"><strong>5.1 Generate SSH Keys</strong></a></li><li><a href="#52-display-public-key"><strong>5.2 Display Public Key</strong></a></li></ul></li><li><a href="#6-transfer-public-key-to-debian-machine"><strong>6. Transfer Public Key to Debian Machine</strong></a><ul><li><a href="#61-add-public-key-to-authorized_keys"><strong>6.1 Add Public Key to <code class="language-plaintext highlighter-rouge">authorized_keys</code></strong></a></li><li><a href="#62-set-correct-permissions-and-ownership"><strong>6.2 Set Correct Permissions and Ownership</strong></a></li></ul></li><li><a href="#7-configure-ssh-client-on-iphone-a-shell"><strong>7. Configure SSH Client on iPhone a-Shell</strong></a><ul><li><a href="#71-determine-home-directory-path"><strong>7.1 Determine Home Directory Path</strong></a></li><li><a href="#72-create-ssh-config-file"><strong>7.2 Create SSH Config File</strong></a></li><li><a href="#73-set-permissions"><strong>7.3 Set Permissions</strong></a></li></ul></li><li><a href="#8-configure-ufw-firewall-on-debian"><strong>8. Configure UFW Firewall on Debian</strong></a><ul><li><a href="#81-install-ufw"><strong>8.1 Install UFW</strong></a></li><li><a href="#82-allow-ssh-through-firewall"><strong>8.2 Allow SSH Through Firewall</strong></a></li><li><a href="#83-enable-firewall"><strong>8.3 Enable Firewall</strong></a></li><li><a href="#84-verify-firewall-status"><strong>8.4 Verify Firewall Status</strong></a></li></ul></li><li><a href="#9-test-and-troubleshoot-ssh-connection"><strong>9. Test and Troubleshoot SSH Connection</strong></a><ul><li><a href="#91-test-ssh-connection-from-iphone"><strong>9.1 Test SSH Connection from iPhone</strong></a></li><li><a href="#92-troubleshoot-if-necessary"><strong>9.2 Troubleshoot if Necessary</strong></a></li></ul></li><li><a href="#10-adjust-for-ios-sandboxing-on-iphone-a-shell"><strong>10. Adjust for iOS Sandboxing on iPhone a-Shell</strong></a></li><li><a href="#11-maintain-security-best-practices"><strong>11. Maintain Security Best Practices</strong></a></li></ul></li></ul></li></ul></li><li><a href="#paper_trail">paper_trail</a></li></ul>
        <h1 id="analysis">
    
    
     <a href="#analysis">#</a><a href="#" aria-label="Back to top">analysis</a>
        
    
  </h1>
      
<ol>
  <li><strong>Initial Data Review:</strong>
    <ul>
      <li>The project aims to establish secure SSH connectivity between a Debian machine and an iPhone using the a-Shell terminal emulator.</li>
      <li>On the <strong>Debian machine</strong>, key actions include:
        <ul>
          <li>Updating and securing the system.</li>
          <li>Installing and configuring the OpenSSH server with security best practices.</li>
          <li>Creating a regular user account for SSH access.</li>
          <li>Setting up firewall rules to allow SSH while minimizing exposure.</li>
          <li>Implementing proper file permissions and ownership.</li>
          <li>Addressing troubleshooting steps for SSH connectivity issues.</li>
        </ul>
      </li>
      <li>On the <strong>iPhone a-Shell</strong>, tasks involve:
        <ul>
          <li>Generating an SSH key pair with appropriate security considerations.</li>
          <li>Configuring the SSH client, taking into account iOS sandboxing constraints.</li>
          <li>Adjusting file paths due to the nature of the iOS file system.</li>
          <li>Testing the SSH connection and resolving any arising issues.</li>
        </ul>
      </li>
      <li>The unstructured data captures multiple configuration attempts and problem-solving strategies, reflecting practical challenges in SSH setup between different operating systems.</li>
    </ul>
  </li>
  <li><strong>Identification of Elements:</strong>
    <ol>
      <li>System update and OpenSSH server installation on Debian with security considerations.</li>
      <li>Secure SSH server configuration on Debian.</li>
      <li>Creation of a non-root user for SSH access.</li>
      <li>Proper setup of <code class="language-plaintext highlighter-rouge">.ssh</code> directories and permissions on Debian.</li>
      <li>SSH key generation on iPhone a-Shell with security advisement.</li>
      <li>Secure transfer of the public key to the Debian machine.</li>
      <li>SSH client configuration on iPhone a-Shell, considering iOS sandboxed environment.</li>
      <li>Firewall setup using UFW on Debian with security best practices.</li>
      <li>Verification and troubleshooting of SSH connectivity.</li>
      <li>Adjustments for iOS file paths due to sandboxing.</li>
      <li>Emphasis on security best practices throughout the configuration process.</li>
    </ol>
  </li>
  <li><strong>Application of Documentation Principles:</strong>
    <ul>
      <li><strong>Causality Chain Initiation:</strong> Each configuration step is directly linked to a specific requirement or issue, ensuring actions have clear justifications.</li>
      <li><strong>Contextual Documentation:</strong> Instructions are tailored to the Debian and iOS environments, providing context-specific guidance.</li>
      <li><strong>Validation Through Testing:</strong> Each configuration change is followed by testing to confirm effectiveness and identify potential issues.</li>
      <li><strong>Integration of Implementation and Testing:</strong> The documentation combines configuration steps with immediate verification, reinforcing the learning and troubleshooting process.</li>
    </ul>
  </li>
  <li><strong>Organization of Information:</strong>
    <ul>
      <li>Documentation is divided into sections based on the system (Debian or iPhone) and tasks are presented in logical order.</li>
      <li>Related tasks are grouped together to enhance clarity.</li>
      <li>Steps are sequential, minimizing back-and-forth between systems.</li>
      <li>Security considerations are integrated throughout the documentation.</li>
      <li>Troubleshooting steps are included alongside relevant configuration actions.</li>
    </ul>
  </li>
  <li><strong>Implementation of Recommendations:</strong>
    <ul>
      <li><strong>Effective Structuring of Issue Documentation:</strong> Clear headings and numbered steps facilitate easy navigation.</li>
      <li><strong>Creation and Maintenance of Comprehensive Documentation:</strong> Detailed explanations and commands ensure completeness.</li>
      <li><strong>Ensuring Permanency and Scalability in Documentation:</strong> Best practices and scalable configurations are emphasized.</li>
      <li><strong>Implementation of Documentation Unit Tests:</strong> Verification steps confirm the correctness of configurations.</li>
      <li><strong>Horizontal Scaling of Project Management through Efficient Documentation:</strong> The documentation is accessible to users with varying levels of expertise, supporting broader project maintenance.</li>
    </ul>
  </li>
</ol>
  <h1 id="organized_information">
    
    
     <a href="#organized_information">#</a><a href="#" aria-label="Back to top">organized_information</a>
        
    
  </h1>
      
  <h1 id="data">
    
    
     <a href="#data">#</a><a href="#" aria-label="Back to top">data</a>
        
    
  </h1>
      
<ol>
  <li><strong>System Update and Secure Installation of OpenSSH Server on Debian:</strong>
    <ul>
      <li>Update system packages:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo apt update &amp;&amp; sudo apt upgrade -y</code></li>
        </ul>
      </li>
      <li>Install OpenSSH server:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo apt install openssh-server -y</code></li>
        </ul>
      </li>
      <li>Verify the SSH service is active:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo systemctl status ssh</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Secure SSH Server Configuration on Debian:</strong>
    <ul>
      <li>Backup existing SSH configuration:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.backup</code></li>
        </ul>
      </li>
      <li>Edit SSH configuration file:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo nano /etc/ssh/sshd_config</code></li>
          <li>Key settings:
            <div class="language-plaintext highlighter-rouge"><div class="highlight"><section><code>PermitRootLogin no
PubkeyAuthentication yes
PasswordAuthentication no
ChallengeResponseAuthentication no
UsePAM yes
AddressFamily inet
</code></section></div>            </div>
          </li>
        </ul>
      </li>
      <li>Restart SSH service to apply changes:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo systemctl restart ssh</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Create a Non-Root User for SSH Access on Debian:</strong>
    <ul>
      <li>Add a new user:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo adduser username</code></li>
        </ul>
      </li>
      <li>Grant sudo privileges if needed:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo usermod -aG sudo username</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Set Up SSH Directory and Permissions for the User on Debian:</strong>
    <ul>
      <li>Switch to the new user:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo su - username</code></li>
        </ul>
      </li>
      <li>Create <code class="language-plaintext highlighter-rouge">.ssh</code> directory:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">mkdir ~/.ssh</code></li>
          <li><code class="language-plaintext highlighter-rouge">chmod 700 ~/.ssh</code></li>
        </ul>
      </li>
      <li>Create <code class="language-plaintext highlighter-rouge">authorized_keys</code> file:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">touch ~/.ssh/authorized_keys</code></li>
          <li><code class="language-plaintext highlighter-rouge">chmod 600 ~/.ssh/authorized_keys</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Generate SSH Key Pair on iPhone a-Shell:</strong>
    <ul>
      <li>Generate key pair with a passphrase:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">ssh-keygen -t rsa -b 4096</code></li>
        </ul>
      </li>
      <li>Store keys in the default location.</li>
      <li>Protect private key with a passphrase for enhanced security.</li>
    </ul>
  </li>
  <li><strong>Transfer Public Key to Debian Machine Securely:</strong>
    <ul>
      <li>Display public key on iPhone:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">cat ~/.ssh/id_rsa.pub</code></li>
        </ul>
      </li>
      <li>On Debian, add the public key to <code class="language-plaintext highlighter-rouge">authorized_keys</code>:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">nano ~/.ssh/authorized_keys</code></li>
          <li>Paste the public key content.</li>
          <li>Save and exit.</li>
        </ul>
      </li>
      <li>Set correct permissions:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">chmod 600 ~/.ssh/authorized_keys</code></li>
        </ul>
      </li>
      <li>Ensure ownership:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">chown username:username ~/.ssh/authorized_keys</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Configure SSH Client on iPhone a-Shell Considering iOS Sandboxing:</strong>
    <ul>
      <li>Check home directory:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">echo $HOME</code></li>
        </ul>
      </li>
      <li>Create SSH config file:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">nano ~/.ssh/config</code></li>
        </ul>
      </li>
      <li>Add configuration:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><section><code>Host debian-server
    HostName YOUR_DEBIAN_IP_ADDRESS
    User username
    IdentityFile /path/to/private/key
    ServerAliveInterval 60
    ServerAliveCountMax 3
</code></section></div>        </div>
        <ul>
          <li>Replace <code class="language-plaintext highlighter-rouge">/path/to/private/key</code> with the accurate path, considering iOS’s file system.</li>
        </ul>
      </li>
      <li>Set permissions:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">chmod 600 ~/.ssh/config</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Configure Firewall on Debian with UFW:</strong>
    <ul>
      <li>Install UFW:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo apt install ufw -y</code></li>
        </ul>
      </li>
      <li>Allow SSH connections:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo ufw allow ssh</code></li>
        </ul>
      </li>
      <li>Enable UFW:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo ufw enable</code></li>
        </ul>
      </li>
      <li>Verify status:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo ufw status</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Verify and Troubleshoot SSH Connectivity:</strong>
    <ul>
      <li>Test SSH connection from iPhone:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">ssh debian-server</code></li>
        </ul>
      </li>
      <li>For detailed output:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">ssh -vv debian-server</code></li>
        </ul>
      </li>
      <li>On Debian, check SSH service status and logs if issues arise:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">sudo systemctl status ssh</code></li>
          <li><code class="language-plaintext highlighter-rouge">sudo journalctl -u ssh</code></li>
          <li><code class="language-plaintext highlighter-rouge">sudo tail /var/log/auth.log</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Adjust File Paths on iPhone Due to iOS Sandbox Environment:</strong>
    <ul>
      <li>iOS apps have unique data directories; ensure the <code class="language-plaintext highlighter-rouge">IdentityFile</code> path in SSH config matches the actual private key location.</li>
      <li>Use commands like <code class="language-plaintext highlighter-rouge">pwd</code> and <code class="language-plaintext highlighter-rouge">ls</code> to determine the correct paths.</li>
    </ul>
  </li>
  <li><strong>Emphasize Security Best Practices Throughout:</strong>
    <ul>
      <li>Use strong, passphrase-protected SSH keys.</li>
      <li>Keep all software up to date.</li>
      <li>Monitor access logs regularly.</li>
      <li>Consider additional security measures like Fail2Ban.</li>
    </ul>
  </li>
</ol>
  <h1 id="documentation">
    
    
     <a href="#documentation">#</a><a href="#" aria-label="Back to top">documentation</a>
        
    
  </h1>
      
  <h3 id="secure-ssh-connection-between-debian-and-iphone-using-a-shell">
    
    
     <a href="#secure-ssh-connection-between-debian-and-iphone-using-a-shell">#</a><a href="#" aria-label="Back to top"><strong>Secure SSH Connection Between Debian and iPhone Using a-Shell</strong></a>
        
    
  </h3>
      
  <h4 id="1-update-and-secure-debian-system">
    
    
     <a href="#1-update-and-secure-debian-system">#</a><a href="#" aria-label="Back to top"><strong>1. Update and Secure Debian System</strong></a>
        
    
  </h4>
      
  <h5 id="11-update-system-packages">
    
    
     <a href="#11-update-system-packages">#</a><a href="#" aria-label="Back to top"><strong>1.1 Update System Packages</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>apt update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt upgrade <span class="nt">-y</span>
</code></section></div></div>
  <h5 id="12-install-openssh-server">
    
    
     <a href="#12-install-openssh-server">#</a><a href="#" aria-label="Back to top"><strong>1.2 Install OpenSSH Server</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>apt <span class="nb">install </span>openssh-server <span class="nt">-y</span>
</code></section></div></div>
  <h5 id="13-verify-ssh-service">
    
    
     <a href="#13-verify-ssh-service">#</a><a href="#" aria-label="Back to top"><strong>1.3 Verify SSH Service</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>systemctl status ssh
</code></section></div></div>

<ul>
  <li>Ensure the SSH service is active and enabled.</li>
</ul>
  <h4 id="2-configure-ssh-server-with-security-best-practices">
    
    
     <a href="#2-configure-ssh-server-with-security-best-practices">#</a><a href="#" aria-label="Back to top"><strong>2. Configure SSH Server with Security Best Practices</strong></a>
        
    
  </h4>
      
  <h5 id="21-backup-ssh-configuration">
    
    
     <a href="#21-backup-ssh-configuration">#</a><a href="#" aria-label="Back to top"><strong>2.1 Backup SSH Configuration</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo cp</span> /etc/ssh/sshd_config /etc/ssh/sshd_config.backup
</code></section></div></div>
  <h5 id="22-edit-ssh-configuration">
    
    
     <a href="#22-edit-ssh-configuration">#</a><a href="#" aria-label="Back to top"><strong>2.2 Edit SSH Configuration</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>nano /etc/ssh/sshd_config
</code></section></div></div>

<ul>
  <li>
    <p>Update the following settings:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><section><code>PermitRootLogin no
PubkeyAuthentication yes
PasswordAuthentication no
ChallengeResponseAuthentication no
UsePAM yes
AddressFamily inet
</code></section></div>    </div>
  </li>
  <li>
    <p>Save and exit the editor.</p>
  </li>
</ul>
  <h5 id="23-restart-ssh-service">
    
    
     <a href="#23-restart-ssh-service">#</a><a href="#" aria-label="Back to top"><strong>2.3 Restart SSH Service</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>systemctl restart ssh
</code></section></div></div>
  <h4 id="3-create-a-non-root-user-account">
    
    
     <a href="#3-create-a-non-root-user-account">#</a><a href="#" aria-label="Back to top"><strong>3. Create a Non-Root User Account</strong></a>
        
    
  </h4>
      
  <h5 id="31-add-new-user">
    
    
     <a href="#31-add-new-user">#</a><a href="#" aria-label="Back to top"><strong>3.1 Add New User</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>adduser username
</code></section></div></div>

<ul>
  <li>Replace <code class="language-plaintext highlighter-rouge">username</code> with your chosen username.</li>
  <li>Follow prompts to set a password and user details.</li>
</ul>
  <h5 id="32-grant-sudo-privileges-optional">
    
    
     <a href="#32-grant-sudo-privileges-optional">#</a><a href="#" aria-label="Back to top"><strong>3.2 Grant Sudo Privileges (Optional)</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>usermod <span class="nt">-aG</span> <span class="nb">sudo </span>username
</code></section></div></div>
  <h4 id="4-set-up-ssh-access-for-the-new-user">
    
    
     <a href="#4-set-up-ssh-access-for-the-new-user">#</a><a href="#" aria-label="Back to top"><strong>4. Set Up SSH Access for the New User</strong></a>
        
    
  </h4>
      
  <h5 id="41-switch-to-new-user">
    
    
     <a href="#41-switch-to-new-user">#</a><a href="#" aria-label="Back to top"><strong>4.1 Switch to New User</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>su - username
</code></section></div></div>
  <h5 id="42-create-ssh-directory">
    
    
     <a href="#42-create-ssh-directory">#</a><a href="#" aria-label="Back to top"><strong>4.2 Create <code class="language-plaintext highlighter-rouge">.ssh</code> Directory</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">mkdir</span> ~/.ssh
<span class="nb">chmod </span>700 ~/.ssh
</code></section></div></div>
  <h5 id="43-create-authorized_keys-file">
    
    
     <a href="#43-create-authorized_keys-file">#</a><a href="#" aria-label="Back to top"><strong>4.3 Create <code class="language-plaintext highlighter-rouge">authorized_keys</code> File</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">touch</span> ~/.ssh/authorized_keys
<span class="nb">chmod </span>600 ~/.ssh/authorized_keys
</code></section></div></div>
  <h4 id="5-generate-ssh-key-pair-on-iphone-a-shell">
    
    
     <a href="#5-generate-ssh-key-pair-on-iphone-a-shell">#</a><a href="#" aria-label="Back to top"><strong>5. Generate SSH Key Pair on iPhone a-Shell</strong></a>
        
    
  </h4>
      
  <h5 id="51-generate-ssh-keys">
    
    
     <a href="#51-generate-ssh-keys">#</a><a href="#" aria-label="Back to top"><strong>5.1 Generate SSH Keys</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code>ssh-keygen <span class="nt">-t</span> rsa <span class="nt">-b</span> 4096
</code></section></div></div>

<ul>
  <li>Store keys in default location.</li>
  <li>Set a passphrase when prompted for added security.</li>
</ul>
  <h5 id="52-display-public-key">
    
    
     <a href="#52-display-public-key">#</a><a href="#" aria-label="Back to top"><strong>5.2 Display Public Key</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">cat</span> ~/.ssh/id_rsa.pub
</code></section></div></div>

<ul>
  <li>Copy the entire output for the next step.</li>
</ul>
  <h4 id="6-transfer-public-key-to-debian-machine">
    
    
     <a href="#6-transfer-public-key-to-debian-machine">#</a><a href="#" aria-label="Back to top"><strong>6. Transfer Public Key to Debian Machine</strong></a>
        
    
  </h4>
      
  <h5 id="61-add-public-key-to-authorized_keys">
    
    
     <a href="#61-add-public-key-to-authorized_keys">#</a><a href="#" aria-label="Back to top"><strong>6.1 Add Public Key to <code class="language-plaintext highlighter-rouge">authorized_keys</code></strong></a>
        
    
  </h5>
      

<ul>
  <li>
    <p>On Debian (logged in as the new user):</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code>nano ~/.ssh/authorized_keys
</code></section></div>    </div>
  </li>
  <li>Paste the public key content into the file.</li>
  <li>Save and exit.</li>
</ul>
  <h5 id="62-set-correct-permissions-and-ownership">
    
    
     <a href="#62-set-correct-permissions-and-ownership">#</a><a href="#" aria-label="Back to top"><strong>6.2 Set Correct Permissions and Ownership</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">chmod </span>600 ~/.ssh/authorized_keys
<span class="nb">chown </span>username:username ~/.ssh/authorized_keys
</code></section></div></div>
  <h4 id="7-configure-ssh-client-on-iphone-a-shell">
    
    
     <a href="#7-configure-ssh-client-on-iphone-a-shell">#</a><a href="#" aria-label="Back to top"><strong>7. Configure SSH Client on iPhone a-Shell</strong></a>
        
    
  </h4>
      
  <h5 id="71-determine-home-directory-path">
    
    
     <a href="#71-determine-home-directory-path">#</a><a href="#" aria-label="Back to top"><strong>7.1 Determine Home Directory Path</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">echo</span> <span class="nv">$HOME</span>
</code></section></div></div>

<ul>
  <li>Note the path for accurate configuration.</li>
</ul>
  <h5 id="72-create-ssh-config-file">
    
    
     <a href="#72-create-ssh-config-file">#</a><a href="#" aria-label="Back to top"><strong>7.2 Create SSH Config File</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code>nano ~/.ssh/config
</code></section></div></div>

<ul>
  <li>
    <p>Add the following content:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><section><code>Host debian-server
    HostName YOUR_DEBIAN_IP_ADDRESS
    User username
    IdentityFile /path/to/id_rsa
    ServerAliveInterval 60
    ServerAliveCountMax 3
</code></section></div>    </div>
  </li>
  <li>
    <p>Replace <code class="language-plaintext highlighter-rouge">/path/to/id_rsa</code> with the actual path to your private key, considering the iOS file system.</p>
  </li>
</ul>
  <h5 id="73-set-permissions">
    
    
     <a href="#73-set-permissions">#</a><a href="#" aria-label="Back to top"><strong>7.3 Set Permissions</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">chmod </span>600 ~/.ssh/config
</code></section></div></div>
  <h4 id="8-configure-ufw-firewall-on-debian">
    
    
     <a href="#8-configure-ufw-firewall-on-debian">#</a><a href="#" aria-label="Back to top"><strong>8. Configure UFW Firewall on Debian</strong></a>
        
    
  </h4>
      
  <h5 id="81-install-ufw">
    
    
     <a href="#81-install-ufw">#</a><a href="#" aria-label="Back to top"><strong>8.1 Install UFW</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>apt <span class="nb">install </span>ufw <span class="nt">-y</span>
</code></section></div></div>
  <h5 id="82-allow-ssh-through-firewall">
    
    
     <a href="#82-allow-ssh-through-firewall">#</a><a href="#" aria-label="Back to top"><strong>8.2 Allow SSH Through Firewall</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>ufw allow OpenSSH
</code></section></div></div>
  <h5 id="83-enable-firewall">
    
    
     <a href="#83-enable-firewall">#</a><a href="#" aria-label="Back to top"><strong>8.3 Enable Firewall</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>ufw <span class="nb">enable</span>
</code></section></div></div>
  <h5 id="84-verify-firewall-status">
    
    
     <a href="#84-verify-firewall-status">#</a><a href="#" aria-label="Back to top"><strong>8.4 Verify Firewall Status</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>ufw status
</code></section></div></div>
  <h4 id="9-test-and-troubleshoot-ssh-connection">
    
    
     <a href="#9-test-and-troubleshoot-ssh-connection">#</a><a href="#" aria-label="Back to top"><strong>9. Test and Troubleshoot SSH Connection</strong></a>
        
    
  </h4>
      
  <h5 id="91-test-ssh-connection-from-iphone">
    
    
     <a href="#91-test-ssh-connection-from-iphone">#</a><a href="#" aria-label="Back to top"><strong>9.1 Test SSH Connection from iPhone</strong></a>
        
    
  </h5>
      

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code>ssh debian-server
</code></section></div></div>

<ul>
  <li>Enter the passphrase for your SSH key when prompted.</li>
</ul>
  <h5 id="92-troubleshoot-if-necessary">
    
    
     <a href="#92-troubleshoot-if-necessary">#</a><a href="#" aria-label="Back to top"><strong>9.2 Troubleshoot if Necessary</strong></a>
        
    
  </h5>
      

<ul>
  <li>
    <p>Use verbose mode for detailed output:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code>ssh <span class="nt">-vv</span> debian-server
</code></section></div>    </div>
  </li>
  <li>
    <p>On Debian, check SSH service and logs:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>systemctl status ssh
<span class="nb">sudo </span>journalctl <span class="nt">-u</span> ssh
<span class="nb">sudo tail</span> /var/log/auth.log
</code></section></div>    </div>
  </li>
</ul>
  <h4 id="10-adjust-for-ios-sandboxing-on-iphone-a-shell">
    
    
     <a href="#10-adjust-for-ios-sandboxing-on-iphone-a-shell">#</a><a href="#" aria-label="Back to top"><strong>10. Adjust for iOS Sandboxing on iPhone a-Shell</strong></a>
        
    
  </h4>
      

<ul>
  <li>
    <p>If you encounter issues, verify the actual file paths:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">pwd
ls</span> <span class="nt">-la</span> ~/.ssh/
</code></section></div>    </div>
  </li>
  <li>
    <p>Adjust <code class="language-plaintext highlighter-rouge">IdentityFile</code> in SSH config to the correct path.</p>
  </li>
</ul>
  <h4 id="11-maintain-security-best-practices">
    
    
     <a href="#11-maintain-security-best-practices">#</a><a href="#" aria-label="Back to top"><strong>11. Maintain Security Best Practices</strong></a>
        
    
  </h4>
      

<ul>
  <li>
    <p><strong>Use Strong Passphrases:</strong></p>

    <ul>
      <li>Protect private keys with strong, unique passphrases.</li>
    </ul>
  </li>
  <li>
    <p><strong>Regularly Update Systems:</strong></p>

    <ul>
      <li>Keep both Debian and iPhone systems updated.</li>
    </ul>
  </li>
  <li>
    <p><strong>Monitor Access Logs:</strong></p>

    <ul>
      <li>Check logs for unauthorized access attempts.</li>
    </ul>

    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo tail</span> /var/log/auth.log
</code></section></div>    </div>
  </li>
  <li>
    <p><strong>Consider Additional Security Measures:</strong></p>

    <ul>
      <li>
        <p>Implement tools like Fail2Ban.</p>
      </li>
      <li>
        <p>Limit SSH access by IP or use port knocking.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>Regularly Review SSH Configuration:</strong></p>

    <ul>
      <li>Ensure settings align with current security recommendations.</li>
    </ul>
  </li>
</ul>
  <h1 id="paper_trail">
    
    
     <a href="#paper_trail">#</a><a href="#" aria-label="Back to top">paper_trail</a>
        
    
  </h1>
      
<ul>
  <li>
    <p><strong>Disabled Root Login Over SSH:</strong> Set <code class="language-plaintext highlighter-rouge">PermitRootLogin no</code> in <code class="language-plaintext highlighter-rouge">sshd_config</code> to prevent direct root access, enhancing security. This aligns with best practices to reduce the risk of unauthorized root-level access.</p>
  </li>
  <li>
    <p><strong>Created Non-Root User for SSH Access:</strong> Established a regular user account to facilitate secure SSH connections. Providing <code class="language-plaintext highlighter-rouge">sudo</code> privileges allows administrative tasks without compromising security.</p>
  </li>
  <li>
    <p><strong>Emphasized Use of Passphrase-Protected SSH Keys:</strong> Encouraged setting a passphrase when generating SSH keys on the iPhone to add a layer of security in case the device is lost or compromised.</p>
  </li>
  <li>
    <p><strong>Adjusted SSH Client Configuration for iOS Sandboxing:</strong> Provided detailed instructions on identifying the correct file paths within the iOS sandbox environment to ensure the SSH client functions correctly.</p>
  </li>
  <li>
    <p><strong>Improved Documentation Structure and Clarity:</strong> Reordered steps for logical flow, grouped related tasks, and distinguished actions between devices and user contexts for better readability.</p>
  </li>
  <li>
    <p><strong>Highlighted Security Best Practices Throughout:</strong> Integrated security considerations into each step, including SSH configuration, key management, and firewall settings, to promote a secure implementation.</p>
  </li>
  <li>
    <p><strong>Provided Troubleshooting Guidance:</strong> Included commands and tips for diagnosing and resolving common SSH connectivity issues, aiding users in effective problem-solving.</p>
  </li>
  <li>
    <p><strong>Verified All Commands and Settings:</strong> Cross-checked all instructions against current best practices and official documentation to ensure accuracy and reliability.</p>
  </li>
  <li>
    <p><strong>Made the Documentation Accessible:</strong> Wrote explanations and instructions suitable for users with varying levels of expertise, ensuring the project is maintainable by third parties.</p>
  </li>
</ul>

      </div>
      
        URL: https://ib.bsb.br/ssh-between-linux-and-iphone-via-a-shell
      
    </article>
    <nav class="post-navigation" aria-label="Post navigation">
      
        <div class="nav-arrow prev">
          <a href="/simon-says-documentation/" title="Simon says: Documentation" rel="prev">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAxVJREFUaEPt18FqG1cUBuD/nLkzI42UiVInkFLTCAKhS+9KA+3Kq1L8AAHjhR7AKz+ADV55qUfoqhvThTfdmC4KzTKmYJrELshJW9PIlSeKRpqZe88pUtouihvVRknqMNoMzD1zdPXNrzMM4RJ+6BLuGeWm39RdK6VL6VcIlPEo41HG401loJQupS8mUM7pi7md/6p3UtoHUJzf4vVecZb0e0EQfB7H8b0kSeqqummt/eb1buN83SebNsZ8QkQCYHVpaenu/v7+ra2tLRwdHWF1ddWq6hfM3BCRE2b+FcBHACQAHo1E5v9c+5mIhkR0e3z0VQ8LotuqWlXVw/GRmT8QkdMK89McuAOAAfwoIu8z85yIHBPRKRGN1/IAeDx0rul53hivo6psrf2ejDGfEtFOu92u7O3tBWtra2i322g0GhgOh9je3ka325UPax7fCR0iw+lp4aLxr70aeOmgkChTRY3JGSb73EroERD73uB54WpOgdhwZkXNQNQLiVDzOU1yFymAhu+lqZVopIqISQKmPLFS+atHv3A1q8AVQ/lXP/VHRPQx+b6frKysxMvLy1hfX0ez2USv18PCwgLiOEaSJKhWq/jhwQN8dnIfVOS4dsWHqCJ5YREGjBuNEMfd0eTc9WshBqnFYGhRqxrUIoNuLwMT4eb1Cp6dZshywdW6mZzr9QsEPuPmXIhfno3gnGKuEWCUC14MLKoVb1L72+8Zvj3JOl/udZt/S7darUqn0wlarRZ2d3cxPz+PJ8dPsPP1Doq8kIbL+cawjxBIM8MRFAidpBlRpIbhFc55gM2NF5IIQtVBRlRTZgTWZQ4wzvc8spO1NPM4Gr9Wh1bSDIjU98C5E0PIC8OVSX+Rlz08hl+4/LsML6X/menFxcW7BwcHtzY2NvDw8CE21zf/NdMAHskFMs3MT/EfMg3gsTsr02f8byfTo16v3+v3+//f6fGKgXNp5vT5huZbqH4nH+NvwXH6V5bS041mU1FKz8ZxepdSerrRbCpK6dk4Tu9SSk83mk1FKT0bx+ldSunpRrOpuJTSfwBcuImxpyA7XgAAAABJRU5ErkJggg==" alt="Previous article" width="45" height="45" loading="lazy">
          </a>
        </div>
      
      
        <div class="nav-arrow next">
          <a href="/a-shell-thermal/" title="iOS Shortcut for Linux Thermal Printing" rel="next">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAwdJREFUaEPtl01rG1cUht9z7p070ijKWLVS3I9YULtNMBRn2UIXxZtuvCjedNWfoKVXBvsHeOUfoIUx5AeY0pVXXSR052UxBJSi0kDiRplII83HvadI9CMtOFjCmBjubC7cc8+Zc555eYdLuIEP3cCe4Zu+rq/mSXvSbyHg5eHl4eVxXRrwpD3p+Qh4n56P2+xZnvTszC7MCAAUF0XfOdJa62+IaCeO40GSJA/zPP8RwB9vDjBtWmv9JRE5ImpZawdVpbo58CkAIyJnIrLAzEvOuXNm/h3AfQDOAGdj5z5m5gXn3G9ENCKilckaiDwpiFZEpCoiTyYrM3/knOtXmHs58BkABvCLc+4DZl6cxIjoh4ODA728vIzt7W2sra09PT4+fgTgQES4LMvHZIy5LyI/f/dJvfK6FKMJqAdqmBS2ZgWINY9zJyZ1whUiRJrTfmGjybSxUemwcFEmghqT1UxlUrpQEXD7jRq3NWelEz10okIi1AJOX+U2EgALgUrT0kVnmcKvQ+uazSZvbW2hWq2i3++j3W5jf38f6+vrebvdHovI5pT09+vN7teLYev990K8GpQYjS1u1TQqhnHez6EU4cM7FTw7z5AXDo16ACcyPRsaxp2FEM9ejKd7zUaIYVpiOCpRq2rUIo0XLzMwEZaaFTzvZ8hyh/iWnu69fF1AAoOfFr/A5w8eYDQaIY5jJEmC09NTNBoNdLtd7O3t4ejoCIeHh8k/pL8KUSkCZcg6hCLDjLk2ufYGpRuXAuOMYiosQiDNNEcQILQuzYgi0QxVWKuAMtcqJPdXDaKaMMOUNrOAtoFSVE5jaaY4mtQPS5dmQPS8WkdfGReYgDe/3cTdpbvo9XrY2NhAp9NBq9XKO53Ov6T/r2mlVBeX0DSAMzeHppm5h7doemdvR99buYfd3V2srq4+PTk5+a+mr9CmrqTU3+5Rr9cHg8HgYve4krddbZGb5dOXmf2d+7n4pi9D4LrOeHl40v42fl0a8KQ96fkIeJ+ej9vsWZ707Mzmy/Ck5+M2e9afhmuAz1BhwewAAAAASUVORK5CYII=" alt="Next article" width="45" height="45" loading="lazy">
          </a>
        </div>
      
    </nav>
    
  </main>
  <footer class="site-footer">
    <p>
      <a href="#" aria-label="Back to top">
        <img src="/assets/Rope_(Old).gif" alt="Back to top" width="32" height="32" loading="lazy">
      </a><a href="https://ib.bsb.br/404" aria-label="404">2024-12-29 15:23:55</a>‎ ⇔‎ <a href="https://github.com/ib-bsb-br/ib-bsb-br.github.io" aria-label="GitHub">ℹ</a>‎ <a href="/" aria-label="Homepage">infoBAG</a>
    </p>
  </footer>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://ib.bsb.br/ssh-between-linux-and-iphone-via-a-shell/"
    },
    "headline": "SSH between Linux and iPhone via a-Shell",
    "description": "",
    "datePublished": "2024-10-26T00:00:00+00:00",
    "dateModified": "2024-10-26T21:04:13+00:00",
    "author": {
      "@type": "Person",
      "name": "Author"
    },
    "publisher": {
      "@type": "Organization",
      "name": "infoBAG"
      
    }
    
  }
  </script>
  <script src="/assets/js/prism.js" defer></script>
</body>
</html>
