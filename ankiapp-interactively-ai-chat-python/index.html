<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    
      AnkiApp interactively AI chat (python) — infoBAG
    
  </title>
  <meta name="title" content="AnkiApp interactively AI chat (python)">
  <meta name="description" content="can't steer unless already moving">
  <meta property="og:title" content="AnkiApp interactively AI chat (python) — infoBAG">
  <meta property="og:description" content="can't steer unless already moving">
  <meta property="og:url" content="https://ib.bsb.br/ankiapp-interactively-ai-chat-python/">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="infoBAG">
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="AnkiApp interactively AI chat (python) — infoBAG">
  <meta name="twitter:description" content="can't steer unless already moving">
  

  <link rel="canonical" href="https://ib.bsb.br/ankiapp-interactively-ai-chat-python/">
  <link rel="alternate" type="application/rss+xml" title="infoBAG" href="https://ib.bsb.br/rss.xml">

  
    <meta name="keywords" content="scripts>AI">
    
      <meta property="article:tag" content="scripts>AI">
    
  
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  

  <link href="/style.css" rel="stylesheet">
</head>
<body class="post-content-body">
  <header class="header-container">
    <nav aria-label="Main navigation" class="header-content">
      <a href="/" aria-label="Home">
        <img src="/favicon.ico" alt="Home" class="favicon search-link" width="45" height="45" loading="lazy">
      </a>
      <a href="/tags" aria-label="Tags">
        <img src="/assets/Label.gif" alt="Tags" class="favicon search-link" width="45" height="45" loading="lazy">
      </a>
      <a href="/archive" aria-label="Archive">
        <img src="/assets/Loose_Stone_Pile.gif" alt="Archive" class="favicon search-link" width="45" height="45" loading="lazy">
      </a>
      <a href="/events" aria-label="Events">
        <img src="/assets/Paralyse_Rune.gif" alt="Events" class="favicon search-link" width="45" height="45" loading="lazy">
      </a>
      <a href="/archive-created" aria-label="Archive created">
          <img src="/assets/Hole_(Rock).gif" alt="Archive created" class="favicon search-link" width="32" height="32" loading="lazy">
      </a>
      <a href="/rot64" aria-label="rot">
          <img src="/assets/rot.gif" alt="rot" class="favicon search-link" width="32" height="32" loading="lazy">
      </a>
    </nav>
    <h5 class="post-title">
      <a href="#bottom-of-page" aria-label="Go to bottom">
        AnkiApp interactively AI chat (python)
      </a>
    </h5>
    <div class="post-meta">
      <time datetime="2024-10-20T00:00:00+00:00" class="post-date">
        20 Oct 2024
      </time>
      
        <span class="post-updated">
          ↣
          <time datetime="2024-10-20T12:35:35+00:00">20 Oct 2024</time>
        </span>
      
      
        <p class="post-slug">
          Slug: <a href="https://ib.bsb.br/ankiapp-interactively-ai-chat-python" class="tag">ankiapp-interactively-ai-chat-python</a>
        </p>
      
      
        <p class="post-tags">
          Tags:
          
            <a href="https://ib.bsb.br/tags/#scripts-ai" class="tag">scripts>AI</a>
          
        </p>
      
    </div>
    <div class="post-actions">
      <div class="page-stats mt-3" role="status" aria-label="Page statistics">
        <span class="badge bg-primary">
          6777 characters
        </span>
        <span class="separator mx-2" aria-hidden="true">•</span>
        <span class="badge bg-primary">
          740 words
        </span>
      </div>
      <div class="action-buttons d-flex flex-wrap gap-2">
        
          
            <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/edit/main/_posts/2024-10-20-ankiapp-interactively-ai-chat-python.md"
                  method="GET"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="d-inline-block">
              <button type="submit" class="btn btn-danger" aria-label="Edit page content">
                <span class="button-text">Improve this page?</span>
                <span class="info-text">aberto.</span>
              </button>
            </form>
          
          <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/commits/main/_posts/2024-10-20-ankiapp-interactively-ai-chat-python.md"
                method="GET"
                target="_blank"
                rel="noopener noreferrer"
                class="d-inline-block">
            <button type="submit" class="btn btn-danger" aria-label="View page revision history">
              View revision history
            </button>
          </form>
        
      </div>
    </div>
  </header>
  <main class="content">
    <article class="post-wrapper">
      <div class="post-content-body">
        

        <section data-filename="python_code-block.py" data-code="import requests
import json
import os
# Authentication details (INSECURE - DO NOT USE IN PRODUCTION). Environment variables are preferred
# Extracting these to env vars should be done before moving the python code
# for interactivelly prompting into the phone
#for setting this on a-shell (ios):
#client_id=$(echo &quot;&lt;clientId from the hardcoded python vars extraction below gathered on script generation phase&gt;&quot; | base64)
#client_token=$(echo &quot;&lt;clientToken&gt;&quot; | base64) #client token does not need adjustments before putting it on base64 for security.
#client_version=&quot;&lt;clientVersion from hardcoded vars as simple string&gt;”
client_ids = [&quot;12e5d390c33649d7b1e6c66b5d98bb80&quot;]  # From your .har file
client_tokens = [&quot;LdGInADDy99mbqWmkfh5YmfzHP9SMhmWwXs7ymfEEJc=&quot;] # From your .har file
client_versions = [&quot;9.6.1&quot;] # From your .har file
def anki_ai_chat(client_id, client_token, client_version):
url = &quot;https://api.ankiapp.com/decks/ai&quot;
headers = {
&quot;accept&quot;: &quot;*/*&quot;,
&quot;accept-language&quot;: &quot;en&quot;,
&quot;ankiapp-client-id&quot;: client_id,
&quot;ankiapp-client-token&quot;: client_token,
&quot;ankiapp-client-version&quot;: client_version,
&quot;content-type&quot;: &quot;application/json&quot;
}
session_id = None
deck = {&quot;layouts&quot;: [], &quot;config&quot;: {}}
while True:
prompt = input(&quot;Enter your prompt (or type 'quit' to exit): &quot;)
if prompt.lower() == &quot;quit&quot;:
break
data = {
&quot;prompt&quot;: prompt,
&quot;deck&quot;: deck,
&quot;pending&quot;: []  # Essential for newer API versions
}
if session_id:
data[&quot;session_id&quot;] = session_id
try:
response = requests.post(url, headers=headers, data=json.dumps(data))
response.raise_for_status()
response_json = response.json()
if &quot;session_id&quot; in response_json and not session_id: #Handles only from the very first time since a single user can and should only generate one of it. Multiple users is to be seen...
session_id = response_json[&quot;session_id&quot;]
if 'data' in response_json:
print(&quot;Response:&quot;)
for item in response_json[&quot;data&quot;]:
print(f&quot;{item[0]}: {item[1]}&quot;)
elif 'pending' in response_json:
print(&quot;Response:&quot;)
for item in response_json[&quot;pending&quot;]:
print(f&quot;{item['Front']}: {item['Back']}&quot;)
else:
print(f&quot;Unexpected response structure:\n{json.dumps(response_json, indent=4)}&quot;)
except requests.exceptions.RequestException as e:
print(f&quot;AnkiApp API Error: {e}&quot;)
if response.content:  # Check for content before attempting decode
try:
error_json = response.json()
print(f&quot;Error details: {json.dumps(error_json, indent=4)}&quot;)
except json.JSONDecodeError: #Handles empty or corrupted data as a raw text format (utf-8 or others...).
print(f&quot;Raw error response: {response.content}&quot;)
except json.JSONDecodeError as e: #If nothing worked, also try converting response's data to raw utf-8 string or even raw data, before continuing the conversation, which will probably halt in errors if done and some new error is introduced, so maybe remove it or adjust...
print(f&quot;Couldn't parse JSON response: {e}. Printing raw content instead...\nResponse content:{response.content}&quot;)
# Example usage (single credential). Extract multiple credentials and pass by user
anki_ai_chat(client_ids[0], client_tokens[0], client_versions[0])" data-download-link="" data-download-link-label="Download Python"><code class="language-python">import requests
import json
import os
# Authentication details (INSECURE - DO NOT USE IN PRODUCTION). Environment variables are preferred
# Extracting these to env vars should be done before moving the python code
# for interactivelly prompting into the phone
#for setting this on a-shell (ios):
#client_id=$(echo "<clientId from="" the="" hardcoded="" python="" vars="" extraction="" below="" gathered="" on="" script="" generation="" phase="">" | base64)
#client_token=$(echo "<clientToken>" | base64) #client token does not need adjustments before putting it on base64 for security.
#client_version="<clientVersion from="" hardcoded="" vars="" as="" simple="" string="">”
client_ids = ["12e5d390c33649d7b1e6c66b5d98bb80"]  # From your .har file
client_tokens = ["LdGInADDy99mbqWmkfh5YmfzHP9SMhmWwXs7ymfEEJc="] # From your .har file
client_versions = ["9.6.1"] # From your .har file
def anki_ai_chat(client_id, client_token, client_version):
url = "https://api.ankiapp.com/decks/ai"
headers = {
"accept": "*/*",
"accept-language": "en",
"ankiapp-client-id": client_id,
"ankiapp-client-token": client_token,
"ankiapp-client-version": client_version,
"content-type": "application/json"
}
session_id = None
deck = {"layouts": [], "config": {}}
while True:
prompt = input("Enter your prompt (or type 'quit' to exit): ")
if prompt.lower() == "quit":
break
data = {
"prompt": prompt,
"deck": deck,
"pending": []  # Essential for newer API versions
}
if session_id:
data["session_id"] = session_id
try:
response = requests.post(url, headers=headers, data=json.dumps(data))
response.raise_for_status()
response_json = response.json()
if "session_id" in response_json and not session_id: #Handles only from the very first time since a single user can and should only generate one of it. Multiple users is to be seen...
session_id = response_json["session_id"]
if 'data' in response_json:
print("Response:")
for item in response_json["data"]:
print(f"{item[0]}: {item[1]}")
elif 'pending' in response_json:
print("Response:")
for item in response_json["pending"]:
print(f"{item['Front']}: {item['Back']}")
else:
print(f"Unexpected response structure:\n{json.dumps(response_json, indent=4)}")
except requests.exceptions.RequestException as e:
print(f"AnkiApp API Error: {e}")
if response.content:  # Check for content before attempting decode
try:
error_json = response.json()
print(f"Error details: {json.dumps(error_json, indent=4)}")
except json.JSONDecodeError: #Handles empty or corrupted data as a raw text format (utf-8 or others...).
print(f"Raw error response: {response.content}")
except json.JSONDecodeError as e: #If nothing worked, also try converting response's data to raw utf-8 string or even raw data, before continuing the conversation, which will probably halt in errors if done and some new error is introduced, so maybe remove it or adjust...
print(f"Couldn't parse JSON response: {e}. Printing raw content instead...\nResponse content:{response.content}")
# Example usage (single credential). Extract multiple credentials and pass by user
anki_ai_chat(client_ids[0], client_tokens[0], client_versions[0])
</clientVersion></clientToken></clientId></code></section>

      </div>
      
        URL: https://ib.bsb.br/ankiapp-interactively-ai-chat-python
      
    </article>
        <nav class="post-navigation same-tag-navigation" aria-label="Posts sharing the same tag">
          
          
        </nav>
    
    
      
      
      
        
      
        
          
          
      
    
    
  </main>
  <footer id="bottom-of-page" class="site-footer">
    <p>
      <a href="#" aria-label="Back to top">
        <img src="/assets/Rope_(Old).gif" alt="Back to top" width="32" height="32" loading="lazy">
      </a><a href="https://ib.bsb.br/404" aria-label="404">2025-01-28 18:18:28</a>‎ ⇔‎ <a href="https://github.com/ib-bsb-br/ib-bsb-br.github.io" aria-label="GitHub">ℹ</a>‎ <a href="/" aria-label="Homepage">infoBAG</a><button id="copyAllButton" aria-label="Copy all code">&copy;</button>
    </p>
  </footer>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://ib.bsb.br/ankiapp-interactively-ai-chat-python/"
    },
    "headline": "AnkiApp interactively AI chat (python)",
    "description": "",
    "datePublished": "2024-10-20T00:00:00+00:00",
    "dateModified": "2024-10-20T12:35:35+00:00",
    "author": {
      "@type": "Person",
      "name": "Author"
    },
    "publisher": {
      "@type": "Organization",
      "name": "infoBAG"
      
    }
    
  }
  </script>
  <script src="/assets/js/prism.js" defer></script>
  <script src="/assets/js/copy-all-code.js"></script>
</body>
</html>
