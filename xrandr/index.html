<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
      
        autorandr and bash script to collect and setup monitor data for xrandr - infoBAG
      
    </title>
    <meta name="title" content="autorandr and bash script to collect and setup monitor data for xrandr - infoBAG" />
    <meta name="description" content="">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://ib.bsb.br/xrandr/">
    <meta property="og:title" content="autorandr and bash script to collect and setup monitor data for xrandr - infoBAG">
    <meta property="og:description" content="">
    <meta property="og:image" content="/favicon.ico">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://ib.bsb.br/xrandr/">
    <meta name="twitter:title" content="autorandr and bash script to collect and setup monitor data for xrandr - infoBAG">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="/favicon.ico">
    <link rel="canonical" href="https://ib.bsb.br/xrandr/">
    <link rel="alternate" type="application/rss+xml" title="infoBAG" href="https://ib.bsb.br/rss.xml">
    
      <meta name="keywords" content="scratchpad">
      
        <meta property="article:tag" content="scratchpad">
      
    
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    
    <link rel="stylesheet" href="/style.css">
  </head>
  <body class="post-content-body">
    <header class="header-container">
      <nav aria-label="Main navigation" class="header-content">
        <a href="/" aria-label="Home">
          <img src="/favicon.ico" alt="Home" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/tags" aria-label="Tags">
          <img src="/assets/Label.gif" alt="Tags" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/send" aria-label="send">
          <img src="/assets/rot.gif" alt="send" class="favicon search-link" width="32" height="32" loading="lazy">
        </a> 
        <a href="/created" aria-label="archive created">
          <img src="/assets/Loose_Stone_Pile.gif" alt="archive created" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/events" aria-label="Events">
          <img src="/assets/Paralyse_Rune.gif" alt="Events" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/modified" aria-label="archive modified">
          <img src="/assets/Hole_(Rock).gif" alt="archive modified" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
    </nav>
      <h5 class="post-title">
        <a href="#bottom-of-page" aria-label="Go to bottom">
          autorandr and bash script to collect and setup monitor data for xrandr
        </a>
      </h5>
      <div class="post-meta">
        <time datetime="2025-04-03T00:00:00+00:00" class="post-date">
          03 Apr 2025
        </time>
        
          <span class="post-updated">
            ↣
            <time datetime="2025-05-07T23:04:56+00:00">
              07 May 2025
            </time>
          </span>
        
        
          <p class="post-slug">
            Slug: <a href="https://ib.bsb.br/xrandr" class="tag">xrandr</a>
          </p>
        
        
          <p class="post-tags">
            Tags:
            
              <a href="https://ib.bsb.br/tags/#scratchpad" class="tag">scratchpad</a>
            
          </p>
        
      </div>
      <div class="post-actions">
        <div class="page-stats mt-3" role="status" aria-label="Page statistics">
      
      <span class="badge bg-primary">
        32705 characters
      </span>
        <span class="separator mx-2" aria-hidden="true">•</span>
        <span class="badge bg-primary">
        4214 words
      </span>
      </div>
        <div class="action-buttons d-flex flex-wrap gap-2">
          
            
              <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/edit/main/_posts/2025-04-03-xrandr.md"
                    method="GET"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="d-inline-block">
                <button type="submit" class="btn btn-danger" aria-label="Edit page content">
                  <span class="button-text">Improve this page?</span>
                  <span class="info-text">aberto.</span>
                </button>
              </form>
            
            <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/commits/main/_posts/2025-04-03-xrandr.md"
                  method="GET"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="d-inline-block">
              <button type="submit" class="btn btn-danger" aria-label="View page revision history">
                View revision history
              </button>
            </form>
          
        </div>
      </div>
    </header>
    <main class="content">
      <article class="post-wrapper">
        <div class="post-content-body">
          
<ul><li><a href="#why-use-autorandr"><strong>Why Use autorandr?</strong></a></li><li><a href="#prerequisites-raspberry-pi-4b-specific"><strong>Prerequisites (Raspberry Pi 4B Specific)</strong></a></li><li><a href="#installation-on-opensuse-tumbleweed"><strong>Installation on openSUSE Tumbleweed</strong></a></li><li><a href="#basic-configuration-creating-and-managing-profiles"><strong>Basic Configuration: Creating and Managing Profiles</strong></a></li><li><a href="#applying-configurations"><strong>Applying Configurations</strong></a></li><li><a href="#automation-recommended"><strong>Automation (Recommended)</strong></a></li><li><a href="#setting-a-default-fallback-profile"><strong>Setting a Default Fallback Profile</strong></a></li><li><a href="#advanced-usage"><strong>Advanced Usage</strong></a></li><li><a href="#troubleshooting"><strong>Troubleshooting</strong></a></li><li><a href="#alternative-hardware-hdmi-edid-emulator"><strong>Alternative: Hardware HDMI EDID Emulator</strong></a></li><li><a href="#resources"><strong>Resources</strong></a></li></ul>
          <h3 id="why-use-autorandr">
    
    
     <a href="#why-use-autorandr">#</a><a href="#" aria-label="Back to top"><strong>Why Use autorandr?</strong></a>
        
    
  </h3>
      

<p>autorandr is a highly effective, Python-based utility specifically designed to automate and simplify the management of multiple display configurations on Linux systems. Its core strength lies in its ability to automatically detect which displays (like projectors, external monitors, or ultrawide screens) are currently connected to your system and then apply a pre-saved configuration (“profile”) that matches that specific hardware setup. This eliminates the need to manually execute commands with xrandr (a command-line tool for configuring display settings) every time you connect or disconnect a display.</p>

<p>This automation is particularly beneficial in your scenario as a professor using a Raspberry Pi 4B with openSUSE Tumbleweed. Imagine moving between different lecture halls, each potentially having a projector with a unique native resolution (1024x768, 1280x800, etc.), then returning to your office to connect to an ultrawide monitor (e.g., 3440x1440), and perhaps later connecting to a standard monitor in a departmental meeting room. Without autorandr, each transition would require manual reconfiguration. With autorandr, once you’ve saved a profile for each setup, the system adapts automatically upon connection. Furthermore, on a modern system like openSUSE Tumbleweed, autorandr integrates seamlessly with the systemd init system. This means it can leverage udev events (the system’s way of detecting hardware changes like plugging in a monitor) to trigger the profile switching automatically in the background, offering a truly hands-off experience after the initial setup.</p>

<p><strong>Key Benefits Elaborated:</strong></p>

<ul>
  <li><strong>Automatic Detection &amp; Application:</strong> autorandr intelligently identifies connected displays, often using their unique EDID information, and compares this against its library of saved profiles to find the best match, applying it instantly.</li>
  <li><strong>Ease of Use:</strong> The “save once, use anywhere” philosophy drastically reduces complexity. Instead of remembering complex xrandr commands or navigating display settings repeatedly, you perform the setup once per unique display combination and save it with a memorable name.</li>
  <li><strong>Flexibility:</strong> It excels at managing numerous distinct profiles. You can have profiles for single displays, dual displays in different arrangements (extended desktop, mirrored), displays with specific resolutions or refresh rates, covering virtually any common scenario you encounter.</li>
  <li><strong>Robustness:</strong> It gracefully handles situations where display EDID information might be missing, corrupt, or ambiguous – common issues with older projectors or certain adapters. Instead of failing outright or requiring manual intervention like raw xrandr might, autorandr can use other detected properties or fall back to a predefined default profile, ensuring you usually get a usable display state.</li>
</ul>
  <h3 id="prerequisites-raspberry-pi-4b-specific">
    
    
     <a href="#prerequisites-raspberry-pi-4b-specific">#</a><a href="#" aria-label="Back to top"><strong>Prerequisites (Raspberry Pi 4B Specific)</strong></a>
        
    
  </h3>
      

<p>Before diving into autorandr installation, optimizing your Raspberry Pi 4B environment is crucial for smooth display operation, especially given its shared memory architecture:</p>

<ul>
  <li><strong>GPU Memory (gpu_mem):</strong> The Raspberry Pi dynamically allocates system RAM between the CPU and the VideoCore GPU. Insufficient memory allocated to the GPU can lead to various graphical issues, such as visual glitches, screen tearing, an inability to drive displays at their native (especially high) resolutions (like 4K), or even completely blank screens. While the default allocation might be sufficient for basic desktop use, connecting multiple monitors or high-resolution displays often requires more. Check your current allocation and consider increasing it if you face issues. You can adjust this by editing the /boot/efi/extraconfig.txt file (the path might vary slightly depending on the exact Tumbleweed Pi image setup) and adding or modifying a line like gpu_mem=256 or gpu_mem=512 (allocating 256MB or 512MB respectively). A reboot is required for this change to be applied by the system.</li>
  <li><strong>Firmware &amp; System Updates:</strong> The Raspberry Pi’s firmware and the Linux kernel’s graphics drivers (like V3D DRM) are continually updated to improve hardware compatibility, fix bugs, and enhance performance. These updates often include improved handling of display detection protocols like EDID. Keeping your openSUSE Tumbleweed system fully updated is the best way to ensure you have the latest fixes and broadest compatibility. Use the standard Tumbleweed update command, sudo zypper dup (which performs a full system upgrade). Regularly running this ensures you benefit from the latest improvements relevant to display handling.</li>
</ul>
  <h3 id="installation-on-opensuse-tumbleweed">
    
    
     <a href="#installation-on-opensuse-tumbleweed">#</a><a href="#" aria-label="Back to top"><strong>Installation on openSUSE Tumbleweed</strong></a>
        
    
  </h3>
      

<p>You have several avenues to install autorandr on your system:</p>

<ol>
  <li>
    <p><strong>Check Standard Repositories (Try First):</strong> OpenSUSE Tumbleweed might already include autorandr in its main repositories. You can check its availability and install it if found:<br />
# Check if the package exists<br />
zypper info autorandr<br />
# If available, install it<br />
sudo zypper refresh<br />
sudo zypper install autorandr</p>
  </li>
  <li>
    <p><strong>Recommended Method (openSUSE Build Service - OBS):</strong> The autorandr author often maintains a more up-to-date version in a dedicated OBS repository. This is generally the preferred method if the package isn’t in the main repos or if you need the latest features/fixes:<br />
# Add the repository<br />
sudo zypper addrepo https://download.opensuse.org/repositories/home:phillipberndt/openSUSE_Tumbleweed/home:phillipberndt.repo<br />
# Refresh repository metadata<br />
sudo zypper refresh<br />
# Install autorandr from the new repo<br />
sudo zypper install autorandr</p>
  </li>
  <li>
    <p><strong>Alternative Method (pip):</strong> You can install autorandr using Python’s package installer, pip. However, be aware that this method might install it only for the current user, might not integrate as seamlessly with system-wide services like systemd/udev, and might require manual handling of non-Python dependencies. It can also lead to conflicts if system packages also provide parts of the dependencies.<br />
# Ensure pip is installed, then install autorandr<br />
sudo zypper install python3-pip<br />
sudo pip install autorandr</p>
  </li>
  <li>
    <p><strong>Alternative Method (From Source):</strong> For developers or those needing the absolute latest code, you can clone the autorandr Git repository and install it manually. This typically requires development tools like gcc and make, and you’ll need to manage dependencies yourself. Consult the README file in the repository for specific instructions.<br />
# Example (dependencies might vary)<br />
sudo zypper install git make python3-devel<br />
git clone https://github.com/phillipberndt/autorandr.git<br />
cd autorandr<br />
sudo make install</p>
  </li>
</ol>
  <h3 id="basic-configuration-creating-and-managing-profiles">
    
    
     <a href="#basic-configuration-creating-and-managing-profiles">#</a><a href="#" aria-label="Back to top"><strong>Basic Configuration: Creating and Managing Profiles</strong></a>
        
    
  </h3>
      

<p>The fundamental workflow for using autorandr revolves around capturing the state of your display setup for each unique configuration you use:</p>

<ol>
  <li><strong>Connect:</strong> Physically connect your Raspberry Pi to the specific combination of displays (e.g., a single classroom projector, your dual monitors at the office).</li>
  <li><strong>Configure Manually (Once):</strong> Use your preferred method to arrange the displays exactly how you want them <em>for this specific setup</em>. This could be:
    <ul>
      <li><strong>Desktop Environment Tools:</strong> Use the graphical display settings panel provided by your desktop environment (e.g., xfce4-display-settings in Xfce, the ‘Displays’ panel in GNOME Settings). Here you can typically enable/disable monitors, set resolutions, refresh rates, orientation, and define primary displays and relative positions in an extended desktop.</li>
      <li><strong>Manual xrandr Commands:</strong> For more fine-grained control or scripting, use xrandr directly in the terminal. For example: xrandr --output HDMI-1 --mode 1920x1080 --primary --output DisplayPort-1 --mode 2560x1440 --rotate left --right-of HDMI-1.</li>
    </ul>
  </li>
  <li>
    <p><strong>Save Profile:</strong> Once the displays are configured correctly, save this entire state as an autorandr profile using a descriptive name. Choosing a consistent naming convention can be helpful, e.g., location-displaytype-resolution or setup_description.<br />
# Example for a specific lecture hall projector<br />
autorandr --save lecturehallB-projector-1280x800</p>

    <p># Example for your office ultrawide setup<br />
autorandr --save office-ultrawide-3440x1440</p>

    <p># Example for a standard 1080p monitor used for testing<br />
autorandr --save lab-monitor-1080p</p>

    <p>It’s a good idea to back up this directory periodically, especially if you have complex or finely-tuned profiles.</p>
  </li>
  <li><strong>List Profiles:</strong> To review the profiles you have saved:<br />
autorandr --list</li>
</ol>
  <h3 id="applying-configurations">
    
    
     <a href="#applying-configurations">#</a><a href="#" aria-label="Back to top"><strong>Applying Configurations</strong></a>
        
    
  </h3>
      

<ul>
  <li>
    <p><strong>Manual Application:</strong> You can manually trigger autorandr to detect the currently connected displays and apply the best-matching profile from your saved library. This is useful for testing or if automation isn’t set up.<br />
autorandr --change</p>

    <p>Behind the scenes, autorandr --change performs several steps: it detects all connected displays and their properties (like EDID, which is data that allows a display to communicate its capabilities to the graphics card), compares this information against the data stored in each of your saved profiles, calculates a “match score” for each profile based on how well it fits the current hardware, and then automatically executes the xrandr commands stored within the highest-scoring profile (if the score exceeds a certain threshold). If no profile matches well enough, it might load the designated default profile or leave the configuration unchanged, depending on your setup.</p>
  </li>
</ul>
  <h3 id="automation-recommended">
    
    
     <a href="#automation-recommended">#</a><a href="#" aria-label="Back to top"><strong>Automation (Recommended)</strong></a>
        
    
  </h3>
      

<p>For the most convenient experience, configure autorandr to react automatically whenever you connect or disconnect a display:</p>

<ul>
  <li>
    <p><strong>Using systemd Service:</strong> This is generally the most robust and manageable method on modern Linux systems like openSUSE Tumbleweed. The autorandr.service unit, when enabled, typically integrates with udev to monitor for display-related hardware events (specifically from the Direct Rendering Manager or DRM subsystem). Upon detecting such an event (e.g., an HDMI cable being plugged in), systemd activates the service, which in turn usually runs autorandr --change to apply the appropriate profile.<br />
# Enable the service to start on boot and start it immediately<br />
sudo systemctl enable --now autorandr.service<br />
# You can check its status later with: systemctl status autorandr.service</p>
  </li>
  <li>
    <p><strong>Using udev Rules:</strong> autorandr packages often include udev rules (e.g., in /lib/udev/rules.d/) that directly trigger autorandr --change when specific kernel events related to display hardware occur. While this works, managing services through systemd often provides better control, logging, and dependency management. If you installed manually or suspect the rules aren’t active, you might need to reload them:<br />
sudo udevadm control --reload-rules &amp;&amp; sudo udevadm trigger</p>

    <p>With either automation method properly configured, plugging in a known projector or monitor should automatically result in your saved configuration being applied, although there might be a brief delay (a few seconds) while autorandr detects the display and applies the profile.</p>
  </li>
</ul>
  <h3 id="setting-a-default-fallback-profile">
    
    
     <a href="#setting-a-default-fallback-profile">#</a><a href="#" aria-label="Back to top"><strong>Setting a Default Fallback Profile</strong></a>
        
    
  </h3>
      

<p>It’s highly recommended to define a “fallback” or “default” profile. This profile will be automatically applied by autorandr --change (and thus by the automated services) if you connect a display configuration that doesn’t closely match any of your specifically saved profiles. The primary purpose is to prevent being left with an unusable or awkward display state (like a very low resolution, incorrect mirroring, or only the laptop’s internal display active when an external one is connected but unrecognized).</p>

<ol>
  <li>
    <p><strong>Choose and Save a Safe Profile:</strong> Configure your display(s) to a very common and widely supported resolution, like 1920x1080@60Hz or perhaps 1280x720@60Hz, which most monitors and projectors should handle without issue. Save this configuration:<br />
# Example: Configure for 1920x1080 manually first, then save<br />
autorandr --save fallback-1080p</p>
  </li>
  <li>
    <p><strong>Set as Default:</strong> Tell autorandr to use this profile as the default:<br />
autorandr --default fallback-1080p</p>

    <p>Now, when connecting an unknown display, autorandr will attempt to apply this safe configuration, maximizing the chances of getting a usable picture.</p>
  </li>
</ol>
  <h3 id="advanced-usage">
    
    
     <a href="#advanced-usage">#</a><a href="#" aria-label="Back to top"><strong>Advanced Usage</strong></a>
        
    
  </h3>
      

<p>autorandr offers features beyond basic profile switching:</p>

<ul>
  <li>
    <p>Wildcard EDID Matching: Sometimes you might have several projectors or monitors of the same model series. Their EDIDs might be very similar but differ slightly (e.g., in serial number fields). To create a single profile that matches all of them, you can edit the config file within the profile directory (e.g., ~/.config/autorandr/classroom-projectors/config). Find the line(s) specifying the EDID for the relevant output(s) and replace the differing parts (or less critical parts) with an asterisk (*).<br />
Example snippet from ~/.config/autorandr/some_profile/config:*<br />
output HDMI-1<br />
  # edid 00ffffffffffff001e6d[…] # Original specific EDID<br />
  edid 00ffffffffffff001e6d* # Matches any EDID starting with this prefix</p>

    <p><em>Caution:</em> Be careful not to make the wildcard too broad, or it might incorrectly match unintended displays.</p>
  </li>
  <li><strong>Hook Scripts:</strong> You can automate actions that should occur whenever a specific profile is loaded or unloaded. Create executable scripts (e.g., using bash or python) named preswitch (runs before switching <em>to</em> this profile), postswitch (runs after switching <em>to</em> this profile), predetect (runs before detection), or postdetect (runs after detection) inside a profile’s directory (~/.config/autorandr/&lt;profile_name&gt;/) or the global config directory (~/.config/autorandr/). Common uses for postswitch include:
    <ul>
      <li>Setting a specific desktop wallpaper: feh --bg-scale /path/to/wallpaper.jpg</li>
      <li>Restarting desktop panels if they don’t resize correctly: xfce4-panel -r</li>
      <li>Changing the default audio output sink.<br />
Remember to make the scripts executable: chmod +x ~/.config/autorandr/&lt;profile_name&gt;/postswitch.</li>
    </ul>
  </li>
  <li><strong>Forcing Matches (–match-edid):</strong> In rare troubleshooting scenarios where display properties other than EDID might be causing incorrect profile matching, you can experiment with options like autorandr --change --match-edid to force matching based primarily or solely on the EDID information. Consult man autorandr for details.</li>
</ul>
  <h3 id="troubleshooting">
    
    
     <a href="#troubleshooting">#</a><a href="#" aria-label="Back to top"><strong>Troubleshooting</strong></a>
        
    
  </h3>
      

<p>If autorandr doesn’t behave as expected:</p>

<ul>
  <li>
    <p><strong>Check Detected Profiles &amp; Scores:</strong> See what autorandr currently detects and how well it matches known profiles. The output shows detected profiles and their calculated match scores.<br />
autorandr --detected</p>
  </li>
  <li>
    <p><strong>Use Debug Mode:</strong> This provides highly detailed output about the detection process, including EDIDs read, profiles considered, matching scores, and the exact xrandr commands being generated and executed. This is invaluable for diagnosing why a specific profile isn’t being selected.<br />
autorandr --change --debug</p>
  </li>
  <li>
    <p><strong>Check System Logs:</strong> Look for errors or warnings related to the graphics driver (DRM) or EDID processing in the system journal. This can reveal underlying hardware or driver issues.<br />
# View live logs (press Ctrl+C to stop)<br />
journalctl -f | grep -i -E “drm|edid|autorandr”<br />
# View logs from the current boot<br />
journalctl -b | grep -i -E “drm|edid|autorandr”</p>
  </li>
  <li><strong>Ensure System Updates:</strong> Reiterate the importance of sudo zypper dup to ensure you have the latest kernel, graphics drivers, and potentially autorandr fixes.</li>
  <li><strong>Check Physical Connections:</strong> Sometimes the simplest solution is overlooked. Ensure HDMI or DisplayPort cables are securely plugged in at both the Raspberry Pi and the display ends. Try a different cable if problems persist.</li>
</ul>
  <h3 id="alternative-hardware-hdmi-edid-emulator">
    
    
     <a href="#alternative-hardware-hdmi-edid-emulator">#</a><a href="#" aria-label="Back to top"><strong>Alternative: Hardware HDMI EDID Emulator</strong></a>
        
    
  </h3>
      

<p>For displays that consistently cause problems due to missing, corrupt, or non-standard EDID information, a hardware <strong>HDMI EDID Emulator</strong> (also known as an EDID ghost or dummy plug) can be a viable workaround. This small device plugs into an HDMI port on the Pi and contains a chip pre-programmed with standard EDID data (e.g., for a 1080p monitor). The Raspberry Pi’s operating system reads the EDID from the emulator instead of the actual connected display. This effectively forces the Pi to “see” a standard display, often resolving issues with problematic hardware like some older projectors or KVM switches. While it provides consistency, it lacks the dynamic flexibility of autorandr – it forces one specific configuration regardless of what display (if any) is actually connected downstream. It’s a targeted solution for specific problematic hardware, not a replacement for general-purpose profile management.</p>
  <h3 id="resources">
    
    
     <a href="#resources">#</a><a href="#" aria-label="Back to top"><strong>Resources</strong></a>
        
    
  </h3>
      

<ul>
  <li><strong>autorandr</strong> GitHub Repository: The primary source for code, detailed documentation (README), and reporting issues. Check the Issues page here for existing bug reports or troubleshooting discussions. <a href="https://github.com/phillipberndt/autorandr">https://github.com/phillipberndt/autorandr</a></li>
  <li><strong>openSUSE Build Service Package:</strong> Link to the specific package page for the OBS repository, useful for checking versions and build status. <a href="https://build.opensuse.org/package/show/home:phillipberndt/autorandr">https://build.opensuse.org/package/show/home:phillipberndt/autorandr</a></li>
</ul>

<p>By carefully configuring autorandr and leveraging its automation features, you can significantly streamline the process of using your Raspberry Pi 4B with diverse display setups, making your transitions between classroom, office, and other locations much smoother and less prone to technical interruptions.</p>
  <h1 id="bash-script-to-collect-monitor-data-on-debian">
    
    
     <a href="#bash-script-to-collect-monitor-data-on-debian">#</a><a href="#" aria-label="Back to top">bash script to collect monitor data on Debian</a>
        
    
  </h1>
      

<p>• Installs all required tools (including optional edid-decode).<br />
• Detects every DRM connector (VGA, HDMI, DP, DVI, etc.), whether EDID-capable or not.<br />
• Enumerates connected and disconnected outputs via xrandr.<br />
• Logs EDID (sysfs, get-edid, DDC/CI), general hardware info (hwinfo, inxi, lshw), and udev data.<br />
• Provides a summary and guidance on extracting modeline parameters.<br />
• Offers an optional CVT-based modeline generator/applicator.</p>

<p>Save as <code class="language-plaintext highlighter-rouge">~/monitor-info.sh</code>, then:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">chmod</span> +x ~/monitor-info.sh
<span class="nb">sudo</span> ~/monitor-info.sh
</code></section></div></div>

<p>Script:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="c">#!/usr/bin/env bash</span>
<span class="c">#</span>
<span class="c"># monitor-info.sh</span>
<span class="c"># Collect comprehensive monitor info for xrandr configuration on Debian Bullseye+.</span>
<span class="c"># Usage: sudo bash ~/monitor-info.sh</span>
<span class="c">#</span>

<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="c"># ------------------------------------------------------------</span>
<span class="c"># Function: ensure_root</span>
<span class="c">#   Abort if not running as root.</span>
<span class="c"># ------------------------------------------------------------</span>
ensure_root<span class="o">()</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="nv">$EUID</span> <span class="nt">-ne</span> 0 <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"ERROR: Must be run as root."</span> <span class="o">&gt;</span>&amp;2
    <span class="nb">exit </span>1
  <span class="k">fi</span>
<span class="o">}</span>

<span class="c"># ------------------------------------------------------------</span>
<span class="c"># Function: install_tools</span>
<span class="c">#   Installs required packages in one apt command.</span>
<span class="c"># ------------------------------------------------------------</span>
install_tools<span class="o">()</span> <span class="o">{</span>
  apt update
  apt <span class="nb">install</span> <span class="nt">-y</span> <span class="se">\</span>
    read-edid <span class="se">\</span>
    ddcutil <span class="se">\</span>
    hwinfo <span class="se">\</span>
    inxi <span class="se">\</span>
    lshw <span class="se">\</span>
    x11-xserver-utils <span class="se">\</span>
    edid-decode <span class="o">||</span> <span class="nb">true</span>  <span class="c"># optional</span>
<span class="o">}</span>

<span class="c"># ------------------------------------------------------------</span>
<span class="c"># Function: setup_outdir</span>
<span class="c">#   Creates a timestamped output directory.</span>
<span class="c"># ------------------------------------------------------------</span>
setup_outdir<span class="o">()</span> <span class="o">{</span>
  <span class="nv">OUTDIR</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">HOME</span><span class="k">}</span><span class="s2">/monitor-info-</span><span class="si">$(</span><span class="nb">date</span> +%Y%m%d-%H%M%S<span class="si">)</span><span class="s2">"</span>
  <span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$OUTDIR</span><span class="s2">"</span>
  <span class="nb">echo</span> <span class="s2">"Output directory: </span><span class="nv">$OUTDIR</span><span class="s2">"</span>
<span class="o">}</span>

<span class="c"># ------------------------------------------------------------</span>
<span class="c"># Function: log_cmd</span>
<span class="c">#   Runs a command, logs stdout/stderr to a file, does not exit on error.</span>
<span class="c">#   Usage: log_cmd logfile command [args...]</span>
<span class="c"># ------------------------------------------------------------</span>
log_cmd<span class="o">()</span> <span class="o">{</span>
  <span class="nb">local </span><span class="nv">logfile</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span><span class="p">;</span> <span class="nb">shift</span>
  <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">"===== </span><span class="si">$(</span><span class="nb">date</span> <span class="s1">'+%F %T'</span><span class="si">)</span><span class="s2"> : </span><span class="nv">$*</span><span class="s2"> ====="</span>
    <span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span> 2&gt;&amp;1 <span class="o">||</span> <span class="nb">echo</span> <span class="s2">"(ERROR: '</span><span class="nv">$*</span><span class="s2">' failed with exit code </span><span class="nv">$?</span><span class="s2">)"</span>
    <span class="nb">echo</span>
  <span class="o">}</span> <span class="o">&gt;&gt;</span><span class="s2">"</span><span class="nv">$OUTDIR</span><span class="s2">/</span><span class="nv">$logfile</span><span class="s2">"</span>
<span class="o">}</span>

<span class="c"># ------------------------------------------------------------</span>
<span class="c"># Function: detect_connectors</span>
<span class="c">#   Populates arrays: DRM_ALL (all connectors), DRM_EDID (with edid),</span>
<span class="c">#   XRANDR_CONNECTED, XRANDR_ALL.</span>
<span class="c"># ------------------------------------------------------------</span>
detect_connectors<span class="o">()</span> <span class="o">{</span>
  <span class="c"># DRM: all dirs under /sys/class/drm matching *-*</span>
  <span class="k">for </span>path <span class="k">in</span> /sys/class/drm/<span class="k">*</span>-<span class="k">*</span><span class="p">;</span> <span class="k">do</span>
    <span class="o">[[</span> <span class="nt">-e</span> <span class="s2">"</span><span class="nv">$path</span><span class="s2">"</span> <span class="o">]]</span> <span class="o">||</span> <span class="k">continue
    </span><span class="nb">local </span><span class="nv">name</span><span class="o">=</span><span class="si">$(</span><span class="nb">basename</span> <span class="s2">"</span><span class="nv">$path</span><span class="s2">"</span><span class="si">)</span>
    DRM_ALL+<span class="o">=(</span><span class="s2">"</span><span class="nv">$name</span><span class="s2">"</span><span class="o">)</span>
    <span class="o">[[</span> <span class="nt">-r</span> <span class="s2">"</span><span class="nv">$path</span><span class="s2">/edid"</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> DRM_EDID+<span class="o">=(</span><span class="s2">"</span><span class="nv">$name</span><span class="s2">"</span><span class="o">)</span>
  <span class="k">done</span>

  <span class="c"># xrandr: all outputs and connected ones</span>
  <span class="k">while </span><span class="nv">IFS</span><span class="o">=</span> <span class="nb">read</span> <span class="nt">-r</span> line<span class="p">;</span> <span class="k">do
    </span><span class="nb">local </span><span class="nv">out</span><span class="o">=</span><span class="si">$(</span><span class="nb">awk</span> <span class="s1">'/ connected/{print $1} / disconnected/{print $1}'</span> <span class="o">&lt;&lt;&lt;</span><span class="s2">"</span><span class="nv">$line</span><span class="s2">"</span><span class="si">)</span>
    <span class="o">[[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$out</span><span class="s2">"</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> XRANDR_ALL+<span class="o">=(</span><span class="s2">"</span><span class="nv">$out</span><span class="s2">"</span><span class="o">)</span>
    <span class="o">[[</span> <span class="nv">$line</span> <span class="o">==</span> <span class="k">*</span><span class="s2">" connected"</span><span class="k">*</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> XRANDR_CONNECTED+<span class="o">=(</span><span class="s2">"</span><span class="nv">$out</span><span class="s2">"</span><span class="o">)</span>
  <span class="k">done</span> &lt; &lt;<span class="o">(</span>xrandr 2&gt;/dev/null<span class="o">)</span>

  <span class="c"># Summary print</span>
  <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">"All DRM connectors: </span><span class="k">${</span><span class="nv">DRM_ALL</span><span class="p">[*]</span><span class="k">:-</span><span class="nv">none</span><span class="k">}</span><span class="s2">"</span>
    <span class="nb">echo</span> <span class="s2">"DRM connectors with EDID: </span><span class="k">${</span><span class="nv">DRM_EDID</span><span class="p">[*]</span><span class="k">:-</span><span class="nv">none</span><span class="k">}</span><span class="s2">"</span>
    <span class="nb">echo</span> <span class="s2">"xrandr outputs: </span><span class="k">${</span><span class="nv">XRANDR_ALL</span><span class="p">[*]</span><span class="k">:-</span><span class="nv">none</span><span class="k">}</span><span class="s2">"</span>
    <span class="nb">echo</span> <span class="s2">"Connected outputs: </span><span class="k">${</span><span class="nv">XRANDR_CONNECTED</span><span class="p">[*]</span><span class="k">:-</span><span class="nv">none</span><span class="k">}</span><span class="s2">"</span>
  <span class="o">}</span> | <span class="nb">tee</span> <span class="s2">"</span><span class="nv">$OUTDIR</span><span class="s2">/summary.txt"</span>
<span class="o">}</span>

<span class="c"># ------------------------------------------------------------</span>
<span class="c"># Function: collect_sysfs_edid</span>
<span class="c">#   Parses EDID from sysfs for connectors in DRM_EDID.</span>
<span class="c"># ------------------------------------------------------------</span>
collect_sysfs_edid<span class="o">()</span> <span class="o">{</span>
  <span class="k">for </span>CON <span class="k">in</span> <span class="s2">"</span><span class="k">${</span><span class="nv">DRM_EDID</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">do
    </span>log_cmd <span class="s2">"edid_sysfs_</span><span class="k">${</span><span class="nv">CON</span><span class="k">}</span><span class="s2">.log"</span> parse-edid &lt;<span class="s2">"/sys/class/drm/</span><span class="k">${</span><span class="nv">CON</span><span class="k">}</span><span class="s2">/edid"</span>
  <span class="k">done</span>
<span class="o">}</span>

<span class="c"># ------------------------------------------------------------</span>
<span class="c"># Function: collect_getedid</span>
<span class="c">#   Parses EDID via get-edid (ISA bus fallback).</span>
<span class="c"># ------------------------------------------------------------</span>
collect_getedid<span class="o">()</span> <span class="o">{</span>
  log_cmd <span class="s2">"edid_getedid.log"</span> get-edid | parse-edid
<span class="o">}</span>

<span class="c"># ------------------------------------------------------------</span>
<span class="c"># Function: collect_ddc</span>
<span class="c">#   Runs ddcutil detect, get-edid, and capabilities once.</span>
<span class="c"># ------------------------------------------------------------</span>
collect_ddc<span class="o">()</span> <span class="o">{</span>
  log_cmd <span class="s2">"ddcutil_detect.log"</span> ddcutil detect
  log_cmd <span class="s2">"ddcutil_edid.log"</span>   ddcutil get-edid | parse-edid
  log_cmd <span class="s2">"ddcutil_caps.log"</span>   ddcutil capabilities
<span class="o">}</span>

<span class="c"># ------------------------------------------------------------</span>
<span class="c"># Function: collect_general_info</span>
<span class="c">#   Captures xrandr verbose, hwinfo, inxi, lshw.</span>
<span class="c"># ------------------------------------------------------------</span>
collect_general_info<span class="o">()</span> <span class="o">{</span>
  log_cmd <span class="s2">"xrandr_verbose.log"</span> xrandr <span class="nt">--verbose</span>
  log_cmd <span class="s2">"hwinfo_monitor.log"</span> hwinfo <span class="nt">--monitor</span>
  log_cmd <span class="s2">"inxi_Gxx.log"</span>       inxi <span class="nt">-Gxx</span>
  log_cmd <span class="s2">"lshw_display.log"</span>   lshw <span class="nt">-C</span> display
<span class="o">}</span>

<span class="c"># ------------------------------------------------------------</span>
<span class="c"># Function: collect_udev</span>
<span class="c">#   Gathers udevadm info for all DRM_ALL connectors.</span>
<span class="c"># ------------------------------------------------------------</span>
collect_udev<span class="o">()</span> <span class="o">{</span>
  <span class="k">for </span>CON <span class="k">in</span> <span class="s2">"</span><span class="k">${</span><span class="nv">DRM_ALL</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">do
    </span><span class="nb">local </span><span class="nv">path</span><span class="o">=</span><span class="s2">"/sys/class/drm/</span><span class="k">${</span><span class="nv">CON</span><span class="k">}</span><span class="s2">"</span>
    log_cmd <span class="s2">"udevadm_</span><span class="k">${</span><span class="nv">CON</span><span class="k">}</span><span class="s2">.log"</span> udevadm info <span class="nt">--query</span><span class="o">=</span>all <span class="nt">--path</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span><span class="nb">readlink</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$path</span><span class="s2">"</span><span class="si">)</span><span class="s2">"</span>
  <span class="k">done</span>
<span class="o">}</span>

<span class="c"># ------------------------------------------------------------</span>
<span class="c"># Function: generate_cvt</span>
<span class="c">#   Prompts user, generates and optionally applies a CVT modeline.</span>
<span class="c"># ------------------------------------------------------------</span>
generate_cvt<span class="o">()</span> <span class="o">{</span>
  <span class="nb">read</span> <span class="nt">-rp</span> <span class="s2">"Enter width height refresh (e.g. 1920 1080 60), or ENTER to skip: "</span> W H R
  <span class="k">if</span> <span class="o">[[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$W$H$R</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">local </span>MODELINE
    <span class="nv">MODELINE</span><span class="o">=</span><span class="si">$(</span>cvt <span class="s2">"</span><span class="nv">$W</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$H</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$R</span><span class="s2">"</span> 2&gt;/dev/null | <span class="nb">tail</span> <span class="nt">-n1</span><span class="si">)</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$MODELINE</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
      </span><span class="nb">local </span><span class="nv">NAME</span><span class="o">=</span><span class="si">$(</span><span class="nb">awk</span> <span class="s1">'{print $2}'</span> <span class="o">&lt;&lt;&lt;</span><span class="s2">"</span><span class="nv">$MODELINE</span><span class="s2">"</span><span class="si">)</span>
      <span class="nb">echo</span> <span class="s2">"Modeline: </span><span class="nv">$MODELINE</span><span class="s2">"</span> | <span class="nb">tee</span> <span class="nt">-a</span> <span class="s2">"</span><span class="nv">$OUTDIR</span><span class="s2">/cvt_modeline.log"</span>
      <span class="nb">local </span><span class="nv">TARGET</span><span class="o">=</span><span class="k">${</span><span class="nv">XRANDR_CONNECTED</span><span class="p">[0]</span><span class="k">:-}</span>
      <span class="k">if</span> <span class="o">[[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$TARGET</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
        </span>xrandr <span class="nt">--newmode</span> <span class="nv">$MODELINE</span> <span class="se">\</span>
          <span class="o">&amp;&amp;</span> xrandr <span class="nt">--addmode</span> <span class="s2">"</span><span class="nv">$TARGET</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$NAME</span><span class="s2">"</span> <span class="se">\</span>
          <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"Applied to </span><span class="nv">$TARGET</span><span class="s2">; use 'xrandr --output </span><span class="nv">$TARGET</span><span class="s2"> --mode </span><span class="nv">$NAME</span><span class="s2">'"</span>
      <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"No connected output to apply mode; saved under cvt_modeline.log."</span>
      <span class="k">fi
    else
      </span><span class="nb">echo</span> <span class="s2">"ERROR: Failed to generate modeline."</span> | <span class="nb">tee</span> <span class="nt">-a</span> <span class="s2">"</span><span class="nv">$OUTDIR</span><span class="s2">/cvt_modeline.log"</span>
    <span class="k">fi
  fi</span>
<span class="o">}</span>

<span class="c"># ------------------- Main Execution -------------------</span>
ensure_root
install_tools

<span class="c"># Arrays for connectors</span>
<span class="nb">declare</span> <span class="nt">-a</span> DRM_ALL DRM_EDID XRANDR_ALL XRANDR_CONNECTED

setup_outdir
detect_connectors
collect_sysfs_edid
collect_getedid
collect_ddc
collect_general_info
collect_udev
generate_cvt

<span class="nb">echo
echo</span> <span class="s2">"Done. Review logs and summary.txt in </span><span class="nv">$OUTDIR</span><span class="s2">."</span>
<span class="nb">echo</span> <span class="s2">"To craft an xrandr modeline manually, inspect 'Detailed Timing Descriptors' in the EDID logs."</span>
</code></section></div></div>

<p>Next Steps:</p>
<ol>
  <li>Open <code class="language-plaintext highlighter-rouge">$OUTDIR/summary.txt</code> to see detected connectors and outputs.</li>
  <li>Inspect <code class="language-plaintext highlighter-rouge">edid_sysfs_*.log</code> and <code class="language-plaintext highlighter-rouge">edid_getedid.log</code> for Detailed Timing Descriptors (pixel clock, hsync/vsync, porches).</li>
  <li>Enclose those values within this <code class="language-plaintext highlighter-rouge">bash</code> script:
```
#!/bin/bash</li>
</ol>
  <h1 id="improved-temporary-xrandr-configuration-script">
    
    
     <a href="#improved-temporary-xrandr-configuration-script">#</a><a href="#" aria-label="Back to top">Improved Temporary Xrandr configuration script</a>
        
    
  </h1>
      
  <h1 id="these-settings-will-only-apply-to-the-current-x-session-and">
    
    
     <a href="#these-settings-will-only-apply-to-the-current-x-session-and">#</a><a href="#" aria-label="Back to top">These settings will only apply to the current X session and</a>
        
    
  </h1>
      
  <h1 id="will-not-persist-after-a-reboot-or-x-server-restart">
    
    
     <a href="#will-not-persist-after-a-reboot-or-x-server-restart">#</a><a href="#" aria-label="Back to top">will not persist after a reboot or X server restart.</a>
        
    
  </h1>
      
  <h1 id="ensure-this-script-is-run-from-within-an-active-x-window-system-session">
    
    
     <a href="#ensure-this-script-is-run-from-within-an-active-x-window-system-session">#</a><a href="#" aria-label="Back to top">Ensure this script is run from within an active X Window System session.</a>
        
    
  </h1>
      
<p>#</p>
  <h1 id="this-script-now-checks-the-connection-status-of-hdmi-1-and-dp-1">
    
    
     <a href="#this-script-now-checks-the-connection-status-of-hdmi-1-and-dp-1">#</a><a href="#" aria-label="Back to top">This script now checks the connection status of HDMI-1 and DP-1</a>
        
    
  </h1>
      
  <h1 id="before-attempting-to-configure-them-based-on-live-xrandr-output">
    
    
     <a href="#before-attempting-to-configure-them-based-on-live-xrandr-output">#</a><a href="#" aria-label="Back to top">before attempting to configure them, based on live ‘xrandr’ output.</a>
        
    
  </h1>
      
  <h1 id="if-dp-1-is-the-only-connected-monitor-it-attempts-to-set-screen-dpi">
    
    
     <a href="#if-dp-1-is-the-only-connected-monitor-it-attempts-to-set-screen-dpi">#</a><a href="#" aria-label="Back to top">If DP-1 is the only connected monitor, it attempts to set screen DPI</a>
        
    
  </h1>
      
  <h1 id="based-on-its-physical-dimensions">
    
    
     <a href="#based-on-its-physical-dimensions">#</a><a href="#" aria-label="Back to top">based on its physical dimensions.</a>
        
    
  </h1>
      
  <h1 id="check-if-xrandr-command-is-available">
    
    
     <a href="#check-if-xrandr-command-is-available">#</a><a href="#" aria-label="Back to top">Check if xrandr command is available</a>
        
    
  </h1>
      
<p>if ! command -v xrandr &amp;&gt; /dev/null; then
    echo “Error: xrandr command not found. Please ensure it is installed and in your PATH.”
    exit 1
fi</p>
  <h1 id="check-if-bc-command-is-available-for-dpi-calculations">
    
    
     <a href="#check-if-bc-command-is-available-for-dpi-calculations">#</a><a href="#" aria-label="Back to top">Check if bc command is available (for DPI calculations)</a>
        
    
  </h1>
      
<p>BC_AVAILABLE=false
if ! command -v bc &amp;&gt; /dev/null; then
    echo “Warning: bc command not found. DPI calculation for DP-1 will be skipped.”
    echo “Please install ‘bc’ if you want to enable automatic DPI setting.”
else
    BC_AVAILABLE=true
fi</p>

<p>echo “Applying temporary xrandr settings…”
echo “This script will check current display connection statuses.”
echo “Verify your display identifiers (e.g., HDMI-1, DP-1) by running ‘xrandr’ in a terminal.”</p>
  <h1 id="define-mode-names-and-modelines">
    
    
     <a href="#define-mode-names-and-modelines">#</a><a href="#" aria-label="Back to top">Define mode names and modelines</a>
        
    
  </h1>
      
<p>MODE_NAME_1=”1152x864_60.00” # For DP-1
MODELINE_1=”81.75  1152 1216 1336 1520  864 867 871 897 -hsync +vsync”
MODE_1_WIDTH_PX=1152
MODE_1_HEIGHT_PX=864</p>

<p>MODE_NAME_2=”2560x1080_60.00” # For HDMI-1
MODELINE_2=”230.00  2560 2720 2992 3424  1080 1083 1093 1120 -hsync +vsync”</p>
  <h1 id="define-output-names">
    
    
     <a href="#define-output-names">#</a><a href="#" aria-label="Back to top">Define output names</a>
        
    
  </h1>
      
<p>OUTPUT_DP=”DP-1”    # DisplayPort output
OUTPUT_HDMI=”HDMI-1” # HDMI output</p>
  <h1 id="physical-dimensions-for-dp-1-in-mm">
    
    
     <a href="#physical-dimensions-for-dp-1-in-mm">#</a><a href="#" aria-label="Back to top">Physical dimensions for DP-1 (in mm)</a>
        
    
  </h1>
      
<p>DP_WIDTH_MM=419
DP_HEIGHT_MM=236</p>
  <h1 id="-define-new-modes-always-attempt-this-">
    
    
     <a href="#-define-new-modes-always-attempt-this-">#</a><a href="#" aria-label="Back to top">— Define New Modes (always attempt this) —</a>
        
    
  </h1>
      
<p>echo “”
echo “Defining new mode: $MODE_NAME_1”
xrandr –newmode “$MODE_NAME_1” $MODELINE_1
if [ $? -ne 0 ]; then
    echo “Warning: Could not define mode $MODE_NAME_1.”
    echo “Possible issues: mode already exists (use ‘xrandr’ to check), incorrect modeline parameters, or xrandr limitations.”
fi</p>

<p>echo “Defining new mode: $MODE_NAME_2”
xrandr –newmode “$MODE_NAME_2” $MODELINE_2
if [ $? -ne 0 ]; then
    echo “Warning: Could not define mode $MODE_NAME_2.”
    echo “Possible issues: mode already exists (use ‘xrandr’ to check), incorrect modeline parameters, or xrandr limitations.”
fi</p>
  <h1 id="-check-current-connection-status-of-displays-">
    
    
     <a href="#-check-current-connection-status-of-displays-">#</a><a href="#" aria-label="Back to top">— Check current connection status of displays —</a>
        
    
  </h1>
      
<p>echo “”
echo “Checking current display connection status…”
IS_DP_CONNECTED=false
if xrandr | grep -q “^${OUTPUT_DP} connected”; then
    IS_DP_CONNECTED=true
    echo “- $OUTPUT_DP is detected as connected.”
else
    echo “- $OUTPUT_DP is detected as disconnected.”
fi</p>

<p>IS_HDMI_CONNECTED=false
if xrandr | grep -q “^${OUTPUT_HDMI} connected”; then
    IS_HDMI_CONNECTED=true
    echo “- $OUTPUT_HDMI is detected as connected.”
else
    echo “- $OUTPUT_HDMI is detected as disconnected.”
fi</p>
  <h1 id="-initial-positioning-command-if-both-displays-are-connected-">
    
    
     <a href="#-initial-positioning-command-if-both-displays-are-connected-">#</a><a href="#" aria-label="Back to top">— Initial Positioning Command (if both displays are connected) —</a>
        
    
  </h1>
      
<p>echo “”
if $IS_HDMI_CONNECTED &amp;&amp; $IS_DP_CONNECTED; then
    echo “Attempting to set $OUTPUT_HDMI –auto –above $OUTPUT_DP…”
    xrandr –output “$OUTPUT_HDMI” –auto –above “$OUTPUT_DP”
    if [ $? -ne 0 ]; then
        echo “Warning: Could not set $OUTPUT_HDMI –auto –above $OUTPUT_DP.”
    else
        echo “Successfully attempted to position $OUTPUT_HDMI above $OUTPUT_DP.”
    fi
elif ! $IS_HDMI_CONNECTED &amp;&amp; $IS_DP_CONNECTED; then
    echo “Skipping initial positioning: $OUTPUT_HDMI is disconnected. $OUTPUT_DP is primary.”
elif $IS_HDMI_CONNECTED &amp;&amp; ! $IS_DP_CONNECTED; then
     echo “Skipping initial positioning: $OUTPUT_DP is disconnected. $OUTPUT_HDMI is primary.”
else
    echo “Skipping initial positioning: Both $OUTPUT_HDMI and $OUTPUT_DP appear to be disconnected.”
fi</p>
  <h1 id="-configure-dp-output-output_dp-">
    
    
     <a href="#-configure-dp-output-output_dp-">#</a><a href="#" aria-label="Back to top">— Configure DP Output ($OUTPUT_DP) —</a>
        
    
  </h1>
      
<p>echo “”
if $IS_DP_CONNECTED; then
    echo “Configuring $OUTPUT_DP…”
    echo “Adding mode $MODE_NAME_1 to $OUTPUT_DP”
    xrandr –addmode “$OUTPUT_DP” “$MODE_NAME_1”
    if [ $? -ne 0 ]; then
        echo “Error adding mode $MODE_NAME_1 to $OUTPUT_DP.”
        echo “Ensure $OUTPUT_DP is truly connected, the mode was defined, and supports this mode.”
    else
        echo “Setting $OUTPUT_DP to mode $MODE_NAME_1”
        xrandr –output “$OUTPUT_DP” –mode “$MODE_NAME_1”
        if [ $? -ne 0 ]; then
            echo “Error setting $OUTPUT_DP to mode $MODE_NAME_1.”
        else
            # If DP-1 is the only connected monitor, try to set screen DPI
            if ! $IS_HDMI_CONNECTED &amp;&amp; $BC_AVAILABLE; then
                echo “”
                echo “DP-1 ($OUTPUT_DP) appears to be the only connected display and ‘bc’ is available.”
                echo “Calculating DPI for screen based on DP-1 physical dimensions ($DP_WIDTH_MM mm x $DP_HEIGHT_MM mm) and mode $MODE_NAME_1 ($MODE_1_WIDTH_PX x $MODE_1_HEIGHT_PX).”</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><section><code>            # Calculate DPI_H and DPI_V using bc for floating point arithmetic
            # scale=2 sets precision for bc output
            # Ensure dimensions are not zero to prevent division by zero, though hardcoded here
            if [ "$DP_WIDTH_MM" -gt 0 ] &amp;&amp; [ "$DP_HEIGHT_MM" -gt 0 ]; then
                DPI_H_CALC=$(bc -l &lt;&lt;&lt; "scale=2; $MODE_1_WIDTH_PX / ($DP_WIDTH_MM / 25.4)")
                DPI_V_CALC=$(bc -l &lt;&lt;&lt; "scale=2; $MODE_1_HEIGHT_PX / ($DP_HEIGHT_MM / 25.4)")

                # Check if bc calculations were successful and returned valid numbers
                if [[ -n "$DPI_H_CALC" &amp;&amp; -n "$DPI_V_CALC" &amp;&amp; "$DPI_H_CALC" =~ ^[0-9]+([.][0-9]+)?$ &amp;&amp; "$DPI_V_CALC" =~ ^[0-9]+([.][0-9]+)?$ ]]; then
                    # Calculate average DPI and round to nearest integer
                    AVG_DPI=$(printf "%.0f" "$(bc -l &lt;&lt;&lt; "($DPI_H_CALC + $DPI_V_CALC) / 2")")

                    echo "Calculated average DPI: $AVG_DPI (H: $DPI_H_CALC, V: $DPI_V_CALC)"
                    echo "Attempting to set screen DPI to $AVG_DPI..."
                    # Note: 'xrandr --dpi' typically applies to the entire X screen.
                    xrandr --dpi "$AVG_DPI"
                    if [ $? -ne 0 ]; then
                        echo "Warning: Could not set screen DPI to $AVG_DPI. Your X server or driver might not support this or the value might be out of range."
                    else
                        echo "Screen DPI successfully set to $AVG_DPI. This may improve font rendering."
                    fi
                else
                    echo "Warning: DPI calculation failed or produced non-numeric results. Skipping DPI setting."
                    echo "DPI_H_CALC raw output: '$DPI_H_CALC'"
                    echo "DPI_V_CALC raw output: '$DPI_V_CALC'"
                fi
            else
                echo "Warning: DP-1 physical dimensions (DP_WIDTH_MM or DP_HEIGHT_MM) are zero. Cannot calculate DPI."
            fi
        elif ! $IS_HDMI_CONNECTED &amp;&amp; ! $BC_AVAILABLE; then
             echo "DP-1 ($OUTPUT_DP) is the only display, but 'bc' is not available. Skipping DPI calculation."
        fi
    fi
fi else
echo "Skipping configuration for $OUTPUT_DP as it is disconnected." fi
</code></section></div></div>
  <h1 id="-configure-hdmi-output-output_hdmi-">
    
    
     <a href="#-configure-hdmi-output-output_hdmi-">#</a><a href="#" aria-label="Back to top">— Configure HDMI Output ($OUTPUT_HDMI) —</a>
        
    
  </h1>
      
<p>echo “”
if $IS_HDMI_CONNECTED; then
    echo “Configuring $OUTPUT_HDMI…”
    echo “Adding mode $MODE_NAME_2 to $OUTPUT_HDMI”
    xrandr –addmode “$OUTPUT_HDMI” “$MODE_NAME_2”
    if [ $? -ne 0 ]; then
        echo “Error adding mode $MODE_NAME_2 to $OUTPUT_HDMI.”
        echo “Ensure $OUTPUT_HDMI is truly connected, the mode was defined, and supports this mode.”
    else
        echo “Setting $OUTPUT_HDMI to mode $MODE_NAME_2”
        xrandr –output “$OUTPUT_HDMI” –mode “$MODE_NAME_2”
        if [ $? -ne 0 ]; then
            echo “Error setting $OUTPUT_HDMI to mode $MODE_NAME_2.”
        fi
    fi
else
    echo “Skipping configuration for $OUTPUT_HDMI as it is disconnected.”
fi</p>

<p>echo “”
echo “Temporary xrandr settings applied (or attempted for connected displays).”
echo “Current screen configuration (relevant connected displays):”
xrandr | grep “ connected”</p>

<p>echo “”
echo “If you encounter issues, please check:”
echo “1. Your display output names ($OUTPUT_DP, $OUTPUT_HDMI) are correct (use ‘xrandr’ to verify).”
echo “2. Your displays are properly connected and powered on.”
echo “3. The modelines are compatible with your hardware.”
echo “4. Review any error messages above from xrandr.”
echo “5. If DPI was set, verify with ‘xdpyinfo | grep resolution’.”
```</p>

        </div>
        
          URL: https://ib.bsb.br/xrandr
        
      </article>
      <nav class="post-navigation-combined" aria-label="Post navigation">
        <!-- Chronological Navigation (always visible at 40vh) -->
        
          <div class="nav-arrow chronological prev">
            <a href="/refactor2/" title="refactor2" rel="prev">
              <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAxVJREFUaEPt18FqG1cUBuD/nLkzI42UiVInkFLTCAKhS+9KA+3Kq1L8AAHjhR7AKz+ADV55qUfoqhvThTfdmC4KzTKmYJrELshJW9PIlSeKRpqZe88pUtouihvVRknqMNoMzD1zdPXNrzMM4RJ+6BLuGeWm39RdK6VL6VcIlPEo41HG401loJQupS8mUM7pi7md/6p3UtoHUJzf4vVecZb0e0EQfB7H8b0kSeqqummt/eb1buN83SebNsZ8QkQCYHVpaenu/v7+ra2tLRwdHWF1ddWq6hfM3BCRE2b+FcBHACQAHo1E5v9c+5mIhkR0e3z0VQ8LotuqWlXVw/GRmT8QkdMK89McuAOAAfwoIu8z85yIHBPRKRGN1/IAeDx0rul53hivo6psrf2ejDGfEtFOu92u7O3tBWtra2i322g0GhgOh9je3ka325UPax7fCR0iw+lp4aLxr70aeOmgkChTRY3JGSb73EroERD73uB54WpOgdhwZkXNQNQLiVDzOU1yFymAhu+lqZVopIqISQKmPLFS+atHv3A1q8AVQ+lXP/VHRPQx+b6frKysxMvLy1hfX0ez2USv18PCwgLiOEaSJKhWq/jhwQN8dnIfVOS4dsWHqCJ5YREGjBuNEMfd0eTc9WshBqnFYGhRqxrUIoNuLwMT4eb1Cp6dZshywdW6mZzr9QsEPuPmXIhfno3gnGKuEWCUC14MLKoVb1L72+8Zvj3JOl/udZt/S7darUqn0wlarRZ2d3cxPz+PJ8dPsPP1Doq8kIbL+cawjxBIM8MRFAidpBlRpIbhFc55gM2NF5IIQtVBRlRTZgTWZQ4wzvc8spO1NPM4Gr9Wh1bSDIjU98C5E0PIC8OVSX+Rlz08hl+4/LsML6X/menFxcW7BwcHtzY2NvDw8CE21zf/NdMAHskFMs3MT/EfMg3gsTsr02f8byfTo16v3+v3+//f6fGKgXNp5vT5huZbqH4nH+NvwXH6V5bS041mU1FKz8ZxepdSerrRbCpK6dk4Tu9SSk83mk1FKT0bx+ldSunpRrOpuJTSfwBcuImxpyA7XgAAAABJRU5ErkJggg==" alt="Previous article" width="45" height="45" loading="lazy">
            </a>
          </div>
        
        
          <div class="nav-arrow chronological next">
            <a href="/aot-3/" title="AoT 3" rel="next">
              <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAwdJREFUaEPtl01rG1cUht9z7p070ijKWLVS3I9YULtNMBRn2UIXxZtuvCjedNWfoKVXBvsHeOUfoIUx5AeY0pVXXSR052UxBJSi0kDiRplII83HvadI9CMtOFjCmBjubC7cc8+Zc555eYdLuIEP3cCe4Zu+rq/mSXvSbyHg5eHl4eVxXRrwpD3p+Qh4n56P2+xZnvTszC7MCAAUF0XfOdJa62+IaCeO40GSJA/zPP8RwB9vDjBtWmv9JRE5ImpZawdVpbo58CkAIyJnIrLAzEvOuXNm/h3AfQDOAGdj5z5m5gXn3G9ENCKilckaiDwpiFZEpCoiTyYrM3/knOtXmHs58BkABvCLc+4DZl6cxIjoh4ODA728vIzt7W2sra09PT4+fgTgQES4LMvHZIy5LyI/f/dJvfK6FKMJqAdqmBS2ZgWINY9zJyZ1whUiRJrTfmGjybSxUemwcFEmghqT1UxlUrpQEXD7jRq3NWelEz10okIi1AJOX+U2EgALgUrT0kVnmcKvQ+uazSZvbW2hWq2i3++j3W5jf38f6+vrebvdHovI5pT09+vN7teLYev990K8GpQYjS1u1TQqhnHez6EU4cM7FTw7z5AXDo16ACcyPRsaxp2FEM9ejKd7zUaIYVpiOCpRq2rUIo0XLzMwEZaaFTzvZ8hyh/iWnu69fF1AAoOfFr/A5w8eYDQaIY5jJEmC09NTNBoNdLtd7O3t4ejoCIeHh8k/pL8KUSkCZcg6hCLDjLk2ufYGpRuXAuOMYiosQiDNNEcQILQuzYgi0QxVWKuAMtcqJPdXDaKaMMOUNrOAtoFSVE5jaaY4mtQPS5dmQPS8WkdfGReYgDe/3cTdpbvo9XrY2NhAp9NBq9XKO53Ov6T/r2mlVBeX0DSAMzeHppm5h7doemdvR99buYfd3V2srq4+PTk5+a+mr9CmrqTU3+5Rr9cHg8HgYve4krddbZGb5dOXmf2d+7n4pi9D4LrOeHl40v42fl0a8KQ96fkIeJ+ej9vsWZ707Mzmy/Ck5+M2e9afhmuAz1BhwewAAAAASUVORK5CYII=" alt="Next article" width="45" height="45" loading="lazy">
            </a>
          </div>
        
            
            
              
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  
                  
              
              
              
              <!-- Navigation block for tag "scratchpad"; default display for the first tag -->
              <div class="nav-group tags" id="tag-nav-scratchpad" style="display: block;">
                <div class="nav-arrow tags prev">
                  
                    <a href="/refactor1/" title="refactor1" rel="prev">
                      <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAxVJREFUaEPt18FqG1cUBuD/nLkzI42UiVInkFLTCAKhS+9KA+3Kq1L8AAHjhR7AKz+ADV55qUfoqhvThTfdmC4KzTKmYJrELshJW9PIlSeKRpqZe88pUtouihvVRknqMNoMzD1zdPXNrzMM4RJ+6BLuGeWm39RdK6VL6VcIlPEo41HG401loJQupS8mUM7pi7md/6p3UtoHUJzf4vVecZb0e0EQfB7H8b0kSeqqummt/eb1buN83SebNsZ8QkQCYHVpaenu/v7+ra2tLRwdHWF1ddWq6hfM3BCRE2b+FcBHACQAHo1E5v9c+5mIhkR0e3z0VQ8LotuqWlXVw/GRmT8QkdMK89McuAOAAfwoIu8z85yIHBPRKRGN1/IAeDx0rul53hivo6psrf2ejDGfEtFOu92u7O3tBWtra2i322g0GhgOh9je3ka325UPax7fCR0iw+lp4aLxr70aeOmgkChTRY3JGSb73EroERD73uB54WpOgdhwZkXNQNQLiVDzOU1yFymAhu+lqZVopIqISQKmPLFS+atHv3A1q8AVQ+lXP/VHRPQx+b6frKysxMvLy1hfX0ez2USv18PCwgLiOEaSJKhWq/jhwQN8dnIfVOS4dsWHqCJ5YREGjBuNEMfd0eTc9WshBqnFYGhRqxrUIoNuLwMT4eb1Cp6dZshywdW6mZzr9QsEPuPmXIhfno3gnGKuEWCUC14MLKoVb1L72+8Zvj3JOl/udZt/S7darUqn0wlarRZ2d3cxPz+PJ8dPsPP1Doq8kIbL+cawjxBIM8MRFAidpBlRpIbhFc55gM2NF5IIQtVBRlRTZgTWZQ4wzvc8spO1NPM4Gr9Wh1bSDIjU98C5E0PIC8OVSX+Rlz08hl+4/LsML6X/menFxcW7BwcHtzY2NvDw8CE21zf/NdMAHskFMs3MT/EfMg3gsTsr02f8byfTo16v3+v3+//f6fGKgXNp5vT5huZbqH4nH+NvwXH6V5bS041mU1FKz8ZxepdSerrRbCpK6dk4Tu9SSk83mk1FKT0bx+ldSunpRrOpuJTSfwBcuImxpyA7XgAAAABJRU5ErkJggg==" alt="Previous in Tag" width="45" height="45" loading="lazy">
                    </a>
                  
                </div>
                <div class="nav-arrow tags next">
                  
                    <a href="/to-enable-video-acceleration-on-rpi4/" title="to enable video acceleration on RPI4" rel="next">
                      <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAwdJREFUaEPtl01rG1cUht9z7p070ijKWLVS3I9YULtNMBRn2UIXxZtuvCjedNWfoKVXBvsHeOUfoIUx5AeY0pVXXSR052UxBJSi0kDiRplII83HvadI9CMtOFjCmBjubC7cc8+Zc555eYdLuIEP3cCe4Zu+rq/mSXvSbyHg5eHl4eVxXRrwpD3p+Qh4n56P2+xZnvTszC7MCAAUF0XfOdJa62+IaCeO40GSJA/zPP8RwB9vDjBtWmv9JRE5ImpZawdVpbo58CkAIyJnIrLAzEvOuXNm/h3AfQDOAGdj5z5m5gXn3G9ENCKilckaiDwpiFZEpCoiTyYrM3/knOtXmHs58BkABvCLc+4DZl6cxIjoh4ODA728vIzt7W2sra09PT4+fgTgQES4LMvHZIy5LyI/f/dJvfK6FKMJqAdqmBS2ZgWINY9zJyZ1whUiRJrTfmGjybSxUemwcFEmghqT1UxlUrpQEXD7jRq3NWelEz10okIi1AJOX+U2EgALgUrT0kVnmcKvQ+uazSZvbW2hWq2i3++j3W5jf38f6+vrebvdHovI5pT09+vN7teLYev990K8GpQYjS1u1TQqhnHez6EU4cM7FTw7z5AXDo16ACcyPRsaxp2FEM9ejKd7zUaIYVpiOCpRq2rUIo0XLzMwEZaaFTzvZ8hyh/iWnu69fF1AAoOfFr/A5w8eYDQaIY5jJEmC09NTNBoNdLtd7O3t4ejoCIeHh8k/pL8KUSkCZcg6hCLDjLk2ufYGpRuXAuOMYiosQiDNNEcQILQuzYgi0QxVWKuAMtcqJPdXDaKaMMOUNrOAtoFSVE5jaaY4mtQPS5dmQPS8WkdfGReYgDe/3cTdpbvo9XrY2NhAp9NBq9XKO53Ov6T/r2mlVBeX0DSAMzeHppm5h7doemdvR99buYfd3V2srq4+PTk5+a+mr9CmrqTU3+5Rr9cHg8HgYve4krddbZGb5dOXmf2d+7n4pi9D4LrOeHl40v42fl0a8KQ96fkIeJ+ej9vsWZ707Mzmy/Ck5+M2e9afhmuAz1BhwewAAAAASUVORK5CYII=" alt="Next in Tag" width="45" height="45" loading="lazy">
                    </a>
                  
                </div>
              </div>
            
          
          <!-- JavaScript to Toggle the Tag-based Navigation -->
          <script>
            document.addEventListener("DOMContentLoaded", function(){
              var tagLinks = document.querySelectorAll('.tag-option');
              tagLinks.forEach(function(link){
                link.addEventListener('click', function(event){
                  event.preventDefault();
                  // Remove "active" class from all tag options.
                  tagLinks.forEach(function(el){ el.classList.remove('active'); });
                  // Add active class to the clicked tag option.
                  this.classList.add('active');
                  // Hide all tag navigation blocks.
                  document.querySelectorAll('.nav-group.tags').forEach(function(block){
                    block.style.display = 'none';
                  });
                  // Show the navigation block corresponding to the selected tag.
                  var tagSlug = this.getAttribute('data-tag');
                  var target = document.getElementById('tag-nav-' + tagSlug);
                  if(target) {
                    target.style.display = 'block';
                  }
                });
              });
            });
          </script>
      </nav>
      
    </main>
    <footer id="bottom-of-page" class="site-footer">
      <div class="footer-content">
        <!-- Back to top link -->
        <a href="#" aria-label="Back to top" class="back2top-link">
          <span class="sronly">Back to top</span>
        </a>
    
        <!-- Liquid Time Calculation and Display -->
        
        
        
        <a href="https://ib.bsb.br/404" aria-label="404">
          2025-05-07 20:07:47
        </a>
        &#x23;
    
        <!-- Tag Selector -->
        <ul class="tag-selector">
          
            
            
              <li>
                <a href="#" class="tag-option active" data-tag="scratchpad">
                  scratchpad
                </a>
              </li>
            
          
        </ul>
        &hArr;
    
        <!-- GitHub Link -->
        <a href="https://github.com/ib-bsb-br/ib-bsb-br.github.io" aria-label="GitHub">
          &#8505;
        </a>
    
        <!-- Homepage Link -->
        <a href="/" aria-label="Homepage">
          infoBAG
        </a>
    
        <!-- Copy All Code Button -->
        <button id="copyAllButton" aria-label="Copy all code">
          &copy;
        </button>
      </div>
    </footer>
    <style>
      .back2top-link {
        display: inline-block;
        width: 32px;
        height: 32px;
        background: url("/assets/Rope_(Old).gif") center center no-repeat;
        background-size: contain;
        text-decoration: none;
        vertical-align: middle;
      }
      .sronly {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
    </style>
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Article",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://ib.bsb.br/xrandr/"
        },
        "headline": "autorandr and bash script to collect and setup monitor data for xrandr",
        "description": "",
        "datePublished": "2025-04-03T00:00:00+00:00",
        "dateModified": "2025-05-07T23:04:56+00:00",
        "author": {
          "@type": "Person",
          "name": "Author"
        },
        "publisher": {
          "@type": "Organization",
          "name": "infoBAG"
          
        }
        
      }
    </script>
    <script src="/assets/js/prism.js" defer></script>
    <script src="/assets/js/copy-all-code.js"></script>
  </body>
</html>
