<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
      
        /.bashrc - infoBAG
      
    </title>
    <meta name="title" content="/.bashrc - infoBAG" />
    <meta name="description" content="">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://ib.bsb.br/bashrc/">
    <meta property="og:title" content="/.bashrc - infoBAG">
    <meta property="og:description" content="">
    <meta property="og:image" content="/favicon.ico">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://ib.bsb.br/bashrc/">
    <meta name="twitter:title" content="/.bashrc - infoBAG">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="/favicon.ico">
    <link rel="canonical" href="https://ib.bsb.br/bashrc/">
    <link rel="alternate" type="application/rss+xml" title="infoBAG" href="https://ib.bsb.br/rss.xml">
    
      <meta name="keywords" content="linux&gt;dotfile">
      
        <meta property="article:tag" content="linux&gt;dotfile">
      
    
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    
    <link rel="stylesheet" href="/style.css">
  </head>
  <body class="post-content-body">
    <header class="header-container">
      <nav aria-label="Main navigation" class="header-content">
        <a href="/" aria-label="Home">
          <img src="/favicon.ico" alt="Home" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/tags" aria-label="Tags">
          <img src="/assets/Label.gif" alt="Tags" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/send" aria-label="send">
          <img src="/assets/rot.gif" alt="send" class="favicon search-link" width="32" height="32" loading="lazy">
        </a> 
        <a href="/created" aria-label="archive created">
          <img src="/assets/Loose_Stone_Pile.gif" alt="archive created" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/events" aria-label="Events">
          <img src="/assets/Paralyse_Rune.gif" alt="Events" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/modified" aria-label="archive modified">
          <img src="/assets/Hole_(Rock).gif" alt="archive modified" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
    </nav>
      <h5 class="post-title">
        <a href="#bottom-of-page" aria-label="Go to bottom">
          /.bashrc
        </a>
      </h5>
      <div class="post-meta">
        <time datetime="2024-04-14T00:00:00+00:00" class="post-date">
          14 Apr 2024
        </time>
        
          <span class="post-updated">
            ↣
            <time datetime="2025-06-16T19:26:05+00:00">
              16 Jun 2025
            </time>
          </span>
        
        
          <p class="post-slug">
            Slug: <a href="https://ib.bsb.br/bashrc" class="tag">bashrc</a>
          </p>
        
        
          <p class="post-tags">
            Tags:
            
              <a href="https://ib.bsb.br/tags/#linux-dotfile" class="tag">linux>dotfile</a>
            
          </p>
        
      </div>
      <div class="post-actions">
        <div class="page-stats mt-3" role="status" aria-label="Page statistics">
      
      <span class="badge bg-primary">
        60364 characters
      </span>
        <span class="separator mx-2" aria-hidden="true">•</span>
        <span class="badge bg-primary">
        7544 words
      </span>
      </div>
        <div class="action-buttons d-flex flex-wrap gap-2">
          
            
              <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/edit/main/_posts/2024-04-14-bashrc.md"
                    method="GET"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="d-inline-block">
                <button type="submit" class="btn btn-danger" aria-label="Edit page content">
                  <span class="button-text">Improve this page?</span>
                  <span class="info-text">aberto.</span>
                </button>
              </form>
            
            <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/commits/main/_posts/2024-04-14-bashrc.md"
                  method="GET"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="d-inline-block">
              <button type="submit" class="btn btn-danger" aria-label="View page revision history">
                View revision history
              </button>
            </form>
          
        </div>
      </div>
    </header>
    <main class="content">
      <article class="post-wrapper">
        <div class="post-content-body">
          
<ul><li><a href="#introduction">Introduction</a></li><li><a href="#1-system-update--core-utilities">1. System Update &amp; Core Utilities</a></li><li><a href="#2-language-runtimes">2. Language Runtimes</a><ul><li><a href="#go-120">Go (≥1.20)</a></li><li><a href="#rust">Rust</a></li></ul></li><li><a href="#3-shell-configuration">3. Shell Configuration</a><ul><li><a href="#31-bash_profile-user">3.1 ~/.bash_profile (User)</a></li><li><a href="#32-bashrc-user">3.2 ~/.bashrc (User)</a></li></ul></li><li><a href="#4-systemd-user-ssh-agent-service-user">4. systemd-user SSH Agent Service (User)</a></li><li><a href="#5-common-ssh-use-cases">5. Common SSH Use Cases</a></li><li><a href="#6-verification-checklist">6. Verification Checklist</a></li><li><a href="#prerequisites-for-linaro-user">Prerequisites for <code class="language-plaintext highlighter-rouge">linaro</code> User</a></li><li><a href="#part-1-system-wide-installations-and-configurations-executed-by-linaro-using-sudo">Part 1: System-Wide Installations and Configurations (executed by <code class="language-plaintext highlighter-rouge">linaro</code> using <code class="language-plaintext highlighter-rouge">sudo</code>)</a><ul><li><a href="#11-system-update">1.1. System Update</a></li><li><a href="#12-core-utilities-and-essential-packages">1.2. Core Utilities and Essential Packages</a></li><li><a href="#13-install-go-language-system-part">1.3. Install Go Language (System Part)</a></li></ul></li><li><a href="#part-2-user-specific-installations-and-configurations-as-linaro">Part 2: User-Specific Installations and Configurations (as <code class="language-plaintext highlighter-rouge">linaro</code>)</a><ul><li><a href="#21-create-user-specific-directories">2.1. Create User-Specific Directories</a></li><li><a href="#22-install-rust-language">2.2. Install Rust Language</a></li><li><a href="#23-generate-ssh-key-pair">2.3. Generate SSH Key Pair</a></li><li><a href="#24-configure-bash_profile">2.4. Configure <code class="language-plaintext highlighter-rouge">~/.bash_profile</code></a></li><li><a href="#25-configure-bashrc">2.5. Configure <code class="language-plaintext highlighter-rouge">~/.bashrc</code></a></li><li><a href="#26-configure-systemd-user-ssh-agent-service">2.6. Configure <code class="language-plaintext highlighter-rouge">systemd-user</code> SSH Agent Service</a></li></ul></li><li><a href="#part-3-verification-checklist">Part 3: Verification Checklist</a></li><li><a href="#part-4-understanding-key-features-and-use-cases">Part 4: Understanding Key Features and Use Cases</a></li></ul>
          <h2 id="introduction">
    
    
     <a href="#introduction">#</a><a href="#" aria-label="Back to top">Introduction</a>
        
    
  </h2>
      
<p>This guide walks through configuring a robust interactive shell on Debian 11 “Bullseye,” including environment variables (Go, Rust, Python), Flatpak, aliases, and a systemd-user–managed SSH agent. It separates user-level and root-level steps, clarifies placeholders, and includes verification commands.</p><hr />
  <h2 id="1-system-update--core-utilities">
    
    
     <a href="#1-system-update--core-utilities">#</a><a href="#" aria-label="Back to top">1. System Update &amp; Core Utilities</a>
        
    
  </h2>
      
<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>apt update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt upgrade <span class="nt">-y</span>
<span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> <span class="se">\</span>
  build-essential git curl wget unzip zip bash-completion <span class="se">\</span>
  python3-pip nodejs npm libpulse-dev flatpak swaks
</code></section></div></div>
  <h2 id="2-language-runtimes">
    
    
     <a href="#2-language-runtimes">#</a><a href="#" aria-label="Back to top">2. Language Runtimes</a>
        
    
  </h2>
      
  <h3 id="go-120">
    
    
     <a href="#go-120">#</a><a href="#" aria-label="Back to top">Go (≥1.20)</a>
        
    
  </h3>
      
<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nv">GO_VER</span><span class="o">=</span>1.20.5
wget https://go.dev/dl/go<span class="k">${</span><span class="nv">GO_VER</span><span class="k">}</span>.linux-amd64.tar.gz
<span class="nb">sudo tar</span> <span class="nt">-C</span> /usr/local <span class="nt">-xzf</span> go<span class="k">${</span><span class="nv">GO_VER</span><span class="k">}</span>.linux-amd64.tar.gz
<span class="nb">rm </span>go<span class="k">${</span><span class="nv">GO_VER</span><span class="k">}</span>.linux-amd64.tar.gz
</code></section></div></div>
  <h3 id="rust">
    
    
     <a href="#rust">#</a><a href="#" aria-label="Back to top">Rust</a>
        
    
  </h3>
      
<div class="language-bash highlighter-rouge"><div class="highlight"><section><code>curl <span class="nt">--proto</span> <span class="s1">'=https'</span> <span class="nt">--tlsv1</span>.2 <span class="nt">-sSf</span> https://sh.rustup.rs | sh <span class="nt">-s</span> <span class="nt">--</span> <span class="nt">-y</span>
</code></section></div></div><hr />
  <h2 id="3-shell-configuration">
    
    
     <a href="#3-shell-configuration">#</a><a href="#" aria-label="Back to top">3. Shell Configuration</a>
        
    
  </h2>
      
  <h3 id="31-bash_profile-user">
    
    
     <a href="#31-bash_profile-user">#</a><a href="#" aria-label="Back to top">3.1 ~/.bash_profile (User)</a>
        
    
  </h3>
      
<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="c"># Source ~/.bashrc for interactive login shells</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$-</span> <span class="o">==</span> <span class="k">*</span>i<span class="k">*</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">source</span> ~/.bashrc
<span class="k">fi</span>
</code></section></div></div>
  <h3 id="32-bashrc-user">
    
    
     <a href="#32-bashrc-user">#</a><a href="#" aria-label="Back to top">3.2 ~/.bashrc (User)</a>
        
    
  </h3>
      
<div class="language-plaintext highlighter-rouge"><div class="highlight"><section><code># 1. Exit if not interactive
case "$-" in *i*) ;; *) return;; esac

# 2. History
HISTCONTROL=ignoreboth # space-prefixed commands and duplicates are not saved
shopt -s histappend # Append to history file, don't overwrite
HISTSIZE=5000 # Number of commands to keep in memory
HISTFILESIZE=10000 # Number of commands to keep in the history file
# Save history after each command and reload it to make it available across terminals.
# `history -a` appends the current session's history to HISTFILE.
# `PROMPT_COMMAND="history -a; ${PROMPT_COMMAND}"` ensures this happens before each prompt.
# Rely on histappend for merging on shell exit.
PROMPT_COMMAND="history -a; ${PROMPT_COMMAND}"

# 3. XDG directories
export XDG_CONFIG_HOME="${XDG_CONFIG_HOME:-$HOME/.config}"
export XDG_CACHE_HOME="${XDG_CACHE_HOME:-$HOME/.cache}"
export XDG_DATA_HOME="${XDG_DATA_HOME:-$HOME/.local/share}"

# Ensure critical XDG directories exist
mkdir -p "$XDG_CONFIG_HOME" "$XDG_CACHE_HOME" "$XDG_DATA_HOME"

# Append Flatpak XDG data dirs to the system default XDG_DATA_DIRS
_FLATPAK_USER_DATA_DIR="$XDG_DATA_HOME/flatpak/exports/share"
_FLATPAK_SYSTEM_DATA_DIR="/var/lib/flatpak/exports/share"
_SYSTEM_XDG_DATA_DIRS="${XDG_DATA_DIRS:-/usr/local/share/:/usr/share/}"

export XDG_DATA_DIRS="${_FLATPAK_USER_DATA_DIR}:${_FLATPAK_SYSTEM_DATA_DIR}:${_SYSTEM_XDG_DATA_DIRS}"
# Clean up temporary variables
unset _FLATPAK_USER_DATA_DIR _FLATPAK_SYSTEM_DATA_DIR _SYSTEM_XDG_DATA_DIRS

# XDG_RUNTIME_DIR is critical and typically set by pam_systemd.
# If it's not set, it indicates a problem with the system's session management (e.g., pam_systemd).
# Do not attempt to set it manually to a /tmp path here as it can cause issues.
if [ -z "$XDG_RUNTIME_DIR" ]; then
    # Log an error or warning if preferred, but avoid setting a non-standard fallback
    # echo "Warning: XDG_RUNTIME_DIR is not set. User services may not function correctly." &gt;&amp;2
    : # No action, rely on system setup
else
    export XDG_RUNTIME_DIR # Ensure it's exported if set by pam_systemd
fi


# 4. PATH updates
export GOPATH="$HOME/go"

_add_to_path_if_missing() {
    local dir_to_add="$1"
    local prepend="$2" # "prepend" or "append"
    if [ -d "$dir_to_add" ]; then
        case ":$PATH:" in
            *":$dir_to_add:"*) :;; # Already in PATH
            *) if [ "$prepend" = "prepend" ]; then
                   PATH="$dir_to_add:$PATH" # Prepend for higher priority
               else
                   PATH="$PATH:$dir_to_add" # Append
               fi
               ;;
        esac
    fi
}

_add_to_path_if_missing "/usr/local/go/bin" "prepend" # Go system binaries
_add_to_path_if_missing "$GOPATH/bin" "prepend" # User-installed Go binaries
_add_to_path_if_missing "$HOME/.local/bin" "prepend" # User-local pip installs, etc.
# Rust path is handled by sourcing .cargo/env, which also prepends.
unset _add_to_path_if_missing
export PATH


# 5. Rust environment
[ -f "$HOME/.cargo/env" ] &amp;&amp; source "$HOME/.cargo/env"

# 6. Bash completion
if ! shopt -oq posix; then
  if [ -f /usr/share/bash-completion/bash_completion ]; then
    source /usr/share/bash-completion/bash_completion
  elif [ -f /etc/bash_completion ]; then
    source /etc/bash_completion
  fi
fi

# 7. SSH agent: Prioritize systemd-user, then GNOME Keyring if in desktop session
# This logic determines which SSH_AUTH_SOCK to use.

# Path for the systemd user ssh-agent socket
_SYSTEMD_SSH_AGENT_SOCK="$XDG_RUNTIME_DIR/ssh-agent.sock"

if [ -n "$XDG_RUNTIME_DIR" ] &amp;&amp; [ -S "$_SYSTEMD_SSH_AGENT_SOCK" ]; then
  # systemd user agent socket exists, use it.
  export SSH_AUTH_SOCK="$_SYSTEMD_SSH_AGENT_SOCK"
elif [ -n "$DESKTOP_SESSION" ] &amp;&amp; command -v gnome-keyring-daemon &gt;/dev/null; then
  # No systemd user agent socket found (or XDG_RUNTIME_DIR not set),
  # but in a desktop session. Attempt to use/start GNOME Keyring.
  # GNOME Keyring might already be running via its own systemd user service or XDG autostart.
  # This eval will set SSH_AUTH_SOCK if gnome-keyring-daemon starts/is running and manages SSH.
  eval "$(gnome-keyring-daemon --start --components=secrets,ssh)"
  export SSH_AUTH_SOCK # Ensure it's exported from eval
fi
unset _SYSTEMD_SSH_AGENT_SOCK

# Attempt to add default SSH key (id_rsa) if an agent is running and has no keys.
if command -v ssh-add &gt;/dev/null; then
    if ! ssh-add -l &amp;&gt;/dev/null; then # Check if agent has ANY keys
        if [ -n "${SSH_AUTH_SOCK}" ] &amp;&amp; [ -S "${SSH_AUTH_SOCK}" ] &amp;&amp; [ -f "$HOME/.ssh/id_rsa" ]; then
            # Agent seems to be running (socket exists), but no keys listed. Add id_rsa.
            # Suppress errors (e.g., passphrase needed but no tty, or key already added by another mechanism).
            ssh-add "$HOME/.ssh/id_rsa" 2&gt;/dev/null || true
        fi
    fi
fi

# 9. Prompt
if [[ "${EUID}" == "0" ]]; then # Root prompt
  PS1='\[\033[01;31m\]\h\[\033[01;34m\] \W \$\[\033[00m\] '
else # User prompt
  PS1='\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ '
fi

# 10. Aliases (!!! REVIEW AND REPLACE PLACEHOLDERS !!!)
alias ls='ls --color=auto -hF' # Added -h for human-readable sizes, -F for type indicators
alias ll='ls -alFh' # Added -h
alias la='ls -Ah' # Added -h
alias l='ls -CFh' # Added -h

alias grep='grep --color=auto'
alias egrep='egrep --color=auto'
alias fgrep='fgrep --color=auto'

# Example ping alias (uses default system ping)
alias p='ping -c 4 example.com' # Pings example.com 4 times

# Swaks alias for email testing
# !!! REPLACE with your actual email, app password, and possibly SMTP server !!!
# For Gmail, you'll need an "App Password". See Google's help documentation.
# alias Z='swaks -4 -tls -f you@gmail.com -t recipient@example.com -s smtp.gmail.com:587 -au you@gmail.com -ap YOUR_GMAIL_APP_PASSWORD -d'
alias Z='echo "Swaks alias Z not configured. Edit ~/.bashrc with your email details and an App Password for services like Gmail."'

# Git project aliases
# !!! REPLACE 'REPO' with your actual repository directory name if different !!!
# And ensure ~/projects/REPO is a git repository.
PROJECTS_DIR="$HOME/projects"
# Example: alias project1-pull='(cd "$PROJECTS_DIR/my-actual-project" &amp;&amp; git pull) || echo "Failed to cd or pull in $PROJECTS_DIR/my-actual-project"'
alias pullrepo='(cd "$PROJECTS_DIR/REPO" &amp;&amp; git pull) || echo "Failed to cd to $PROJECTS_DIR/REPO or pull"'
alias pushrepo='(cd "$PROJECTS_DIR/REPO" &amp;&amp; git push) || echo "Failed to cd to $PROJECTS_DIR/REPO or push"'

# Update system
alias update='sudo apt update &amp;&amp; sudo apt full-upgrade -y &amp;&amp; sudo apt autoremove -y &amp;&amp; sudo apt clean &amp;&amp; echo "System update process completed."'

alias f2p='f2p.py --xml --max-depth 9 --include-hidden --ignore-gitignore --output /home/linaro/Downloads/f2put.txt'

# Check for listening ports
alias listports='sudo ss -tulnp'

fix_ownership_preserve_permissions_final() {
    local home_dir="/home/linaro"
    local target_user="linaro"
    local target_group="linaro" # Assuming group is the same as the user
    local overall_success=true # Flag to track if all critical operations succeeded

    echo "-----------------------------------------------------------------------------"
    echo "Home Directory Ownership &amp; Permission Corrector (Preserve &amp; Secure)"
    echo "-----------------------------------------------------------------------------"
    echo "This script will perform the following actions within '${home_dir}':"
    echo "1. Phase 1 (Symbolic Links): Change ownership of symbolic LINKS THEMSELVES to '${target_user}:${target_group}'."
    echo "2. Phase 2 (All Items): Change ownership of all files, directories, and symlink TARGETS"
    echo "   to '${target_user}:${target_group}' AND re-apply their original permission bits."
    echo "3. Phase 3 (Security): For '${home_dir}/.ssh' and '${home_dir}/.gnupg', ENFORCE known-good secure permissions."
    echo ""
    echo "WARNING:"
    echo "- This operation uses 'sudo' and modifies file ownership and permissions recursively."
    echo "- If a non-SSH/GPG file had insecure permissions (e.g., 777) while owned by root,"
    echo "  Phase 2 will preserve those permissions under '${target_user}' ownership."
    echo "  Review permissions of sensitive non-SSH/GPG files afterwards."
    echo "- Ensure you have a backup if you are uncertain about any consequences."
    echo "-----------------------------------------------------------------------------"
    read -p "Are you absolutely sure you want to proceed? (Type 'yes' to continue): " confirmation

    if [[ "$confirmation" != "yes" ]]; then
        echo "Operation cancelled by user."
        return 1
    fi

    echo ""
    echo "Proceeding with ownership and permission changes..."

    # --- Phase 1: Set ownership of Symbolic Links themselves ---
    echo ""
    echo "Phase 1: Setting ownership of symbolic links themselves to '${target_user}:${target_group}'..."
    sudo find "${home_dir}" -type l -print0 | while IFS= read -r -d $'\0' symlink_item; do
        echo "  Processing symlink: ${symlink_item}"
        if ! sudo chown -h "${target_user}:${target_group}" "${symlink_item}"; then
            echo "    ERROR: Failed to change ownership of symlink '${symlink_item}'."
            overall_success=false
        else
            echo "    Ownership of symlink set."
        fi
    done
    echo "Phase 1 complete."

    # --- Phase 2: Change ownership and re-apply original permissions for all items ---
    # For symlinks, this phase will operate on their TARGETS.
    echo ""
    echo "Phase 2: Changing ownership to '${target_user}' and re-applying original permissions for all items (including symlink targets)..."
    sudo find "${home_dir}" -print0 | while IFS= read -r -d $'\0' item; do
        echo "  Processing item: ${item}"
        item_type=$(sudo stat -L -c "%F" "${item}") # Get type, dereferencing symlink

        # Get current permissions in octal format (dereferences symlinks by default)
        current_perms_octal=$(sudo stat -c "%a" "${item}")
        if [[ -z "$current_perms_octal" ]]; then
            echo "    ERROR: Could not get permissions for '${item}'. Skipping permission change."
            # Still attempt chown if possible
            if ! sudo chown "${target_user}:${target_group}" "${item}"; then
                 echo "    ERROR: Failed to change ownership for '${item}' as well."
                 overall_success=false
            fi
            continue
        fi
        echo "    Original Permissions (of item/target): ${current_perms_octal}, Type: ${item_type}"

        # 1. Change ownership to the target user and group (dereferences symlinks by default)
        if ! sudo chown "${target_user}:${target_group}" "${item}"; then
            echo "    ERROR: Failed to change ownership for '${item}'. Skipping chmod for this item."
            overall_success=false
            continue
        fi
        echo "    Ownership changed to ${target_user}:${target_group}."

        # 2. Re-apply the original permissions (dereferences symlinks by default)
        #    Skip chmod for symbolic links themselves (their permissions are special: lrwxrwxrwx)
        #    We are interested in the target's permissions, which stat already gave us.
        if [[ "${item_type}" != "symbolic link" ]]; then # Only chmod non-symlinks directly
            if ! sudo chmod "${current_perms_octal}" "${item}"; then
                echo "    ERROR: Failed to re-apply original permissions '${current_perms_octal}' to '${item}'."
                overall_success=false
            else
                echo "    Original permissions '${current_perms_octal}' re-applied."
            fi
        else
            # For symlinks, we've already processed the target's permissions if 'item' was a symlink.
            # The link's own permissions (lrwxrwxrwx) are not changed by chmod.
            echo "    Item is a symbolic link. Its target's ownership/permissions handled. Link's own perms (lrwxrwxrwx) unchanged by chmod."
        fi
        echo "  ---"
    done
    echo "Phase 2 complete."

    # --- Phase 3: Enforce specific secure permissions for critical directories ---
    echo ""
    echo "Phase 3: Enforcing specific secure permissions for critical directories..."

    # For .ssh directory
    if [ -d "${home_dir}/.ssh" ]; then
        echo "  Enforcing secure permissions for '${home_dir}/.ssh'..."
        sudo chown -R "${target_user}:${target_group}" "${home_dir}/.ssh" # Robustness
        sudo chmod 700 "${home_dir}/.ssh"
        sudo find "${home_dir}/.ssh" -type f \( -name "id_rsa" -o -name "id_dsa" -o -name "id_ecdsa" -o -name "id_ed25519" \) -exec sudo chmod 600 {} \;
        sudo find "${home_dir}/.ssh" -type f \( -name "*.pub" \) -exec sudo chmod 644 {} \;
        [ -f "${home_dir}/.ssh/authorized_keys" ] &amp;&amp; sudo chmod 600 "${home_dir}/.ssh/authorized_keys"
        [ -f "${home_dir}/.ssh/known_hosts" ] &amp;&amp; sudo chmod 644 "${home_dir}/.ssh/known_hosts"
        [ -f "${home_dir}/.ssh/config" ] &amp;&amp; sudo chmod 600 "${home_dir}/.ssh/config"
        sudo find "${home_dir}/.ssh" -mindepth 1 -type f \
            ! \( -name "id_rsa" -o -name "id_dsa" -o -name "id_ecdsa" -o -name "id_ed25519" \
            -o -name "*.pub" -o -name "authorized_keys" -o -name "known_hosts" -o -name "config" \) -exec sudo chmod 600 {} \;
        sudo find "${home_dir}/.ssh" -mindepth 1 -type d -exec sudo chmod 700 {} \;
        echo "  Permissions for '${home_dir}/.ssh' secured."
    fi

    # For .gnupg directory
    if [ -d "${home_dir}/.gnupg" ]; then
        echo "  Enforcing secure permissions for '${home_dir}/.gnupg'..."
        sudo chown -R "${target_user}:${target_group}" "${home_dir}/.gnupg" # Robustness
        sudo chmod 700 "${home_dir}/.gnupg"
        sudo find "${home_dir}/.gnupg" -type f -exec sudo chmod 600 {} \;
        sudo find "${home_dir}/.gnupg" -mindepth 1 -type d -exec sudo chmod 700 {} \;
        echo "  Permissions for '${home_dir}/.gnupg' secured."
    fi
    echo "Phase 3 complete."

    echo "-----------------------------------------------------------------------------"
    if [[ "$overall_success" == true ]]; then
        echo "Ownership and permission adjustment process completed successfully."
    else
        echo "Ownership and permission adjustment process completed with SOME ERRORS (see log above)."
    fi
    echo "IMPORTANT: Review permissions of sensitive files outside of .ssh and .gnupg."
    echo "If they had overly permissive settings, those have been preserved under"
    echo "'${target_user}' ownership. Adjust manually if needed."
    echo "Verify that all applications function as expected."
    echo "-----------------------------------------------------------------------------"

    if [[ "$overall_success" == true ]]; then
        return 0
    else
        return 1
    fi
}

# Alias to call the enhanced function
alias fixmyhome='fix_ownership_preserve_permissions_final'
. "$HOME/.cargo/env"
source ~/.bash_completion/alacritty

# restic backup function: resto /path/to/backup
resto() {
    # --- Configuration ---
    local restic_cmd="restic_0.18"
    local repository_location="rclone:storj:rest-3588"
    local hardcoded_password="placeholder" # &lt;&lt;&lt; YOUR HARDCODED PASSWORD (QUOTED)

    # --- Argument Validation ---
    if [ -z "$1" ]; then
        echo "Error: You must specify the path to back up." &gt;&amp;2
        echo "Usage: resto /path/to/your/data" &gt;&amp;2
        return 1 # Return an error code
    fi

    # --- Variable Setup ---
    local backup_path="$1"
    local current_date_tag
    current_date_tag=$(date +%Y%m%d) # Generates tag like YYYYMMDD (e.g., 20250516)

    # --- User Feedback ---
    echo "--------------------------------------------------"
    echo "Attempting restic backup:"
    echo "  Source:      ${backup_path}"
    echo "  Repository:  ${repository_location}"
    echo "  Tag:         ${current_date_tag}"
    echo "  Restic cmd:  ${restic_cmd}"
    echo "  Auth Method: Hardcoded password (WARNING: SERIOUS SECURITY RISK!)" # Emphasize risk
    echo "--------------------------------------------------"

    # --- Command Execution ---
    # The RESTIC_PASSWORD environment variable is set *only* for this specific command's environment.
    # It does not persist in the current shell session afterwards.
    # Quotes around "${hardcoded_password}" are crucial, especially since your password
    # contains '&amp;', a special shell metacharacter (used for backgrounding processes).
    # The backslashes (\) at the end of lines are for line continuation, allowing
    # a single command to be split across multiple lines for readability.
    RESTIC_PASSWORD="${hardcoded_password}" "${restic_cmd}" \
        -r "${repository_location}" \
        -o rclone.connections=8 \
        backup "${backup_path}" \
        --verbose \
        --pack-size=60 \
        --tag "${current_date_tag}"

    # --- Post-Execution Feedback ---
    local exit_status=$?
    if [ ${exit_status} -eq 0 ]; then
        echo "--------------------------------------------------"
        echo "SUCCESS: Backup completed for: ${backup_path}"
        echo "--------------------------------------------------"
    else
        echo "--------------------------------------------------"
        echo "ERROR: Backup FAILED for: ${backup_path} (Exit status: ${exit_status})" &gt;&amp;2
        echo "  (Verify repository settings, password, rclone configuration, and target path.)"
        echo "--------------------------------------------------"
    fi
    return ${exit_status}
}

#!/bin/bash
# fpsync wrapper 'cesto' for Debian Bullseye
# Designed to maximize fpsync's parallel transfer capabilities by ensuring
# fpsync always operates on a directory whose contents can be partitioned by fpart.
#
# - If a single directory is provided as source, it's passed directly to fpsync.
# - If multiple files/directories or a single file are provided as sources,
#   they are copied into a temporary aggregation directory. This aggregation
#   directory is then passed to fpsync, allowing fpart to see all individual
#   items and partition them effectively for parallel rsync workers.

cesto() {
  # --- Argument Validation ---
  # Ensures at least two arguments: one or more sources, and one destination.
  if [ "$#" -lt 2 ]; then
    echo "Error: At least one source item and a destination directory are required." &gt;&amp;2
    echo "Usage: cesto &lt;source_item_1&gt; [source_item_2...] &lt;destination_directory/&gt;" &gt;&amp;2
    echo "   or: cesto &lt;single_source_directory&gt; &lt;destination_directory&gt;" &gt;&amp;2
    echo "Example (multiple files for aggregation): cesto report.pdf image.png data_files/*.csv ./backup/aggregated_reports_images_data" &gt;&amp;2
    echo "Example (single large directory for direct sync): cesto ./my_entire_dataset/ /mnt/archive/dataset_backup/" &gt;&amp;2
    return 1
  fi

  # --- Variable Initialization ---
  local user_dest_dir="${!#}"          # Last argument is the destination directory path provided by the user.
  local sources_array=("${@:1:$#-1}")  # All arguments except the last are considered source items.
  local num_sources="${#sources_array[@]}" # Count of source items.

  local num_workers=4                 # Number of parallel fpsync workers (as per original alias request).
  local fpsync_opts="-v"              # Default options for fpsync (verbose).

  # Path for the temporary aggregation directory, if needed. Local to this function call.
  local tmp_aggregation_dir=""

  # Setup a 'trap' for robust cleanup of the temporary aggregation directory.
  # This command executes when the function exits (EXIT signal) or on common interrupt signals.
  # The command string is in single quotes, so '$tmp_aggregation_dir' is evaluated
  # *when the trap is triggered*, using its value at that moment.
  # 'trap - ...' at the end of the trap command aims to make it a self-disabling one-shot trap.
  trap 'if [ -n "$tmp_aggregation_dir" ] &amp;&amp; [ -d "$tmp_aggregation_dir" ]; then echo "INFO: (Trap) Cleaning up temporary aggregation directory: $tmp_aggregation_dir"; rm -rf "$tmp_aggregation_dir"; fi; trap - EXIT HUP INT QUIT TERM' EXIT HUP INT QUIT TERM

  # --- Destination Path Preparation ---
  # This section ensures the destination path is an absolute directory path with a trailing slash.
  echo "INFO: Preparing destination directory: \"$user_dest_dir\""
  # 'mkdir -p' creates the directory including any necessary parent directories.
  # It doesn't error if the directory already exists, making it idempotent.
  if ! mkdir -p "$user_dest_dir"; then
    echo "Error: Failed to create or access directory structure for destination \"$user_dest_dir\"." &gt;&amp;2
    return 1
  fi
  local abs_dest_dir # Will hold the canonical, absolute path to the destination.
  # 'readlink -f' resolves all symlinks, '..' and '.', making the path absolute.
  # This requires the path (or its components up to the symlink target) to exist.
  abs_dest_dir=$(readlink -f "$user_dest_dir")
  if [ -z "$abs_dest_dir" ] || [ ! -d "$abs_dest_dir" ]; then
      echo "Error: Could not resolve destination \"$user_dest_dir\" to an absolute directory path, or it's not a directory after 'mkdir -p'." &gt;&amp;2
      return 1
  fi
  # Ensures a single trailing slash, signifying to fpsync/rsync to sync *into* this directory.
  local final_dest_dir_for_fpsync="${abs_dest_dir%/}/"


  # --- Source Path Handling ---
  # This variable will hold the final, absolute source directory path (with trailing slash) for fpsync.
  local path_to_sync_via_fpsync

  # Case 1: A single source item is provided by the user.
  # We check if this single item is a directory. If so, it's used directly.
  # This is the most straightforward and often most performant case for fpsync.
  if [ "$num_sources" -eq 1 ]; then
    local single_src_item_orig="${sources_array[0]}"
    local single_src_item_abs # Will hold the absolute path of the single source.
    single_src_item_abs=$(readlink -f "$single_src_item_orig")

    if [ -z "$single_src_item_abs" ]; then
      echo "Error: Source \"$single_src_item_orig\" could not be resolved to an absolute path." &gt;&amp;2
      return 1
    fi

    if [ -d "$single_src_item_abs" ]; then
      echo "INFO: Mode: Single source directory detected (\"${single_src_item_abs}\"). Using direct fpsync for maximum parallelism of its contents."
      path_to_sync_via_fpsync="${single_src_item_abs%/}/" # Ensure trailing slash.
    # If the single source item is not a directory (e.g., it's a file),
    # 'path_to_sync_via_fpsync' remains unset. The script will then proceed to the
    # aggregation logic (Case 2) to handle this single file.
    fi
  fi

  # Case 2: Multiple source items were provided, OR it was a single source item that was not a directory.
  # (This is triggered if 'path_to_sync_via_fpsync' was not set in Case 1).
  # In this scenario, all specified source items are copied into a temporary aggregation directory.
  # This aggregation directory then becomes the source for fpsync.
  if [ -z "$path_to_sync_via_fpsync" ]; then
    echo "INFO: Mode: Multiple sources or single file source detected. Aggregating into a temporary directory to enable optimal fpsync parallelism."
    
    # Create a unique temporary directory.
    # Uses $TMPDIR if set (standard practice), otherwise defaults to /tmp.
    # The XXXXXX template ensures mktemp generates a unique, secure name.
    # Note: This temporary directory may consume significant disk space if source items are large.
    tmp_aggregation_dir=$(mktemp -d "/mnt/mSATA/tmp_cesto/cesto_aggregate_src.XXXXXXXXXX")
    # Check if mktemp was successful and created a directory.
    if [ $? -ne 0 ] || [ -z "$tmp_aggregation_dir" ] || [ ! -d "$tmp_aggregation_dir" ]; then
      echo "Error: Failed to create temporary aggregation directory using mktemp." &gt;&amp;2
      tmp_aggregation_dir="" # Ensure var is empty for the trap's conditional check.
      return 1
    fi
    # The trap (set earlier) will now be responsible for cleaning up this specific '$tmp_aggregation_dir' path.

    local item_copied_successfully=0 # Flag to track if any items were actually copied.
    echo "INFO: Populating temporary aggregation directory: ${tmp_aggregation_dir}"
    for src_item_orig in "${sources_array[@]}"; do
      local src_item_abs # Absolute path of the current source item.
      src_item_abs=$(readlink -f "$src_item_orig")

      if [ -z "$src_item_abs" ]; then
        echo "Warning: Could not resolve source item \"$src_item_orig\" to an absolute path. Skipping." &gt;&amp;2
        continue
      fi
      if [ ! -e "$src_item_abs" ]; then # Check if the resolved path actually exists.
        echo "Warning: Source item \"$src_item_orig\" (resolved to \"$src_item_abs\") does not exist. Skipping." &gt;&amp;2
        continue
      fi

      # Use 'cp -aL' to copy items into the aggregation directory:
      #   -a (archive mode): Equivalent to -dR --preserve=all.
      #     -d: same as --no-dereference --preserve=links (preserves symlinks as symlinks).
      #     -R: copy directories recursively.
      #     --preserve=all: preserves mode, ownership, timestamps, links, context, xattr.
      #   -L (dereference): When copying, if a source argument is a symbolic link,
      #     copy the file or directory it points to, rather than the link itself.
      # This ensures the actual data/directory structures are placed into the aggregation directory.
      # If 'src_item_abs' is a directory, it will be copied recursively into 'tmp_aggregation_dir'.
      echo "      Copying \"$src_item_orig\" (as \"$src_item_abs\") into temporary aggregation directory..."
      if cp -aL "$src_item_abs" "$tmp_aggregation_dir/"; then
        item_copied_successfully=1
      else
        echo "Warning: Failed to copy \"$src_item_orig\" (resolved to \"$src_item_abs\") to temporary aggregation directory. Skipping." &gt;&amp;2
      fi
    done

    if [ "$item_copied_successfully" -eq 0 ]; then
      echo "Error: No source items were successfully copied to the temporary aggregation directory." &gt;&amp;2
      # The EXIT trap will handle cleaning up the (empty or partially filled) tmp_aggregation_dir.
      return 1
    fi
    # The source for fpsync will be this populated temporary aggregation directory.
    # A trailing slash is crucial for fpsync to synchronize the *contents* of this directory.
    path_to_sync_via_fpsync="${tmp_aggregation_dir%/}/"
  fi

  # --- Execution ---
  echo "INFO: Running fpsync with source \"${path_to_sync_via_fpsync}\" and destination \"${final_dest_dir_for_fpsync}\""
  # fpsync will now operate on 'path_to_sync_via_fpsync'.
  # If this is a user's single source directory, fpsync processes it directly.
  # If this is the temporary aggregation directory, fpsync processes all the items copied into it.
  # In both scenarios, fpart (within fpsync) can see a directory structure containing all
  # individual files and sub-directories, allowing it to partition the workload effectively
  # for the parallel rsync workers, thus maximizing parallelism.
  # rsync (used by fpsync) can also provide benefits like delta-transfer if files are being updated.
  fpsync -n "${num_workers}" ${fpsync_opts} "${path_to_sync_via_fpsync}" "${final_dest_dir_for_fpsync}"

  local fpsync_status=$? # Capture the exit status of fpsync for reliable error checking.

  if [ ${fpsync_status} -ne 0 ]; then
    echo "Warning: fpsync operation completed with errors (status: ${fpsync_status})." &gt;&amp;2
  else
    echo "INFO: fpsync operation completed successfully."
  fi
  
  # The EXIT trap (if '$tmp_aggregation_dir' was set and points to a created directory)
  # will automatically clean up the source-side temporary aggregation directory.
  # The function returns fpsync's exit status, allowing the caller (e.g., another script)
  # to check for success or failure of the cesto command.
  return ${fpsync_status}
}

alias hands='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=aafcjomacmnbaahoofemlheilcimkppb &amp; exit'
alias drive='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=aghbiahbpaijignceidepookljebhfak &amp; exit'
alias gemini='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=caidcmannjgahlnbpmidmiecjcoiiigg &amp; exit'
alias openai='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=cfbmnkmmjhboeflpgnckjneljkhagell &amp; exit'
alias ide='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=ehjakkgkdlikfiplhaghbilnpdlmfgbo &amp; exit'
alias gingko='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=glpafmialolpdohgeinpjffpbnjjfhhc &amp; exit'
alias whats='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=hnpfjngllnobngcgfapefoaidbinmjnm &amp; exit'
alias devin='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=jeanpambhekpchfnadhifbfdfhfjonag &amp; exit'
alias workspace='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=kejlbheaeffmkkfopajhgmefbpmgelfp &amp; exit'
alias jules='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=kfhlllhpifmmhopbnlabhbmcmkokpgge &amp; exit'
alias github='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=mjoklplbddabcmpepnokjaffbmgbkkgg &amp; exit'
alias studio='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=mojogeknlbnppmajemmkcfkilgaapppk &amp; exit'
alias khoj='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=oojcbbhlpifpfcefjdoppjkdmljbjnda &amp; exit'
alias doc2plan='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=paomcjbhlkmgamkbcllamfnkmiefidhg &amp; exit'
alias codespace='/opt/chromium.org/thorium/thorium-browser --profile-directory=Default --app-id=pdeapfppmifikfghhlchhocndoingjbc &amp; exit'
</code></section></div></div><hr />
  <h2 id="4-systemd-user-ssh-agent-service-user">
    
    
     <a href="#4-systemd-user-ssh-agent-service-user">#</a><a href="#" aria-label="Back to top">4. systemd-user SSH Agent Service (User)</a>
        
    
  </h2>
      
<p>Create <code class="language-plaintext highlighter-rouge">~/.config/systemd/user/ssh-agent.service</code>:</p>
<div class="language-ini highlighter-rouge"><div class="highlight"><section><code><span class="nn">[Unit]</span>
<span class="py">Description</span><span class="p">=</span><span class="s">SSH Agent per user</span>
<span class="py">After</span><span class="p">=</span><span class="s">network.target</span>

<span class="nn">[Service]</span>
<span class="py">Type</span><span class="p">=</span><span class="s">forking</span>
<span class="py">Environment</span><span class="p">=</span><span class="s">SSH_AUTH_SOCK=%t/ssh-agent.sock</span>
<span class="py">ExecStart</span><span class="p">=</span><span class="s">/usr/bin/ssh-agent -a $SSH_AUTH_SOCK</span>

<span class="nn">[Install]</span>
<span class="py">WantedBy</span><span class="p">=</span><span class="s">default.target</span>
</code></section></div></div>

<p>Enable and start:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><section><code>systemctl <span class="nt">--user</span> daemon-reload
systemctl <span class="nt">--user</span> <span class="nb">enable </span>ssh-agent.service
systemctl <span class="nt">--user</span> start ssh-agent.service
</code></section></div></div>

<p>Verify:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><section><code>systemctl <span class="nt">--user</span> status ssh-agent.service
<span class="nb">ls</span> <span class="nt">-l</span> <span class="s2">"</span><span class="nv">$XDG_RUNTIME_DIR</span><span class="s2">/ssh-agent.sock"</span>
ssh-add <span class="nt">-l</span>
</code></section></div></div><hr />
  <h2 id="5-common-ssh-use-cases">
    
    
     <a href="#5-common-ssh-use-cases">#</a><a href="#" aria-label="Back to top">5. Common SSH Use Cases</a>
        
    
  </h2>
      
<ul>
  <li><strong>Passwordless login:</strong> Key-based server access.</li>
  <li><strong>Git over SSH:</strong> Seamless <code class="language-plaintext highlighter-rouge">git clone/push/pull</code>.</li>
  <li><strong>Agent forwarding:</strong> Secure multi-hop SSH.</li>
  <li><strong>Hardware tokens:</strong> GNOME Keyring integration.</li>
</ul><hr />
  <h2 id="6-verification-checklist">
    
    
     <a href="#6-verification-checklist">#</a><a href="#" aria-label="Back to top">6. Verification Checklist</a>
        
    
  </h2>
      
<div class="language-bash highlighter-rouge"><div class="highlight"><section><code>go version
rustc <span class="nt">--version</span>
bash <span class="nt">--login</span> <span class="nt">-ic</span> <span class="s1">'echo interactive'</span>
ssh-add <span class="nt">-l</span>
</code></section></div></div>
  <h1 id="installing-the-necessary-dependencies">
    
    
     <a href="#installing-the-necessary-dependencies">#</a><a href="#" aria-label="Back to top">installing the necessary dependencies</a>
        
    
  </h1>
      

<p>This comprehensive guide will walk you through installing and configuring every dependency and necessity to fully implement the features of your provided <code class="language-plaintext highlighter-rouge">.bashrc</code> configuration and SSH setup on a Debian 11 “Bullseye” system. It assumes your root user is <code class="language-plaintext highlighter-rouge">root</code> and your local user is <code class="language-plaintext highlighter-rouge">linaro</code>.</p>

<p><strong>User Account Assumption:</strong></p>
<ul>
  <li>Root user: <code class="language-plaintext highlighter-rouge">root</code></li>
  <li>Local user: <code class="language-plaintext highlighter-rouge">linaro</code></li>
</ul><hr />
  <h2 id="prerequisites-for-linaro-user">
    
    
     <a href="#prerequisites-for-linaro-user">#</a><a href="#" aria-label="Back to top">Prerequisites for <code class="language-plaintext highlighter-rouge">linaro</code> User</a>
        
    
  </h2>
      

<p>Before starting, ensure the <code class="language-plaintext highlighter-rouge">linaro</code> user has <code class="language-plaintext highlighter-rouge">sudo</code> privileges to execute administrative commands. If not, as the <code class="language-plaintext highlighter-rouge">root</code> user, run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="c"># As root user</span>
usermod <span class="nt">-aG</span> <span class="nb">sudo </span>linaro
</code></section></div></div>

<p>After running this command, <code class="language-plaintext highlighter-rouge">linaro</code> must log out and log back in for the group change to take effect. All commands prefixed with <code class="language-plaintext highlighter-rouge">sudo</code> below should be run by the <code class="language-plaintext highlighter-rouge">linaro</code> user, leveraging these <code class="language-plaintext highlighter-rouge">sudo</code> privileges.</p><hr />
  <h2 id="part-1-system-wide-installations-and-configurations-executed-by-linaro-using-sudo">
    
    
     <a href="#part-1-system-wide-installations-and-configurations-executed-by-linaro-using-sudo">#</a><a href="#" aria-label="Back to top">Part 1: System-Wide Installations and Configurations (executed by <code class="language-plaintext highlighter-rouge">linaro</code> using <code class="language-plaintext highlighter-rouge">sudo</code>)</a>
        
    
  </h2>
      

<p>These steps involve installing packages and setting up system-level configurations.</p>
  <h3 id="11-system-update">
    
    
     <a href="#11-system-update">#</a><a href="#" aria-label="Back to top">1.1. System Update</a>
        
    
  </h3>
      

<p>First, ensure your system’s package list and installed packages are up-to-date:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>apt update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt upgrade <span class="nt">-y</span>
</code></section></div></div>

<ul>
  <li><strong>What:</strong> Updates the local package lists from repositories and upgrades all currently installed packages to their newest versions.</li>
  <li><strong>Why:</strong> Essential for system stability, security, and to ensure compatibility with new software.</li>
  <li><strong>Verification:</strong> The commands complete without errors. You can run <code class="language-plaintext highlighter-rouge">sudo apt list --upgradable</code> afterwards; it should show no or very few packages.</li>
</ul>
  <h3 id="12-core-utilities-and-essential-packages">
    
    
     <a href="#12-core-utilities-and-essential-packages">#</a><a href="#" aria-label="Back to top">1.2. Core Utilities and Essential Packages</a>
        
    
  </h3>
      

<p>Install the core utilities and packages mentioned in your script, plus a few others that are implicitly needed or highly recommended for the setup:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> <span class="se">\</span>
  build-essential <span class="se">\</span>
  git <span class="se">\</span>
  curl <span class="se">\</span>
  wget <span class="se">\</span>
  unzip <span class="se">\</span>
  zip <span class="se">\</span>
  bash-completion <span class="se">\</span>
  python3-pip <span class="se">\</span>
  nodejs <span class="se">\</span>
  npm <span class="se">\</span>
  libpulse-dev <span class="se">\</span>
  flatpak <span class="se">\</span>
  swaks <span class="se">\</span>
  openssh-client <span class="se">\</span>
  iputils-ping <span class="se">\</span>
  gnome-keyring <span class="se">\</span>
  libnss-myhostname <span class="se">\</span>
  dbus-user-session
</code></section></div></div>

<p>Let’s break down why each of these is needed:</p>

<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">build-essential</code></strong>:
    <ul>
      <li><strong>What:</strong> A meta-package that installs GCC (C compiler), <code class="language-plaintext highlighter-rouge">make</code>, and other essential tools for compiling software from source.</li>
      <li><strong>Why:</strong> Required by Rust’s installation script (<code class="language-plaintext highlighter-rouge">rustup</code>) and potentially for other software you might build.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">gcc --version</code> and <code class="language-plaintext highlighter-rouge">make --version</code> should display their versions.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">git</code></strong>:
    <ul>
      <li><strong>What:</strong> A distributed version control system.</li>
      <li><strong>Why:</strong> Needed for the <code class="language-plaintext highlighter-rouge">pull</code> and <code class="language-plaintext highlighter-rouge">push</code> aliases in your <code class="language-plaintext highlighter-rouge">.bashrc</code> (interacting with <code class="language-plaintext highlighter-rouge">~/projects/REPO</code>) and potentially by <code class="language-plaintext highlighter-rouge">rustup</code>.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">git --version</code> should display the installed version.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">curl</code></strong>:
    <ul>
      <li><strong>What:</strong> A command-line tool for transferring data using various network protocols.</li>
      <li><strong>Why:</strong> Used to download the Rust installation script (<code class="language-plaintext highlighter-rouge">sh.rustup.rs</code>).</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">curl --version</code> should display its version.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">wget</code></strong>:
    <ul>
      <li><strong>What:</strong> A command-line tool for downloading files from the web.</li>
      <li><strong>Why:</strong> Used to download the Go language tarball.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">wget --version</code> should display its version.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">unzip</code> &amp; <code class="language-plaintext highlighter-rouge">zip</code></strong>:
    <ul>
      <li><strong>What:</strong> Utilities for decompressing and creating ZIP archives, respectively.</li>
      <li><strong>Why:</strong> General-purpose utilities useful for managing compressed files.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">unzip -v</code> and <code class="language-plaintext highlighter-rouge">zip -v</code> should display their versions.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">bash-completion</code></strong>:
    <ul>
      <li><strong>What:</strong> Provides programmable command-line completion for the Bash shell.</li>
      <li><strong>Why:</strong> Your <code class="language-plaintext highlighter-rouge">.bashrc</code> explicitly sources bash completion scripts, enhancing shell interactivity (e.g., pressing Tab to complete commands or options).</li>
      <li><strong>Verify:</strong> After setting up <code class="language-plaintext highlighter-rouge">.bashrc</code> and opening a new terminal, typing a command like <code class="language-plaintext highlighter-rouge">apt ins</code> and pressing Tab should offer <code class="language-plaintext highlighter-rouge">install</code> as a suggestion.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">python3-pip</code></strong>:
    <ul>
      <li><strong>What:</strong> The package installer for Python 3.</li>
      <li><strong>Why:</strong> While not directly called by a <code class="language-plaintext highlighter-rouge">.bashrc</code> function, it’s useful for Python development. Python scripts installed via pip for the user might go into <code class="language-plaintext highlighter-rouge">$HOME/.local/bin</code>, which is added to your <code class="language-plaintext highlighter-rouge">PATH</code>.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">pip3 --version</code> should display its version.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">nodejs</code> &amp; <code class="language-plaintext highlighter-rouge">npm</code></strong>:
    <ul>
      <li><strong>What:</strong> Node.js is a JavaScript runtime; npm is its package manager.</li>
      <li><strong>Why:</strong> Common tools for web development and various JavaScript-based utilities. Not directly used by <code class="language-plaintext highlighter-rouge">.bashrc</code> but good for a development setup.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">node --version</code> and <code class="language-plaintext highlighter-rouge">npm --version</code> should display their versions.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">libpulse-dev</code></strong>:
    <ul>
      <li><strong>What:</strong> Development files for PulseAudio, a sound server.</li>
      <li><strong>Why:</strong> Often a dependency for desktop applications or development involving audio. Its inclusion might be related to expectations in a desktop environment where GNOME Keyring is also used.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">dpkg -s libpulse-dev | grep Status</code> should show “install ok installed”.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">flatpak</code></strong>:
    <ul>
      <li><strong>What:</strong> A system for building, distributing, and running sandboxed desktop applications.</li>
      <li><strong>Why:</strong> Your <code class="language-plaintext highlighter-rouge">.bashrc</code> modifies <code class="language-plaintext highlighter-rouge">XDG_DATA_DIRS</code> to include Flatpak paths, making applications installed via Flatpak discoverable.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">flatpak --version</code> should display its version.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">swaks</code></strong>:
    <ul>
      <li><strong>What:</strong> “Swiss Army Knife for SMTP,” a command-line SMTP testing tool.</li>
      <li><strong>Why:</strong> Used by the <code class="language-plaintext highlighter-rouge">Z</code> alias in your <code class="language-plaintext highlighter-rouge">.bashrc</code> for sending test emails.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">swaks --version</code> should display its version.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">openssh-client</code></strong>:
    <ul>
      <li><strong>What:</strong> Provides SSH client tools like <code class="language-plaintext highlighter-rouge">ssh</code>, <code class="language-plaintext highlighter-rouge">scp</code>, <code class="language-plaintext highlighter-rouge">ssh-agent</code>, <code class="language-plaintext highlighter-rouge">ssh-add</code>, and <code class="language-plaintext highlighter-rouge">ssh-keygen</code>.</li>
      <li><strong>Why:</strong> Essential for all SSH functionalities: agent management, key generation, connecting to SSH servers, and for the <code class="language-plaintext highlighter-rouge">ssh-add</code> command in <code class="language-plaintext highlighter-rouge">.bashrc</code>.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">ssh -V</code> should display its version.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">iputils-ping</code></strong>:
    <ul>
      <li><strong>What:</strong> Provides the <code class="language-plaintext highlighter-rouge">ping</code> utility.</li>
      <li><strong>Why:</strong> Required for the <code class="language-plaintext highlighter-rouge">p</code> alias in your <code class="language-plaintext highlighter-rouge">.bashrc</code>.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">ping -V</code> should display its version (use <code class="language-plaintext highlighter-rouge">Ctrl+C</code> to stop if it starts pinging).</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">gnome-keyring</code></strong>:
    <ul>
      <li><strong>What:</strong> A daemon that keeps passwords and other secrets for users. It can also manage SSH keys.</li>
      <li><strong>Why:</strong> Your <code class="language-plaintext highlighter-rouge">.bashrc</code> includes a fallback mechanism to use <code class="language-plaintext highlighter-rouge">gnome-keyring-daemon</code> as an SSH agent if a <code class="language-plaintext highlighter-rouge">DESKTOP_SESSION</code> is active.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">dpkg -s gnome-keyring | grep Status</code> should show “install ok installed”.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">libnss-myhostname</code></strong>:
    <ul>
      <li><strong>What:</strong> A plugin for NSS providing hostname resolution for the locally configured system hostname.</li>
      <li><strong>Why:</strong> Crucial for the stability of <code class="language-plaintext highlighter-rouge">systemd --user</code> services, ensuring the local hostname is consistently resolvable, preventing potential issues with services that rely on it, especially in minimal or containerized environments.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">dpkg -s libnss-myhostname | grep Status</code> should show “install ok installed”.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">dbus-user-session</code></strong>:
    <ul>
      <li><strong>What:</strong> Provides D-Bus session management for user sessions, often launched via <code class="language-plaintext highlighter-rouge">systemd --user</code>.</li>
      <li><strong>Why:</strong> Essential for proper functioning of the <code class="language-plaintext highlighter-rouge">systemd</code> user instance (<code class="language-plaintext highlighter-rouge">systemd --user</code>), which manages user-specific services like the <code class="language-plaintext highlighter-rouge">ssh-agent.service</code>. It ensures the user’s D-Bus is available, which many modern applications and services rely on, and helps manage <code class="language-plaintext highlighter-rouge">XDG_RUNTIME_DIR</code>.</li>
      <li><strong>Verify:</strong> <code class="language-plaintext highlighter-rouge">dpkg -s dbus-user-session | grep Status</code> should show “install ok installed”.</li>
    </ul>
  </li>
</ul>
  <h3 id="13-install-go-language-system-part">
    
    
     <a href="#13-install-go-language-system-part">#</a><a href="#" aria-label="Back to top">1.3. Install Go Language (System Part)</a>
        
    
  </h3>
      

<p>This installs Go into <code class="language-plaintext highlighter-rouge">/usr/local/go</code>, accessible by all users. (Assumes <code class="language-plaintext highlighter-rouge">linux-amd64</code> architecture).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="c"># To find the latest Go version, visit https://go.dev/dl/</span>
<span class="c"># As of May 2025, a recent stable version is 1.22.3. Please check for the latest.</span>
<span class="nv">GO_VER</span><span class="o">=</span><span class="s2">"1.22.3"</span> <span class="c"># Example: Update this to the latest desired stable version.</span>
<span class="nv">GO_ARCH</span><span class="o">=</span><span class="s2">"amd64"</span> <span class="c"># Adjust if your architecture is different (e.g., arm64)</span>

<span class="c"># Download Go binary tarball (as linaro)</span>
wget <span class="s2">"https://go.dev/dl/go</span><span class="k">${</span><span class="nv">GO_VER</span><span class="k">}</span><span class="s2">.linux-</span><span class="k">${</span><span class="nv">GO_ARCH</span><span class="k">}</span><span class="s2">.tar.gz"</span> <span class="nt">-P</span> /tmp

<span class="c"># Extract Go to /usr/local (needs sudo)</span>
<span class="nb">sudo tar</span> <span class="nt">-C</span> /usr/local <span class="nt">-xzf</span> <span class="s2">"/tmp/go</span><span class="k">${</span><span class="nv">GO_VER</span><span class="k">}</span><span class="s2">.linux-</span><span class="k">${</span><span class="nv">GO_ARCH</span><span class="k">}</span><span class="s2">.tar.gz"</span>

<span class="c"># Remove the downloaded tarball (as linaro)</span>
<span class="nb">rm</span> <span class="s2">"/tmp/go</span><span class="k">${</span><span class="nv">GO_VER</span><span class="k">}</span><span class="s2">.linux-</span><span class="k">${</span><span class="nv">GO_ARCH</span><span class="k">}</span><span class="s2">.tar.gz"</span>
</code></section></div></div>

<ul>
  <li><strong>What:</strong> Installs the Go programming language binaries.</li>
  <li><strong>Why:</strong> Your <code class="language-plaintext highlighter-rouge">.bashrc</code> sets <code class="language-plaintext highlighter-rouge">GOPATH</code> and adds <code class="language-plaintext highlighter-rouge">/usr/local/go/bin</code> to the <code class="language-plaintext highlighter-rouge">PATH</code> for using Go commands.</li>
  <li><strong>Verification (later, after <code class="language-plaintext highlighter-rouge">.bashrc</code> is configured):</strong> <code class="language-plaintext highlighter-rouge">go version</code></li>
</ul><hr />
  <h2 id="part-2-user-specific-installations-and-configurations-as-linaro">
    
    
     <a href="#part-2-user-specific-installations-and-configurations-as-linaro">#</a><a href="#" aria-label="Back to top">Part 2: User-Specific Installations and Configurations (as <code class="language-plaintext highlighter-rouge">linaro</code>)</a>
        
    
  </h2>
      

<p>These steps are performed by the <code class="language-plaintext highlighter-rouge">linaro</code> user and configure their specific environment.</p>
  <h3 id="21-create-user-specific-directories">
    
    
     <a href="#21-create-user-specific-directories">#</a><a href="#" aria-label="Back to top">2.1. Create User-Specific Directories</a>
        
    
  </h3>
      

<p>Your <code class="language-plaintext highlighter-rouge">.bashrc</code> and language tools expect certain directories in <code class="language-plaintext highlighter-rouge">linaro</code>’s home.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="c"># For Go development (GOPATH)</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/go/bin"</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/go/pkg"</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/go/src"</span>

<span class="c"># For XDG Base Directory Specification &amp; systemd user services</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.config/systemd/user"</span>
<span class="nb">chmod </span>0700 <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.config"</span> <span class="c"># Ensure parent .config dir is secure</span>
<span class="nb">chmod </span>0700 <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.config/systemd"</span>
<span class="nb">chmod </span>0700 <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.config/systemd/user"</span> <span class="c"># Secure user service definitions</span>

<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.local/share/flatpak/exports/share"</span> <span class="c"># For user-installed Flatpak data</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.local/bin"</span> <span class="c"># For user-specific executables (pip might install here)</span>

<span class="c"># For project alias examples</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/projects/REPO"</span> <span class="c"># Replace REPO with your actual project name if desired</span>
<span class="c"># You would then 'git init' or 'git clone' into ~/projects/REPO</span>
</code></section></div></div>

<ul>
  <li><strong>What:</strong> Creates standard directory structures used by Go, XDG-compliant applications, Flatpak, pip, and your example aliases. Ensures correct permissions for systemd user directories.</li>
  <li><strong>Why:</strong> Ensures these tools and configurations function correctly and securely.</li>
  <li><strong>Verification:</strong> <code class="language-plaintext highlighter-rouge">ls -ld "$HOME/go"</code>, <code class="language-plaintext highlighter-rouge">stat -c "%a %n" "$HOME/.config/systemd/user"</code> etc., should show the created directories with appropriate permissions (e.g., <code class="language-plaintext highlighter-rouge">700</code> for <code class="language-plaintext highlighter-rouge">~/.config/systemd/user</code>).</li>
</ul>
  <h3 id="22-install-rust-language">
    
    
     <a href="#22-install-rust-language">#</a><a href="#" aria-label="Back to top">2.2. Install Rust Language</a>
        
    
  </h3>
      

<p>Rust is installed per-user using <code class="language-plaintext highlighter-rouge">rustup</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code>curl <span class="nt">--proto</span> <span class="s1">'=https'</span> <span class="nt">--tlsv1</span>.2 <span class="nt">-sSf</span> https://sh.rustup.rs | sh <span class="nt">-s</span> <span class="nt">--</span> <span class="nt">-y</span>
</code></section></div></div>

<ul>
  <li><strong>What:</strong> Downloads and runs <code class="language-plaintext highlighter-rouge">rustup-init.sh</code>, which installs <code class="language-plaintext highlighter-rouge">rustup</code> (the Rust toolchain manager) and the latest stable Rust toolchain (compiler <code class="language-plaintext highlighter-rouge">rustc</code>, package manager <code class="language-plaintext highlighter-rouge">cargo</code>, etc.) into <code class="language-plaintext highlighter-rouge">$HOME/.cargo</code>.</li>
  <li><strong>Why:</strong> Your <code class="language-plaintext highlighter-rouge">.bashrc</code> sources <code class="language-plaintext highlighter-rouge">$HOME/.cargo/env</code> to add Rust tools to your <code class="language-plaintext highlighter-rouge">PATH</code>.</li>
  <li><strong>Verification (later, after <code class="language-plaintext highlighter-rouge">.bashrc</code> is configured):</strong> <code class="language-plaintext highlighter-rouge">rustc --version</code> and <code class="language-plaintext highlighter-rouge">cargo --version</code>. You might need to source <code class="language-plaintext highlighter-rouge">$HOME/.cargo/env</code> manually for the current session before editing <code class="language-plaintext highlighter-rouge">.bashrc</code>: <code class="language-plaintext highlighter-rouge">source "$HOME/.cargo/env"</code>.</li>
</ul>
  <h3 id="23-generate-ssh-key-pair">
    
    
     <a href="#23-generate-ssh-key-pair">#</a><a href="#" aria-label="Back to top">2.3. Generate SSH Key Pair</a>
        
    
  </h3>
      

<p>If <code class="language-plaintext highlighter-rouge">linaro</code> doesn’t already have an SSH key, generate one. This key (<code class="language-plaintext highlighter-rouge">~/.ssh/id_rsa</code>) will be added to the SSH agent.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="c"># Check if a key already exists</span>
<span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh/id_rsa"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span> <span class="s2">"SSH key not found. Generating a new one..."</span>
  <span class="c"># Generate with a comment including username and hostname (or 'debian' if hostname fails)</span>
  ssh-keygen <span class="nt">-t</span> rsa <span class="nt">-b</span> 4096 <span class="nt">-C</span> <span class="s2">"linaro@</span><span class="si">$(</span><span class="nb">hostname</span> <span class="o">||</span> <span class="nb">echo </span>debian<span class="si">)</span><span class="s2">"</span>
  <span class="nb">echo</span> <span class="s2">"SSH key generated."</span>
<span class="k">else
  </span><span class="nb">echo</span> <span class="s2">"SSH key </span><span class="nv">$HOME</span><span class="s2">/.ssh/id_rsa already exists."</span>
<span class="k">fi</span>

<span class="c"># Ensure correct permissions for .ssh directory and its contents</span>
<span class="nb">chmod </span>700 <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh"</span>
<span class="o">[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh/id_rsa"</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">chmod </span>600 <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh/id_rsa"</span>
<span class="o">[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh/id_rsa.pub"</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">chmod </span>644 <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh/id_rsa.pub"</span>
<span class="c"># Apply strict permissions to other common SSH files if they exist</span>
<span class="o">[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh/authorized_keys"</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">chmod </span>600 <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh/authorized_keys"</span>
<span class="o">[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh/known_hosts"</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">chmod </span>600 <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh/known_hosts"</span>
<span class="o">[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh/config"</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">chmod </span>600 <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.ssh/config"</span>
</code></section></div></div>

<ul>
  <li><strong>What:</strong> <code class="language-plaintext highlighter-rouge">ssh-keygen</code> creates a private (<code class="language-plaintext highlighter-rouge">id_rsa</code>) and public (<code class="language-plaintext highlighter-rouge">id_rsa.pub</code>) key pair.</li>
  <li><strong>Why:</strong> The private key is used for authenticating to SSH servers (e.g., for passwordless login, Git operations). The <code class="language-plaintext highlighter-rouge">.bashrc</code> script attempts to <code class="language-plaintext highlighter-rouge">ssh-add ~/.ssh/id_rsa</code>.</li>
  <li><strong>During generation:</strong> You’ll be asked for a file to save the key (press Enter for default) and a passphrase (optional, but highly recommended for security). The SSH agent will help manage this passphrase so you don’t have to type it repeatedly.</li>
  <li><strong>Verification:</strong> <code class="language-plaintext highlighter-rouge">ls -al "$HOME/.ssh/id_rsa"</code> should show the private key file with <code class="language-plaintext highlighter-rouge">600</code> permissions.</li>
</ul>
  <h3 id="24-configure-bash_profile">
    
    
     <a href="#24-configure-bash_profile">#</a><a href="#" aria-label="Back to top">2.4. Configure <code class="language-plaintext highlighter-rouge">~/.bash_profile</code></a>
        
    
  </h3>
      

<p>This file ensures <code class="language-plaintext highlighter-rouge">.bashrc</code> is loaded for interactive login shells (e.g., when you SSH into the <code class="language-plaintext highlighter-rouge">linaro</code> account or log in on the console).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="sh">'</span><span class="no">EOF</span><span class="sh">' &gt; "</span><span class="nv">$HOME</span><span class="sh">/.bash_profile"
# Source ~/.bashrc for interactive login shells
# Check if running interactively and if .bashrc exists
if [[ </span><span class="nv">$-</span><span class="sh"> == *i* &amp;&amp; -f "</span><span class="nv">$HOME</span><span class="sh">/.bashrc" ]]; then
  source "</span><span class="nv">$HOME</span><span class="sh">/.bashrc"
fi

# Fallback PATH adjustments (though .bashrc should handle these comprehensively)
# This ensures .local/bin and .cargo/bin are in PATH even if .bashrc is minimal.
_add_to_path_if_missing() {
    if [ -d "</span><span class="nv">$1</span><span class="sh">" ]; then
        case ":</span><span class="nv">$PATH</span><span class="sh">:" in
            *":</span><span class="nv">$1</span><span class="sh">:"*) :;; # Already in PATH
            *) PATH="</span><span class="nv">$1</span><span class="sh">:</span><span class="nv">$PATH</span><span class="sh">" ;; # Prepend
        esac
    fi
}
_add_to_path_if_missing "</span><span class="nv">$HOME</span><span class="sh">/.local/bin"
_add_to_path_if_missing "</span><span class="nv">$HOME</span><span class="sh">/.cargo/bin" # Rustup typically handles this via .profile modification too
unset _add_to_path_if_missing
export PATH
</span><span class="no">EOF
</span></code></section></div></div>

<ul>
  <li><strong>What:</strong> Configures Bash to source <code class="language-plaintext highlighter-rouge">~/.bashrc</code> upon login.</li>
  <li><strong>Why:</strong> Makes your aliases, PATH settings, and other <code class="language-plaintext highlighter-rouge">.bashrc</code> configurations available immediately after logging in.</li>
  <li><strong>Verification (later, after full setup):</strong> <code class="language-plaintext highlighter-rouge">bash --login -ic 'type ll'</code> should show that <code class="language-plaintext highlighter-rouge">ll</code> is an alias.</li>
</ul>
  <h3 id="25-configure-bashrc">
    
    
     <a href="#25-configure-bashrc">#</a><a href="#" aria-label="Back to top">2.5. Configure <code class="language-plaintext highlighter-rouge">~/.bashrc</code></a>
        
    
  </h3>
      

<p>Create or replace <code class="language-plaintext highlighter-rouge">~/.bashrc</code> with your provided configuration.
<strong>Important:</strong> Review the aliases section and replace placeholders.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="sh">'</span><span class="no">EOF</span><span class="sh">' &gt; "</span><span class="nv">$HOME</span><span class="sh">/.bashrc"
# 1. Exit if not interactive
case "</span><span class="nv">$-</span><span class="sh">" in *i*) ;; *) return;; esac

# 2. History
HISTCONTROL=ignoreboth # space-prefixed commands and duplicates are not saved
shopt -s histappend # Append to history file, don't overwrite
HISTSIZE=5000 # Number of commands to keep in memory
HISTFILESIZE=10000 # Number of commands to keep in the history file
# Save history after each command and reload it to make it available across terminals.
# `history -a` appends the current session's history to HISTFILE.
# `PROMPT_COMMAND="history -a; </span><span class="k">${</span><span class="nv">PROMPT_COMMAND</span><span class="k">}</span><span class="sh">"` ensures this happens before each prompt.
# Rely on histappend for merging on shell exit.
PROMPT_COMMAND="history -a; </span><span class="k">${</span><span class="nv">PROMPT_COMMAND</span><span class="k">}</span><span class="sh">"

# 3. XDG directories
export XDG_CONFIG_HOME="</span><span class="k">${</span><span class="nv">XDG_CONFIG_HOME</span><span class="k">:-</span><span class="nv">$HOME</span><span class="p">/.config</span><span class="k">}</span><span class="sh">"
export XDG_CACHE_HOME="</span><span class="k">${</span><span class="nv">XDG_CACHE_HOME</span><span class="k">:-</span><span class="nv">$HOME</span><span class="p">/.cache</span><span class="k">}</span><span class="sh">"
export XDG_DATA_HOME="</span><span class="k">${</span><span class="nv">XDG_DATA_HOME</span><span class="k">:-</span><span class="nv">$HOME</span><span class="p">/.local/share</span><span class="k">}</span><span class="sh">"

# Ensure critical XDG directories exist
mkdir -p "</span><span class="nv">$XDG_CONFIG_HOME</span><span class="sh">" "</span><span class="nv">$XDG_CACHE_HOME</span><span class="sh">" "</span><span class="nv">$XDG_DATA_HOME</span><span class="sh">"

# Append Flatpak XDG data dirs to the system default XDG_DATA_DIRS
_FLATPAK_USER_DATA_DIR="</span><span class="nv">$XDG_DATA_HOME</span><span class="sh">/flatpak/exports/share"
_FLATPAK_SYSTEM_DATA_DIR="/var/lib/flatpak/exports/share"
_SYSTEM_XDG_DATA_DIRS="</span><span class="k">${</span><span class="nv">XDG_DATA_DIRS</span><span class="k">:-</span><span class="p">/usr/local/share/</span>:/usr/share/<span class="k">}</span><span class="sh">"

export XDG_DATA_DIRS="</span><span class="k">${</span><span class="nv">_FLATPAK_USER_DATA_DIR</span><span class="k">}</span><span class="sh">:</span><span class="k">${</span><span class="nv">_FLATPAK_SYSTEM_DATA_DIR</span><span class="k">}</span><span class="sh">:</span><span class="k">${</span><span class="nv">_SYSTEM_XDG_DATA_DIRS</span><span class="k">}</span><span class="sh">"
# Clean up temporary variables
unset _FLATPAK_USER_DATA_DIR _FLATPAK_SYSTEM_DATA_DIR _SYSTEM_XDG_DATA_DIRS

# XDG_RUNTIME_DIR is critical and typically set by pam_systemd.
# If it's not set, it indicates a problem with the system's session management (e.g., pam_systemd).
# Do not attempt to set it manually to a /tmp path here as it can cause issues.
if [ -z "</span><span class="nv">$XDG_RUNTIME_DIR</span><span class="sh">" ]; then
    # Log an error or warning if preferred, but avoid setting a non-standard fallback
    # echo "Warning: XDG_RUNTIME_DIR is not set. User services may not function correctly." &gt;&amp;2
    : # No action, rely on system setup
else
    export XDG_RUNTIME_DIR # Ensure it's exported if set by pam_systemd
fi


# 4. PATH updates
export GOPATH="</span><span class="nv">$HOME</span><span class="sh">/go"

_add_to_path_if_missing() {
    local dir_to_add="</span><span class="nv">$1</span><span class="sh">"
    local prepend="</span><span class="nv">$2</span><span class="sh">" # "prepend" or "append"
    if [ -d "</span><span class="nv">$dir_to_add</span><span class="sh">" ]; then
        case ":</span><span class="nv">$PATH</span><span class="sh">:" in
            *":</span><span class="nv">$dir_to_add</span><span class="sh">:"*) :;; # Already in PATH
            *) if [ "</span><span class="nv">$prepend</span><span class="sh">" = "prepend" ]; then
                   PATH="</span><span class="nv">$dir_to_add</span><span class="sh">:</span><span class="nv">$PATH</span><span class="sh">" # Prepend for higher priority
               else
                   PATH="</span><span class="nv">$PATH</span><span class="sh">:</span><span class="nv">$dir_to_add</span><span class="sh">" # Append
               fi
               ;;
        esac
    fi
}

_add_to_path_if_missing "/usr/local/go/bin" "prepend" # Go system binaries
_add_to_path_if_missing "</span><span class="nv">$GOPATH</span><span class="sh">/bin" "prepend" # User-installed Go binaries
_add_to_path_if_missing "</span><span class="nv">$HOME</span><span class="sh">/.local/bin" "prepend" # User-local pip installs, etc.
# Rust path is handled by sourcing .cargo/env, which also prepends.
unset _add_to_path_if_missing
export PATH


# 5. Rust environment
[ -f "</span><span class="nv">$HOME</span><span class="sh">/.cargo/env" ] &amp;&amp; source "</span><span class="nv">$HOME</span><span class="sh">/.cargo/env"

# 6. Bash completion
if ! shopt -oq posix; then
  if [ -f /usr/share/bash-completion/bash_completion ]; then
    source /usr/share/bash-completion/bash_completion
  elif [ -f /etc/bash_completion ]; then
    source /etc/bash_completion
  fi
fi

# 7. SSH agent: Prioritize systemd-user, then GNOME Keyring if in desktop session
# This logic determines which SSH_AUTH_SOCK to use.

# Path for the systemd user ssh-agent socket
_SYSTEMD_SSH_AGENT_SOCK="</span><span class="nv">$XDG_RUNTIME_DIR</span><span class="sh">/ssh-agent.sock"

if [ -n "</span><span class="nv">$XDG_RUNTIME_DIR</span><span class="sh">" ] &amp;&amp; [ -S "</span><span class="nv">$_SYSTEMD_SSH_AGENT_SOCK</span><span class="sh">" ]; then
  # systemd user agent socket exists, use it.
  export SSH_AUTH_SOCK="</span><span class="nv">$_SYSTEMD_SSH_AGENT_SOCK</span><span class="sh">"
elif [ -n "</span><span class="nv">$DESKTOP_SESSION</span><span class="sh">" ] &amp;&amp; command -v gnome-keyring-daemon &gt;/dev/null; then
  # No systemd user agent socket found (or XDG_RUNTIME_DIR not set),
  # but in a desktop session. Attempt to use/start GNOME Keyring.
  # GNOME Keyring might already be running via its own systemd user service or XDG autostart.
  # This eval will set SSH_AUTH_SOCK if gnome-keyring-daemon starts/is running and manages SSH.
  eval "</span><span class="si">$(</span>gnome-keyring-daemon <span class="nt">--start</span> <span class="nt">--components</span><span class="o">=</span>secrets,ssh<span class="si">)</span><span class="sh">"
  export SSH_AUTH_SOCK # Ensure it's exported from eval
fi
unset _SYSTEMD_SSH_AGENT_SOCK

# Attempt to add default SSH key (id_rsa) if an agent is running and has no keys.
if command -v ssh-add &gt;/dev/null; then
    if ! ssh-add -l &amp;&gt;/dev/null; then # Check if agent has ANY keys
        if [ -n "</span><span class="k">${</span><span class="nv">SSH_AUTH_SOCK</span><span class="k">}</span><span class="sh">" ] &amp;&amp; [ -S "</span><span class="k">${</span><span class="nv">SSH_AUTH_SOCK</span><span class="k">}</span><span class="sh">" ] &amp;&amp; [ -f "</span><span class="nv">$HOME</span><span class="sh">/.ssh/id_rsa" ]; then
            # Agent seems to be running (socket exists), but no keys listed. Add id_rsa.
            # Suppress errors (e.g., passphrase needed but no tty, or key already added by another mechanism).
            ssh-add "</span><span class="nv">$HOME</span><span class="sh">/.ssh/id_rsa" 2&gt;/dev/null || true
        fi
    fi
fi

# 9. Prompt
if [[ "</span><span class="k">${</span><span class="nv">EUID</span><span class="k">}</span><span class="sh">" == "0" ]]; then # Root prompt
  PS1='</span><span class="se">\[\0</span><span class="sh">33[01;31m</span><span class="se">\]\h\[\0</span><span class="sh">33[01;34m</span><span class="se">\]</span><span class="sh"> </span><span class="se">\W</span><span class="sh"> </span><span class="se">\$\[\0</span><span class="sh">33[00m</span><span class="se">\]</span><span class="sh"> '
else # User prompt
  PS1='</span><span class="se">\[\0</span><span class="sh">33[01;32m</span><span class="se">\]\u</span><span class="sh">@</span><span class="se">\h\[\0</span><span class="sh">33[00m</span><span class="se">\]</span><span class="sh">:</span><span class="se">\[\0</span><span class="sh">33[01;34m</span><span class="se">\]\w\[\0</span><span class="sh">33[00m</span><span class="se">\]\$</span><span class="sh"> '
fi

# 10. Aliases (!!! REVIEW AND REPLACE PLACEHOLDERS !!!)
alias ls='ls --color=auto -hF' # Added -h for human-readable sizes, -F for type indicators
alias ll='ls -alFh' # Added -h
alias la='ls -Ah' # Added -h
alias l='ls -CFh' # Added -h

alias grep='grep --color=auto'
alias egrep='egrep --color=auto'
alias fgrep='fgrep --color=auto'

# Example ping alias (uses default system ping)
alias p='ping -c 4 example.com' # Pings example.com 4 times

# Swaks alias for email testing
# !!! REPLACE with your actual email, app password, and possibly SMTP server !!!
# For Gmail, you'll need an "App Password". See Google's help documentation.
# alias Z='swaks -4 -tls -f you@gmail.com -t recipient@example.com -s smtp.gmail.com:587 -au you@gmail.com -ap YOUR_GMAIL_APP_PASSWORD -d'
alias Z='echo "Swaks alias Z not configured. Edit ~/.bashrc with your email details and an App Password for services like Gmail."'

# Git project aliases
# !!! REPLACE 'REPO' with your actual repository directory name if different !!!
# And ensure ~/projects/REPO is a git repository.
PROJECTS_DIR="</span><span class="nv">$HOME</span><span class="sh">/projects"
# Example: alias project1-pull='(cd "</span><span class="nv">$PROJECTS_DIR</span><span class="sh">/my-actual-project" &amp;&amp; git pull) || echo "Failed to cd or pull in </span><span class="nv">$PROJECTS_DIR</span><span class="sh">/my-actual-project"'
alias pullrepo='(cd "</span><span class="nv">$PROJECTS_DIR</span><span class="sh">/REPO" &amp;&amp; git pull) || echo "Failed to cd to </span><span class="nv">$PROJECTS_DIR</span><span class="sh">/REPO or pull"'
alias pushrepo='(cd "</span><span class="nv">$PROJECTS_DIR</span><span class="sh">/REPO" &amp;&amp; git push) || echo "Failed to cd to </span><span class="nv">$PROJECTS_DIR</span><span class="sh">/REPO or push"'

# Update system
alias update='sudo apt update &amp;&amp; sudo apt full-upgrade -y &amp;&amp; sudo apt autoremove -y &amp;&amp; sudo apt clean &amp;&amp; echo "System update process completed."'

# Check for listening ports
alias listports='sudo ss -tulnp'
</span><span class="no">EOF
</span></code></section></div></div>

<p><strong>Key points about this revised <code class="language-plaintext highlighter-rouge">.bashrc</code>:</strong></p>

<ul>
  <li><strong>Placeholders in Aliases:</strong> Critical for <code class="language-plaintext highlighter-rouge">Z</code> (swaks) and <code class="language-plaintext highlighter-rouge">pullrepo</code>/<code class="language-plaintext highlighter-rouge">pushrepo</code>.</li>
  <li><strong>History:</strong> Uses <code class="language-plaintext highlighter-rouge">PROMPT_COMMAND="history -a; ${PROMPT_COMMAND}"</code> for immediate availability of commands in other terminals, with <code class="language-plaintext highlighter-rouge">shopt -s histappend</code> for merging on exit.</li>
  <li><strong>XDG Directories:</strong> Uses standard defaults if variables are unset. Avoids risky <code class="language-plaintext highlighter-rouge">XDG_RUNTIME_DIR</code> fallback.</li>
  <li><strong>PATH Management:</strong> Robustly adds paths, prepending for priority.</li>
  <li><strong>SSH Agent Logic:</strong> Clearly prioritizes the <code class="language-plaintext highlighter-rouge">systemd-user</code> agent. If its socket <code class="language-plaintext highlighter-rouge">$XDG_RUNTIME_DIR/ssh-agent.sock</code> exists, it’s used. Otherwise, if in a <code class="language-plaintext highlighter-rouge">DESKTOP_SESSION</code>, it attempts to use/start <code class="language-plaintext highlighter-rouge">gnome-keyring-daemon</code>. Then, it tries to add <code class="language-plaintext highlighter-rouge">~/.ssh/id_rsa</code> if an agent is active but has no keys.</li>
  <li><strong>Prompt:</strong> Colored prompt, different for <code class="language-plaintext highlighter-rouge">root</code> and regular users.</li>
  <li><strong>Aliases:</strong> Minor improvements like <code class="language-plaintext highlighter-rouge">-h</code> for human-readable sizes in <code class="language-plaintext highlighter-rouge">ls</code>.</li>
</ul>

<p><strong>Apply <code class="language-plaintext highlighter-rouge">.bashrc</code> changes:</strong>
For the current terminal session, source it:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">source</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.bashrc"</span>
</code></section></div></div>
<p>New terminals will load it automatically.</p>
  <h3 id="26-configure-systemd-user-ssh-agent-service">
    
    
     <a href="#26-configure-systemd-user-ssh-agent-service">#</a><a href="#" aria-label="Back to top">2.6. Configure <code class="language-plaintext highlighter-rouge">systemd-user</code> SSH Agent Service</a>
        
    
  </h3>
      

<p>This creates a service that automatically starts <code class="language-plaintext highlighter-rouge">ssh-agent</code> for the <code class="language-plaintext highlighter-rouge">linaro</code> user upon login.</p>

<p>Create the service file <code class="language-plaintext highlighter-rouge">~/.config/systemd/user/ssh-agent.service</code>:
(Ensure <code class="language-plaintext highlighter-rouge">~/.config/systemd/user</code> exists and has <code class="language-plaintext highlighter-rouge">0700</code> permissions from step 2.1).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="sh">'</span><span class="no">EOF</span><span class="sh">' &gt; "</span><span class="nv">$HOME</span><span class="sh">/.config/systemd/user/ssh-agent.service"
[Unit]
Description=SSH Authentication Agent for User Session
# This service should start early if it's going to be used.
# .bashrc will connect to the socket if this service is running.
# It doesn't need to be a hard requirement for default.target if SSH isn't always used
# or if another agent (like GNOME Keyring) is preferred in some sessions.
Documentation=man:ssh-agent(1)
Before=default.target
# Requires XDG_RUNTIME_DIR to be available and the user session to be set up.
After=network.target systemd-user-sessions.service user@</span><span class="si">$(</span><span class="nb">id</span> <span class="nt">-u</span><span class="si">)</span><span class="sh">.service

[Service]
Type=forking
# The Environment variable defines the socket path for *this* ssh-agent instance.
# %t expands to the XDG_RUNTIME_DIR path (e.g., /run/user/1000).
Environment=SSH_AUTH_SOCK=%t/ssh-agent.sock
# ssh-agent with -a creates the socket and forks into the background.
ExecStart=/usr/bin/ssh-agent -a %t/ssh-agent.sock
# Restart=always # Optional: uncomment if you want it to try restarting on failure.

[Install]
WantedBy=default.target
</span><span class="no">EOF
</span></code></section></div></div>

<p>Enable and start the service:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code>systemctl <span class="nt">--user</span> daemon-reload
systemctl <span class="nt">--user</span> <span class="nb">enable </span>ssh-agent.service
systemctl <span class="nt">--user</span> start ssh-agent.service <span class="c"># Or restart if it was already running: systemctl --user restart ssh-agent.service</span>
</code></section></div></div>

<ul>
  <li><strong>What:</strong> <code class="language-plaintext highlighter-rouge">ssh-agent.service</code> defines how <code class="language-plaintext highlighter-rouge">systemd</code> manages <code class="language-plaintext highlighter-rouge">ssh-agent</code> for user <code class="language-plaintext highlighter-rouge">linaro</code>.</li>
  <li><strong>Why:</strong> Provides a reliable, auto-starting SSH agent managed by <code class="language-plaintext highlighter-rouge">systemd</code>, independent of graphical sessions (unless GNOME Keyring takes precedence as configured in <code class="language-plaintext highlighter-rouge">.bashrc</code>).</li>
  <li><strong>Verification (after starting):</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code>  systemctl <span class="nt">--user</span> status ssh-agent.service
  <span class="c"># Look for "active (running)"</span>

  <span class="nb">ls</span> <span class="nt">-al</span> <span class="s2">"</span><span class="nv">$XDG_RUNTIME_DIR</span><span class="s2">/ssh-agent.sock"</span>
  <span class="c"># Should show the socket file, e.g., srw------- 1 linaro linaro 0 May  8 12:34 /run/user/1000/ssh-agent.sock</span>

  ssh-add <span class="nt">-l</span>
  <span class="c"># If the .bashrc logic has run and added the key:</span>
  <span class="c"># Should list your ~/.ssh/id_rsa key or state "The agent has no identities." if .bashrc hasn't run yet in a new shell</span>
  <span class="c"># or if the key requires a passphrase that hasn't been entered.</span>
</code></section></div>    </div>
  </li>
</ul><hr />
  <h2 id="part-3-verification-checklist">
    
    
     <a href="#part-3-verification-checklist">#</a><a href="#" aria-label="Back to top">Part 3: Verification Checklist</a>
        
    
  </h2>
      

<p>After completing all steps, and ideally after logging out and logging back in (or rebooting) to ensure all services and profile scripts are loaded correctly:</p>

<ol>
  <li><strong>Go Version:</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code>go version
</code></section></div>    </div>
    <ul>
      <li>Expected: <code class="language-plaintext highlighter-rouge">go version goX.Y.Z linux/amd64</code> (your chosen version).</li>
    </ul>
  </li>
  <li><strong>Rust Version:</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code>rustc <span class="nt">--version</span>
cargo <span class="nt">--version</span>
</code></section></div>    </div>
    <ul>
      <li>Expected: Shows versions like <code class="language-plaintext highlighter-rouge">rustc x.y.z ...</code> and <code class="language-plaintext highlighter-rouge">cargo x.y.z ...</code>.</li>
    </ul>
  </li>
  <li><strong>Bash Login Shell &amp; <code class="language-plaintext highlighter-rouge">.bashrc</code> Sourcing:</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code>bash <span class="nt">--login</span> <span class="nt">-ic</span> <span class="s1">'type ll &amp;&amp; echo SSH_AUTH_SOCK is $SSH_AUTH_SOCK'</span>
</code></section></div>    </div>
    <ul>
      <li>Expected:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">ll is an alias for ls -alFh</code></li>
          <li><code class="language-plaintext highlighter-rouge">SSH_AUTH_SOCK is /run/user/$(id -u linaro)/ssh-agent.sock</code> (or a GNOME Keyring path if in a desktop session and it took over).</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>SSH Agent Status:</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code>ssh-add <span class="nt">-l</span>
</code></section></div>    </div>
    <ul>
      <li>Expected: Lists your <code class="language-plaintext highlighter-rouge">~/.ssh/id_rsa</code> key (e.g., <code class="language-plaintext highlighter-rouge">4096 SHA256:... linaro@hostname (RSA)</code>).</li>
      <li>If it says “The agent has no identities.” try opening a new terminal. If your key has a passphrase, the <code class="language-plaintext highlighter-rouge">ssh-add</code> in <code class="language-plaintext highlighter-rouge">.bashrc</code> (if the terminal is interactive and TTY is available) or the first attempt to use the key (e.g., <code class="language-plaintext highlighter-rouge">ssh somehost</code>) should prompt for it. Once entered, the agent remembers it for the session (or longer if integrated with GNOME Keyring and configured to do so).</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">XDG_RUNTIME_DIR</code>:</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$XDG_RUNTIME_DIR</span><span class="s2">"</span>
<span class="nb">stat</span> <span class="nt">-c</span> <span class="s2">"Permissions: %a, Path: %n"</span> <span class="s2">"</span><span class="nv">$XDG_RUNTIME_DIR</span><span class="s2">"</span>
</code></section></div>    </div>
    <ul>
      <li>Expected: A path like <code class="language-plaintext highlighter-rouge">/run/user/1000</code> (where 1000 is <code class="language-plaintext highlighter-rouge">linaro</code>’s UID). Permissions should be <code class="language-plaintext highlighter-rouge">700</code> (drwx——). If empty or permissions are wrong, <code class="language-plaintext highlighter-rouge">systemd-user</code> services and other applications might fail. This is normally set up by <code class="language-plaintext highlighter-rouge">pam_systemd</code>.</li>
    </ul>
  </li>
  <li><strong>Aliases:</strong>
Test your aliases:
    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code>ll <span class="c"># Should list files with details</span>
p <span class="c"># Should attempt to ping example.com</span>
<span class="c"># Z # Test after configuring with your email details</span>
<span class="c"># pullrepo # Test after setting up ~/projects/REPO</span>
</code></section></div>    </div>
  </li>
</ol><hr />
  <h2 id="part-4-understanding-key-features-and-use-cases">
    
    
     <a href="#part-4-understanding-key-features-and-use-cases">#</a><a href="#" aria-label="Back to top">Part 4: Understanding Key Features and Use Cases</a>
        
    
  </h2>
      

<ul>
  <li><strong>SSH Agent (systemd-user vs. GNOME Keyring):</strong>
    <ul>
      <li>Your setup prioritizes the <code class="language-plaintext highlighter-rouge">systemd-user ssh-agent.service</code>. The socket for this is <code class="language-plaintext highlighter-rouge">$XDG_RUNTIME_DIR/ssh-agent.sock</code>.</li>
      <li>If this systemd agent socket isn’t found AND you log into a desktop environment (where <code class="language-plaintext highlighter-rouge">DESKTOP_SESSION</code> is set), the <code class="language-plaintext highlighter-rouge">.bashrc</code> allows <code class="language-plaintext highlighter-rouge">gnome-keyring-daemon</code> to be used for SSH agent functions. GNOME Keyring is often auto-started by the desktop environment (e.g., via its own systemd user service or XDG autostart) and can integrate well with desktop login, potentially unlocking your SSH key automatically.</li>
      <li>The <code class="language-plaintext highlighter-rouge">ssh-add ~/.ssh/id_rsa</code> line in <code class="language-plaintext highlighter-rouge">.bashrc</code> attempts to add your default private key to whichever agent’s <code class="language-plaintext highlighter-rouge">SSH_AUTH_SOCK</code> is currently active.</li>
    </ul>
  </li>
  <li><strong>Passwordless SSH Login:</strong>
    <ol>
      <li>Generate your key pair (<code class="language-plaintext highlighter-rouge">ssh-keygen</code> - done).</li>
      <li>Ensure <code class="language-plaintext highlighter-rouge">ssh-agent</code> is running and has your key added (<code class="language-plaintext highlighter-rouge">ssh-add -l</code> to check - handled by <code class="language-plaintext highlighter-rouge">.bashrc</code> and systemd service).</li>
      <li>Copy your public key to the remote server: <code class="language-plaintext highlighter-rouge">ssh-copy-id user@remote_host</code>.</li>
      <li>Now <code class="language-plaintext highlighter-rouge">ssh user@remote_host</code> should log you in without a password (it uses the key from the agent). If your key has a passphrase, the agent will prompt for it once per session (or as configured) and then remember it.</li>
    </ol>
  </li>
  <li><strong>Git over SSH:</strong>
    <ul>
      <li>Once your SSH agent is working with your key, Git operations (clone, pull, push) with SSH URLs (e.g., <code class="language-plaintext highlighter-rouge">git@github.com:user/repo.git</code>) will automatically use the keys from the agent.</li>
    </ul>
  </li>
  <li><strong>Agent Forwarding:</strong>
    <ul>
      <li>Allows using your local SSH keys on a remote server to connect to another subsequent server, without your private key ever leaving your local machine.</li>
      <li>To use: <code class="language-plaintext highlighter-rouge">ssh -A user@intermediate_host</code>. From <code class="language-plaintext highlighter-rouge">intermediate_host</code>, you can then <code class="language-plaintext highlighter-rouge">ssh further_host</code>.</li>
      <li><strong>Security Note:</strong> Only use agent forwarding (<code class="language-plaintext highlighter-rouge">-A</code> or <code class="language-plaintext highlighter-rouge">ForwardAgent yes</code>) with trusted intermediate hosts.</li>
      <li>Configure per-host in <code class="language-plaintext highlighter-rouge">~/.ssh/config</code>:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><section><code>  Host my_intermediate_server
    HostName server.example.com
    User your_user
    ForwardAgent yes
</code></section></div>        </div>
      </li>
    </ul>
  </li>
  <li><strong>Hardware Tokens (e.g., YubiKey for SSH):</strong>
    <ul>
      <li>GNOME Keyring might offer some integration for PKCS#11 devices if supported by your desktop environment.</li>
      <li>For direct control, typically packages like <code class="language-plaintext highlighter-rouge">opensc-pkcs11</code> are installed, and the SSH client is configured to use the hardware token via its PKCS#11 library (e.g., by setting <code class="language-plaintext highlighter-rouge">PKCS11Provider</code> in <code class="language-plaintext highlighter-rouge">~/.ssh/config</code> or using <code class="language-plaintext highlighter-rouge">ssh -I /path/to/lib.so</code>). This is an advanced setup.</li>
    </ul>
  </li>
  <li><strong>Flatpak Integration (<code class="language-plaintext highlighter-rouge">XDG_DATA_DIRS</code>):</strong>
    <ul>
      <li>Adding Flatpak’s <code class="language-plaintext highlighter-rouge">exports/share</code> directories to <code class="language-plaintext highlighter-rouge">XDG_DATA_DIRS</code> helps your shell and desktop environment discover application metadata (like <code class="language-plaintext highlighter-rouge">.desktop</code> files) for Flatpak applications.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">swaks</code> Alias (<code class="language-plaintext highlighter-rouge">Z</code>):</strong>
    <ul>
      <li>This alias is a template for sending test emails. You <strong>must</strong> configure it with your sender email, recipient, SMTP server details, and an <strong>App Password</strong> if using services like Gmail with 2-Step Verification.</li>
    </ul>
  </li>
</ul>

        </div>
        
          URL: https://ib.bsb.br/bashrc
        
      </article>
      <nav class="post-navigation-combined" aria-label="Post navigation">
        <!-- Chronological Navigation (always visible at 40vh) -->
        
          <div class="nav-arrow chronological prev">
            <a href="/reassess/" title="reassess" rel="prev">
              <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAxVJREFUaEPt18FqG1cUBuD/nLkzI42UiVInkFLTCAKhS+9KA+3Kq1L8AAHjhR7AKz+ADV55qUfoqhvThTfdmC4KzTKmYJrELshJW9PIlSeKRpqZe88pUtouihvVRknqMNoMzD1zdPXNrzMM4RJ+6BLuGeWm39RdK6VL6VcIlPEo41HG401loJQupS8mUM7pi7md/6p3UtoHUJzf4vVecZb0e0EQfB7H8b0kSeqqummt/eb1buN83SebNsZ8QkQCYHVpaenu/v7+ra2tLRwdHWF1ddWq6hfM3BCRE2b+FcBHACQAHo1E5v9c+5mIhkR0e3z0VQ8LotuqWlXVw/GRmT8QkdMK89McuAOAAfwoIu8z85yIHBPRKRGN1/IAeDx0rul53hivo6psrf2ejDGfEtFOu92u7O3tBWtra2i322g0GhgOh9je3ka325UPax7fCR0iw+lp4aLxr70aeOmgkChTRY3JGSb73EroERD73uB54WpOgdhwZkXNQNQLiVDzOU1yFymAhu+lqZVopIqISQKmPLFS+atHv3A1q8AVQ+lXP/VHRPQx+b6frKysxMvLy1hfX0ez2USv18PCwgLiOEaSJKhWq/jhwQN8dnIfVOS4dsWHqCJ5YREGjBuNEMfd0eTc9WshBqnFYGhRqxrUIoNuLwMT4eb1Cp6dZshywdW6mZzr9QsEPuPmXIhfno3gnGKuEWCUC14MLKoVb1L72+8Zvj3JOl/udZt/S7darUqn0wlarRZ2d3cxPz+PJ8dPsPP1Doq8kIbL+cawjxBIM8MRFAidpBlRpIbhFc55gM2NF5IIQtVBRlRTZgTWZQ4wzvc8spO1NPM4Gr9Wh1bSDIjU98C5E0PIC8OVSX+Rlz08hl+4/LsML6X/menFxcW7BwcHtzY2NvDw8CE21zf/NdMAHskFMs3MT/EfMg3gsTsr02f8byfTo16v3+v3+//f6fGKgXNp5vT5huZbqH4nH+NvwXH6V5bS041mU1FKz8ZxepdSerrRbCpK6dk4Tu9SSk83mk1FKT0bx+ldSunpRrOpuJTSfwBcuImxpyA7XgAAAABJRU5ErkJggg==" alt="Previous article" width="45" height="45" loading="lazy">
            </a>
          </div>
        
        
          <div class="nav-arrow chronological next">
            <a href="/dpkg-sources/" title="/etc/apt/sources.list + deb pkgs" rel="next">
              <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAwdJREFUaEPtl01rG1cUht9z7p070ijKWLVS3I9YULtNMBRn2UIXxZtuvCjedNWfoKVXBvsHeOUfoIUx5AeY0pVXXSR052UxBJSi0kDiRplII83HvadI9CMtOFjCmBjubC7cc8+Zc555eYdLuIEP3cCe4Zu+rq/mSXvSbyHg5eHl4eVxXRrwpD3p+Qh4n56P2+xZnvTszC7MCAAUF0XfOdJa62+IaCeO40GSJA/zPP8RwB9vDjBtWmv9JRE5ImpZawdVpbo58CkAIyJnIrLAzEvOuXNm/h3AfQDOAGdj5z5m5gXn3G9ENCKilckaiDwpiFZEpCoiTyYrM3/knOtXmHs58BkABvCLc+4DZl6cxIjoh4ODA728vIzt7W2sra09PT4+fgTgQES4LMvHZIy5LyI/f/dJvfK6FKMJqAdqmBS2ZgWINY9zJyZ1whUiRJrTfmGjybSxUemwcFEmghqT1UxlUrpQEXD7jRq3NWelEz10okIi1AJOX+U2EgALgUrT0kVnmcKvQ+uazSZvbW2hWq2i3++j3W5jf38f6+vrebvdHovI5pT09+vN7teLYev990K8GpQYjS1u1TQqhnHez6EU4cM7FTw7z5AXDo16ACcyPRsaxp2FEM9ejKd7zUaIYVpiOCpRq2rUIo0XLzMwEZaaFTzvZ8hyh/iWnu69fF1AAoOfFr/A5w8eYDQaIY5jJEmC09NTNBoNdLtd7O3t4ejoCIeHh8k/pL8KUSkCZcg6hCLDjLk2ufYGpRuXAuOMYiosQiDNNEcQILQuzYgi0QxVWKuAMtcqJPdXDaKaMMOUNrOAtoFSVE5jaaY4mtQPS5dmQPS8WkdfGReYgDe/3cTdpbvo9XrY2NhAp9NBq9XKO53Ov6T/r2mlVBeX0DSAMzeHppm5h7doemdvR99buYfd3V2srq4+PTk5+a+mr9CmrqTU3+5Rr9cHg8HgYve4krddbZGb5dOXmf2d+7n4pi9D4LrOeHl40v42fl0a8KQ96fkIeJ+ej9vsWZ707Mzmy/Ck5+M2e9afhmuAz1BhwewAAAAASUVORK5CYII=" alt="Next article" width="45" height="45" loading="lazy">
            </a>
          </div>
        
            
            
              
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  
                  
              
              
              
              <!-- Navigation block for tag "linux>dotfile"; default display for the first tag -->
              <div class="nav-group tags" id="tag-nav-linux-dotfile" style="display: block;">
                <div class="nav-arrow tags prev">
                  
                    <a href="/dpkg-sources/" title="/etc/apt/sources.list + deb pkgs" rel="prev">
                      <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAxVJREFUaEPt18FqG1cUBuD/nLkzI42UiVInkFLTCAKhS+9KA+3Kq1L8AAHjhR7AKz+ADV55qUfoqhvThTfdmC4KzTKmYJrELshJW9PIlSeKRpqZe88pUtouihvVRknqMNoMzD1zdPXNrzMM4RJ+6BLuGeWm39RdK6VL6VcIlPEo41HG401loJQupS8mUM7pi7md/6p3UtoHUJzf4vVecZb0e0EQfB7H8b0kSeqqummt/eb1buN83SebNsZ8QkQCYHVpaenu/v7+ra2tLRwdHWF1ddWq6hfM3BCRE2b+FcBHACQAHo1E5v9c+5mIhkR0e3z0VQ8LotuqWlXVw/GRmT8QkdMK89McuAOAAfwoIu8z85yIHBPRKRGN1/IAeDx0rul53hivo6psrf2ejDGfEtFOu92u7O3tBWtra2i322g0GhgOh9je3ka325UPax7fCR0iw+lp4aLxr70aeOmgkChTRY3JGSb73EroERD73uB54WpOgdhwZkXNQNQLiVDzOU1yFymAhu+lqZVopIqISQKmPLFS+atHv3A1q8AVQ+lXP/VHRPQx+b6frKysxMvLy1hfX0ez2USv18PCwgLiOEaSJKhWq/jhwQN8dnIfVOS4dsWHqCJ5YREGjBuNEMfd0eTc9WshBqnFYGhRqxrUIoNuLwMT4eb1Cp6dZshywdW6mZzr9QsEPuPmXIhfno3gnGKuEWCUC14MLKoVb1L72+8Zvj3JOl/udZt/S7darUqn0wlarRZ2d3cxPz+PJ8dPsPP1Doq8kIbL+cawjxBIM8MRFAidpBlRpIbhFc55gM2NF5IIQtVBRlRTZgTWZQ4wzvc8spO1NPM4Gr9Wh1bSDIjU98C5E0PIC8OVSX+Rlz08hl+4/LsML6X/menFxcW7BwcHtzY2NvDw8CE21zf/NdMAHskFMs3MT/EfMg3gsTsr02f8byfTo16v3+v3+//f6fGKgXNp5vT5huZbqH4nH+NvwXH6V5bS041mU1FKz8ZxepdSerrRbCpK6dk4Tu9SSk83mk1FKT0bx+ldSunpRrOpuJTSfwBcuImxpyA7XgAAAABJRU5ErkJggg==" alt="Previous in Tag" width="45" height="45" loading="lazy">
                    </a>
                  
                </div>
                <div class="nav-arrow tags next">
                  
                    <a href="/ratpoisonrc/" title="ratpoisonrc dot files" rel="next">
                      <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAwdJREFUaEPtl01rG1cUht9z7p070ijKWLVS3I9YULtNMBRn2UIXxZtuvCjedNWfoKVXBvsHeOUfoIUx5AeY0pVXXSR052UxBJSi0kDiRplII83HvadI9CMtOFjCmBjubC7cc8+Zc555eYdLuIEP3cCe4Zu+rq/mSXvSbyHg5eHl4eVxXRrwpD3p+Qh4n56P2+xZnvTszC7MCAAUF0XfOdJa62+IaCeO40GSJA/zPP8RwB9vDjBtWmv9JRE5ImpZawdVpbo58CkAIyJnIrLAzEvOuXNm/h3AfQDOAGdj5z5m5gXn3G9ENCKilckaiDwpiFZEpCoiTyYrM3/knOtXmHs58BkABvCLc+4DZl6cxIjoh4ODA728vIzt7W2sra09PT4+fgTgQES4LMvHZIy5LyI/f/dJvfK6FKMJqAdqmBS2ZgWINY9zJyZ1whUiRJrTfmGjybSxUemwcFEmghqT1UxlUrpQEXD7jRq3NWelEz10okIi1AJOX+U2EgALgUrT0kVnmcKvQ+uazSZvbW2hWq2i3++j3W5jf38f6+vrebvdHovI5pT09+vN7teLYev990K8GpQYjS1u1TQqhnHez6EU4cM7FTw7z5AXDo16ACcyPRsaxp2FEM9ejKd7zUaIYVpiOCpRq2rUIo0XLzMwEZaaFTzvZ8hyh/iWnu69fF1AAoOfFr/A5w8eYDQaIY5jJEmC09NTNBoNdLtd7O3t4ejoCIeHh8k/pL8KUSkCZcg6hCLDjLk2ufYGpRuXAuOMYiosQiDNNEcQILQuzYgi0QxVWKuAMtcqJPdXDaKaMMOUNrOAtoFSVE5jaaY4mtQPS5dmQPS8WkdfGReYgDe/3cTdpbvo9XrY2NhAp9NBq9XKO53Ov6T/r2mlVBeX0DSAMzeHppm5h7doemdvR99buYfd3V2srq4+PTk5+a+mr9CmrqTU3+5Rr9cHg8HgYve4krddbZGb5dOXmf2d+7n4pi9D4LrOeHl40v42fl0a8KQ96fkIeJ+ej9vsWZ707Mzmy/Ck5+M2e9afhmuAz1BhwewAAAAASUVORK5CYII=" alt="Next in Tag" width="45" height="45" loading="lazy">
                    </a>
                  
                </div>
              </div>
            
          
          <!-- JavaScript to Toggle the Tag-based Navigation -->
          <script>
            document.addEventListener("DOMContentLoaded", function(){
              var tagLinks = document.querySelectorAll('.tag-option');
              tagLinks.forEach(function(link){
                link.addEventListener('click', function(event){
                  event.preventDefault();
                  // Remove "active" class from all tag options.
                  tagLinks.forEach(function(el){ el.classList.remove('active'); });
                  // Add active class to the clicked tag option.
                  this.classList.add('active');
                  // Hide all tag navigation blocks.
                  document.querySelectorAll('.nav-group.tags').forEach(function(block){
                    block.style.display = 'none';
                  });
                  // Show the navigation block corresponding to the selected tag.
                  var tagSlug = this.getAttribute('data-tag');
                  var target = document.getElementById('tag-nav-' + tagSlug);
                  if(target) {
                    target.style.display = 'block';
                  }
                });
              });
            });
          </script>
      </nav>
      
    </main>
    <footer id="bottom-of-page" class="site-footer">
      <div class="footer-content">
        <!-- Back to top link -->
        <a href="#" aria-label="Back to top" class="back2top-link">
          <span class="sronly">Back to top</span>
        </a>
    
        <!-- Liquid Time Calculation and Display -->
        
        
        
        <a href="https://ib.bsb.br/404" aria-label="404">
          2025-07-21 13:13:53
        </a>
        &#x23;
    
        <!-- Tag Selector -->
        <ul class="tag-selector">
          
            
            
              <li>
                <a href="#" class="tag-option active" data-tag="linux-dotfile">
                  linux>dotfile
                </a>
              </li>
            
          
        </ul>
        &hArr;
    
        <!-- GitHub Link -->
        <a href="https://github.com/ib-bsb-br/ib-bsb-br.github.io" aria-label="GitHub">
          &#8505;
        </a>
    
        <!-- Homepage Link -->
        <a href="/" aria-label="Homepage">
          infoBAG
        </a>
    
        <!-- Copy All Code Button -->
        <button id="copyAllButton" aria-label="Copy all code">
          &copy;
        </button>
      </div>
    </footer>
    <style>
      .back2top-link {
        display: inline-block;
        width: 32px;
        height: 32px;
        background: url("/assets/Rope_(Old).gif") center center no-repeat;
        background-size: contain;
        text-decoration: none;
        vertical-align: middle;
      }
      .sronly {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
    </style>
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Article",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://ib.bsb.br/bashrc/"
        },
        "headline": "/.bashrc",
        "description": "",
        "datePublished": "2024-04-14T00:00:00+00:00",
        "dateModified": "2025-06-16T19:26:05+00:00",
        "author": {
          "@type": "Person",
          "name": "Author"
        },
        "publisher": {
          "@type": "Organization",
          "name": "infoBAG"
          
        }
        
      }
    </script>
    <script src="/assets/js/prism.js" defer></script>
    <script src="/assets/js/copy-all-code.js"></script>
  </body>
</html>
