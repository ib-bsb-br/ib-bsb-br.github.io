---
tags: [tools]
layout: default
slug: regex
---
    <style>
      /* The result div now preserves line breaks and wraps long text */
      #result {
        white-space: pre-wrap;
        word-wrap: break-word;
        border: 1px solid #ddd;
        padding: 10px;
        background-color: #f8f9fa;
        text-align: left; /* To ensure text aligns correctly */
      }
      /* Optional: Highlight matched text */
      .matched-text {
        background-color: #ffff99;
      }
    </style>
    <div class="container mt-5">
      <div class="row">
        <!-- Input/Options Column -->
        <div class="col-md-6">
          <div class="form-group">
            <label for="sourceInput">Source Text:</label>
            <textarea class="form-control" id="sourceInput" rows="12" placeholder="Enter your text with line breaks here"></textarea>
          </div>
          <div class="form-group my-3">
            <label for="regexInput">Regular Expression:</label>
            <input
              type="text"
              class="form-control"
              id="regexInput"
              placeholder="e.g., (?<=^|\n)\s*#.*(?=\n|$)"
            />
          </div>
          <div class="form-group my-3">
            <label for="prependInput">Prepend Value:</label>
            <input
              type="text"
              class="form-control"
              id="prependInput"
              placeholder="Optional: Text to prepend"
            />
          </div>
          <div class="form-group my-3">
            <label for="appendInput">Append Value:</label>
            <input
              type="text"
              class="form-control"
              id="appendInput"
              placeholder="Optional: Text to append"
            />
          </div>
          <div class="form-group my-3">
            <label for="operationSelect">Select Operation:</label>
            <select class="form-control" id="operationSelect">
              <option value="prepend">Prepend</option>
              <option value="append">Append</option>
              <option value="replace">Replace</option>
              <option value="append-prepend">Append and Prepend</option>
            </select>
          </div>
          <div class="form-group my-3">
            <button class="btn btn-primary btn-block" id="findMatchButton">
              Find Match
            </button>
            <button class="btn btn-success btn-block" id="applyOperationButton">
              Apply Operation
            </button>
          </div>
        </div>

        <!-- Result Column -->
        <div class="col-md-6">
          <div class="text-center">
            <h2>Result:</h2>
            <button class="btn btn-secondary my-2" onclick="copyResultToClipboard()">
              Copy Result
            </button>
          </div>
          <!-- The #result container displays processed text while preserving line breaks -->
          <div id="result"></div>
        </div>
      </div>
    </div>

    <!-- JavaScript: Bootstrap and clipboard functionality -->
    <!-- jQuery and Bootstrap JS (optional, for Bootstrap functionality) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.min.js"></script>
    
    <script>
      // Utility function to encode HTML entities
      function encodeHTML(str) {
        var div = document.createElement("div");
        div.appendChild(document.createTextNode(str));
        return div.innerHTML;
      }

      document.addEventListener("DOMContentLoaded", function () {
        const findMatchButton = document.getElementById("findMatchButton");
        const applyOperationButton = document.getElementById("applyOperationButton");
        const resultDiv = document.getElementById("result");
        let processedText = ""; // Store the processed text with highlighted matches

        // Find and highlight matches based on the regex pattern provided
        findMatchButton.addEventListener("click", function () {
          const sourceText = document.getElementById("sourceInput").value;
          const regexPattern = document.getElementById("regexInput").value.trim();

          try {
            const regex = new RegExp(regexPattern, "g");
            // Wrap each match in a span for further processing/operations
            processedText = sourceText.replace(regex, function(match) {
              return `<span class="matched-text">${encodeHTML(match)}</span>`;
            });
            // Use innerHTML so that line breaks are rendered (CSS handles the formatting)
            resultDiv.innerHTML = processedText;
          } catch (error) {
            resultDiv.textContent = "Invalid Regular Expression";
          }
        });

        // Apply the chosen operation (prepend, append, replace, or both) on the matched segments
        applyOperationButton.addEventListener("click", function () {
          const operation = document.getElementById("operationSelect").value;
          const prependValue = document.getElementById("prependInput").value;
          const appendValue = document.getElementById("appendInput").value;

          if (processedText) {
            // Use a regex that matches the span-wrapped matches, handling multiline content (including newlines)
            processedText = processedText.replace(/<span class="matched-text">([\s\S]*?)<\/span>/g, function(match, group) {
              switch (operation) {
                case "prepend":
                  return `<span class="matched-text">${encodeHTML(prependValue + group)}</span>`;
                case "append":
                  return `<span class="matched-text">${encodeHTML(group + appendValue)}</span>`;
                case "replace":
                  return encodeHTML(appendValue);
                case "append-prepend":
                  return `<span class="matched-text">${encodeHTML(prependValue + group + appendValue)}</span>`;
                default:
                  return match;
              }
            });
            resultDiv.innerHTML = processedText;
          } else {
            resultDiv.textContent = "No matching text to apply the operation.";
          }
        });
      });

      // The copy function uses innerText to ensure that the line breaks are preserved when copying
      function copyResultToClipboard() {
        const resultDiv = document.getElementById("result");
        const tempTextArea = document.createElement("textarea");
        tempTextArea.value = resultDiv.innerText;
        document.body.appendChild(tempTextArea);
        tempTextArea.select();
        document.execCommand("copy");
        document.body.removeChild(tempTextArea);
        alert("Copied result to clipboard!");
      }
    </script>
    
```
This tool is a browser-based find and replace utility built with HTML, JavaScript, and Bootstrap that allows users to input source text, specify a regular expression (which is compiled with the “g” flag only), and define optional prepend and/or append strings, with a dropdown menu to select the intended operation (prepend, append, replace, or append-prepend). When the "Find Match" button is clicked, the tool uses the provided regex (constructed via JavaScript’s RegExp constructor with the global flag) to locate all matches in the source text and wraps each match in a <span> with the class "matched-text" for visual identification. Once matches are identified, clicking "Apply Operation" executes a replacement routine that processes these <span> elements based on the selected operation—either prepending, appending, or completely replacing the matched text—with proper HTML encoding to preserve markup. The tool is designed to work line‐by‐line (for example, using lookaround assertions like (?<=^|\n)\s*#.*(?=\n|$) to match lines starting with a hash, regardless of leading whitespace), and it provides an easy way to copy the final modified text from the result area, ensuring minimal friction when editing or debugging text using regular expressions.
```
