---
tags: [tools]
layout: default
slug: gh
---
bibref https://useful-forks.github.io/

<div class="container">
  <h2 class="text-center mb-4">GitHub Repository Sorter</h2>

  <!-- Input: GitHub username + Button -->
  <div class="row mb-4">
    <div class="col-md-9">
      <input
        type="text"
        id="usernameInput"
        placeholder="Enter GitHub Username (e.g., ib-bsb-br)"
        value="ib-bsb-br"
        class="form-control"
        aria-label="GitHub Username"
      />
    </div>
    <div class="col-md-3">
      <button
        id="fetchButton"
        class="btn btn-primary w-100"
      >
        <i class="bi bi-github"></i> Fetch Repos
      </button>
    </div>
  </div>

  <!-- Sorting dropdown (initially hidden) -->
  <div id="controls" class="mb-4 d-none">
    <label for="sortSelect" class="form-label">Sort by:</label>
    <select id="sortSelect" class="form-control">
      <option value="created_at_asc">Date Created (Oldest)</option>
      <option value="created_at">Date Created (Newest)</option>
      <option value="forks_count_asc">Forks (Least)</option>
      <option value="forks_count">Forks (Most)</option>
      <option value="language_desc">Language (Z-A)</option>
      <option value="language">Language (A-Z)</option>
      <option value="name_desc">Name (Z-A)</option>
      <option value="name">Name (A-Z)</option>
      <option value="open_issues_count_asc">Open Issues (Least)</option>
      <option value="open_issues_count">Open Issues (Most)</option>
      <option value="size_asc">Size (Smallest)</option>
      <option value="size">Size (Largest)</option>
      <option value="stargazers_count_asc">Stars (Least)</option>
      <option value="stargazers_count">Stars (Most)</option>
      <option value="updated_at_asc">Last Updated (Oldest)</option>
      <option value="updated_at">Last Updated (Newest)</option>
    </select>
  </div>

  <!-- Loading indicator -->
  <div id="loading" class="text-center py-4 d-none" aria-live="polite">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="text-muted">Loading repositories...</p>
  </div>

  <!-- Error alert -->
  <div
    id="error"
    class="alert alert-danger d-none"
    role="alert"
    aria-live="polite"
    aria-atomic="true"
  >
    <strong>Error:</strong>
    <span id="errorMessage"></span>
  </div>

  <!-- Repository list -->
  <div id="repoList" class="mt-4" aria-live="polite">
    <!-- Repos load here -->
  </div>
</div>

<script>
  const usernameInput = document.getElementById('usernameInput');
  const fetchButton = document.getElementById('fetchButton');
  const sortSelect = document.getElementById('sortSelect');
  const repoList = document.getElementById('repoList');
  const loading = document.getElementById('loading');
  const errorDiv = document.getElementById('error');
  const errorMessage = document.getElementById('errorMessage');
  const controlsDiv = document.getElementById('controls');

  let currentRepos = [];

  function showError(message) {
    errorMessage.textContent = message;
    errorDiv.classList.remove('d-none');
  }
  function hideError() {
    errorDiv.classList.add('d-none');
    errorMessage.textContent = '';
  }

  async function fetchRepos(username) {
    if (!username) {
      showError("Please enter a GitHub username.");
      return;
    }

    hideError();
    loading.classList.remove('d-none');
    repoList.innerHTML = '';
    controlsDiv.classList.add('d-none');

    try {
      const apiUrl = `https://api.github.com/users/${username}/repos?sort=updated&direction=desc&per_page=100`;
      const response = await fetch(apiUrl);

      if (!response.ok) {
        if (response.status === 404) {
          throw new Error(`User '${username}' not found.`);
        } else if (response.status === 403) {
          const rateLimitRemaining = response.headers.get('X-RateLimit-Remaining');
          const rateLimitReset = response.headers.get('X-RateLimit-Reset');
          let message = 'API rate limit exceeded. ';
          if (rateLimitRemaining === '0' && rateLimitReset) {
            const resetTime = new Date(rateLimitReset * 1000);
            const minutesToWait = Math.ceil((resetTime - new Date()) / 60000);
            message += `Please wait about ${minutesToWait} minute(s) and try again.`;
          } else {
            message += 'Please wait and try again later.';
          }
          throw new Error(message);
        }
        throw new Error(`Failed to fetch repositories (Status: ${response.status})`);
      }

      const repos = await response.json();
      currentRepos = repos;

      if (repos.length === 0) {
        repoList.textContent = 'This user has no public repositories.';
      } else {
        sortSelect.value = 'updated_at';
        sortAndDisplayRepos();
        controlsDiv.classList.remove('d-none');
      }
    } catch (err) {
      console.error("Fetch error:", err);
      showError(err.message);
      currentRepos = [];
    } finally {
      loading.classList.add('d-none');
    }
  }

  function sortRepos(repos, sortBy) {
    const getLang = (repo) => repo.language ? repo.language.toLowerCase() : 'zzzz';
    return [...repos].sort((a, b) => {
      switch (sortBy) {
        case 'name':
          return a.name.localeCompare(b.name);
        case 'name_desc':
          return b.name.localeCompare(a.name);
        case 'stargazers_count':
          return b.stargazers_count - a.stargazers_count;
        case 'stargazers_count_asc':
          return a.stargazers_count - b.stargazers_count;
        case 'updated_at':
          return new Date(b.updated_at) - new Date(a.updated_at);
        case 'updated_at_asc':
          return new Date(a.updated_at) - new Date(b.updated_at);
        case 'created_at':
          return new Date(b.created_at) - new Date(a.created_at);
        case 'created_at_asc':
          return new Date(a.created_at) - new Date(b.created_at);
        case 'language': {
          const langA = getLang(a);
          const langB = getLang(b);
          if (langA < langB) return -1;
          if (langA > langB) return 1;
          return a.name.localeCompare(b.name);
        }
        case 'language_desc': {
          const langADesc = getLang(a);
          const langBDesc = getLang(b);
          if (langADesc > langBDesc) return -1;
          if (langADesc < langBDesc) return 1;
          return a.name.localeCompare(b.name);
        }
        case 'forks_count':
          return b.forks_count - a.forks_count;
        case 'forks_count_asc':
          return a.forks_count - b.forks_count;
        case 'open_issues_count':
          return b.open_issues_count - a.open_issues_count;
        case 'open_issues_count_asc':
          return a.open_issues_count - b.open_issues_count;
        case 'size':
          return b.size - a.size;
        case 'size_asc':
          return a.size - b.size;
        default:
          return 0;
      }
    });
  }

  function sortAndDisplayRepos() {
    const sortBy = sortSelect.value;
    const sortedRepos = sortRepos(currentRepos, sortBy);
    displayRepos(sortedRepos);
  }

  function displayRepos(repos) {
    repoList.innerHTML = '';
    if (repos.length === 0) {
      if (currentRepos.length > 0) {
        repoList.textContent = 'No repositories match the current criteria.';
      } else if (!repoList.textContent) {
        repoList.textContent = 'No repository data available.';
      }
      return;
    }

    repos.forEach(repo => {
      const repoCard = document.createElement('div');
      repoCard.className = 'card mb-3';

      const updatedAt = new Date(repo.updated_at).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
      });
      const createdAt = new Date(repo.created_at).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
      });

      const description = repo.description || '<i class="text-muted">No description provided.</i>';
      const language = repo.language ? `<span class="badge bg-primary">${repo.language}</span>` : '';
      let sizeText = `${repo.size} KB`;
      if (repo.size > 1024) {
        sizeText = `${(repo.size / 1024).toFixed(1)} MB`;
      }

      repoCard.innerHTML = `
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start mb-2">
            <h5 class="card-title">
              <a href="${repo.html_url}" target="_blank" rel="noopener noreferrer">${repo.name}</a>
            </h5>
            <div class="d-flex gap-3 text-muted">
              <span title="Stars"><i class="bi bi-star-fill text-warning"></i> ${repo.stargazers_count}</span>
              <span title="Forks"><i class="bi bi-diagram-2"></i> ${repo.forks_count}</span>
              <span title="Open Issues"><i class="bi bi-exclamation-circle text-danger"></i> ${repo.open_issues_count}</span>
            </div>
          </div>
          <p class="card-text">${description}</p>
          <div class="d-flex justify-content-between align-items-center small text-muted">
            <div>
              ${language}
              <span class="ms-2" title="Repository Size">${sizeText}</span>
            </div>
            <div class="text-end">
              <div>Updated: ${updatedAt}</div>
              <div>Created: ${createdAt}</div>
            </div>
          </div>
        </div>
      `;
      repoList.appendChild(repoCard);
    });
  }

  fetchButton.addEventListener('click', () => {
    fetchRepos(usernameInput.value.trim());
  });

  usernameInput.addEventListener('keypress', (event) => {
    if (event.key === 'Enter') {
      fetchRepos(usernameInput.value.trim());
    }
  });

  sortSelect.addEventListener('change', sortAndDisplayRepos);

  document.addEventListener('DOMContentLoaded', () => {
    fetchRepos(usernameInput.value.trim());
    controlsDiv.classList.add('d-none');
  });
</script>
