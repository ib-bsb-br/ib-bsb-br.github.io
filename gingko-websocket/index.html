<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
      
        Gingko Python WebSocket script - infoBAG
      
    </title>
    <meta name="title" content="Gingko Python WebSocket script - infoBAG" />
    <meta name="description" content="">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://ib.bsb.br/gingko-websocket/">
    <meta property="og:title" content="Gingko Python WebSocket script - infoBAG">
    <meta property="og:description" content="">
    <meta property="og:image" content="/favicon.ico">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://ib.bsb.br/gingko-websocket/">
    <meta name="twitter:title" content="Gingko Python WebSocket script - infoBAG">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="/favicon.ico">
    <link rel="canonical" href="https://ib.bsb.br/gingko-websocket/">
    <link rel="alternate" type="application/rss+xml" title="infoBAG" href="https://ib.bsb.br/rss.xml">
    
      <meta name="keywords" content="scripts&gt;cloud,scratchpad">
      
        <meta property="article:tag" content="scripts&gt;cloud">
      
        <meta property="article:tag" content="scratchpad">
      
    
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    
    <link rel="stylesheet" href="/style.css">
  </head>
  <body class="post-content-body">
    <header class="header-container">
      <nav aria-label="Main navigation" class="header-content">
        <a href="/" aria-label="Home">
          <img src="/favicon.ico" alt="Home" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/tags" aria-label="Tags">
          <img src="/assets/Label.gif" alt="Tags" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/send" aria-label="send">
          <img src="/assets/rot.gif" alt="send" class="favicon search-link" width="32" height="32" loading="lazy">
        </a> 
        <a href="/created" aria-label="archive created">
          <img src="/assets/Loose_Stone_Pile.gif" alt="archive created" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/events" aria-label="Events">
          <img src="/assets/Paralyse_Rune.gif" alt="Events" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/modified" aria-label="archive modified">
          <img src="/assets/Hole_(Rock).gif" alt="archive modified" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
    </nav>
      <h5 class="post-title">
        <a href="#bottom-of-page" aria-label="Go to bottom">
          Gingko Python WebSocket script
        </a>
      </h5>
      <div class="post-meta">
        <time datetime="2024-11-03T00:00:00+00:00" class="post-date">
          03 Nov 2024
        </time>
        
          <span class="post-updated">
            ↣
            <time datetime="2025-10-05T01:50:24+00:00">
              05 Oct 2025
            </time>
          </span>
        
        
          <p class="post-slug">
            Slug: <a href="https://ib.bsb.br/gingko-websocket" class="tag">gingko-websocket</a>
          </p>
        
        
          <p class="post-tags">
            Tags:
            
              <a href="https://ib.bsb.br/tags/#scripts-cloud" class="tag">scripts>cloud</a>
            
              <a href="https://ib.bsb.br/tags/#scratchpad" class="tag">scratchpad</a>
            
          </p>
        
      </div>
      <div class="post-actions">
        <div class="page-stats mt-3" role="status" aria-label="Page statistics">
      
      <span class="badge bg-primary">
        17532 characters
      </span>
        <span class="separator mx-2" aria-hidden="true">•</span>
        <span class="badge bg-primary">
        1578 words
      </span>
      </div>
        <div class="action-buttons d-flex flex-wrap gap-2">
          
            
              <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/edit/main/_posts/2024-11-03-gingko-websocket.md"
                    method="GET"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="d-inline-block">
                <button type="submit" class="btn btn-danger" aria-label="Edit page content">
                  <span class="button-text">Improve this page?</span>
                  <span class="info-text">aberto.</span>
                </button>
              </form>
            
            <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/commits/main/_posts/2024-11-03-gingko-websocket.md"
                  method="GET"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="d-inline-block">
              <button type="submit" class="btn btn-danger" aria-label="View page revision history">
                View revision history
              </button>
            </form>
          
        </div>
      </div>
    </header>
    <main class="content">
      <article class="post-wrapper">
        <div class="post-content-body">
          

          <p><code class="language-plaintext highlighter-rouge">https://app.gingkowriter.com/database-download.html</code></p>

<p>A Python WebSocket client script was successfully developed to enable programmatic interaction with the Gingko Writer application. The project began with the goal of establishing a stable connection to <code class="language-plaintext highlighter-rouge">wss://app.gingkowriter.com/ws</code>, managing authentication through cookies, and handling various message types such as <code class="language-plaintext highlighter-rouge">'rt:join'</code>, <code class="language-plaintext highlighter-rouge">'trees'</code>, and <code class="language-plaintext highlighter-rouge">'user'</code>.  An initial script provided basic connection logic, logging, and message exchange capabilities.
The development process then encountered challenges related to using the established connection for specific tasks, like creating cards. This practical application focus required deeper investigation into message formatting, asynchronous handling of user input alongside incoming messages, and the implementation of a structured request mechanism.  The project required guidance on adding an interactive command interface, concurrent processing, improved logging, and robust error handling to ensure maintainability and extensibility.
A revised Python script was subsequently developed. This version incorporated credentials and authentication details from browser Developer Tools, ensuring proper formatting of the <code class="language-plaintext highlighter-rouge">'rt:join'</code> message with the correct <code class="language-plaintext highlighter-rouge">tr</code>, <code class="language-plaintext highlighter-rouge">uid</code>, and <code class="language-plaintext highlighter-rouge">m</code> parameters.  The script’s message handling was enhanced to process messages like <code class="language-plaintext highlighter-rouge">'rt:joinOk'</code> (join confirmation) and <code class="language-plaintext highlighter-rouge">'pushOk'</code> (push acknowledgment).  Securing credentials through environment variables and using valid, up-to-date system cookies was emphasized.
Initial testing revealed, via execution logs, that the <code class="language-plaintext highlighter-rouge">'rt:joinOk'</code> message was not being received, indicating a potential authentication problem.  Diagnostic steps and instructions for correctly extracting authentication details from Developer Tools were provided, prompting a script update.  This led to a successful connection and correct card creation within Gingko Writer, confirmed by subsequent logs showing push messages, <code class="language-plaintext highlighter-rouge">'pushOk'</code> acknowledgments, and seamless card hierarchy creation.
Throughout the project, issues with authentication parameter accuracy, session checkpoints, and real-time message exchange were addressed. Key milestones included accurate formatting of the <code class="language-plaintext highlighter-rouge">'rt:join'</code> message and correct interpretation of server acknowledgments. These achievements transformed the initial script into a functional tool for interacting with the Gingko Writer service.
The collaborative effort resulted in a robust Python WebSocket client capable of securely connecting to the Gingko Writer server and performing operations like creating structured card hierarchies. This was accomplished by meticulously resolving authentication problems, improving message handling, and ensuring adaptability through enhanced logging and error management. This foundation supports future extensions, such as adding interactive features or integrating more message types, increasing the script’s utility for programmatically managing Gingko Writer documents.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><section><code><span class="kn">import</span> <span class="n">asyncio</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">random</span>
<span class="kn">import</span> <span class="n">string</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="n">websockets</span>
<span class="kn">from</span> <span class="n">websockets.exceptions</span> <span class="kn">import</span> <span class="n">ConnectionClosedError</span><span class="p">,</span> <span class="n">WebSocketException</span>

<span class="c1"># Configure logging for detailed debugging
</span><span class="n">logging</span><span class="p">.</span><span class="nf">basicConfig</span><span class="p">(</span>
    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">DEBUG</span><span class="p">,</span>  <span class="c1"># Set to DEBUG for comprehensive logs
</span>    <span class="nb">format</span><span class="o">=</span><span class="sh">'</span><span class="s">%(asctime)s - %(levelname)s - %(message)s</span><span class="sh">'</span>
<span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">GingkoWebsocketClient</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">
    A client to interact with the Gingko Writer application via WebSocket.
    </span><span class="sh">"""</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cookies</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tree_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">auth_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Initializes the GingkoWebsocketClient with the necessary credentials and parameters.

        Args:
            url (str): The WebSocket URL for the Gingko Writer application.
            cookies (str): The authentication cookies.
            tree_id (str): The ID of the tree (document) to interact with.
            user_id (str): The user</span><span class="sh">'</span><span class="s">s Gingko Writer user ID.
            auth_token (str): The authentication token from the </span><span class="sh">'</span><span class="s">rt:join</span><span class="sh">'</span><span class="s"> message.
        </span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cookies</span> <span class="o">=</span> <span class="n">cookies</span>
        <span class="n">self</span><span class="p">.</span><span class="n">tree_id</span> <span class="o">=</span> <span class="n">tree_id</span>
        <span class="n">self</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">user_id</span>
        <span class="n">self</span><span class="p">.</span><span class="n">auth_token</span> <span class="o">=</span> <span class="n">auth_token</span>
        <span class="n">self</span><span class="p">.</span><span class="n">session_id</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">self</span><span class="p">.</span><span class="n">checkpoint</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">self</span><span class="p">.</span><span class="n">push_ok_event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nc">Event</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">ws</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">self</span><span class="p">.</span><span class="n">reconnect_attempts</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">self</span><span class="p">.</span><span class="n">max_reconnect_attempts</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">generate_timestamp</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s">
        Generates a unique timestamp for operations.

        Returns:
            str: A timestamp string in the format </span><span class="sh">'</span><span class="s">milliseconds:sequence:session_fragment</span><span class="sh">'</span><span class="s">
        </span><span class="sh">"""</span>
        <span class="n">millis</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">sequence</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
        <span class="n">session_fragment</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">choices</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>
        <span class="k">return</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">millis</span><span class="si">}</span><span class="s">:</span><span class="si">{</span><span class="n">sequence</span><span class="si">}</span><span class="s">:</span><span class="si">{</span><span class="n">session_fragment</span><span class="si">}</span><span class="sh">"</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">generate_card_id</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s">
        Generates a unique card ID.

        Returns:
            str: A 24-character alphanumeric string.
        </span><span class="sh">"""</span>
        <span class="k">return</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">choices</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">24</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">send_message</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">message_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Sends a formatted message over the WebSocket connection.

        Args:
            message_type (str): The type of the message (e.g., </span><span class="sh">'</span><span class="s">push</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">rt:join</span><span class="sh">'</span><span class="s">).
            data (dict): The message data payload.
        </span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">ws</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sh">"</span><span class="s">WebSocket connection is not established.</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">message</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">t</span><span class="sh">"</span><span class="p">:</span> <span class="n">message_type</span><span class="p">,</span> <span class="sh">"</span><span class="s">d</span><span class="sh">"</span><span class="p">:</span> <span class="n">data</span><span class="p">}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="n">ws</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Sent </span><span class="si">{</span><span class="n">message_type</span><span class="si">}</span><span class="s"> message: </span><span class="si">{</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Failed to send message </span><span class="sh">'</span><span class="si">{</span><span class="n">message_type</span><span class="si">}</span><span class="sh">'</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">handle_user_message</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Received user data: </span><span class="si">{</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">handle_trees_message</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">trees</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Received trees data: </span><span class="si">{</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">trees</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">tree_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">tree</span><span class="p">[</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">trees</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">tree_id</span> <span class="ow">in</span> <span class="n">tree_ids</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">session_id</span> <span class="o">=</span> <span class="sh">"</span><span class="s">SessionNotProvided</span><span class="sh">"</span>
            <span class="n">self</span><span class="p">.</span><span class="n">push_ok_event</span><span class="p">.</span><span class="nf">set</span><span class="p">()</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Tree </span><span class="sh">'</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">tree_id</span><span class="si">}</span><span class="sh">'</span><span class="s"> is available. Proceeding with operations.</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Tree </span><span class="sh">'</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">tree_id</span><span class="si">}</span><span class="sh">'</span><span class="s"> not found in your account.</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">handle_rt_users_message</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Received rt:users data: </span><span class="si">{</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">handle_push_ok_message</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">checkpoint_list</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">if</span> <span class="n">checkpoint_list</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">checkpoint</span> <span class="o">=</span> <span class="n">checkpoint_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Updated checkpoint to: </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">checkpoint</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">push_ok_event</span><span class="p">.</span><span class="nf">set</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sh">"</span><span class="s">Received pushOk without checkpoint data.</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">handle_rt_join_ok_message</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">session_id</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">sid</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">initial_checkpoint</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">chk</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">initial_checkpoint</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">checkpoint</span> <span class="o">=</span> <span class="n">initial_checkpoint</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Joined session: </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">session_id</span><span class="si">}</span><span class="s">, initial checkpoint: </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">checkpoint</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">push_ok_event</span><span class="p">.</span><span class="nf">set</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">handle_error_message</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Received error from server: </span><span class="si">{</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">handle_message</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">message_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Handles incoming messages from the WebSocket.

        Args:
            message_data (dict): The received message data.
        </span><span class="sh">"""</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Received message: </span><span class="si">{</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">message_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">message_type</span> <span class="o">=</span> <span class="n">message_data</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">t</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">message_data</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">d</span><span class="sh">"</span><span class="p">,</span> <span class="p">{})</span>

        <span class="n">handler</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">user</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">handle_user_message</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">trees</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">handle_trees_message</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">rt:users</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">handle_rt_users_message</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">pushOk</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">handle_push_ok_message</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">rt:joinOk</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">handle_rt_join_ok_message</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">handle_error_message</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">ping</span><span class="sh">"</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">send_message</span><span class="p">(</span><span class="sh">"</span><span class="s">pong</span><span class="sh">"</span><span class="p">,</span> <span class="p">{})</span>
        <span class="p">}.</span><span class="nf">get</span><span class="p">(</span><span class="n">message_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">handler</span><span class="p">:</span>
            <span class="k">await</span> <span class="nf">handler</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Unhandled message type: </span><span class="si">{</span><span class="n">message_type</span><span class="si">}</span><span class="s">, data: </span><span class="si">{</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">message_handler</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Continuously handles incoming messages from the WebSocket.
        </span><span class="sh">"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">ws</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">message_data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                    <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">handle_message</span><span class="p">(</span><span class="n">message_data</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">json</span><span class="p">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Failed to decode JSON message: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">except </span><span class="p">(</span><span class="n">ConnectionClosedError</span><span class="p">,</span> <span class="n">WebSocketException</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Connection closed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">reconnect</span><span class="p">()</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Unexpected error in message handler: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">reconnect</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_join_message</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s">
        Constructs the </span><span class="sh">'</span><span class="s">rt:join</span><span class="sh">'</span><span class="s"> message to join the Gingko session.

        Returns:
            dict: The </span><span class="sh">'</span><span class="s">rt:join</span><span class="sh">'</span><span class="s"> message data.
        </span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">tr</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">tree_id</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">uid</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">user_id</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">m</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">a</span><span class="sh">"</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">auth_token</span><span class="p">]</span>
        <span class="p">}</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_card</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parent_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s">
        Creates a new card in the Gingko tree.

        Args:
            content (str): The content of the card.
            parent_id (str, optional): The ID of the parent card. Defaults to None.
            position (int, optional): The position among siblings. Defaults to 0.

        Returns:
            str: The ID of the created card.
        </span><span class="sh">"""</span>
        <span class="n">card_id</span> <span class="o">=</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">generate_card_id</span><span class="p">()</span>
        <span class="n">insert_ts</span> <span class="o">=</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">generate_timestamp</span><span class="p">()</span>
        <span class="n">update_ts</span> <span class="o">=</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">generate_timestamp</span><span class="p">()</span>

        <span class="c1"># Insert operation
</span>        <span class="n">insert_delta</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">:</span> <span class="n">card_id</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">ts</span><span class="sh">"</span><span class="p">:</span> <span class="n">insert_ts</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">ops</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="sh">"</span><span class="s">t</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">i</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">c</span><span class="sh">"</span><span class="p">:</span> <span class="sh">""</span><span class="p">,</span> <span class="sh">"</span><span class="s">p</span><span class="sh">"</span><span class="p">:</span> <span class="n">parent_id</span><span class="p">,</span> <span class="sh">"</span><span class="s">pos</span><span class="sh">"</span><span class="p">:</span> <span class="n">position</span><span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>

        <span class="c1"># Update operation
</span>        <span class="n">update_delta</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">:</span> <span class="n">card_id</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">ts</span><span class="sh">"</span><span class="p">:</span> <span class="n">update_ts</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">ops</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="sh">"</span><span class="s">t</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">u</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">c</span><span class="sh">"</span><span class="p">:</span> <span class="n">content</span><span class="p">,</span> <span class="sh">"</span><span class="s">e</span><span class="sh">"</span><span class="p">:</span> <span class="n">insert_ts</span><span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>

        <span class="n">push_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">dlts</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="n">insert_delta</span><span class="p">,</span> <span class="n">update_delta</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">tr</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">tree_id</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">chk</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">checkpoint</span> <span class="ow">or</span> <span class="n">insert_ts</span>
        <span class="p">}</span>

        <span class="n">self</span><span class="p">.</span><span class="n">push_ok_event</span><span class="p">.</span><span class="nf">clear</span><span class="p">()</span>
        <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">send_message</span><span class="p">(</span><span class="sh">"</span><span class="s">push</span><span class="sh">"</span><span class="p">,</span> <span class="n">push_data</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Sent push for card </span><span class="sh">'</span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="sh">'</span><span class="s"> with ID </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">wait_for</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">push_ok_event</span><span class="p">.</span><span class="nf">wait</span><span class="p">(),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Push acknowledgment received for card </span><span class="sh">'</span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="sh">'"</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">asyncio</span><span class="p">.</span><span class="nb">TimeoutError</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sh">"</span><span class="s">Did not receive pushOk acknowledgment in time.</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sh">"</span><span class="s">pushOk timeout</span><span class="sh">"</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">card_id</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_tree_structure</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">structure</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">parent_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Recursively creates a tree structure based on the provided data.

        Args:
            structure (list): A list of dicts representing the tree structure.
            parent_id (str, optional): The ID of the parent card. Defaults to None.
        </span><span class="sh">"""</span>
        <span class="k">for</span> <span class="n">position</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">structure</span><span class="p">):</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">content</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">).</span><span class="nf">strip</span><span class="p">()</span>
            <span class="n">children</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">children</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">content</span><span class="p">:</span>
                <span class="n">logger</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sh">"</span><span class="s">Encountered node without content. Skipping.</span><span class="sh">"</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">card_id</span> <span class="o">=</span> <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">create_card</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">parent_id</span><span class="p">,</span> <span class="n">position</span><span class="p">)</span>
                <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Created card </span><span class="sh">'</span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="sh">'</span><span class="s"> with ID </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">children</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">create_tree_structure</span><span class="p">(</span><span class="n">children</span><span class="p">,</span> <span class="n">card_id</span><span class="p">)</span>

                <span class="c1"># Small delay to avoid overwhelming the server
</span>                <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Failed to create card </span><span class="sh">'</span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="sh">'</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">perform_operations</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Performs desired operations after establishing the WebSocket connection.
        This could be interacting with the tree, creating cards, etc.
        </span><span class="sh">"""</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Starting operations...</span><span class="sh">"</span><span class="p">)</span>

        <span class="c1"># Example: Create a single card.
</span>        <span class="n">example_structure</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="sh">"</span><span class="s">content</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Automated Root Card</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">children</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="sh">"</span><span class="s">content</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Automated Child 1</span><span class="sh">"</span><span class="p">},</span>
                    <span class="p">{</span><span class="sh">"</span><span class="s">content</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Automated Child 2</span><span class="sh">"</span><span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>

        <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">create_tree_structure</span><span class="p">(</span><span class="n">example_structure</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Completed creating example card structure.</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Establishes the WebSocket connection and handles reconnection logic.
        </span><span class="sh">"""</span>
        <span class="k">while</span> <span class="n">self</span><span class="p">.</span><span class="n">reconnect_attempts</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">max_reconnect_attempts</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">async</span> <span class="k">with</span> <span class="n">websockets</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">extra_headers</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">Cookie</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">cookies</span><span class="p">}</span>
                <span class="p">)</span> <span class="k">as</span> <span class="n">ws</span><span class="p">:</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">ws</span> <span class="o">=</span> <span class="n">ws</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">reconnect_attempts</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Connected to </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">url</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

                    <span class="c1"># Send 'rt:join' message
</span>                    <span class="n">join_message</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_join_message</span><span class="p">()</span>
                    <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">send_message</span><span class="p">(</span><span class="sh">"</span><span class="s">rt:join</span><span class="sh">"</span><span class="p">,</span> <span class="n">join_message</span><span class="p">)</span>
                    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Sent </span><span class="sh">'</span><span class="s">rt:join</span><span class="sh">'</span><span class="s"> message: </span><span class="si">{</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">join_message</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                    <span class="n">logger</span><span class="p">.</span><span class="nf">debug</span><span class="p">(</span><span class="sh">"</span><span class="s">Waiting for </span><span class="sh">'</span><span class="s">rt:joinOk</span><span class="sh">'</span><span class="s"> message...</span><span class="sh">"</span><span class="p">)</span>

                    <span class="c1"># Start handling incoming messages
</span>                    <span class="n">message_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">create_task</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="nf">message_handler</span><span class="p">())</span>

                    <span class="c1"># Wait until session ID is received
</span>                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">wait_for</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">push_ok_event</span><span class="p">.</span><span class="nf">wait</span><span class="p">(),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
                    <span class="k">except</span> <span class="n">asyncio</span><span class="p">.</span><span class="nb">TimeoutError</span><span class="p">:</span>
                        <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sh">"</span><span class="s">Did not receive </span><span class="sh">'</span><span class="s">rt:joinOk</span><span class="sh">'</span><span class="s"> acknowledgment in time.</span><span class="sh">"</span><span class="p">)</span>
                        <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">reconnect</span><span class="p">()</span>
                        <span class="k">continue</span>

                    <span class="c1"># Proceed with operations
</span>                    <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">perform_operations</span><span class="p">()</span>

                    <span class="c1"># Keep the connection alive
</span>                    <span class="k">await</span> <span class="n">message_task</span>

            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="p">.</span><span class="nf">exception</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Connection error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">reconnect</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">reconnect</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Handles reconnection logic with exponential backoff.
        </span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">reconnect_attempts</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">reconnect_attempts</span> <span class="o">&gt;=</span> <span class="n">self</span><span class="p">.</span><span class="n">max_reconnect_attempts</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sh">"</span><span class="s">Maximum reconnection attempts reached. Exiting.</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">wait_time</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">self</span><span class="p">.</span><span class="n">reconnect_attempts</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Attempting to reconnect in </span><span class="si">{</span><span class="n">wait_time</span><span class="si">}</span><span class="s"> seconds (Attempt </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">reconnect_attempts</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">max_reconnect_attempts</span><span class="si">}</span><span class="s">)...</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">wait_time</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Reconnecting...</span><span class="sh">"</span><span class="p">)</span>
        <span class="c1"># Reset session-specific data
</span>        <span class="n">self</span><span class="p">.</span><span class="n">session_id</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">self</span><span class="p">.</span><span class="n">checkpoint</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">self</span><span class="p">.</span><span class="n">push_ok_event</span><span class="p">.</span><span class="nf">clear</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        Starts the client, connects to the server, and initiates operations.
        </span><span class="sh">"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="nf">connect</span><span class="p">()</span>
        <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Interrupted by user.</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">ws</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">self</span><span class="p">.</span><span class="n">ws</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">exception</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">load_credentials_from_env</span><span class="p">():</span>
        <span class="sh">"""</span><span class="s">
        Loads credentials from environment variables.

        Returns:
            tuple: A tuple containing url, cookies, tree_id, user_id, auth_token
        </span><span class="sh">"""</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">wss://app.gingkowriter.com/ws</span><span class="sh">"</span>  <span class="c1"># Fixed URL
</span>        <span class="n">cookies</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sh">"</span><span class="s">connect.sid=placeholder; </span><span class="sh">"</span>
            <span class="sh">"</span><span class="s">_lr_uf_-jtqjrc=placeholder; </span><span class="sh">"</span>
            <span class="sh">"</span><span class="s">_BEAMER_USER_ID_mYJLRImY38547=placeholder; </span><span class="sh">"</span>
            <span class="sh">"</span><span class="s">_BEAMER_FIRST_VISIT_mYJLRImY38547=placeholder; </span><span class="sh">"</span>
            <span class="sh">"</span><span class="s">__stripe_mid=placeholder; </span><span class="sh">"</span>
            <span class="sh">"</span><span class="s">_BEAMER_LAST_POST_SHOWN_mYJLRImY38547=placeholder; </span><span class="sh">"</span>
            <span class="sh">"</span><span class="s">_BEAMER_DATE_mYJLRImY38547=placeholder; </span><span class="sh">"</span>
            <span class="sh">"</span><span class="s">_BEAMER_FILTER_BY_URL_mYJLRImY38547=placeholder; </span><span class="sh">"</span>
            <span class="sh">"</span><span class="s">__stripe_sid=placeholder; </span><span class="sh">"</span>
            <span class="sh">"</span><span class="s">_lr_tabs_-jtqjrc%2Fgingko-writer-production=placeholder}; </span><span class="sh">"</span>
            <span class="sh">"</span><span class="s">_lr_hb_-jtqjrc%2Fgingko-writer-production=placeholder}</span><span class="sh">"</span>
        <span class="p">)</span>
        <span class="n">tree_id</span> <span class="o">=</span> <span class="sh">"</span><span class="s">6oj4Rzb</span><span class="sh">"</span>  <span class="c1"># As per your 'rt:join' message
</span>        <span class="n">user_id</span> <span class="o">=</span> <span class="sh">"</span><span class="s">h9ogoeh2o2u7</span><span class="sh">"</span>  <span class="c1"># As per your 'rt:join' message
</span>        <span class="n">auth_token</span> <span class="o">=</span> <span class="sh">"</span><span class="s">TLOBcFHCOPU6oI6mYHKdpR5F</span><span class="sh">"</span>  <span class="c1"># As per your 'rt:join' message
</span>        <span class="k">return</span> <span class="n">url</span><span class="p">,</span> <span class="n">cookies</span><span class="p">,</span> <span class="n">tree_id</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">auth_token</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">
    Main function to start the GingkoWebsocketClient.
    </span><span class="sh">"""</span>
    <span class="c1"># Load credentials directly from provided data
</span>    <span class="n">URL</span><span class="p">,</span> <span class="n">COOKIES</span><span class="p">,</span> <span class="n">TREE_ID</span><span class="p">,</span> <span class="n">USER_ID</span><span class="p">,</span> <span class="n">AUTH_TOKEN</span> <span class="o">=</span> <span class="n">GingkoWebsocketClient</span><span class="p">.</span><span class="nf">load_credentials_from_env</span><span class="p">()</span>

    <span class="n">client</span> <span class="o">=</span> <span class="nc">GingkoWebsocketClient</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">COOKIES</span><span class="p">,</span> <span class="n">TREE_ID</span><span class="p">,</span> <span class="n">USER_ID</span><span class="p">,</span> <span class="n">AUTH_TOKEN</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">asyncio</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="nf">main</span><span class="p">())</span>
</code></section></div></div>

        </div>
        
          URL: https://ib.bsb.br/gingko-websocket
        
      </article>
      <nav class="post-navigation-combined" aria-label="Post navigation">
        <!-- Chronological Navigation (always visible at 40vh) -->
        
          <div class="nav-arrow chronological prev">
            <a href="/zutty-linux-terminal/" title="Zutty Linux terminal" rel="prev">
              <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAxVJREFUaEPt18FqG1cUBuD/nLkzI42UiVInkFLTCAKhS+9KA+3Kq1L8AAHjhR7AKz+ADV55qUfoqhvThTfdmC4KzTKmYJrELshJW9PIlSeKRpqZe88pUtouihvVRknqMNoMzD1zdPXNrzMM4RJ+6BLuGeWm39RdK6VL6VcIlPEo41HG401loJQupS8mUM7pi7md/6p3UtoHUJzf4vVecZb0e0EQfB7H8b0kSeqqummt/eb1buN83SebNsZ8QkQCYHVpaenu/v7+ra2tLRwdHWF1ddWq6hfM3BCRE2b+FcBHACQAHo1E5v9c+5mIhkR0e3z0VQ8LotuqWlXVw/GRmT8QkdMK89McuAOAAfwoIu8z85yIHBPRKRGN1/IAeDx0rul53hivo6psrf2ejDGfEtFOu92u7O3tBWtra2i322g0GhgOh9je3ka325UPax7fCR0iw+lp4aLxr70aeOmgkChTRY3JGSb73EroERD73uB54WpOgdhwZkXNQNQLiVDzOU1yFymAhu+lqZVopIqISQKmPLFS+atHv3A1q8AVQ+lXP/VHRPQx+b6frKysxMvLy1hfX0ez2USv18PCwgLiOEaSJKhWq/jhwQN8dnIfVOS4dsWHqCJ5YREGjBuNEMfd0eTc9WshBqnFYGhRqxrUIoNuLwMT4eb1Cp6dZshywdW6mZzr9QsEPuPmXIhfno3gnGKuEWCUC14MLKoVb1L72+8Zvj3JOl/udZt/S7darUqn0wlarRZ2d3cxPz+PJ8dPsPP1Doq8kIbL+cawjxBIM8MRFAidpBlRpIbhFc55gM2NF5IIQtVBRlRTZgTWZQ4wzvc8spO1NPM4Gr9Wh1bSDIjU98C5E0PIC8OVSX+Rlz08hl+4/LsML6X/menFxcW7BwcHtzY2NvDw8CE21zf/NdMAHskFMs3MT/EfMg3gsTsr02f8byfTo16v3+v3+//f6fGKgXNp5vT5huZbqH4nH+NvwXH6V5bS041mU1FKz8ZxepdSerrRbCpK6dk4Tu9SSk83mk1FKT0bx+ldSunpRrOpuJTSfwBcuImxpyA7XgAAAABJRU5ErkJggg==" alt="Previous article" width="45" height="45" loading="lazy">
            </a>
          </div>
        
        
          <div class="nav-arrow chronological next">
            <a href="/converting-curl-to-ios-shortcut/" title="Converting cURL to iOS Shortcut" rel="next">
              <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAwdJREFUaEPtl01rG1cUht9z7p070ijKWLVS3I9YULtNMBRn2UIXxZtuvCjedNWfoKVXBvsHeOUfoIUx5AeY0pVXXSR052UxBJSi0kDiRplII83HvadI9CMtOFjCmBjubC7cc8+Zc555eYdLuIEP3cCe4Zu+rq/mSXvSbyHg5eHl4eVxXRrwpD3p+Qh4n56P2+xZnvTszC7MCAAUF0XfOdJa62+IaCeO40GSJA/zPP8RwB9vDjBtWmv9JRE5ImpZawdVpbo58CkAIyJnIrLAzEvOuXNm/h3AfQDOAGdj5z5m5gXn3G9ENCKilckaiDwpiFZEpCoiTyYrM3/knOtXmHs58BkABvCLc+4DZl6cxIjoh4ODA728vIzt7W2sra09PT4+fgTgQES4LMvHZIy5LyI/f/dJvfK6FKMJqAdqmBS2ZgWINY9zJyZ1whUiRJrTfmGjybSxUemwcFEmghqT1UxlUrpQEXD7jRq3NWelEz10okIi1AJOX+U2EgALgUrT0kVnmcKvQ+uazSZvbW2hWq2i3++j3W5jf38f6+vrebvdHovI5pT09+vN7teLYev990K8GpQYjS1u1TQqhnHez6EU4cM7FTw7z5AXDo16ACcyPRsaxp2FEM9ejKd7zUaIYVpiOCpRq2rUIo0XLzMwEZaaFTzvZ8hyh/iWnu69fF1AAoOfFr/A5w8eYDQaIY5jJEmC09NTNBoNdLtd7O3t4ejoCIeHh8k/pL8KUSkCZcg6hCLDjLk2ufYGpRuXAuOMYiosQiDNNEcQILQuzYgi0QxVWKuAMtcqJPdXDaKaMMOUNrOAtoFSVE5jaaY4mtQPS5dmQPS8WkdfGReYgDe/3cTdpbvo9XrY2NhAp9NBq9XKO53Ov6T/r2mlVBeX0DSAMzeHppm5h7doemdvR99buYfd3V2srq4+PTk5+a+mr9CmrqTU3+5Rr9cHg8HgYve4krddbZGb5dOXmf2d+7n4pi9D4LrOeHl40v42fl0a8KQ96fkIeJ+ej9vsWZ707Mzmy/Ck5+M2e9afhmuAz1BhwewAAAAASUVORK5CYII=" alt="Next article" width="45" height="45" loading="lazy">
            </a>
          </div>
        
            
            
              
              
                
              
                
              
                
              
                
                  
                  
              
              
              
              <!-- Navigation block for tag "scripts>cloud"; default display for the first tag -->
              <div class="nav-group tags" id="tag-nav-scripts-cloud" style="display: block;">
                <div class="nav-arrow tags prev">
                  
                    <a href="/building-a-file-storage-service-with-cloudflare-workers-and-r2/" title="Building a File Storage Service with Cloudflare Workers and R2" rel="prev">
                      <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAxVJREFUaEPt18FqG1cUBuD/nLkzI42UiVInkFLTCAKhS+9KA+3Kq1L8AAHjhR7AKz+ADV55qUfoqhvThTfdmC4KzTKmYJrELshJW9PIlSeKRpqZe88pUtouihvVRknqMNoMzD1zdPXNrzMM4RJ+6BLuGeWm39RdK6VL6VcIlPEo41HG401loJQupS8mUM7pi7md/6p3UtoHUJzf4vVecZb0e0EQfB7H8b0kSeqqummt/eb1buN83SebNsZ8QkQCYHVpaenu/v7+ra2tLRwdHWF1ddWq6hfM3BCRE2b+FcBHACQAHo1E5v9c+5mIhkR0e3z0VQ8LotuqWlXVw/GRmT8QkdMK89McuAOAAfwoIu8z85yIHBPRKRGN1/IAeDx0rul53hivo6psrf2ejDGfEtFOu92u7O3tBWtra2i322g0GhgOh9je3ka325UPax7fCR0iw+lp4aLxr70aeOmgkChTRY3JGSb73EroERD73uB54WpOgdhwZkXNQNQLiVDzOU1yFymAhu+lqZVopIqISQKmPLFS+atHv3A1q8AVQ+lXP/VHRPQx+b6frKysxMvLy1hfX0ez2USv18PCwgLiOEaSJKhWq/jhwQN8dnIfVOS4dsWHqCJ5YREGjBuNEMfd0eTc9WshBqnFYGhRqxrUIoNuLwMT4eb1Cp6dZshywdW6mZzr9QsEPuPmXIhfno3gnGKuEWCUC14MLKoVb1L72+8Zvj3JOl/udZt/S7darUqn0wlarRZ2d3cxPz+PJ8dPsPP1Doq8kIbL+cawjxBIM8MRFAidpBlRpIbhFc55gM2NF5IIQtVBRlRTZgTWZQ4wzvc8spO1NPM4Gr9Wh1bSDIjU98C5E0PIC8OVSX+Rlz08hl+4/LsML6X/menFxcW7BwcHtzY2NvDw8CE21zf/NdMAHskFMs3MT/EfMg3gsTsr02f8byfTo16v3+v3+//f6fGKgXNp5vT5huZbqH4nH+NvwXH6V5bS041mU1FKz8ZxepdSerrRbCpK6dk4Tu9SSk83mk1FKT0bx+ldSunpRrOpuJTSfwBcuImxpyA7XgAAAABJRU5ErkJggg==" alt="Previous in Tag" width="45" height="45" loading="lazy">
                    </a>
                  
                </div>
                <div class="nav-arrow tags next">
                  
                    <a href="javascript:void(0)" class="disabled" aria-disabled="true" title="No next in tag">
                      <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAxVJREFUaEPt18FqG1cUBuD/nLkzI42UiVInkFLTCAKhS+9KA+3Kq1L8AAHjhR7AKz+ADV55qUfoqhvThTfdmC4KzTKmYJrELshJW9PIlSeKRpqZe88pUtouihvVRknqMNoMzD1zdPXNrzMM4RJ+6BLuGeWm39RdK6VL6VcIlPEo41HG401loJQupS8mUM7pi7md/6p3UtoHUJzf4vVecZb0e0EQfB7H8b0kSeqqummt/eb1buN83SebNsZ8QkQCYHVpaenu/v7+ra2tLRwdHWF1ddWq6hfM3BCRE2b+FcBHACQAHo1E5v9c+5mIhkR0e3z0VQ8LotuqWlXVw/GRmT8QkdMK89McuAOAAfwoIu8z85yIHBPRKRGN1/IAeDx0rul53hivo6psrf2ejDGfEtFOu92u7O3tBWtra2i322g0GhgOh9je3ka325UPax7fCR0iw+lp4aLxr70aeOmgkChTRY3JGSb73EroERD73uB54WpOgdhwZkXNQNQLiVDzOU1yFymAhu+lqZVopIqISQKmPLFS+atHv3A1q8AVQ+lXP/VHRPQx+b6frKysxMvLy1hfX0ez2USv18PCwgLiOEaSJKhWq/jhwQN8dnIfVOS4dsWHqCJ5YREGjBuNEMfd0eTc9WshBqnFYGhRqxrUIoNuLwMT4eb1Cp6dZshywdW6mZzr9QsEPuPmXIhfno3gnGKuEWCUC14MLKoVb1L72+8Zvj3JOl/udZt/S7darUqn0wlarRZ2d3cxPz+PJ8dPsPP1Doq8kIbL+cawjxBIM8MRFAidpBlRpIbhFc55gM2NF5IIQtVBRlRTZgTWZQ4wzvc8spO1NPM4Gr9Wh1bSDIjU98C5E0PIC8OVSX+Rlz08hl+4/LsML6X/menFxcW7BwcHtzY2NvDw8CE21zf/NdMAHskFMs3MT/EfMg3gsTsr02f8byfTo16v3+v3+//f6fGKgXNp5vT5huZbqH4nH+NvwXH6V5bS041mU1FKz8ZxepdSerrRbCpK6dk4Tu9SSk83mk1FKT0bx+ldSunpRrOpuJTSfwBcuImxpyA7XgAAAABJRU5ErkJggg==" alt="No next in Tag" width="45" height="45" loading="lazy">
                    </a>
                  
                </div>
              </div>
            
          
            
            
              
              
                
              
                
              
                
              
                
              
                
                  
                  
              
              
              
              <!-- Navigation block for tag "scratchpad"; default display for the first tag -->
              <div class="nav-group tags" id="tag-nav-scratchpad" style="display: none;">
                <div class="nav-arrow tags prev">
                  
                    <a href="/a-shell-thermal/" title="iOS Shortcut for Linux Thermal Printing" rel="prev">
                      <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAxVJREFUaEPt18FqG1cUBuD/nLkzI42UiVInkFLTCAKhS+9KA+3Kq1L8AAHjhR7AKz+ADV55qUfoqhvThTfdmC4KzTKmYJrELshJW9PIlSeKRpqZe88pUtouihvVRknqMNoMzD1zdPXNrzMM4RJ+6BLuGeWm39RdK6VL6VcIlPEo41HG401loJQupS8mUM7pi7md/6p3UtoHUJzf4vVecZb0e0EQfB7H8b0kSeqqummt/eb1buN83SebNsZ8QkQCYHVpaenu/v7+ra2tLRwdHWF1ddWq6hfM3BCRE2b+FcBHACQAHo1E5v9c+5mIhkR0e3z0VQ8LotuqWlXVw/GRmT8QkdMK89McuAOAAfwoIu8z85yIHBPRKRGN1/IAeDx0rul53hivo6psrf2ejDGfEtFOu92u7O3tBWtra2i322g0GhgOh9je3ka325UPax7fCR0iw+lp4aLxr70aeOmgkChTRY3JGSb73EroERD73uB54WpOgdhwZkXNQNQLiVDzOU1yFymAhu+lqZVopIqISQKmPLFS+atHv3A1q8AVQ+lXP/VHRPQx+b6frKysxMvLy1hfX0ez2USv18PCwgLiOEaSJKhWq/jhwQN8dnIfVOS4dsWHqCJ5YREGjBuNEMfd0eTc9WshBqnFYGhRqxrUIoNuLwMT4eb1Cp6dZshywdW6mZzr9QsEPuPmXIhfno3gnGKuEWCUC14MLKoVb1L72+8Zvj3JOl/udZt/S7darUqn0wlarRZ2d3cxPz+PJ8dPsPP1Doq8kIbL+cawjxBIM8MRFAidpBlRpIbhFc55gM2NF5IIQtVBRlRTZgTWZQ4wzvc8spO1NPM4Gr9Wh1bSDIjU98C5E0PIC8OVSX+Rlz08hl+4/LsML6X/menFxcW7BwcHtzY2NvDw8CE21zf/NdMAHskFMs3MT/EfMg3gsTsr02f8byfTo16v3+v3+//f6fGKgXNp5vT5huZbqH4nH+NvwXH6V5bS041mU1FKz8ZxepdSerrRbCpK6dk4Tu9SSk83mk1FKT0bx+ldSunpRrOpuJTSfwBcuImxpyA7XgAAAABJRU5ErkJggg==" alt="Previous in Tag" width="45" height="45" loading="lazy">
                    </a>
                  
                </div>
                <div class="nav-arrow tags next">
                  
                    <a href="/converting-curl-to-ios-shortcut/" title="Converting cURL to iOS Shortcut" rel="next">
                      <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAwdJREFUaEPtl01rG1cUht9z7p070ijKWLVS3I9YULtNMBRn2UIXxZtuvCjedNWfoKVXBvsHeOUfoIUx5AeY0pVXXSR052UxBJSi0kDiRplII83HvadI9CMtOFjCmBjubC7cc8+Zc555eYdLuIEP3cCe4Zu+rq/mSXvSbyHg5eHl4eVxXRrwpD3p+Qh4n56P2+xZnvTszC7MCAAUF0XfOdJa62+IaCeO40GSJA/zPP8RwB9vDjBtWmv9JRE5ImpZawdVpbo58CkAIyJnIrLAzEvOuXNm/h3AfQDOAGdj5z5m5gXn3G9ENCKilckaiDwpiFZEpCoiTyYrM3/knOtXmHs58BkABvCLc+4DZl6cxIjoh4ODA728vIzt7W2sra09PT4+fgTgQES4LMvHZIy5LyI/f/dJvfK6FKMJqAdqmBS2ZgWINY9zJyZ1whUiRJrTfmGjybSxUemwcFEmghqT1UxlUrpQEXD7jRq3NWelEz10okIi1AJOX+U2EgALgUrT0kVnmcKvQ+uazSZvbW2hWq2i3++j3W5jf38f6+vrebvdHovI5pT09+vN7teLYev990K8GpQYjS1u1TQqhnHez6EU4cM7FTw7z5AXDo16ACcyPRsaxp2FEM9ejKd7zUaIYVpiOCpRq2rUIo0XLzMwEZaaFTzvZ8hyh/iWnu69fF1AAoOfFr/A5w8eYDQaIY5jJEmC09NTNBoNdLtd7O3t4ejoCIeHh8k/pL8KUSkCZcg6hCLDjLk2ufYGpRuXAuOMYiosQiDNNEcQILQuzYgi0QxVWKuAMtcqJPdXDaKaMMOUNrOAtoFSVE5jaaY4mtQPS5dmQPS8WkdfGReYgDe/3cTdpbvo9XrY2NhAp9NBq9XKO53Ov6T/r2mlVBeX0DSAMzeHppm5h7doemdvR99buYfd3V2srq4+PTk5+a+mr9CmrqTU3+5Rr9cHg8HgYve4krddbZGb5dOXmf2d+7n4pi9D4LrOeHl40v42fl0a8KQ96fkIeJ+ej9vsWZ707Mzmy/Ck5+M2e9afhmuAz1BhwewAAAAASUVORK5CYII=" alt="Next in Tag" width="45" height="45" loading="lazy">
                    </a>
                  
                </div>
              </div>
            
          
          <!-- JavaScript to Toggle the Tag-based Navigation -->
          <script>
            document.addEventListener("DOMContentLoaded", function(){
              var tagLinks = document.querySelectorAll('.tag-option');
              tagLinks.forEach(function(link){
                link.addEventListener('click', function(event){
                  event.preventDefault();
                  // Remove "active" class from all tag options.
                  tagLinks.forEach(function(el){ el.classList.remove('active'); });
                  // Add active class to the clicked tag option.
                  this.classList.add('active');
                  // Hide all tag navigation blocks.
                  document.querySelectorAll('.nav-group.tags').forEach(function(block){
                    block.style.display = 'none';
                  });
                  // Show the navigation block corresponding to the selected tag.
                  var tagSlug = this.getAttribute('data-tag');
                  var target = document.getElementById('tag-nav-' + tagSlug);
                  if(target) {
                    target.style.display = 'block';
                  }
                });
              });
            });
          </script>
      </nav>
      
    <div class="comment-box">
      Ref. 
      <a href="https://app.gingkowriter.com/database-download.html" title="https://app.gingkowriter.com/database-download.html">https://app.gingkowriter.com/database-download.html</a>
    </div>
    
    </main>
    <footer id="bottom-of-page" class="site-footer">
      <div class="footer-content">
        <!-- Back to top link -->
        <a href="#" aria-label="Back to top" class="back2top-link">
          <span class="sronly">Back to top</span>
        </a>
    
        <!-- Liquid Time Calculation and Display -->
        
        
        
        <a href="https://ib.bsb.br/404" aria-label="404">
          2026-01-15 10:13:08
        </a>
        &#x23;
    
        <!-- Tag Selector -->
        <ul class="tag-selector">
          
            
            
              <li>
                <a href="#" class="tag-option active" data-tag="scripts-cloud">
                  scripts>cloud
                </a>
              </li>
            
          
            
            
              <li>
                <a href="#" class="tag-option " data-tag="scratchpad">
                  scratchpad
                </a>
              </li>
            
          
        </ul>
        &hArr;
    
        <!-- GitHub Link -->
        <a href="https://github.com/ib-bsb-br/ib-bsb-br.github.io" aria-label="GitHub">
          &#8505;
        </a>
    
        <!-- Homepage Link -->
        <a href="/" aria-label="Homepage">
          infoBAG
        </a>
    
        <!-- Copy All Code Button -->
        <button id="copyAllButton" aria-label="Copy all code">
          &copy;
        </button>
      </div>
    </footer>
    <style>
      .back2top-link {
        display: inline-block;
        width: 32px;
        height: 32px;
        background: url("/assets/Rope_(Old).gif") center center no-repeat;
        background-size: contain;
        text-decoration: none;
        vertical-align: middle;
      }
      .sronly {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
    </style>
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Article",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://ib.bsb.br/gingko-websocket/"
        },
        "headline": "Gingko Python WebSocket script",
        "description": "",
        "datePublished": "2024-11-03T00:00:00+00:00",
        "dateModified": "2025-10-05T01:50:24+00:00",
        "author": {
          "@type": "Person",
          "name": "Author"
        },
        "publisher": {
          "@type": "Organization",
          "name": "infoBAG"
          
        }
        
      }
    </script>
    <script src="/assets/js/prism.js" defer></script>
    <script src="/assets/js/copy-all-code.js"></script>
  </body>
</html>
