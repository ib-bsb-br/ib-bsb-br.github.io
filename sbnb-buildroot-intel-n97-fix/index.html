<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
      
        sbnb buildroot intel n97 fix - infoBAG
      
    </title>
    <meta name="title" content="sbnb buildroot intel n97 fix - infoBAG" />
    <meta name="description" content="">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://ib.bsb.br/sbnb-buildroot-intel-n97-fix/">
    <meta property="og:title" content="sbnb buildroot intel n97 fix - infoBAG">
    <meta property="og:description" content="">
    <meta property="og:image" content="/favicon.ico">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://ib.bsb.br/sbnb-buildroot-intel-n97-fix/">
    <meta name="twitter:title" content="sbnb buildroot intel n97 fix - infoBAG">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="/favicon.ico">
    <link rel="canonical" href="https://ib.bsb.br/sbnb-buildroot-intel-n97-fix/">
    <link rel="alternate" type="application/rss+xml" title="infoBAG" href="https://ib.bsb.br/rss.xml">
    
      <meta name="keywords" content="scratchpad">
      
        <meta property="article:tag" content="scratchpad">
      
    
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    
    <link rel="stylesheet" href="/style.css">
  </head>
  <body class="post-content-body">
    <header class="header-container">
      <nav aria-label="Main navigation" class="header-content">
        <a href="/" aria-label="Home">
          <img src="/favicon.ico" alt="Home" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/tags" aria-label="Tags">
          <img src="/assets/Label.gif" alt="Tags" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/send" aria-label="send">
          <img src="/assets/rot.gif" alt="send" class="favicon search-link" width="32" height="32" loading="lazy">
        </a> 
        <a href="/created" aria-label="archive created">
          <img src="/assets/Loose_Stone_Pile.gif" alt="archive created" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/events" aria-label="Events">
          <img src="/assets/Paralyse_Rune.gif" alt="Events" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
        <a href="/modified" aria-label="archive modified">
          <img src="/assets/Hole_(Rock).gif" alt="archive modified" class="favicon search-link" width="32" height="32" loading="lazy">
        </a>
    </nav>
      <h5 class="post-title">
        <a href="#bottom-of-page" aria-label="Go to bottom">
          sbnb buildroot intel n97 fix
        </a>
      </h5>
      <div class="post-meta">
        <time datetime="2025-05-03T00:00:00+00:00" class="post-date">
          03 May 2025
        </time>
        
          <span class="post-updated">
            ↣
            <time datetime="2025-05-03T22:13:51+00:00">
              03 May 2025
            </time>
          </span>
        
        
          <p class="post-slug">
            Slug: <a href="https://ib.bsb.br/sbnb-buildroot-intel-n97-fix" class="tag">sbnb-buildroot-intel-n97-fix</a>
          </p>
        
        
          <p class="post-tags">
            Tags:
            
              <a href="https://ib.bsb.br/tags/#scratchpad" class="tag">scratchpad</a>
            
          </p>
        
      </div>
      <div class="post-actions">
        <div class="page-stats mt-3" role="status" aria-label="Page statistics">
      
      <span class="badge bg-primary">
        27860 characters
      </span>
        <span class="separator mx-2" aria-hidden="true">•</span>
        <span class="badge bg-primary">
        2964 words
      </span>
      </div>
        <div class="action-buttons d-flex flex-wrap gap-2">
          
            
              <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/edit/main/_posts/2025-05-03-sbnb-buildroot-intel-n97-fix.md"
                    method="GET"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="d-inline-block">
                <button type="submit" class="btn btn-danger" aria-label="Edit page content">
                  <span class="button-text">Improve this page?</span>
                  <span class="info-text">aberto.</span>
                </button>
              </form>
            
            <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/commits/main/_posts/2025-05-03-sbnb-buildroot-intel-n97-fix.md"
                  method="GET"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="d-inline-block">
              <button type="submit" class="btn btn-danger" aria-label="View page revision history">
                View revision history
              </button>
            </form>
          
        </div>
      </div>
    </header>
    <main class="content">
      <article class="post-wrapper">
        <div class="post-content-body">
          
<ul><li><a href="#second-approach">second approach</a></li></ul>
          <p>Okay, let’s refactor the provided Buildroot files (<code class="language-plaintext highlighter-rouge">create_efi.sh</code> and <code class="language-plaintext highlighter-rouge">sbnb_defconfig</code>) to permanently include the <code class="language-plaintext highlighter-rouge">nomodeset</code> kernel parameter for the boot process initiated by the custom EFI executable.</p>

<p>The main challenge here is that your <code class="language-plaintext highlighter-rouge">create_efi.sh</code> script <strong>builds a unified EFI executable and hardcodes the kernel command line within itself</strong>. This approach bypasses the standard Buildroot mechanism for setting the kernel command line via <code class="language-plaintext highlighter-rouge">BR2_KERNEL_CMDLINE_*</code> options in the configuration, which are typically used by bootloaders like GRUB or Syslinux.</p>

<p>Therefore, to add <code class="language-plaintext highlighter-rouge">nomodeset</code>, we must modify the script directly. Changes to the <code class="language-plaintext highlighter-rouge">sbnb_defconfig</code> file will primarily involve ensuring other settings (like the initramfs format) are consistent with the script and adding comments for clarity.</p>

<p><strong>1. Refactored <code class="language-plaintext highlighter-rouge">board/sbnb/sbnb/scripts/create_efi.sh</code></strong></p>

<p>This version adds <code class="language-plaintext highlighter-rouge">nomodeset</code> to the command line string and includes a note about a potentially unused variable from the original script.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="c">#!/bin/bash</span>

<span class="nb">set</span> <span class="nt">-euxo</span> pipefail

<span class="c"># This script creates a custom bootable EFI binary by combining an EFI stub,</span>
<span class="c"># Linux kernel, initrd, osrel and cmdline.</span>

<span class="c"># Define variables</span>
<span class="nv">STUB</span><span class="o">=</span>/usr/lib/systemd/boot/efi/linuxx64.efi.stub
<span class="nv">KERNEL</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">BINARIES_DIR</span><span class="k">}</span><span class="s2">/bzImage"</span>
<span class="c"># --- VERIFY THIS INITRD PATH ---</span>
<span class="c"># Ensure this path correctly points to the CPIO archive you intend to use.</span>
<span class="c"># Buildroot generates the CPIO in ${BINARIES_DIR}. Check if it's compressed</span>
<span class="c"># (e.g., rootfs-sbnb.cpio.xz) or uncompressed (e.g., rootfs-sbnb.cpio)</span>
<span class="c"># and adjust this variable and/or your Buildroot config accordingly.</span>
<span class="c"># See notes in the defconfig section below.</span>
<span class="nv">INITRD</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">BINARIES_DIR</span><span class="k">}</span><span class="s2">/rootfs-sbnb.cpio"</span>
<span class="nv">OS_RELEASE</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">TARGET_DIR</span><span class="k">}</span><span class="s2">/etc/os-release"</span>
<span class="c"># --- MODIFIED KERNEL COMMAND LINE ---</span>
<span class="c"># Added 'nomodeset' to the end of the command line string.</span>
<span class="c"># IMPORTANT: This command line is HARDCODED. Changes to BR2_KERNEL_CMDLINE_*</span>
<span class="c"># in the Buildroot config will NOT affect the EFI file generated by this script.</span>
<span class="nv">CMDLINE</span><span class="o">=</span><span class="s2">"console=tty0 console=ttyS0 earlyprintk verbose intel_iommu=on module_blacklist=nouveau,nvidiafb,snd_hda_intel dyndbg=</span><span class="se">\"</span><span class="s2">module firmware_class +p; module microcode +p; module ccp +p</span><span class="se">\"</span><span class="s2"> nomodeset"</span>
<span class="c"># --- END MODIFICATION ---</span>
<span class="nv">CMDLINE_TMP</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span><span class="si">)</span>
<span class="nv">OUTPUT</span><span class="o">=</span>sbnb.efi <span class="c"># Output filename in the current directory</span>

<span class="c"># Write the command line to a temporary file</span>
<span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"</span><span class="k">${</span><span class="nv">CMDLINE</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;</span> <span class="s2">"</span><span class="k">${</span><span class="nv">CMDLINE_TMP</span><span class="k">}</span><span class="s2">"</span>

<span class="c"># Calculate alignment</span>
<span class="nv">align</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>objdump <span class="nt">-p</span> <span class="s2">"</span><span class="k">${</span><span class="nv">STUB</span><span class="k">}</span><span class="s2">"</span> | <span class="nb">awk</span> <span class="s1">'{ if ($1 == "SectionAlignment"){print $2} }'</span><span class="si">)</span><span class="s2">"</span>
<span class="nv">align</span><span class="o">=</span><span class="k">$((</span><span class="m">16</span><span class="c">#$align))</span>

<span class="c"># Calculate offsets for sections</span>
<span class="nv">stub_line</span><span class="o">=</span><span class="si">$(</span>objdump <span class="nt">-h</span> <span class="s2">"</span><span class="k">${</span><span class="nv">STUB</span><span class="k">}</span><span class="s2">"</span> | <span class="nb">tail</span> <span class="nt">-2</span> | <span class="nb">head</span> <span class="nt">-1</span><span class="si">)</span>
<span class="nv">stub_size</span><span class="o">=</span><span class="m">0</span>x<span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$stub_line</span><span class="s2">"</span> | <span class="nb">awk</span> <span class="s1">'{print $3}'</span><span class="si">)</span>
<span class="nv">stub_offs</span><span class="o">=</span><span class="m">0</span>x<span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$stub_line</span><span class="s2">"</span> | <span class="nb">awk</span> <span class="s1">'{print $4}'</span><span class="si">)</span>
<span class="nv">osrel_offs</span><span class="o">=</span><span class="k">$((</span>stub_size <span class="o">+</span> stub_offs<span class="k">))</span>
<span class="nv">osrel_offs</span><span class="o">=</span><span class="k">$((</span>osrel_offs <span class="o">+</span> align <span class="o">-</span> osrel_offs <span class="o">%</span> align<span class="k">))</span>
<span class="nv">cmdline_offs</span><span class="o">=</span><span class="k">$((</span>osrel_offs <span class="o">+</span> <span class="si">$(</span><span class="nb">stat</span> <span class="nt">-Lc</span>%s <span class="s2">"</span><span class="k">${</span><span class="nv">OS_RELEASE</span><span class="k">}</span><span class="s2">"</span><span class="si">)</span><span class="k">))</span>
<span class="nv">cmdline_offs</span><span class="o">=</span><span class="k">$((</span>cmdline_offs <span class="o">+</span> align <span class="o">-</span> cmdline_offs <span class="o">%</span> align<span class="k">))</span>
<span class="c"># --- NOTE: splash_offs Calculation ---</span>
<span class="c"># The following offset is calculated but doesn't appear to be used in the</span>
<span class="c"># objcopy command below in the original script. Verify if this is intended.</span>
<span class="nv">splash_offs</span><span class="o">=</span><span class="k">$((</span>cmdline_offs <span class="o">+</span> <span class="si">$(</span><span class="nb">stat</span> <span class="nt">-Lc</span>%s <span class="s2">"</span><span class="k">${</span><span class="nv">CMDLINE_TMP</span><span class="k">}</span><span class="s2">"</span><span class="si">)</span><span class="k">))</span>
<span class="nv">splash_offs</span><span class="o">=</span><span class="k">$((</span>splash_offs <span class="o">+</span> align <span class="o">-</span> splash_offs <span class="o">%</span> align<span class="k">))</span>
<span class="c"># --- END NOTE ---</span>
<span class="nv">linux_offs</span><span class="o">=</span><span class="k">$((</span>splash_offs<span class="k">))</span> <span class="c"># Original script sets linux_offs based on splash_offs</span>
<span class="nv">initrd_offs</span><span class="o">=</span><span class="k">$((</span>linux_offs <span class="o">+</span> <span class="si">$(</span><span class="nb">stat</span> <span class="nt">-Lc</span>%s <span class="s2">"</span><span class="k">${</span><span class="nv">KERNEL</span><span class="k">}</span><span class="s2">"</span><span class="si">)</span><span class="k">))</span>
<span class="nv">initrd_offs</span><span class="o">=</span><span class="k">$((</span>initrd_offs <span class="o">+</span> align <span class="o">-</span> initrd_offs <span class="o">%</span> align<span class="k">))</span>

<span class="c"># Use objcopy to add sections to the EFI stub</span>
<span class="c"># Ensure all required files exist before running objcopy</span>
<span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="o">-</span>f <span class="s2">"</span><span class="k">${</span><span class="nv">OS_RELEASE</span><span class="k">}</span><span class="s2">"</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="o">!</span> <span class="o">-</span>f <span class="s2">"</span><span class="k">${</span><span class="nv">CMDLINE_TMP</span><span class="k">}</span><span class="s2">"</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="o">!</span> <span class="o">-</span>f <span class="s2">"</span><span class="k">${</span><span class="nv">KERNEL</span><span class="k">}</span><span class="s2">"</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="o">!</span> <span class="o">-</span>f <span class="s2">"</span><span class="k">${</span><span class="nv">INITRD</span><span class="k">}</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Error: One or more input files for objcopy not found!"</span> <span class="o">&gt;&amp;</span><span class="m">2</span>
    <span class="nb">echo</span> <span class="s2">"OS_RELEASE: </span><span class="k">${</span><span class="nv">OS_RELEASE</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;&amp;</span><span class="m">2</span>
    <span class="nb">echo</span> <span class="s2">"CMDLINE_TMP: </span><span class="k">${</span><span class="nv">CMDLINE_TMP</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;&amp;</span><span class="m">2</span>
    <span class="nb">echo</span> <span class="s2">"KERNEL: </span><span class="k">${</span><span class="nv">KERNEL</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;&amp;</span><span class="m">2</span>
    <span class="nb">echo</span> <span class="s2">"INITRD: </span><span class="k">${</span><span class="nv">INITRD</span><span class="k">}</span><span class="s2">"</span> <span class="o">&gt;&amp;</span><span class="m">2</span>
    <span class="nb">rm</span> <span class="o">-</span>f <span class="s2">"</span><span class="k">${</span><span class="nv">CMDLINE_TMP</span><span class="k">}</span><span class="s2">"</span> <span class="c"># Clean up temp file on error</span>
    <span class="nb">exit </span><span class="m">1</span>
<span class="k">fi

</span>objcopy <span class="se">\</span>
    <span class="o">--</span>add-section .osrel<span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">OS_RELEASE</span><span class="k">}</span><span class="s2">"</span> <span class="o">--</span>change-section-vma .osrel<span class="o">=</span><span class="si">$(</span><span class="nb">printf </span>0x%x <span class="nv">$osrel_offs</span><span class="si">)</span> <span class="se">\</span>
    <span class="o">--</span>add-section .cmdline<span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">CMDLINE_TMP</span><span class="k">}</span><span class="s2">"</span> <span class="o">--</span>change-section-vma .cmdline<span class="o">=</span><span class="si">$(</span><span class="nb">printf </span>0x%x <span class="nv">$cmdline_offs</span><span class="si">)</span> <span class="se">\</span>
    <span class="o">--</span>add-section .linux<span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">KERNEL</span><span class="k">}</span><span class="s2">"</span> <span class="o">--</span>change-section-vma .linux<span class="o">=</span><span class="si">$(</span><span class="nb">printf </span>0x%x <span class="nv">$linux_offs</span><span class="si">)</span> <span class="se">\</span>
    <span class="o">--</span>add-section .initrd<span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">INITRD</span><span class="k">}</span><span class="s2">"</span> <span class="o">--</span>change-section-vma .initrd<span class="o">=</span><span class="si">$(</span><span class="nb">printf </span>0x%x <span class="nv">$initrd_offs</span><span class="si">)</span> <span class="se">\</span>
    <span class="s2">"</span><span class="k">${</span><span class="nv">STUB</span><span class="k">}</span><span class="s2">"</span> <span class="s2">"</span><span class="k">${</span><span class="nv">OUTPUT</span><span class="k">}</span><span class="s2">"</span>

<span class="c"># Clean up temporary file</span>
<span class="nb">rm</span> <span class="o">-</span>f <span class="s2">"</span><span class="k">${</span><span class="nv">CMDLINE_TMP</span><span class="k">}</span><span class="s2">"</span>

<span class="c"># Output the result</span>
<span class="nb">echo</span> <span class="s2">"Unified EFI executable created: </span><span class="k">${</span><span class="nv">OUTPUT</span><span class="k">}</span><span class="s2">"</span>

<span class="c"># Move the final EFI file to the standard Buildroot images directory</span>
<span class="c"># BR2_ROOTFS_POST_IMAGE_SCRIPT runs from the Buildroot top-level directory.</span>
<span class="c"># ${BINARIES_DIR} correctly points to output/images in this context.</span>
<span class="nb">mv</span> <span class="s2">"</span><span class="k">${</span><span class="nv">OUTPUT</span><span class="k">}</span><span class="s2">"</span> <span class="s2">"</span><span class="k">${</span><span class="nv">BINARIES_DIR</span><span class="k">}</span><span class="s2">/"</span>
<span class="nb">echo</span> <span class="s2">"Moved </span><span class="k">${</span><span class="nv">OUTPUT</span><span class="k">}</span><span class="s2"> to </span><span class="k">${</span><span class="nv">BINARIES_DIR</span><span class="k">}</span><span class="s2">/"</span>

</code></section></div></div>

<p><strong>2. Refactored <code class="language-plaintext highlighter-rouge">configs/sbnb_defconfig</code></strong></p>

<p>This version includes comments explaining the implications of the custom script and provides guidance on CPIO and Syslinux settings.</p>

<div class="language-makefile highlighter-rouge"><div class="highlight"><section><code><span class="nv">BR2_x86_64</span><span class="o">=</span>y
<span class="nv">BR2_CCACHE</span><span class="o">=</span>y
<span class="nv">BR2_INIT_SYSTEMD</span><span class="o">=</span>y
<span class="nv">BR2_SYSTEM_DEFAULT_PATH</span><span class="o">=</span><span class="s2">"/bin:/sbin:/usr/bin:/usr/sbin"</span>
<span class="nv">BR2_GENERATE_LOCALE</span><span class="o">=</span><span class="s2">"en_US"</span>
<span class="nv">BR2_ROOTFS_OVERLAY</span><span class="o">=</span><span class="s2">"</span><span class="p">$(</span><span class="s2">BR2_EXTERNAL_SBNB_PATH</span><span class="p">)</span><span class="s2">/board/sbnb/sbnb/rootfs-overlay"</span>
<span class="nv">BR2_ROOTFS_PRE_BUILD_SCRIPT</span><span class="o">=</span><span class="s2">"</span><span class="p">$(</span><span class="s2">BR2_EXTERNAL_SBNB_PATH</span><span class="p">)</span><span class="s2">/board/sbnb/sbnb/pre_build.sh"</span>
<span class="nv">BR2_ROOTFS_POST_BUILD_SCRIPT</span><span class="o">=</span><span class="s2">"</span><span class="p">$(</span><span class="s2">BR2_EXTERNAL_SBNB_PATH</span><span class="p">)</span><span class="s2">/board/sbnb/sbnb/post_build.sh"</span>

<span class="c"># --- Custom EFI Generation ---
# This post-image script creates a unified EFI executable (sbnb.efi)
# IMPORTANT: The kernel command line is HARDCODED inside the create_efi.sh script.
# Standard BR2_KERNEL_CMDLINE_* options below will NOT affect sbnb.efi.
</span><span class="nv">BR2_ROOTFS_POST_IMAGE_SCRIPT</span><span class="o">=</span><span class="s2">"</span><span class="p">$(</span><span class="s2">BR2_EXTERNAL_SBNB_PATH</span><span class="p">)</span><span class="s2">/board/sbnb/sbnb/scripts/create_efi.sh"</span>

<span class="nv">BR2_LINUX_KERNEL_GZIP</span><span class="o">=</span>y
<span class="nv">BR2_LINUX_KERNEL</span><span class="o">=</span>y
<span class="nv">BR2_LINUX_KERNEL_USE_CUSTOM_CONFIG</span><span class="o">=</span>y
<span class="c"># Switch back to upstream kernel once Restricted Injection hypervisor support
# patches merged: https://lore.kernel.org/lkml/Z08J0EVu0VeA7Z%2FR@rli9-mobl/T/
</span><span class="nv">BR2_LINUX_KERNEL_CUSTOM_GIT</span><span class="o">=</span>y
<span class="nv">BR2_LINUX_KERNEL_CUSTOM_REPO_URL</span><span class="o">=</span><span class="s2">"https://github.com/coconut-svsm/linux.git"</span>
<span class="nv">BR2_LINUX_KERNEL_CUSTOM_REPO_VERSION</span><span class="o">=</span><span class="s2">"svsm"</span>
<span class="nv">BR2_LINUX_KERNEL_CUSTOM_CONFIG_FILE</span><span class="o">=</span><span class="s2">"</span><span class="p">$(</span><span class="s2">BR2_EXTERNAL_SBNB_PATH</span><span class="p">)</span><span class="s2">/board/sbnb/sbnb/kernel-config"</span>
<span class="nv">BR2_LINUX_KERNEL_CONFIG_FRAGMENT_FILES</span><span class="o">=</span><span class="s2">"kernel-config-firmware"</span>
<span class="nv">BR2_LINUX_KERNEL_NEEDS_HOST_LIBELF</span><span class="o">=</span>y

<span class="c"># --- Kernel Command Line (Standard Bootloaders Only) ---
# These settings configure bootloaders like Syslinux or GRUB.
# They are NOT used by the custom create_efi.sh script.
# If Syslinux (enabled below) is actually used as a boot method,
# you SHOULD configure these options appropriately for it.
# Otherwise, the Syslinux boot entry might use an empty or default command line.
# Example:
# BR2_KERNEL_CMDLINE_EXTEND=y
# BR2_KERNEL_CMDLINE_FRAGMENT="nomodeset console=tty1"
</span><span class="nv">BR2_KERNEL_CMDLINE_DEFAULT</span><span class="o">=</span>y <span class="c"># Or choose custom/extend as needed for Syslinux</span>
<span class="c"># BR2_KERNEL_CMDLINE_CUSTOM is not set
# BR2_KERNEL_CMDLINE_EXTEND is not set
# BR2_KERNEL_CMDLINE_FRAGMENT=""
</span>
<span class="nv">BR2_PACKAGE_HOST_LINUX_HEADERS_CUSTOM_6_11</span><span class="o">=</span>y
<span class="c"># ... (other packages remain the same) ...
</span><span class="nv">BR2_PACKAGE_LINUX_TOOLS_CPUPOWER</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_XZ</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_STRACE</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_E2FSPROGS</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_E2FSPROGS_DEBUGFS</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_E2FSPROGS_E2IMAGE</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_E2FSPROGS_E4DEFRAG</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_E2FSPROGS_FUSE2FS</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_E2FSPROGS_RESIZE2FS</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_XORG7</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_XLIB_LIBX11</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_DMIDECODE</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_HWDATA</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_HWDATA_IAB_OUI_TXT</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_HWDATA_PNP_IDS</span><span class="o">=</span>y
<span class="c"># BR2_PACKAGE_HWDATA_USB_IDS is not set
</span><span class="nv">BR2_PACKAGE_INTEL_MICROCODE</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_IPMITOOL</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_IPMITOOL_LANPLUS</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_NVME</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_PARTED</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_SYSSTAT</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_CA_CERTIFICATES</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_LIBOPENSSL_BIN</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_LIBCURL</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_LIBCURL_CURL</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_SLANG</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_BIRD</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_NETCAT_OPENBSD</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_OPENSSH</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_WIREGUARD_TOOLS</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_SUDO</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_TMUX</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_DOCKER_CLI_BUILDX</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_DOCKER_COMPOSE</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_DOCKER_ENGINE</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_DOCKER_ENGINE_DRIVER_BTRFS</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_DOCKER_ENGINE_DRIVER_DEVICEMAPPER</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_DOCKER_ENGINE_DRIVER_VFS</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_EFIBOOTMGR</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_UTIL_LINUX_WIPEFS</span><span class="o">=</span>y

<span class="c"># --- Syslinux Bootloader ---
# Syslinux is enabled here for MBR and EFI.
# If you ONLY boot using the custom sbnb.efi generated by the script,
# you might consider disabling Syslinux to avoid confusion:
# # BR2_TARGET_SYSLINUX is not set
# If Syslinux IS used (e.g., for USB boot), ensure the standard kernel
# command line options above (BR2_KERNEL_CMDLINE_*) are set correctly for it.
</span><span class="nv">BR2_TARGET_SYSLINUX</span><span class="o">=</span>y
<span class="nv">BR2_TARGET_SYSLINUX_MBR</span><span class="o">=</span>y
<span class="nv">BR2_TARGET_SYSLINUX_EFI</span><span class="o">=</span>y

<span class="nv">BR2_PACKAGE_HOST_KMOD_XZ</span><span class="o">=</span>y
<span class="c"># ... (other host packages) ...
</span><span class="nv">BR2_PACKAGE_HOST_PYTHON3</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_HOST_PYTHON3_BZIP2</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_HOST_PYTHON3_XZ</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_HOST_PYTHON3_CURSES</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_HOST_PYTHON3_SSL</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_TAILSCALE</span><span class="o">=</span>y

<span class="c"># --- Root Filesystem / Initramfs Generation ---
</span><span class="nv">BR2_TARGET_ROOTFS_CPIO</span><span class="o">=</span>y
<span class="c"># IMPORTANT: Verify CPIO format needed by create_efi.sh!
# The script uses INITRD="${BINARIES_DIR}/rootfs-sbnb.cpio".
# This implies an UNCOMPRESSED CPIO archive.
# Your original defconfig had BR2_TARGET_ROOTFS_CPIO_XZ=y, which creates
# a compressed file (e.g., rootfs.cpio.xz or rootfs-sbnb.cpio.xz).
#
# ACTION REQUIRED:
# 1. Determine if create_efi.sh truly needs an UNCOMPRESSED CPIO.
# 2. If YES: Use BR2_TARGET_ROOTFS_CPIO_NONE=y below.
# 3. If NO (it needs a compressed CPIO like XZ):
#    a. Change the INITRD variable in create_efi.sh to the correct compressed filename
#       (e.g., INITRD="${BINARIES_DIR}/rootfs-sbnb.cpio.xz").
#    b. Use the corresponding compression option below (e.g., BR2_TARGET_ROOTFS_CPIO_XZ=y).
#
# Assuming UNCOMPRESSED based on script variable:
</span><span class="nv">BR2_TARGET_ROOTFS_CPIO_NONE</span><span class="o">=</span>y
<span class="c"># BR2_TARGET_ROOTFS_CPIO_GZIP is not set
# BR2_TARGET_ROOTFS_CPIO_BZIP2 is not set
# BR2_TARGET_ROOTFS_CPIO_LZMA is not set
# BR2_TARGET_ROOTFS_CPIO_LZO is not set
# BR2_TARGET_ROOTFS_CPIO_LZ4 is not set
# BR2_TARGET_ROOTFS_CPIO_XZ is not set # Make sure this is commented out if using NONE
# BR2_TARGET_ROOTFS_CPIO_ZSTD is not set
# Set the output filename to match the script variable:
</span><span class="nv">BR2_TARGET_ROOTFS_CPIO_FILENAME</span><span class="o">=</span><span class="s2">"rootfs-sbnb.cpio"</span>
<span class="nv">BR2_TARGET_ROOTFS_CPIO_OPTS</span><span class="o">=</span><span class="s2">""</span>
<span class="nv">BR2_TARGET_ROOTFS_CPIO_ARGS</span><span class="o">=</span><span class="s2">""</span>

<span class="c"># ... (rest of packages remain the same) ...
</span><span class="nv">BR2_PACKAGE_SEVCTL</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_SNPGUEST</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_TPM2_TOOLS</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_BUSYBOX_CONFIG_FRAGMENT_FILES</span><span class="o">=</span><span class="s2">"</span><span class="p">$(</span><span class="s2">BR2_EXTERNAL_SBNB_PATH</span><span class="p">)</span><span class="s2">/board/sbnb/sbnb/busybox.fragment"</span>
<span class="nv">BR2_TARGET_ROOTFS_SQUASHFS</span><span class="o">=</span>y
<span class="nv">BR2_TARGET_ROOTFS_SQUASHFS4_XZ</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_OPENVMTOOLS</span><span class="o">=</span>y
<span class="nv">BR2_SHARED_STATIC_LIBS</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_FATRESIZE</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_MOKUTIL</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_TCPDUMP</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_DOSFSTOOLS</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_DOSFSTOOLS_FATLABEL</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_DOSFSTOOLS_FSCK_FAT</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_DOSFSTOOLS_MKFS_FAT</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_PYTHON3</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_PYTHON_PIP</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_PYTHON3_ZLIB</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_PYTHON_REQUESTS</span><span class="o">=</span>y
<span class="nv">BR2_PACKAGE_JQ</span><span class="o">=</span>y

</code></section></div></div>

<p><strong>3. Explanation of Changes and Important Considerations:</strong></p>

<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">create_efi.sh</code>:</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">nomodeset</code> was added to the <code class="language-plaintext highlighter-rouge">CMDLINE</code> variable.</li>
      <li>A check was added to ensure input files exist before <code class="language-plaintext highlighter-rouge">objcopy</code> runs.</li>
      <li>A comment was added regarding the <code class="language-plaintext highlighter-rouge">INITRD</code> variable path – <strong>you must verify</strong> if your script needs a compressed (e.g., <code class="language-plaintext highlighter-rouge">.xz</code>) or uncompressed CPIO file and adjust the <code class="language-plaintext highlighter-rouge">INITRD</code> variable in the script and the CPIO settings in the defconfig accordingly.</li>
      <li>A note was added about the <code class="language-plaintext highlighter-rouge">splash_offs</code> variable, which seems calculated but unused in the <code class="language-plaintext highlighter-rouge">objcopy</code> command of the original script. You may want to investigate this.</li>
      <li>The <code class="language-plaintext highlighter-rouge">rm</code> command ensures the temporary command line file is deleted.</li>
      <li>The <code class="language-plaintext highlighter-rouge">mv</code> command ensures the final <code class="language-plaintext highlighter-rouge">sbnb.efi</code> is placed in <code class="language-plaintext highlighter-rouge">output/images/</code>.</li>
    </ul>
  </li>
  <li><strong><code class="language-plaintext highlighter-rouge">sbnb_defconfig</code>:</strong>
    <ul>
      <li><strong>CPIO Configuration:</strong> This is the most critical part to verify. The configuration is set up assuming the script needs an <em>uncompressed</em> CPIO named <code class="language-plaintext highlighter-rouge">rootfs-sbnb.cpio</code>, based on the script’s <code class="language-plaintext highlighter-rouge">INITRD</code> variable. If your original <code class="language-plaintext highlighter-rouge">BR2_TARGET_ROOTFS_CPIO_XZ=y</code> setting was intentional and the script <em>should</em> use a compressed initrd, you need to:
        <ol>
          <li>Change <code class="language-plaintext highlighter-rouge">INITRD</code> in the script (e.g., <code class="language-plaintext highlighter-rouge">INITRD="${BINARIES_DIR}/rootfs-sbnb.cpio.xz"</code>).</li>
          <li>Change the defconfig back to <code class="language-plaintext highlighter-rouge">BR2_TARGET_ROOTFS_CPIO_XZ=y</code> (and comment out <code class="language-plaintext highlighter-rouge">BR2_TARGET_ROOTFS_CPIO_NONE=y</code>).</li>
          <li>Ensure <code class="language-plaintext highlighter-rouge">BR2_TARGET_ROOTFS_CPIO_FILENAME</code> results in the correct name if needed (it might default correctly if compression is enabled).</li>
        </ol>
      </li>
      <li><strong>Kernel Command Line:</strong> Comments explicitly state that <code class="language-plaintext highlighter-rouge">BR2_KERNEL_CMDLINE_*</code> options are ignored by the script but <em>are</em> relevant for Syslinux. You need to decide:
        <ul>
          <li>If Syslinux is used: Configure <code class="language-plaintext highlighter-rouge">BR2_KERNEL_CMDLINE_*</code> appropriately for it.</li>
          <li>If Syslinux is NOT used: Consider disabling <code class="language-plaintext highlighter-rouge">BR2_TARGET_SYSLINUX*</code> options to avoid confusion.</li>
        </ul>
      </li>
      <li><strong>Comments:</strong> Added comments to explain the hardcoded command line, the CPIO verification need, and the Syslinux interaction.</li>
    </ul>
  </li>
</ul>

<p><strong>4. Next Steps:</strong></p>

<ol>
  <li><strong>Verify CPIO Requirement:</strong> Determine the exact initramfs file (compressed or uncompressed, exact name) that <code class="language-plaintext highlighter-rouge">create_efi.sh</code> is intended to embed.</li>
  <li><strong>Apply Changes:</strong> Replace your existing files with these refactored versions, making sure the CPIO settings in <em>both</em> the script (<code class="language-plaintext highlighter-rouge">INITRD</code> variable) and the defconfig (<code class="language-plaintext highlighter-rouge">BR2_TARGET_ROOTFS_CPIO_*</code>) are consistent with your verified requirement. Adjust Syslinux settings as needed.</li>
  <li><strong>Rebuild:</strong> Navigate to your Buildroot top-level directory and run <code class="language-plaintext highlighter-rouge">make</code>. This will rebuild the necessary components and execute the post-image script.</li>
  <li><strong>Deploy:</strong> Use the updated <code class="language-plaintext highlighter-rouge">output/images/sbnb.efi</code> file to boot your GMKtec G5.</li>
  <li><strong>Verify:</strong> After booting, log in and run <code class="language-plaintext highlighter-rouge">cat /proc/cmdline</code> to confirm that <code class="language-plaintext highlighter-rouge">nomodeset</code> is present in the kernel command line arguments.</li>
</ol>

<p><strong>5. Further Considerations / Alternatives:</strong></p>

<ul>
  <li><strong>Reading Command Line from Buildroot:</strong> Instead of hardcoding the command line in <code class="language-plaintext highlighter-rouge">create_efi.sh</code>, a more robust approach would be to modify the script to read the command line configured via Buildroot’s <code class="language-plaintext highlighter-rouge">BR2_KERNEL_CMDLINE_*</code> options. This could involve reading the generated bootloader config file (like <code class="language-plaintext highlighter-rouge">syslinux.cfg</code>) or having Buildroot write the command line to a temporary file that the script reads. This makes configuration more centralized but requires more significant script changes.</li>
  <li><strong>Script Robustness:</strong> The provided <code class="language-plaintext highlighter-rouge">create_efi.sh</code> could benefit from more robust error checking (e.g., verifying <code class="language-plaintext highlighter-rouge">objcopy</code> success).</li>
</ul>

<p>By applying these changes and carefully verifying the CPIO configuration, you should successfully embed the <code class="language-plaintext highlighter-rouge">nomodeset</code> parameter into your custom EFI boot process.</p><hr />
  <h1 id="second-approach">
    
    
     <a href="#second-approach">#</a><a href="#" aria-label="Back to top">second approach</a>
        
    
  </h1>
      

<p>Okay, let’s refine the approach for adding the <code class="language-plaintext highlighter-rouge">nomodeset</code> kernel parameter to your Buildroot OS image, specifically addressing the interaction between your <code class="language-plaintext highlighter-rouge">sbnb_defconfig</code> and the custom <code class="language-plaintext highlighter-rouge">create_efi.sh</code> script.</p>

<p><strong>Understanding the Context</strong></p>

<p>Your setup uses a custom post-image script (<code class="language-plaintext highlighter-rouge">board/sbnb/sbnb/scripts/create_efi.sh</code>) to generate a unified EFI executable (<code class="language-plaintext highlighter-rouge">sbnb.efi</code>). The critical point is that, in its original form, this script <strong>hardcodes the kernel command line arguments</strong> within the script itself. This bypasses Buildroot’s standard mechanism for managing kernel parameters via the <code class="language-plaintext highlighter-rouge">BR2_CMDLINE</code> variable (or older <code class="language-plaintext highlighter-rouge">BR2_KERNEL_CMDLINE_*</code> options) in the configuration (<code class="language-plaintext highlighter-rouge">defconfig</code>).</p>

<p>Therefore, simply setting <code class="language-plaintext highlighter-rouge">BR2_CMDLINE</code> in your <code class="language-plaintext highlighter-rouge">sbnb_defconfig</code> will <em>not</em> affect the <code class="language-plaintext highlighter-rouge">sbnb.efi</code> file generated by the original script.</p>

<p>We need to modify the system so that <code class="language-plaintext highlighter-rouge">nomodeset</code> is included in the command line embedded within <code class="language-plaintext highlighter-rouge">sbnb.efi</code>. There are two main ways to achieve this:</p>

<ol>
  <li><strong>Solution A (Quick Fix):</strong> Modify the script to include <code class="language-plaintext highlighter-rouge">nomodeset</code> in its hardcoded command line string. This is simpler but less maintainable.</li>
  <li><strong>Solution B (Recommended):</strong> Modify the script to <em>read</em> the command line from the Buildroot environment variable <code class="language-plaintext highlighter-rouge">BR2_CMDLINE</code> and define <code class="language-plaintext highlighter-rouge">BR2_CMDLINE</code> in your <code class="language-plaintext highlighter-rouge">sbnb_defconfig</code>. This aligns with standard Buildroot practices and centralizes configuration.</li>
</ol>

<p>We will also ensure the Buildroot configuration correctly generates the CPIO root filesystem expected by the script.</p>

<p><strong>Rationale Recap:</strong> The <code class="language-plaintext highlighter-rouge">nomodeset</code> parameter is being added as a troubleshooting step. It tells the kernel <em>not</em> to load video drivers and attempt display mode changes during initialization. This can prevent hangs or slowdowns caused by graphics driver issues on certain hardware, like the slow console output you observed.</p><hr />

<p><strong>Solution A: Modify Hardcoded Command Line in Script (Quick Fix)</strong></p>

<p>This approach directly edits the <code class="language-plaintext highlighter-rouge">CMDLINE</code> variable within <code class="language-plaintext highlighter-rouge">create_efi.sh</code>.</p>

<p><strong>1. Modify <code class="language-plaintext highlighter-rouge">board/sbnb/sbnb/scripts/create_efi.sh</code>:</strong></p>

<div class="language-diff highlighter-rouge"><div class="highlight"><section><code><span class="gd">--- a/board/sbnb/sbnb/scripts/create_efi.sh
</span><span class="gi">+++ b/board/sbnb/sbnb/scripts/create_efi.sh
</span><span class="p">@@ -10,8 +10,10 @@</span>
 KERNEL="${BINARIES_DIR}/bzImage"
 INITRD="${BINARIES_DIR}/rootfs-sbnb.cpio"
 OS_RELEASE="${TARGET_DIR}/etc/os-release"
<span class="gd">-CMDLINE="console=tty0 console=ttyS0 earlyprintk verbose intel_iommu=on module_blacklist=nouveau,nvidiafb,snd_hda_intel dyndbg=\"module firmware_class +p; module microcode +p; module ccp +p\""
</span><span class="gi">+# --- MODIFIED KERNEL COMMAND LINE (Hardcoded) ---
+# Added 'nomodeset'. Note: This bypasses standard Buildroot BR2_CMDLINE config.
+CMDLINE="console=tty0 console=ttyS0 earlyprintk verbose intel_iommu=on module_blacklist=nouveau,nvidiafb,snd_hda_intel dyndbg=\"module firmware_class +p; module microcode +p; module ccp +p\" nomodeset"
+# --- END MODIFICATION ---
</span> CMDLINE_TMP=$(mktemp)
 OUTPUT=sbnb.efi
<span class="err">
</span><span class="p">@@ -41,8 +43,13 @@</span>
     --add-section .initrd="${INITRD}" --change-section-vma .initrd=$(printf 0x%x $initrd_offs) \
     "${STUB}" "${OUTPUT}"
<span class="err">
</span><span class="gi">+# Clean up temporary file
+rm -f "${CMDLINE_TMP}"
+
</span> # Output the result
 echo "Output: ${OUTPUT}"
<span class="gi">+
+# Move the final EFI file to the standard Buildroot images directory (BINARIES_DIR=output/images)
+mv "${OUTPUT}" "${BINARIES_DIR}/"
+echo "Moved ${OUTPUT} to ${BINARIES_DIR}/"
</span><span class="err">
</span></code></section></div></div>

<ul>
  <li><strong>Change:</strong> Added <code class="language-plaintext highlighter-rouge">nomodeset</code> to the end of the <code class="language-plaintext highlighter-rouge">CMDLINE</code> variable string.</li>
  <li><strong>Added:</strong> Cleanup for the temporary file (<code class="language-plaintext highlighter-rouge">rm -f "${CMDLINE_TMP}"</code>).</li>
  <li><strong>Added:</strong> <code class="language-plaintext highlighter-rouge">mv "${OUTPUT}" "${BINARIES_DIR}/"</code> to place the final artifact in the correct Buildroot output directory (<code class="language-plaintext highlighter-rouge">output/images</code>). Buildroot provides <code class="language-plaintext highlighter-rouge">BINARIES_DIR</code> in the environment when running post-image scripts.</li>
</ul>

<p><strong>2. Modify <code class="language-plaintext highlighter-rouge">configs/sbnb_defconfig</code> (CPIO Settings &amp; Comments):</strong></p>

<p>Ensure the CPIO settings match what the script expects (<code class="language-plaintext highlighter-rouge">rootfs-sbnb.cpio</code>, likely uncompressed). Add comments clarifying the hardcoded nature.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><section><code><span class="gd">--- a/configs/sbnb_defconfig
</span><span class="gi">+++ b/configs/sbnb_defconfig
</span><span class="p">@@ -8,9 +8,10 @@</span>
 BR2_ROOTFS_OVERLAY="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/rootfs-overlay"
 BR2_ROOTFS_PRE_BUILD_SCRIPT="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/pre_build.sh"
 BR2_ROOTFS_POST_BUILD_SCRIPT="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/post_build.sh"
<span class="gi">+# This post-image script creates a unified EFI executable (sbnb.efi)
+# IMPORTANT: With Solution A, the kernel command line is HARDCODED inside create_efi.sh
+# Standard BR2_CMDLINE options will NOT affect sbnb.efi in this case.
</span> BR2_ROOTFS_POST_IMAGE_SCRIPT="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/scripts/create_efi.sh"
<span class="gd">-BR2_LINUX_KERNEL_GZIP=y
</span> BR2_LINUX_KERNEL=y
 BR2_LINUX_KERNEL_USE_CUSTOM_CONFIG=y
 # Switch back to upstream kernel once Restricted Injection hypervisor support
<span class="p">@@ -20,6 +21,7 @@</span>
 BR2_LINUX_KERNEL_CUSTOM_REPO_VERSION="svsm"
 BR2_LINUX_KERNEL_CUSTOM_CONFIG_FILE="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/kernel-config"
 BR2_LINUX_KERNEL_CONFIG_FRAGMENT_FILES="kernel-config-firmware"
<span class="gi">+# BR2_CMDLINE is not set here as it's bypassed by the script in Solution A
</span> BR2_LINUX_KERNEL_NEEDS_HOST_LIBELF=y
 BR2_PACKAGE_HOST_LINUX_HEADERS_CUSTOM_6_11=y
 BR2_PACKAGE_LINUX_TOOLS_CPUPOWER=y
<span class="p">@@ -75,14 +77,11 @@</span>
 BR2_PACKAGE_HOST_PYTHON3_CURSES=y
 BR2_PACKAGE_HOST_PYTHON3_SSL=y
 BR2_PACKAGE_TAILSCALE=y
<span class="gi">+# Configure CPIO rootfs generation to match the script's expectation
</span> BR2_TARGET_ROOTFS_CPIO=y
<span class="gd">-# BR2_TARGET_ROOTFS_CPIO_XZ is not set
-BR2_PACKAGE_SEVCTL=y
-BR2_PACKAGE_SNPGUEST=y
-BR2_PACKAGE_TPM2_TOOLS=y
-BR2_PACKAGE_BUSYBOX_CONFIG_FRAGMENT_FILES="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/busybox.fragment"
-BR2_TARGET_ROOTFS_SQUASHFS=y
-BR2_TARGET_ROOTFS_SQUASHFS4_XZ=y
</span><span class="gi">+# Ensure CPIO is not compressed as the script uses the base name 'rootfs-sbnb.cpio'
+BR2_TARGET_ROOTFS_CPIO_NONE=y
+BR2_TARGET_ROOTFS_CPIO_FILENAME="rootfs-sbnb.cpio"
</span> BR2_PACKAGE_OPENVMTOOLS=y
 BR2_SHARED_STATIC_LIBS=y
 BR2_PACKAGE_FATRESIZE=y
<span class="p">@@ -97,4 +96,10 @@</span>
 BR2_PACKAGE_PYTHON3_ZLIB=y
 BR2_PACKAGE_PYTHON_REQUESTS=y
 BR2_PACKAGE_JQ=y
<span class="gi">+BR2_PACKAGE_SEVCTL=y
+BR2_PACKAGE_SNPGUEST=y
+BR2_PACKAGE_TPM2_TOOLS=y
+BR2_PACKAGE_BUSYBOX_CONFIG_FRAGMENT_FILES="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/busybox.fragment"
+BR2_TARGET_ROOTFS_SQUASHFS=y
+BR2_TARGET_ROOTFS_SQUASHFS4_XZ=y
</span><span class="err">
</span></code></section></div></div>

<ul>
  <li><strong>Changes:</strong> Added comments about the hardcoded command line. Explicitly set <code class="language-plaintext highlighter-rouge">BR2_TARGET_ROOTFS_CPIO_NONE=y</code> and <code class="language-plaintext highlighter-rouge">BR2_TARGET_ROOTFS_CPIO_FILENAME="rootfs-sbnb.cpio"</code> to ensure the correct, uncompressed CPIO file is generated for the script. Removed <code class="language-plaintext highlighter-rouge">BR2_LINUX_KERNEL_GZIP=y</code> as the script uses <code class="language-plaintext highlighter-rouge">bzImage</code>, implying bzip2 compression (which is the default for x86/x86_64 <code class="language-plaintext highlighter-rouge">bzImage</code> anyway, Buildroot handles this).</li>
</ul>

<p><strong>Drawbacks of Solution A:</strong></p>
<ul>
  <li>Kernel command line configuration is hidden within a script, not in the central Buildroot configuration.</li>
  <li>Harder to maintain and modify parameters later.</li>
</ul><hr />

<p><strong>Solution B: Integrate Script with Buildroot <code class="language-plaintext highlighter-rouge">BR2_CMDLINE</code> (Recommended)</strong></p>

<p>This approach modifies the script to use the standard <code class="language-plaintext highlighter-rouge">BR2_CMDLINE</code> variable defined in the defconfig. This is the preferred method for better integration and maintainability.</p>

<p><strong>1. Modify <code class="language-plaintext highlighter-rouge">board/sbnb/sbnb/scripts/create_efi.sh</code>:</strong></p>

<div class="language-diff highlighter-rouge"><div class="highlight"><section><code><span class="gd">--- a/board/sbnb/sbnb/scripts/create_efi.sh
</span><span class="gi">+++ b/board/sbnb/sbnb/scripts/create_efi.sh
</span><span class="p">@@ -10,8 +10,10 @@</span>
 KERNEL="${BINARIES_DIR}/bzImage"
 INITRD="${BINARIES_DIR}/rootfs-sbnb.cpio"
 OS_RELEASE="${TARGET_DIR}/etc/os-release"
<span class="gd">-CMDLINE="console=tty0 console=ttyS0 earlyprintk verbose intel_iommu=on module_blacklist=nouveau,nvidiafb,snd_hda_intel dyndbg=\"module firmware_class +p; module microcode +p; module ccp +p\""
</span><span class="gi">+# --- MODIFIED KERNEL COMMAND LINE (Read from Buildroot Env) ---
+# Read command line from BR2_CMDLINE environment variable provided by Buildroot.
+CMDLINE="${BR2_CMDLINE:?Error: BR2_CMDLINE environment variable not set or empty. Check Buildroot kernel configuration (BR2_CMDLINE).}"
+# --- END MODIFICATION ---
</span> CMDLINE_TMP=$(mktemp)
 OUTPUT=sbnb.efi
<span class="err">
</span><span class="p">@@ -41,8 +43,13 @@</span>
     --add-section .initrd="${INITRD}" --change-section-vma .initrd=$(printf 0x%x $initrd_offs) \
     "${STUB}" "${OUTPUT}"
<span class="err">
</span><span class="gi">+# Clean up temporary file
+rm -f "${CMDLINE_TMP}"
+
</span> # Output the result
 echo "Output: ${OUTPUT}"
<span class="gi">+
+# Move the final EFI file to the standard Buildroot images directory (BINARIES_DIR=output/images)
+mv "${OUTPUT}" "${BINARIES_DIR}/"
+echo "Moved ${OUTPUT} to ${BINARIES_DIR}/"
</span><span class="err">
</span></code></section></div></div>

<ul>
  <li><strong>Change:</strong> Replaced the hardcoded <code class="language-plaintext highlighter-rouge">CMDLINE</code> variable with <code class="language-plaintext highlighter-rouge">CMDLINE="${BR2_CMDLINE:?...}"</code>. This reads the command line string from the <code class="language-plaintext highlighter-rouge">BR2_CMDLINE</code> environment variable, which Buildroot sets based on the defconfig. The <code class="language-plaintext highlighter-rouge">:?Error...</code> part ensures the script fails if <code class="language-plaintext highlighter-rouge">BR2_CMDLINE</code> isn’t properly set in the configuration, preventing silent errors.</li>
  <li><strong>Added:</strong> Cleanup and <code class="language-plaintext highlighter-rouge">mv</code> command as in Solution A.</li>
</ul>

<p><strong>2. Modify <code class="language-plaintext highlighter-rouge">configs/sbnb_defconfig</code>:</strong></p>

<p>Define <code class="language-plaintext highlighter-rouge">BR2_CMDLINE</code> with all required parameters, including <code class="language-plaintext highlighter-rouge">nomodeset</code>. Also ensure CPIO settings are correct.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><section><code><span class="gd">--- a/configs/sbnb_defconfig
</span><span class="gi">+++ b/configs/sbnb_defconfig
</span><span class="p">@@ -8,9 +8,9 @@</span>
 BR2_ROOTFS_OVERLAY="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/rootfs-overlay"
 BR2_ROOTFS_PRE_BUILD_SCRIPT="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/pre_build.sh"
 BR2_ROOTFS_POST_BUILD_SCRIPT="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/post_build.sh"
<span class="gd">-# This post-image script creates a unified EFI executable (sbnb.efi)
-# IMPORTANT: The kernel command line is HARDCODED inside create_efi.sh
-# Standard BR2_KERNEL_CMDLINE_* options will NOT affect sbnb.efi
</span><span class="gi">+# This post-image script creates a unified EFI executable (sbnb.efi).
+# With Solution B, the script reads the command line from BR2_CMDLINE below.
</span> BR2_ROOTFS_POST_IMAGE_SCRIPT="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/scripts/create_efi.sh"
<span class="gd">-BR2_LINUX_KERNEL_GZIP=y
</span> BR2_LINUX_KERNEL=y
 BR2_LINUX_KERNEL_USE_CUSTOM_CONFIG=y
 # Switch back to upstream kernel once Restricted Injection hypervisor support
<span class="p">@@ -20,6 +20,8 @@</span>
 BR2_LINUX_KERNEL_CUSTOM_REPO_VERSION="svsm"
 BR2_LINUX_KERNEL_CUSTOM_CONFIG_FILE="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/kernel-config"
 BR2_LINUX_KERNEL_CONFIG_FRAGMENT_FILES="kernel-config-firmware"
<span class="gi">+# Define the kernel command line arguments (used by create_efi.sh in Solution B)
+BR2_CMDLINE="console=tty0 console=ttyS0 earlyprintk verbose intel_iommu=on module_blacklist=nouveau,nvidiafb,snd_hda_intel dyndbg=\"module firmware_class +p; module microcode +p; module ccp +p\" nomodeset"
</span> BR2_LINUX_KERNEL_NEEDS_HOST_LIBELF=y
 BR2_PACKAGE_HOST_LINUX_HEADERS_CUSTOM_6_11=y
 BR2_PACKAGE_LINUX_TOOLS_CPUPOWER=y
<span class="p">@@ -75,14 +77,11 @@</span>
 BR2_PACKAGE_HOST_PYTHON3_CURSES=y
 BR2_PACKAGE_HOST_PYTHON3_SSL=y
 BR2_PACKAGE_TAILSCALE=y
<span class="gi">+# Configure CPIO rootfs generation to match the script's expectation
</span> BR2_TARGET_ROOTFS_CPIO=y
<span class="gd">-# BR2_TARGET_ROOTFS_CPIO_XZ is not set
-BR2_PACKAGE_SEVCTL=y
-BR2_PACKAGE_SNPGUEST=y
-BR2_PACKAGE_TPM2_TOOLS=y
-BR2_PACKAGE_BUSYBOX_CONFIG_FRAGMENT_FILES="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/busybox.fragment"
-BR2_TARGET_ROOTFS_SQUASHFS=y
-BR2_TARGET_ROOTFS_SQUASHFS4_XZ=y
</span><span class="gi">+# Ensure CPIO is not compressed as the script uses the base name 'rootfs-sbnb.cpio'
+BR2_TARGET_ROOTFS_CPIO_NONE=y
+BR2_TARGET_ROOTFS_CPIO_FILENAME="rootfs-sbnb.cpio"
</span> BR2_PACKAGE_OPENVMTOOLS=y
 BR2_SHARED_STATIC_LIBS=y
 BR2_PACKAGE_FATRESIZE=y
<span class="p">@@ -97,4 +96,10 @@</span>
 BR2_PACKAGE_PYTHON3_ZLIB=y
 BR2_PACKAGE_PYTHON_REQUESTS=y
 BR2_PACKAGE_JQ=y
<span class="gi">+BR2_PACKAGE_SEVCTL=y
+BR2_PACKAGE_SNPGUEST=y
+BR2_PACKAGE_TPM2_TOOLS=y
+BR2_PACKAGE_BUSYBOX_CONFIG_FRAGMENT_FILES="$(BR2_EXTERNAL_SBNB_PATH)/board/sbnb/sbnb/busybox.fragment"
+BR2_TARGET_ROOTFS_SQUASHFS=y
+BR2_TARGET_ROOTFS_SQUASHFS4_XZ=y
</span><span class="err">
</span></code></section></div></div>

<ul>
  <li><strong>Changes:</strong> Added the <code class="language-plaintext highlighter-rouge">BR2_CMDLINE</code> definition containing the full command string including <code class="language-plaintext highlighter-rouge">nomodeset</code>. Adjusted comments. Ensured CPIO settings are correct (same as Solution A). Removed <code class="language-plaintext highlighter-rouge">BR2_LINUX_KERNEL_GZIP=y</code> (same reason as Solution A).</li>
</ul>

<p><strong>Benefits of Solution B:</strong></p>
<ul>
  <li>Centralizes kernel command line configuration in the standard Buildroot <code class="language-plaintext highlighter-rouge">defconfig</code>.</li>
  <li>Easier to manage and modify parameters using <code class="language-plaintext highlighter-rouge">make menuconfig</code> (under <code class="language-plaintext highlighter-rouge">Kernel -&gt; Kernel command line string</code>).</li>
  <li>Aligns with standard Buildroot practices.</li>
</ul><hr />

<p><strong>Next Steps (Apply either Solution A or B):</strong></p>

<ol>
  <li><strong>Apply Changes:</strong> Replace the content of your existing <code class="language-plaintext highlighter-rouge">board/sbnb/sbnb/scripts/create_efi.sh</code> and <code class="language-plaintext highlighter-rouge">configs/sbnb_defconfig</code> with the versions from your chosen solution (Solution B is recommended).</li>
  <li><strong>Rebuild:</strong> Navigate to your Buildroot top-level directory in the terminal and run:
    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code>make
</code></section></div>    </div>
    <p>Buildroot will rebuild the necessary components and execute the post-image script, generating a new <code class="language-plaintext highlighter-rouge">output/images/sbnb.efi</code>.</p>
  </li>
  <li><strong>Deploy:</strong> Copy the updated <code class="language-plaintext highlighter-rouge">output/images/sbnb.efi</code> to your target system’s EFI System Partition (ESP).</li>
  <li><strong>Boot:</strong> Boot your GMKtec G5 from the updated EFI file.</li>
  <li><strong>Verify:</strong> Once the system has booted (even if slowly), log in to a console and run the following command to check if <code class="language-plaintext highlighter-rouge">nomodeset</code> was actually passed to the kernel:
    <div class="language-bash highlighter-rouge"><div class="highlight"><section><code><span class="nb">cat</span> /proc/cmdline
</code></section></div>    </div>
    <p>Look for <code class="language-plaintext highlighter-rouge">nomodeset</code> within the output string.</p>
  </li>
</ol>

<p><strong>Long-Term Alternative:</strong></p>

<p>While outside the scope of simply adding <code class="language-plaintext highlighter-rouge">nomodeset</code>, you might eventually consider whether the custom <code class="language-plaintext highlighter-rouge">create_efi.sh</code> script is strictly necessary. Buildroot has built-in support for generating bootable images using standard bootloaders like GRUB2 or syslinux, which handle kernel parameters through their own configuration files managed by Buildroot based on <code class="language-plaintext highlighter-rouge">BR2_CMDLINE</code>. Migrating to a standard bootloader setup could simplify your build process further, but would require more significant changes.</p>

        </div>
        
          URL: https://ib.bsb.br/sbnb-buildroot-intel-n97-fix
        
      </article>
      <nav class="post-navigation-combined" aria-label="Post navigation">
        <!-- Chronological Navigation (always visible at 40vh) -->
        
          <div class="nav-arrow chronological prev">
            <a href="/liveraizo-sbnb/" title="Live Raizo OS as a hypervisor to run the `sbnb.vhd` VM" rel="prev">
              <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAxVJREFUaEPt18FqG1cUBuD/nLkzI42UiVInkFLTCAKhS+9KA+3Kq1L8AAHjhR7AKz+ADV55qUfoqhvThTfdmC4KzTKmYJrELshJW9PIlSeKRpqZe88pUtouihvVRknqMNoMzD1zdPXNrzMM4RJ+6BLuGeWm39RdK6VL6VcIlPEo41HG401loJQupS8mUM7pi7md/6p3UtoHUJzf4vVecZb0e0EQfB7H8b0kSeqqummt/eb1buN83SebNsZ8QkQCYHVpaenu/v7+ra2tLRwdHWF1ddWq6hfM3BCRE2b+FcBHACQAHo1E5v9c+5mIhkR0e3z0VQ8LotuqWlXVw/GRmT8QkdMK89McuAOAAfwoIu8z85yIHBPRKRGN1/IAeDx0rul53hivo6psrf2ejDGfEtFOu92u7O3tBWtra2i322g0GhgOh9je3ka325UPax7fCR0iw+lp4aLxr70aeOmgkChTRY3JGSb73EroERD73uB54WpOgdhwZkXNQNQLiVDzOU1yFymAhu+lqZVopIqISQKmPLFS+atHv3A1q8AVQ+lXP/VHRPQx+b6frKysxMvLy1hfX0ez2USv18PCwgLiOEaSJKhWq/jhwQN8dnIfVOS4dsWHqCJ5YREGjBuNEMfd0eTc9WshBqnFYGhRqxrUIoNuLwMT4eb1Cp6dZshywdW6mZzr9QsEPuPmXIhfno3gnGKuEWCUC14MLKoVb1L72+8Zvj3JOl/udZt/S7darUqn0wlarRZ2d3cxPz+PJ8dPsPP1Doq8kIbL+cawjxBIM8MRFAidpBlRpIbhFc55gM2NF5IIQtVBRlRTZgTWZQ4wzvc8spO1NPM4Gr9Wh1bSDIjU98C5E0PIC8OVSX+Rlz08hl+4/LsML6X/menFxcW7BwcHtzY2NvDw8CE21zf/NdMAHskFMs3MT/EfMg3gsTsr02f8byfTo16v3+v3+//f6fGKgXNp5vT5huZbqH4nH+NvwXH6V5bS041mU1FKz8ZxepdSerrRbCpK6dk4Tu9SSk83mk1FKT0bx+ldSunpRrOpuJTSfwBcuImxpyA7XgAAAABJRU5ErkJggg==" alt="Previous article" width="45" height="45" loading="lazy">
            </a>
          </div>
        
        
          <div class="nav-arrow chronological next">
            <a href="/how-to-integrate-wifi-support-into-the-sbnb-bridge-based-networking-setup/" title="How to integrate WiFi support into the SBNB bridge-based networking setup" rel="next">
              <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAwdJREFUaEPtl01rG1cUht9z7p070ijKWLVS3I9YULtNMBRn2UIXxZtuvCjedNWfoKVXBvsHeOUfoIUx5AeY0pVXXSR052UxBJSi0kDiRplII83HvadI9CMtOFjCmBjubC7cc8+Zc555eYdLuIEP3cCe4Zu+rq/mSXvSbyHg5eHl4eVxXRrwpD3p+Qh4n56P2+xZnvTszC7MCAAUF0XfOdJa62+IaCeO40GSJA/zPP8RwB9vDjBtWmv9JRE5ImpZawdVpbo58CkAIyJnIrLAzEvOuXNm/h3AfQDOAGdj5z5m5gXn3G9ENCKilckaiDwpiFZEpCoiTyYrM3/knOtXmHs58BkABvCLc+4DZl6cxIjoh4ODA728vIzt7W2sra09PT4+fgTgQES4LMvHZIy5LyI/f/dJvfK6FKMJqAdqmBS2ZgWINY9zJyZ1whUiRJrTfmGjybSxUemwcFEmghqT1UxlUrpQEXD7jRq3NWelEz10okIi1AJOX+U2EgALgUrT0kVnmcKvQ+uazSZvbW2hWq2i3++j3W5jf38f6+vrebvdHovI5pT09+vN7teLYev990K8GpQYjS1u1TQqhnHez6EU4cM7FTw7z5AXDo16ACcyPRsaxp2FEM9ejKd7zUaIYVpiOCpRq2rUIo0XLzMwEZaaFTzvZ8hyh/iWnu69fF1AAoOfFr/A5w8eYDQaIY5jJEmC09NTNBoNdLtd7O3t4ejoCIeHh8k/pL8KUSkCZcg6hCLDjLk2ufYGpRuXAuOMYiosQiDNNEcQILQuzYgi0QxVWKuAMtcqJPdXDaKaMMOUNrOAtoFSVE5jaaY4mtQPS5dmQPS8WkdfGReYgDe/3cTdpbvo9XrY2NhAp9NBq9XKO53Ov6T/r2mlVBeX0DSAMzeHppm5h7doemdvR99buYfd3V2srq4+PTk5+a+mr9CmrqTU3+5Rr9cHg8HgYve4krddbZGb5dOXmf2d+7n4pi9D4LrOeHl40v42fl0a8KQ96fkIeJ+ej9vsWZ707Mzmy/Ck5+M2e9afhmuAz1BhwewAAAAASUVORK5CYII=" alt="Next article" width="45" height="45" loading="lazy">
            </a>
          </div>
        
            
            
              
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  
                  
              
              
              
              <!-- Navigation block for tag "scratchpad"; default display for the first tag -->
              <div class="nav-group tags" id="tag-nav-scratchpad" style="display: block;">
                <div class="nav-arrow tags prev">
                  
                    <a href="/4-node-nethserver-8-homelab/" title="4-node NethServer 8 homelab" rel="prev">
                      <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAxVJREFUaEPt18FqG1cUBuD/nLkzI42UiVInkFLTCAKhS+9KA+3Kq1L8AAHjhR7AKz+ADV55qUfoqhvThTfdmC4KzTKmYJrELshJW9PIlSeKRpqZe88pUtouihvVRknqMNoMzD1zdPXNrzMM4RJ+6BLuGeWm39RdK6VL6VcIlPEo41HG401loJQupS8mUM7pi7md/6p3UtoHUJzf4vVecZb0e0EQfB7H8b0kSeqqummt/eb1buN83SebNsZ8QkQCYHVpaenu/v7+ra2tLRwdHWF1ddWq6hfM3BCRE2b+FcBHACQAHo1E5v9c+5mIhkR0e3z0VQ8LotuqWlXVw/GRmT8QkdMK89McuAOAAfwoIu8z85yIHBPRKRGN1/IAeDx0rul53hivo6psrf2ejDGfEtFOu92u7O3tBWtra2i322g0GhgOh9je3ka325UPax7fCR0iw+lp4aLxr70aeOmgkChTRY3JGSb73EroERD73uB54WpOgdhwZkXNQNQLiVDzOU1yFymAhu+lqZVopIqISQKmPLFS+atHv3A1q8AVQ+lXP/VHRPQx+b6frKysxMvLy1hfX0ez2USv18PCwgLiOEaSJKhWq/jhwQN8dnIfVOS4dsWHqCJ5YREGjBuNEMfd0eTc9WshBqnFYGhRqxrUIoNuLwMT4eb1Cp6dZshywdW6mZzr9QsEPuPmXIhfno3gnGKuEWCUC14MLKoVb1L72+8Zvj3JOl/udZt/S7darUqn0wlarRZ2d3cxPz+PJ8dPsPP1Doq8kIbL+cawjxBIM8MRFAidpBlRpIbhFc55gM2NF5IIQtVBRlRTZgTWZQ4wzvc8spO1NPM4Gr9Wh1bSDIjU98C5E0PIC8OVSX+Rlz08hl+4/LsML6X/menFxcW7BwcHtzY2NvDw8CE21zf/NdMAHskFMs3MT/EfMg3gsTsr02f8byfTo16v3+v3+//f6fGKgXNp5vT5huZbqH4nH+NvwXH6V5bS041mU1FKz8ZxepdSerrRbCpK6dk4Tu9SSk83mk1FKT0bx+ldSunpRrOpuJTSfwBcuImxpyA7XgAAAABJRU5ErkJggg==" alt="Previous in Tag" width="45" height="45" loading="lazy">
                    </a>
                  
                </div>
                <div class="nav-arrow tags next">
                  
                    <a href="/liveraizo-sbnb/" title="Live Raizo OS as a hypervisor to run the `sbnb.vhd` VM" rel="next">
                      <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAwdJREFUaEPtl01rG1cUht9z7p070ijKWLVS3I9YULtNMBRn2UIXxZtuvCjedNWfoKVXBvsHeOUfoIUx5AeY0pVXXSR052UxBJSi0kDiRplII83HvadI9CMtOFjCmBjubC7cc8+Zc555eYdLuIEP3cCe4Zu+rq/mSXvSbyHg5eHl4eVxXRrwpD3p+Qh4n56P2+xZnvTszC7MCAAUF0XfOdJa62+IaCeO40GSJA/zPP8RwB9vDjBtWmv9JRE5ImpZawdVpbo58CkAIyJnIrLAzEvOuXNm/h3AfQDOAGdj5z5m5gXn3G9ENCKilckaiDwpiFZEpCoiTyYrM3/knOtXmHs58BkABvCLc+4DZl6cxIjoh4ODA728vIzt7W2sra09PT4+fgTgQES4LMvHZIy5LyI/f/dJvfK6FKMJqAdqmBS2ZgWINY9zJyZ1whUiRJrTfmGjybSxUemwcFEmghqT1UxlUrpQEXD7jRq3NWelEz10okIi1AJOX+U2EgALgUrT0kVnmcKvQ+uazSZvbW2hWq2i3++j3W5jf38f6+vrebvdHovI5pT09+vN7teLYev990K8GpQYjS1u1TQqhnHez6EU4cM7FTw7z5AXDo16ACcyPRsaxp2FEM9ejKd7zUaIYVpiOCpRq2rUIo0XLzMwEZaaFTzvZ8hyh/iWnu69fF1AAoOfFr/A5w8eYDQaIY5jJEmC09NTNBoNdLtd7O3t4ejoCIeHh8k/pL8KUSkCZcg6hCLDjLk2ufYGpRuXAuOMYiosQiDNNEcQILQuzYgi0QxVWKuAMtcqJPdXDaKaMMOUNrOAtoFSVE5jaaY4mtQPS5dmQPS8WkdfGReYgDe/3cTdpbvo9XrY2NhAp9NBq9XKO53Ov6T/r2mlVBeX0DSAMzeHppm5h7doemdvR99buYfd3V2srq4+PTk5+a+mr9CmrqTU3+5Rr9cHg8HgYve4krddbZGb5dOXmf2d+7n4pi9D4LrOeHl40v42fl0a8KQ96fkIeJ+ej9vsWZ707Mzmy/Ck5+M2e9afhmuAz1BhwewAAAAASUVORK5CYII=" alt="Next in Tag" width="45" height="45" loading="lazy">
                    </a>
                  
                </div>
              </div>
            
          
          <!-- JavaScript to Toggle the Tag-based Navigation -->
          <script>
            document.addEventListener("DOMContentLoaded", function(){
              var tagLinks = document.querySelectorAll('.tag-option');
              tagLinks.forEach(function(link){
                link.addEventListener('click', function(event){
                  event.preventDefault();
                  // Remove "active" class from all tag options.
                  tagLinks.forEach(function(el){ el.classList.remove('active'); });
                  // Add active class to the clicked tag option.
                  this.classList.add('active');
                  // Hide all tag navigation blocks.
                  document.querySelectorAll('.nav-group.tags').forEach(function(block){
                    block.style.display = 'none';
                  });
                  // Show the navigation block corresponding to the selected tag.
                  var tagSlug = this.getAttribute('data-tag');
                  var target = document.getElementById('tag-nav-' + tagSlug);
                  if(target) {
                    target.style.display = 'block';
                  }
                });
              });
            });
          </script>
      </nav>
      
    </main>
    <footer id="bottom-of-page" class="site-footer">
      <div class="footer-content">
        <!-- Back to top link -->
        <a href="#" aria-label="Back to top" class="back2top-link">
          <span class="sronly">Back to top</span>
        </a>
    
        <!-- Liquid Time Calculation and Display -->
        
        
        
        <a href="https://ib.bsb.br/404" aria-label="404">
          2025-05-06 21:58:31
        </a>
        &#x23;
    
        <!-- Tag Selector -->
        <ul class="tag-selector">
          
            
            
              <li>
                <a href="#" class="tag-option active" data-tag="scratchpad">
                  scratchpad
                </a>
              </li>
            
          
        </ul>
        &hArr;
    
        <!-- GitHub Link -->
        <a href="https://github.com/ib-bsb-br/ib-bsb-br.github.io" aria-label="GitHub">
          &#8505;
        </a>
    
        <!-- Homepage Link -->
        <a href="/" aria-label="Homepage">
          infoBAG
        </a>
    
        <!-- Copy All Code Button -->
        <button id="copyAllButton" aria-label="Copy all code">
          &copy;
        </button>
      </div>
    </footer>
    <style>
      .back2top-link {
        display: inline-block;
        width: 32px;
        height: 32px;
        background: url("/assets/Rope_(Old).gif") center center no-repeat;
        background-size: contain;
        text-decoration: none;
        vertical-align: middle;
      }
      .sronly {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
    </style>
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Article",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://ib.bsb.br/sbnb-buildroot-intel-n97-fix/"
        },
        "headline": "sbnb buildroot intel n97 fix",
        "description": "",
        "datePublished": "2025-05-03T00:00:00+00:00",
        "dateModified": "2025-05-03T22:13:51+00:00",
        "author": {
          "@type": "Person",
          "name": "Author"
        },
        "publisher": {
          "@type": "Organization",
          "name": "infoBAG"
          
        }
        
      }
    </script>
    <script src="/assets/js/prism.js" defer></script>
    <script src="/assets/js/copy-all-code.js"></script>
  </body>
</html>
