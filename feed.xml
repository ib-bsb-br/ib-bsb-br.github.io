<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://ib.bsb.br/feed.xml" rel="self" type="application/atom+xml" /><link href="https://ib.bsb.br/" rel="alternate" type="text/html" /><updated>2026-01-23T00:06:21+00:00</updated><id>https://ib.bsb.br/feed.xml</id><title type="html">infoBAG</title><entry><title type="html">rotation + compression + size caps in logrotate/rsyslog on Debian</title><link href="https://ib.bsb.br/logs-rotation-deb/" rel="alternate" type="text/html" title="rotation + compression + size caps in logrotate/rsyslog on Debian" /><published>2026-01-21T00:00:00+00:00</published><updated>2026-01-21T22:24:52+00:00</updated><id>https://ib.bsb.br/logs-rotation_deb</id><content type="html" xml:base="https://ib.bsb.br/logs-rotation-deb/"><![CDATA[<p>You want two layers: (1) rotate/compress aggressively enough, and (2) reduce the log volume at the source.</p>

<p>C1) Strengthen logrotate policy for syslog + daemon.log
Edit <code class="language-plaintext highlighter-rouge">/etc/logrotate.d/rsyslog</code> and ensure both files are covered with:</p>

<ul>
  <li>compression enabled</li>
  <li>a retention count (rotate N)</li>
  <li>a size cap (<code class="language-plaintext highlighter-rouge">maxsize</code> or <code class="language-plaintext highlighter-rouge">size</code>)</li>
  <li>a postrotate hook that reopens logs via the rsyslog helper (or HUP)</li>
</ul>

<p>Example policy (conservative, “stop the bleeding”):</p>

<ul>
  <li>rotate daily</li>
  <li>keep 14 rotations</li>
  <li>compress, with delaycompress</li>
  <li>rotate early if it exceeds 100 MB</li>
</ul>

<p>Conceptually:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">maxsize</code> is useful when you still want a time schedule (daily) but also want rotation triggered by size.</li>
  <li><code class="language-plaintext highlighter-rouge">size</code> is similar but is mutually exclusive with time intervals and rotates purely based on size. ([Linux Die][8])</li>
</ul>

<p>Important operational detail: size-based triggers only take effect when logrotate runs. If logrotate runs once per day, “maxsize 100M” will only be checked once per day, and a runaway log can still grow very large within that day. This is why the logrotate docs note you must run it more frequently (e.g., hourly) if you truly need small, frequent rotations. ([man7.org][9])</p>

<p>C2) If growth is extreme, run logrotate more frequently
If you’re seeing multi-GB growth in hours, consider executing logrotate hourly via a systemd timer override or a cron.hourly job. The key idea is not distro-specific: logrotate must be invoked more frequently to enforce frequent size-based rotation. ([man7.org][9])</p>

<p>D. Reduce the log volume: find what’s flooding syslog/daemon.log
Rotation is containment; the real fix is stopping the spammer.</p>

<ol>
  <li>Identify top “talkers” (fast triage)</li>
</ol>

<ul>
  <li>
    <p>Count by program tag (approximate, but often enough to find the culprit):</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">sudo awk '{print $5}' /var/log/syslog | sed 's/\[.*\]://' | sort | uniq -c | sort -nr | head -30</code></li>
    </ul>
  </li>
  <li>
    <p>Then inspect that program’s last messages:</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">sudo grep -F 'programname' /var/log/syslog | tail -n 200</code>
Do the same for <code class="language-plaintext highlighter-rouge">/var/log/daemon.log</code>.</li>
    </ul>
  </li>
</ul>

<ol>
  <li>Confirm if a single repeating line is exploding volume</li>
</ol>

<ul>
  <li>
    <p>Quickly spot repetition:</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">sudo tail -n 5000 /var/log/syslog | sort | uniq -c | sort -nr | head -20</code></li>
    </ul>
  </li>
</ul>

<ol>
  <li>Fix at the source
Typical “log floods” come from:</li>
</ol>

<ul>
  <li>a failing service retry-loop (network DNS failures, storage errors, authentication failures, crashing + systemd restart loops)</li>
  <li>debug logging accidentally enabled</li>
  <li>hardware/driver chatter (kernel/udev messages routed onward)
The correct fix depends on the service you find; but once you identify the top talker, you almost always have a direct knob: reduce log level or fix the underlying error condition.</li>
</ul>

<ol>
  <li>Consider rsyslog repeated-message reduction only with eyes open
rsyslog supports “Last line repeated n times” behavior via <code class="language-plaintext highlighter-rouge">$RepeatedMsgReduction</code>. Upstream docs describe it as legacy and many modern workflows consider it a misfeature because it can hide event granularity that tools expect. ([GitHub][5])
So treat this as a last resort for purely identical spam where you accept the loss of detail.</li>
</ol>

<p>E. Optional: ensure systemd-journald isn’t also consuming disk
Even if <code class="language-plaintext highlighter-rouge">/var/log/syslog</code> is your main problem, Debian systems also keep the systemd journal, and it has configurable disk caps like <code class="language-plaintext highlighter-rouge">SystemMaxUse=</code> / <code class="language-plaintext highlighter-rouge">RuntimeMaxUse=</code>. ([Debian Sources][4])</p>

<ul>
  <li>Check usage: <code class="language-plaintext highlighter-rouge">journalctl --disk-usage</code></li>
  <li>If needed, cap retention via <code class="language-plaintext highlighter-rouge">/etc/systemd/journald.conf</code> and vacuum old entries.</li>
</ul>

<h1 id="etclogrotatedrsyslog">/etc/logrotate.d/rsyslog</h1>
<section class="code-block-container" role="group" aria-label=" Code Block" data-filename="_code_block.txt" data-code="/var/log/syslog
/var/log/daemon.log
/var/log/kern.log
/var/log/auth.log
/var/log/messages
{
	# Rotate these frequently to prevent multi-GB growth
	hourly

	# Keep up to 7 days of hourly history (24*7 = 168)
	rotate 168
	maxage 7

	missingok
	notifempty

	# Size guardrails:
	# - minsize prevents rotating tiny files every hour
	# - maxsize forces rotation at next run even if time interval hasn&#39;t elapsed
	minsize 1M
	maxsize 50M

	compress
	delaycompress

	# Hour-stamped rotated filenames (avoids collisions with hourly)
	dateext
	dateformat -%Y%m%d-%H
	datehourago

	sharedscripts
	postrotate
		/usr/lib/rsyslog/rsyslog-rotate
	endscript
}

/var/log/mail.info
/var/log/mail.warn
/var/log/mail.err
/var/log/mail.log
/var/log/user.log
/var/log/lpr.log
/var/log/cron.log
/var/log/debug
{
	# These typically don&#39;t need hourly rotation; still protected by size caps.
	daily

	# Keep ~30 days
	rotate 30
	maxage 30

	missingok
	notifempty

	minsize 100k
	maxsize 20M

	compress
	delaycompress

	dateext
	sharedscripts
	postrotate
		/usr/lib/rsyslog/rsyslog-rotate
	endscript
}" data-download-link="" data-download-label="Download ">
  <code class="language-">/var/log/syslog
/var/log/daemon.log
/var/log/kern.log
/var/log/auth.log
/var/log/messages
{
	# Rotate these frequently to prevent multi-GB growth
	hourly

	# Keep up to 7 days of hourly history (24*7 = 168)
	rotate 168
	maxage 7

	missingok
	notifempty

	# Size guardrails:
	# - minsize prevents rotating tiny files every hour
	# - maxsize forces rotation at next run even if time interval hasn&#39;t elapsed
	minsize 1M
	maxsize 50M

	compress
	delaycompress

	# Hour-stamped rotated filenames (avoids collisions with hourly)
	dateext
	dateformat -%Y%m%d-%H
	datehourago

	sharedscripts
	postrotate
		/usr/lib/rsyslog/rsyslog-rotate
	endscript
}

/var/log/mail.info
/var/log/mail.warn
/var/log/mail.err
/var/log/mail.log
/var/log/user.log
/var/log/lpr.log
/var/log/cron.log
/var/log/debug
{
	# These typically don&#39;t need hourly rotation; still protected by size caps.
	daily

	# Keep ~30 days
	rotate 30
	maxage 30

	missingok
	notifempty

	minsize 100k
	maxsize 20M

	compress
	delaycompress

	dateext
	sharedscripts
	postrotate
		/usr/lib/rsyslog/rsyslog-rotate
	endscript
}</code>
</section>

<p>Why this structure works:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">hourly</code> is a real directive in bullseye logrotate. ([manpages.debian.org][1])</li>
  <li><code class="language-plaintext highlighter-rouge">minsize</code>/<code class="language-plaintext highlighter-rouge">maxsize</code> behave exactly the way you want for “don’t rotate tiny files, but never let them explode”. ([manpages.debian.org][1])</li>
  <li><code class="language-plaintext highlighter-rouge">dateext</code> + an hour-bearing <code class="language-plaintext highlighter-rouge">dateformat</code> + <code class="language-plaintext highlighter-rouge">datehourago</code> prevents name collisions and makes the timestamp match the hour the logs cover. ([manpages.debian.org][1])</li>
</ul>

<h2 id="make-logrotate-actually-run-hourly-required">Make logrotate actually run hourly (required)</h2>

<p>Logrotate configs don’t schedule themselves. You must run logrotate hourly via <strong>systemd timer</strong> or <strong>cron</strong>.</p>

<h1 id="systemd-timer-cleanest-if-you-have-it">systemd timer (cleanest if you have it)</h1>

<p>Check if it exists:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl status logrotate.timer 2&gt;/dev/null
systemctl list-timers | <span class="nb">grep</span> <span class="nt">-i</span> logrotate <span class="o">||</span> <span class="nb">true</span>
</code></pre></div></div>

<p>If <code class="language-plaintext highlighter-rouge">logrotate.timer</code> exists, override it to hourly. The important trick is: when overriding <code class="language-plaintext highlighter-rouge">OnCalendar=</code>, you should first reset it by assigning an empty value (systemd supports “empty string resets the list”). ([manpages.debian.org][3])</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl edit logrotate.timer
</code></pre></div></div>

<p>Put this in the editor:</p>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[Timer]</span>
<span class="py">OnCalendar</span><span class="p">=</span>
<span class="py">OnCalendar</span><span class="p">=</span><span class="s">hourly</span>
<span class="py">Persistent</span><span class="p">=</span><span class="s">true</span>
</code></pre></div></div>

<p>Then:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl daemon-reload
<span class="nb">sudo </span>systemctl restart logrotate.timer
systemctl list-timers logrotate.timer
</code></pre></div></div>

<h2 id="validate-safely">Validate safely</h2>

<p>Dry-run the specific policy:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>logrotate <span class="nt">-d</span> /etc/logrotate.d/rsyslog
</code></pre></div></div>

<p>Force one rotation to confirm naming/permissions (do this once, not repeatedly):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>logrotate <span class="nt">-f</span> /etc/logrotate.d/rsyslog
</code></pre></div></div>

<p>Watch whether the files stop ballooning:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-lh</span> /var/log/syslog /var/log/daemon.log
</code></pre></div></div>

<p>One pragmatic warning: hourly rotation + very noisy logs can still generate lots of compressed archives. If that happens, tighten <code class="language-plaintext highlighter-rouge">maxage</code> (e.g., 3) or reduce <code class="language-plaintext highlighter-rouge">rotate</code>, or increase compression aggressiveness later.</p>]]></content><author><name></name></author><category term="scratchpad" /></entry><entry><title type="html">maim screenshooter debian 11 bash script</title><link href="https://ib.bsb.br/maim/" rel="alternate" type="text/html" title="maim screenshooter debian 11 bash script" /><published>2026-01-15T00:00:00+00:00</published><updated>2026-01-15T12:05:43+00:00</updated><id>https://ib.bsb.br/maim</id><content type="html" xml:base="https://ib.bsb.br/maim/"><![CDATA[<section class="code-block-container" role="group" aria-label="Bash Code Block" data-filename="bash_code_block.sh" data-code="#!/bin/bash
set -euo pipefail

# ==============================================================================
# Script Name: install_maim_rk3588.sh
# Purpose: Automates the build and installation of &#39;maim&#39; and &#39;slop&#39; on Debian 11.
# Target System: ARM64 Rockchip RK3588 (Bare-metal)
# Execution Context: User home directory
# Tutorial Source: VPC-3588 Maim Installation Guide
# ==============================================================================

# --- Configuration Variables ---
SLOP_REPO_URL=&quot;https://github.com/naelstrof/slop.git&quot;
MAIM_REPO_URL=&quot;https://github.com/naelstrof/maim.git&quot;
INSTALL_PREFIX=&quot;/usr/local&quot;  # Tutorial specifies /usr/local (Note: Overwrites system files)
CPU_CORES=8            # RK3588 has 8 cores

# --- Helper Functions ---

# Function: cleanup
# Description: Removes temporary build directories on script exit.
cleanup() {
    local exit_code=$?
    echo &quot;----------------------------------------------------------------&quot;
    if [ -n &quot;${TEMP_BUILD_DIR:-}&quot; ] &amp;&amp; [ -d &quot;$TEMP_BUILD_DIR&quot; ]; then
        echo &quot;Cleaning up temporary directory: $TEMP_BUILD_DIR&quot;
        rm -rf &quot;$TEMP_BUILD_DIR&quot;
    fi
    
    if [ $exit_code -eq 0 ]; then
        echo &quot;Script finished successfully.&quot;
    else
        echo &quot;Script failed with exit code $exit_code.&quot;
    fi
}

# Trap cleanup on EXIT, SIGINT (Ctrl+C), and SIGTERM
trap cleanup EXIT SIGINT SIGTERM

# Function: ensure_package_installed
# Description: Checks if a package is installed; installs it if missing.
ensure_package_installed() {
    local package_name=&quot;$1&quot;
    if ! dpkg -s &quot;$package_name&quot; &gt;/dev/null 2&gt;&amp;1; then
        echo &quot;Package &#39;$package_name&#39; is missing. Installing...&quot;
        if ! sudo apt install -y &quot;$package_name&quot;; then
            echo &quot;Error: Failed to install package &#39;$package_name&#39;.&quot; &gt;&amp;2
            exit 1
        fi
    else
        echo &quot;Package &#39;$package_name&#39; is already installed.&quot;
    fi
}

# --- Main Script Execution ---

echo &quot;================================================================&quot;
echo &quot;   Maim &amp; Slop Build/Install Script for RK3588 (Debian 11)      &quot;
echo &quot;================================================================&quot;

# 1. Critical Safety Confirmation
echo &quot;WARNING: This script compiles software and installs it directly to &#39;$INSTALL_PREFIX&#39;.&quot;
echo &quot;This action:&quot;
echo &quot;  - Requires sudo privileges.&quot;
echo &quot;  - May overwrite files managed by the system package manager.&quot;
echo &quot;  - Is based on the specific VPC-3588 tutorial provided.&quot;
echo &quot;&quot;

if command -v maim &gt;/dev/null 2&gt;&amp;1; then
    echo &quot;NOTICE: &#39;maim&#39; is already installed at $(command -v maim).&quot;
    echo &quot;Proceeding will overwrite the existing installation.&quot;
    echo &quot;&quot;
fi

read -r -p &quot;Do you want to proceed with the installation? (yes/NO): &quot; confirmation
if [[ &quot;$confirmation&quot; != &quot;yes&quot; ]]; then
    echo &quot;Operation cancelled by user.&quot; &gt;&amp;2
    exit 1
fi

# 2. Create Temporary Build Directory
# Using mktemp as per best practices for secure temporary directory creation
TEMP_BUILD_DIR=$(mktemp -d -t maim_build.XXXXXX)
echo &quot;Created temporary build directory: $TEMP_BUILD_DIR&quot;

# 3. Phase 1: Install Build Dependencies
echo &quot;&quot;
echo &quot;&gt;&gt;&gt; Phase 1: Installing Build Dependencies...&quot;

echo &quot;Updating package lists...&quot;
if ! sudo apt update; then
    echo &quot;Error: Failed to update package lists.&quot; &gt;&amp;2
    exit 1
fi

# List of dependencies from the tutorial
DEPENDENCIES=(
    &quot;build-essential&quot;
    &quot;git&quot;
    &quot;cmake&quot;
    &quot;libx11-dev&quot;
    &quot;libxext-dev&quot;
    &quot;libxfixes-dev&quot;
    &quot;libxrandr-dev&quot;
    &quot;libxrender-dev&quot;
    &quot;libxcomposite-dev&quot;
    &quot;libglm-dev&quot;
    &quot;libpng-dev&quot;
    &quot;libjpeg62-turbo-dev&quot;
    &quot;libwebp-dev&quot;
    &quot;libicu-dev&quot;
)

for dep in &quot;${DEPENDENCIES[@]}&quot;; do
    ensure_package_installed &quot;$dep&quot;
done

# 4. Phase 2: Build and Install &#39;slop&#39; (Prerequisite)
echo &quot;&quot;
echo &quot;&gt;&gt;&gt; Phase 2: Building and Installing &#39;slop&#39;...&quot;

# Navigate to temp dir
cd &quot;$TEMP_BUILD_DIR&quot;

echo &quot;Cloning slop repository...&quot;
if ! git clone &quot;$SLOP_REPO_URL&quot;; then
    echo &quot;Error: Failed to clone slop repository.&quot; &gt;&amp;2
    exit 1
fi

cd slop

echo &quot;Configuring slop (CMake)...&quot;
# Tutorial specifies in-source build with /usr/local prefix
if ! cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=&quot;$INSTALL_PREFIX&quot; ./; then
    echo &quot;Error: CMake configuration for slop failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Compiling slop (Jobs: $CPU_CORES)...&quot;
if ! make -j&quot;$CPU_CORES&quot;; then
    echo &quot;Error: Compilation of slop failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Installing slop...&quot;
if ! sudo make install; then
    echo &quot;Error: Installation of slop failed.&quot; &gt;&amp;2
    exit 1
fi

# 5. Phase 3: Build and Install &#39;maim&#39;
echo &quot;&quot;
echo &quot;&gt;&gt;&gt; Phase 3: Building and Installing &#39;maim&#39;...&quot;

# Return to temp root
cd &quot;$TEMP_BUILD_DIR&quot;

echo &quot;Cloning maim repository...&quot;
if ! git clone &quot;$MAIM_REPO_URL&quot;; then
    echo &quot;Error: Failed to clone maim repository.&quot; &gt;&amp;2
    exit 1
fi

cd maim

echo &quot;Configuring maim (CMake)...&quot;
# CMake should find the SLOP library installed in the previous step
if ! cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=&quot;$INSTALL_PREFIX&quot; ./; then
    echo &quot;Error: CMake configuration for maim failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Compiling maim (Jobs: $CPU_CORES)...&quot;
if ! make -j&quot;$CPU_CORES&quot;; then
    echo &quot;Error: Compilation of maim failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Installing maim...&quot;
if ! sudo make install; then
    echo &quot;Error: Installation of maim failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Updating shared library cache (ldconfig)...&quot;
if ! sudo ldconfig; then
    echo &quot;Warning: &#39;ldconfig&#39; command failed. Shared libraries might not be linked correctly.&quot; &gt;&amp;2
fi

# 6. Phase 4: Verification
echo &quot;&quot;
echo &quot;&gt;&gt;&gt; Phase 4: Verification...&quot;

if command -v maim &gt;/dev/null 2&gt;&amp;1; then
    INSTALLED_VERSION=$(maim --version)
    echo &quot;Success! &#39;maim&#39; has been installed.&quot;
    echo &quot;Detected Version: $INSTALLED_VERSION&quot;
    
    # Check for X11 Display before attempting screenshot
    if [ -n &quot;${DISPLAY:-}&quot; ]; then
        TEST_FILE=&quot;$HOME/maim_test_$(date +%s).png&quot;
        echo &quot;Taking a test screenshot to: $TEST_FILE&quot;
        if maim &quot;$TEST_FILE&quot;; then
            echo &quot;Screenshot successful.&quot;
        else
            echo &quot;Warning: Test screenshot failed. Ensure X11 is running correctly.&quot; &gt;&amp;2
        fi
    else
        echo &quot;Skipping screenshot test: DISPLAY environment variable not set (Headless environment?).&quot;
    fi
else
    echo &quot;Error: &#39;maim&#39; command not found in PATH after installation.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;&quot;
echo &quot;Installation process completed.&quot;
exit 0" data-download-link="" data-download-label="Download Bash">
  <code class="language-bash">#!/bin/bash
set -euo pipefail

# ==============================================================================
# Script Name: install_maim_rk3588.sh
# Purpose: Automates the build and installation of &#39;maim&#39; and &#39;slop&#39; on Debian 11.
# Target System: ARM64 Rockchip RK3588 (Bare-metal)
# Execution Context: User home directory
# Tutorial Source: VPC-3588 Maim Installation Guide
# ==============================================================================

# --- Configuration Variables ---
SLOP_REPO_URL=&quot;https://github.com/naelstrof/slop.git&quot;
MAIM_REPO_URL=&quot;https://github.com/naelstrof/maim.git&quot;
INSTALL_PREFIX=&quot;/usr/local&quot;  # Tutorial specifies /usr/local (Note: Overwrites system files)
CPU_CORES=8            # RK3588 has 8 cores

# --- Helper Functions ---

# Function: cleanup
# Description: Removes temporary build directories on script exit.
cleanup() {
    local exit_code=$?
    echo &quot;----------------------------------------------------------------&quot;
    if [ -n &quot;${TEMP_BUILD_DIR:-}&quot; ] &amp;&amp; [ -d &quot;$TEMP_BUILD_DIR&quot; ]; then
        echo &quot;Cleaning up temporary directory: $TEMP_BUILD_DIR&quot;
        rm -rf &quot;$TEMP_BUILD_DIR&quot;
    fi
    
    if [ $exit_code -eq 0 ]; then
        echo &quot;Script finished successfully.&quot;
    else
        echo &quot;Script failed with exit code $exit_code.&quot;
    fi
}

# Trap cleanup on EXIT, SIGINT (Ctrl+C), and SIGTERM
trap cleanup EXIT SIGINT SIGTERM

# Function: ensure_package_installed
# Description: Checks if a package is installed; installs it if missing.
ensure_package_installed() {
    local package_name=&quot;$1&quot;
    if ! dpkg -s &quot;$package_name&quot; &gt;/dev/null 2&gt;&amp;1; then
        echo &quot;Package &#39;$package_name&#39; is missing. Installing...&quot;
        if ! sudo apt install -y &quot;$package_name&quot;; then
            echo &quot;Error: Failed to install package &#39;$package_name&#39;.&quot; &gt;&amp;2
            exit 1
        fi
    else
        echo &quot;Package &#39;$package_name&#39; is already installed.&quot;
    fi
}

# --- Main Script Execution ---

echo &quot;================================================================&quot;
echo &quot;   Maim &amp; Slop Build/Install Script for RK3588 (Debian 11)      &quot;
echo &quot;================================================================&quot;

# 1. Critical Safety Confirmation
echo &quot;WARNING: This script compiles software and installs it directly to &#39;$INSTALL_PREFIX&#39;.&quot;
echo &quot;This action:&quot;
echo &quot;  - Requires sudo privileges.&quot;
echo &quot;  - May overwrite files managed by the system package manager.&quot;
echo &quot;  - Is based on the specific VPC-3588 tutorial provided.&quot;
echo &quot;&quot;

if command -v maim &gt;/dev/null 2&gt;&amp;1; then
    echo &quot;NOTICE: &#39;maim&#39; is already installed at $(command -v maim).&quot;
    echo &quot;Proceeding will overwrite the existing installation.&quot;
    echo &quot;&quot;
fi

read -r -p &quot;Do you want to proceed with the installation? (yes/NO): &quot; confirmation
if [[ &quot;$confirmation&quot; != &quot;yes&quot; ]]; then
    echo &quot;Operation cancelled by user.&quot; &gt;&amp;2
    exit 1
fi

# 2. Create Temporary Build Directory
# Using mktemp as per best practices for secure temporary directory creation
TEMP_BUILD_DIR=$(mktemp -d -t maim_build.XXXXXX)
echo &quot;Created temporary build directory: $TEMP_BUILD_DIR&quot;

# 3. Phase 1: Install Build Dependencies
echo &quot;&quot;
echo &quot;&gt;&gt;&gt; Phase 1: Installing Build Dependencies...&quot;

echo &quot;Updating package lists...&quot;
if ! sudo apt update; then
    echo &quot;Error: Failed to update package lists.&quot; &gt;&amp;2
    exit 1
fi

# List of dependencies from the tutorial
DEPENDENCIES=(
    &quot;build-essential&quot;
    &quot;git&quot;
    &quot;cmake&quot;
    &quot;libx11-dev&quot;
    &quot;libxext-dev&quot;
    &quot;libxfixes-dev&quot;
    &quot;libxrandr-dev&quot;
    &quot;libxrender-dev&quot;
    &quot;libxcomposite-dev&quot;
    &quot;libglm-dev&quot;
    &quot;libpng-dev&quot;
    &quot;libjpeg62-turbo-dev&quot;
    &quot;libwebp-dev&quot;
    &quot;libicu-dev&quot;
)

for dep in &quot;${DEPENDENCIES[@]}&quot;; do
    ensure_package_installed &quot;$dep&quot;
done

# 4. Phase 2: Build and Install &#39;slop&#39; (Prerequisite)
echo &quot;&quot;
echo &quot;&gt;&gt;&gt; Phase 2: Building and Installing &#39;slop&#39;...&quot;

# Navigate to temp dir
cd &quot;$TEMP_BUILD_DIR&quot;

echo &quot;Cloning slop repository...&quot;
if ! git clone &quot;$SLOP_REPO_URL&quot;; then
    echo &quot;Error: Failed to clone slop repository.&quot; &gt;&amp;2
    exit 1
fi

cd slop

echo &quot;Configuring slop (CMake)...&quot;
# Tutorial specifies in-source build with /usr/local prefix
if ! cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=&quot;$INSTALL_PREFIX&quot; ./; then
    echo &quot;Error: CMake configuration for slop failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Compiling slop (Jobs: $CPU_CORES)...&quot;
if ! make -j&quot;$CPU_CORES&quot;; then
    echo &quot;Error: Compilation of slop failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Installing slop...&quot;
if ! sudo make install; then
    echo &quot;Error: Installation of slop failed.&quot; &gt;&amp;2
    exit 1
fi

# 5. Phase 3: Build and Install &#39;maim&#39;
echo &quot;&quot;
echo &quot;&gt;&gt;&gt; Phase 3: Building and Installing &#39;maim&#39;...&quot;

# Return to temp root
cd &quot;$TEMP_BUILD_DIR&quot;

echo &quot;Cloning maim repository...&quot;
if ! git clone &quot;$MAIM_REPO_URL&quot;; then
    echo &quot;Error: Failed to clone maim repository.&quot; &gt;&amp;2
    exit 1
fi

cd maim

echo &quot;Configuring maim (CMake)...&quot;
# CMake should find the SLOP library installed in the previous step
if ! cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=&quot;$INSTALL_PREFIX&quot; ./; then
    echo &quot;Error: CMake configuration for maim failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Compiling maim (Jobs: $CPU_CORES)...&quot;
if ! make -j&quot;$CPU_CORES&quot;; then
    echo &quot;Error: Compilation of maim failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Installing maim...&quot;
if ! sudo make install; then
    echo &quot;Error: Installation of maim failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Updating shared library cache (ldconfig)...&quot;
if ! sudo ldconfig; then
    echo &quot;Warning: &#39;ldconfig&#39; command failed. Shared libraries might not be linked correctly.&quot; &gt;&amp;2
fi

# 6. Phase 4: Verification
echo &quot;&quot;
echo &quot;&gt;&gt;&gt; Phase 4: Verification...&quot;

if command -v maim &gt;/dev/null 2&gt;&amp;1; then
    INSTALLED_VERSION=$(maim --version)
    echo &quot;Success! &#39;maim&#39; has been installed.&quot;
    echo &quot;Detected Version: $INSTALLED_VERSION&quot;
    
    # Check for X11 Display before attempting screenshot
    if [ -n &quot;${DISPLAY:-}&quot; ]; then
        TEST_FILE=&quot;$HOME/maim_test_$(date +%s).png&quot;
        echo &quot;Taking a test screenshot to: $TEST_FILE&quot;
        if maim &quot;$TEST_FILE&quot;; then
            echo &quot;Screenshot successful.&quot;
        else
            echo &quot;Warning: Test screenshot failed. Ensure X11 is running correctly.&quot; &gt;&amp;2
        fi
    else
        echo &quot;Skipping screenshot test: DISPLAY environment variable not set (Headless environment?).&quot;
    fi
else
    echo &quot;Error: &#39;maim&#39; command not found in PATH after installation.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;&quot;
echo &quot;Installation process completed.&quot;
exit 0</code>
</section>]]></content><author><name></name></author><category term="scratchpad" /></entry><entry><title type="html">nsxiv image viewer debian 11 bash script</title><link href="https://ib.bsb.br/nsxiv/" rel="alternate" type="text/html" title="nsxiv image viewer debian 11 bash script" /><published>2026-01-15T00:00:00+00:00</published><updated>2026-01-15T13:07:54+00:00</updated><id>https://ib.bsb.br/nsxiv</id><content type="html" xml:base="https://ib.bsb.br/nsxiv/"><![CDATA[<section class="code-block-container" role="group" aria-label="Bash Code Block" data-filename="bash_code_block.sh" data-code="#!/bin/bash
set -euo pipefail

# Script to build and install nsxiv (Neo Simple X Image Viewer)
# Target: Debian 11 (Bullseye) on ARM64 RK3588
# Purpose: Automates dependencies, Imlib2 compilation (fixing version issues),
#          nsxiv compilation (with optimizations), and post-install configuration.

# --- Configuration Variables ---
BUILD_DIR=&quot;$HOME/build&quot;
NSXIV_REPO_URL=&quot;https://codeberg.org/nsxiv/nsxiv.git&quot;
NSXIV_DIR=&quot;$BUILD_DIR/nsxiv&quot;
CONFIG_DIR=&quot;$HOME/.config/nsxiv/exec&quot;
IMLIB2_VERSION=&quot;1.12.6&quot;
IMLIB2_URL=&quot;https://downloads.sourceforge.net/enlightenment/imlib2-${IMLIB2_VERSION}.tar.xz&quot;
IMLIB2_DIR=&quot;$BUILD_DIR/imlib2-${IMLIB2_VERSION}&quot;
LD_CONF_FILE=&quot;/etc/ld.so.conf.d/local-libs.conf&quot;

# --- Helper Functions ---

# Function to check if a command exists and install its package if missing
ensure_tool_installed() {
    local tool_name=&quot;$1&quot;
    local package_name=&quot;${2:-$tool_name}&quot; # Use second arg as package name if provided, else tool_name
    if ! command -v &quot;$tool_name&quot; &gt;/dev/null 2&gt;&amp;1; then
        echo &quot;Tool &#39;$tool_name&#39; not found. Installing &#39;$package_name&#39;...&quot;
        if ! sudo apt install -y &quot;$package_name&quot;; then
            echo &quot;Error: Failed to install &#39;$package_name&#39;.&quot; &gt;&amp;2
            exit 1
        fi
        echo &quot;&#39;$package_name&#39; installed successfully.&quot;
    else
        echo &quot;Tool &#39;$tool_name&#39; is already installed.&quot;
    fi
}

# Setup trap for cleanup on exit
trap &#39;echo &quot;Script execution finished or interrupted.&quot;&#39; EXIT SIGINT SIGTERM

# --- Main Script ---

echo &quot;Starting nsxiv build and installation script for RK3588...&quot;

# --- Phase 1: Preparation &amp; Dependencies ---

echo &quot;Updating package lists...&quot;
if ! sudo apt update; then
    echo &quot;Error: Failed to update package lists.&quot; &gt;&amp;2
    exit 1
fi
echo &quot;Package lists updated.&quot;

echo &quot;Installing build dependencies and required tools...&quot;
# Core build tools
ensure_tool_installed &quot;git&quot;
ensure_tool_installed &quot;make&quot; &quot;build-essential&quot;
ensure_tool_installed &quot;gcc&quot;
ensure_tool_installed &quot;wget&quot;

# Specific library development headers and runtime tools
# Note: &#39;gimp&#39; and &#39;rawtherapee&#39; are added because the default key-handler script uses them.
PACKAGES_TO_INSTALL=(
    &quot;libx11-dev&quot;
    &quot;libimlib2-dev&quot; # Needed initially for dependencies, will be overridden by custom build
    &quot;libxft-dev&quot;
    &quot;libexif-dev&quot;
    &quot;libfontconfig1-dev&quot;
    &quot;xclip&quot;
    &quot;libjpeg-progs&quot;
    &quot;imagemagick&quot;
    &quot;exiv2&quot;
    &quot;gimp&quot;
    &quot;rawtherapee&quot;
    &quot;libjpeg-dev&quot;
    &quot;libpng-dev&quot;
    &quot;libtiff-dev&quot;
    &quot;libgif-dev&quot;
    &quot;libwebp-dev&quot;
    &quot;libfreetype6-dev&quot;
    &quot;libxext-dev&quot;
    &quot;libxcb1-dev&quot;
)

echo &quot;Installing packages: ${PACKAGES_TO_INSTALL[*]}&quot;
if ! sudo apt install -y &quot;${PACKAGES_TO_INSTALL[@]}&quot;; then
    echo &quot;Error: Failed to install dependencies.&quot; &gt;&amp;2
    exit 1
fi
echo &quot;Dependencies installed successfully.&quot;

# --- Phase 2: Handling Imlib2 Version Issue ---

echo &quot;Checking Imlib2 version requirements...&quot;
# Debian 11 has an old Imlib2. We need to build a newer one.
# Remove system libimlib2-dev to avoid conflicts during build
if dpkg -s libimlib2-dev &gt;/dev/null 2&gt;&amp;1; then
    echo &quot;Removing system libimlib2-dev to prevent conflicts with custom build...&quot;
    if ! sudo apt remove -y libimlib2-dev; then
        echo &quot;Error: Failed to remove libimlib2-dev.&quot; &gt;&amp;2
        exit 1
    fi
    echo &quot;System libimlib2-dev removed.&quot;
fi

# Create build directory
if [ ! -d &quot;$BUILD_DIR&quot; ]; then
    mkdir -p &quot;$BUILD_DIR&quot;
    echo &quot;Created build directory: $BUILD_DIR&quot;
fi

# Download and Extract Imlib2
if [ ! -d &quot;$IMLIB2_DIR&quot; ]; then
    echo &quot;Downloading Imlib2 ${IMLIB2_VERSION}...&quot;
    cd &quot;$BUILD_DIR&quot;
    if ! wget &quot;$IMLIB2_URL&quot;; then
        echo &quot;Error: Failed to download Imlib2.&quot; &gt;&amp;2
        exit 1
    fi
    
    echo &quot;Extracting Imlib2...&quot;
    if ! tar -xf &quot;imlib2-${IMLIB2_VERSION}.tar.xz&quot;; then
        echo &quot;Error: Failed to extract Imlib2.&quot; &gt;&amp;2
        exit 1
    fi
else
    echo &quot;Imlib2 source directory already exists. Skipping download.&quot;
fi

echo &quot;Configuring and compiling Imlib2...&quot;
cd &quot;$IMLIB2_DIR&quot;

# Clean previous builds if any
if [ -f &quot;Makefile&quot; ]; then
    make clean || true
fi

# Configure with specific flags to avoid issues with old system libs (avif, heif, jxl)
# We install to /usr/local to keep it separate from system packages
if ! ./configure --prefix=/usr/local --without-avif --without-heif --without-jxl; then
    echo &quot;Error: Imlib2 configuration failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Compiling Imlib2 (this may take a while)...&quot;
if ! make -j$(nproc); then
    echo &quot;Error: Imlib2 compilation failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Installing Imlib2...&quot;
if ! sudo make install; then
    echo &quot;Error: Imlib2 installation failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Updating library cache...&quot;
# Ensure /usr/local/lib is in the linker search path
if [ ! -f &quot;$LD_CONF_FILE&quot; ]; then
    echo &quot;Creating linker config file $LD_CONF_FILE...&quot;
    echo &quot;/usr/local/lib&quot; | sudo tee &quot;$LD_CONF_FILE&quot; &gt; /dev/null
else
    # Check if it already contains the path
    if ! grep -q &quot;/usr/local/lib&quot; &quot;$LD_CONF_FILE&quot;; then
        echo &quot;/usr/local/lib&quot; | sudo tee -a &quot;$LD_CONF_FILE&quot; &gt; /dev/null
        echo &quot;Added /usr/local/lib to $LD_CONF_FILE&quot;
    fi
fi

if ! sudo ldconfig; then
    echo &quot;Error: Failed to update library cache with ldconfig.&quot; &gt;&amp;2
    exit 1
fi
echo &quot;Imlib2 installed and library cache updated.&quot;

# --- Phase 3: Downloading and Building nsxiv ---

echo &quot;Preparing to build nsxiv...&quot;
if [ ! -d &quot;$NSXIV_DIR&quot; ]; then
    echo &quot;Cloning nsxiv repository...&quot;
    cd &quot;$BUILD_DIR&quot;
    if ! git clone &quot;$NSXIV_REPO_URL&quot;; then
        echo &quot;Error: Failed to clone nsxiv repository.&quot; &gt;&amp;2
        exit 1
    fi
else
    echo &quot;nsxiv repository already exists. Pulling latest changes...&quot;
    cd &quot;$NSXIV_DIR&quot;
    git pull
fi

cd &quot;$NSXIV_DIR&quot;

# Clean previous builds
make clean || true

# Configure config.mk for RK3588 optimization
echo &quot;Configuring config.mk for ARM64 optimization...&quot;
# Replace CFLAGS with optimized version for Cortex-A76/A55
if [ -f &quot;config.mk&quot; ]; then
    sed -i &#39;s/^CFLAGS = -Wall -pedantic -O2 -DNDEBUG/CFLAGS = -Wall -pedantic -O3 -mcpu=native -DNDEBUG/&#39; config.mk
    echo &quot;config.mk updated.&quot;
else
    echo &quot;Error: config.mk not found in nsxiv directory.&quot; &gt;&amp;2
    exit 1
fi

# Generate config.h
echo &quot;Generating config.h...&quot;
if ! make config.h; then
    echo &quot;Error: Failed to generate config.h.&quot; &gt;&amp;2
    exit 1
fi

# Edit config.h settings
echo &quot;Applying custom settings to config.h...&quot;
# Increase cache size to 10% (using flexible regex for whitespace)
sed -i &#39;s/static const int CACHE_SIZE_MEM_PERCENTAGE[[:space:]]*=[[:space:]]*3;/static const int CACHE_SIZE_MEM_PERCENTAGE = 10;/&#39; config.h

# Change font to monospace-10 (using flexible regex)
# Matches: static const char *BAR_FONT[] = { &quot;Nsxiv.bar.font&quot;, &quot;monospace-8&quot; };
sed -i &#39;s/static const char \*BAR_FONT\[\][[:space:]]*=[[:space:]]*{[[:space:]]*&quot;Nsxiv.bar.font&quot;,[[:space:]]*&quot;monospace-8&quot;[[:space:]]*};/static const char *BAR_FONT[] = { &quot;Nsxiv.bar.font&quot;, &quot;monospace-10&quot; };/&#39; config.h

echo &quot;config.h updated.&quot;

# Set environment variables to ensure compiler finds the new Imlib2 headers/libs
export CPATH=&quot;/usr/local/include:${CPATH:-}&quot;
export LIBRARY_PATH=&quot;/usr/local/lib:${LIBRARY_PATH:-}&quot;
export LD_LIBRARY_PATH=&quot;/usr/local/lib:${LD_LIBRARY_PATH:-}&quot;

echo &quot;Compiling nsxiv...&quot;
if ! make; then
    echo &quot;Error: nsxiv compilation failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Installing nsxiv...&quot;
if ! sudo make install-all; then
    echo &quot;Error: nsxiv installation failed.&quot; &gt;&amp;2
    exit 1
fi
echo &quot;nsxiv installed successfully.&quot;

# --- Phase 4: Post-Install Integration ---

echo &quot;Setting up post-install scripts and configuration...&quot;

# Create config directory
if [ ! -d &quot;$CONFIG_DIR&quot; ]; then
    mkdir -p &quot;$CONFIG_DIR&quot;
    echo &quot;Created configuration directory: $CONFIG_DIR&quot;
fi

# Copy example scripts
echo &quot;Copying example scripts...&quot;
if cp etc/examples/* &quot;$CONFIG_DIR/&quot;; then
    echo &quot;Scripts copied.&quot;
else
    echo &quot;Error: Failed to copy example scripts.&quot; &gt;&amp;2
    exit 1
fi

# Make scripts executable
chmod +x &quot;$CONFIG_DIR&quot;/*
echo &quot;Scripts made executable.&quot;

# Fix key-handler script for Alacritty/Zutty support
KEY_HANDLER_SCRIPT=&quot;$CONFIG_DIR/key-handler&quot;
echo &quot;Modifying key-handler script for terminal compatibility...&quot;

# Overwrite key-handler with the corrected content
cat &lt;&lt; &#39;EOF&#39; &gt; &quot;$KEY_HANDLER_SCRIPT&quot;
#!/bin/sh

# Example for $XDG_CONFIG_HOME/nsxiv/exec/key-handler
# Called by nsxiv(1) after the external prefix key (C-x by default) is pressed.
# The next key combo is passed as its first argument. Passed via stdin are the
# images to act upon: all marked images, if in thumbnail mode and at least one
# image has been marked, otherwise the current image. nsxiv(1) will block until
# the handler terminates. It then checks which images have been modified and
# reloads them.

# The key combo argument has the following form: &quot;[C-][M-][S-]KEY&quot;,
# where C/M/S indicate Ctrl/Meta(Alt)/Shift modifier states and KEY is the X
# keysym as listed in /usr/include/X11/keysymdef.h without the &quot;XK_&quot; prefix.
# If KEY has an uppercase equivalent, S-KEY is resolved into it. For instance,
# K replaces S-k and Scedilla replaces S-scedilla, but S-Delete is sent as-is.

# By default nsxiv(1) will send one image per-line to stdin, however when using
# -0 the image list will be NULL separated and the environment variable
# &quot;$NSXIV_USING_NULL&quot; will be set to 1.

[ &quot;$NSXIV_USING_NULL&quot; = 1 ] &amp;&amp; DELIM=&#39;\0&#39; || DELIM=&#39;\n&#39;

rotate() {
	tr &quot;$DELIM&quot; &#39;\0&#39; | xargs -0 realpath -z | sort -z -u | xargs -0 -I {} sh -c &#39;
		degree=&quot;$1&quot;
		case &quot;$(file -b -i &quot;{}&quot;)&quot; in
		image/jpeg*) jpegtran -rotate &quot;$degree&quot; -copy all -outfile &quot;{}&quot; &quot;{}&quot; ;;
		*)           mogrify  -rotate &quot;$degree&quot; &quot;{}&quot; ;;
		esac
	&#39; -- &quot;$1&quot;
}

spawn_term() {
  title=$1
  shift

  # If you set PREF_TERM, we&#39;ll honor it *if available*.
  if [ &quot;${PREF_TERM:-}&quot; = &quot;alacritty&quot; ] &amp;&amp; command -v alacritty &gt;/dev/null 2&gt;&amp;1; then
    alacritty -T &quot;$title&quot; -e &quot;$@&quot;
    return
  fi
  if [ &quot;${PREF_TERM:-}&quot; = &quot;zutty&quot; ] &amp;&amp; command -v zutty &gt;/dev/null 2&gt;&amp;1; then
    zutty -bg &quot;#444&quot; -fg &quot;#eee&quot; -saveLines 0 -title &quot;$title&quot; -e &quot;$@&quot;
    return
  fi

  # Auto-select. If both exist, this prefers alacritty; swap the order if you prefer zutty.
  if command -v alacritty &gt;/dev/null 2&gt;&amp;1; then
    alacritty -T &quot;$title&quot; -e &quot;$@&quot;
  elif command -v zutty &gt;/dev/null 2&gt;&amp;1; then
    zutty -bg &quot;#444&quot; -fg &quot;#eee&quot; -saveLines 0 -title &quot;$title&quot; -e &quot;$@&quot;
  else
    printf &gt;&amp;2 &#39;No supported terminal found (need alacritty and/or zutty)\n&#39;
    return 127
  fi
}

case &quot;$1&quot; in
&quot;C-x&quot;)      xclip -in -filter | tr &#39;\n&#39; &#39; &#39; | xclip -in -selection clipboard ;;
&quot;C-c&quot;)      while read file; do xclip -selection clipboard -target image/png &quot;$file&quot;; done ;;
&quot;C-e&quot;)      if [ &quot;${PREF_TERM:-}&quot; = &quot;alacritty&quot; ] &amp;&amp; command -v alacritty &gt;/dev/null 2&gt;&amp;1; then T=alacritty; elif [ &quot;${PREF_TERM:-}&quot; = &quot;zutty&quot; ] &amp;&amp; command -v zutty &gt;/dev/null 2&gt;&amp;1; then T=zutty; elif command -v alacritty &gt;/dev/null 2&gt;&amp;1; then T=alacritty; elif command -v zutty &gt;/dev/null 2&gt;&amp;1; then T=zutty; else T=; printf &gt;&amp;2 &#39;No supported terminal found (need alacritty and/or zutty)\n&#39;; fi; if [ -n &quot;$T&quot; ]; then while IFS= read -r file; do if [ &quot;$T&quot; = alacritty ]; then alacritty -T &quot;$file&quot; -e sh -c &#39;exiv2 -q -pa pr &quot;$1&quot; | less&#39; sh &quot;$file&quot; &amp; else zutty -bg &quot;#444&quot; -fg &quot;#eee&quot; -saveLines 0 -title &quot;$file&quot; -e sh -c &#39;exiv2 -q -pa pr &quot;$1&quot; | less&#39; sh &quot;$file&quot; &amp; fi; done; fi ;;
&quot;C-g&quot;)      tr &#39;\n&#39; &#39;\0&#39; | xargs -0 gimp &amp; ;;
&quot;C-r&quot;)      while read file; do rawtherapee &quot;$file&quot; &amp; done ;;
&quot;C-comma&quot;)  rotate 270 ;;
&quot;C-period&quot;) rotate  90 ;;
&quot;C-slash&quot;)  rotate 180 ;;
esac
EOF

echo &quot;key-handler script updated.&quot;

# --- Phase 5: Verification ---

echo &quot;Verifying installation...&quot;
if nsxiv -v; then
    echo &quot;nsxiv version check passed.&quot;
else
    echo &quot;Error: nsxiv version check failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Checking library linking...&quot;
if ldd &quot;$(which nsxiv)&quot; | grep -q &quot;/usr/local/lib/libImlib2.so&quot;; then
    echo &quot;Library linking check passed: nsxiv is using the correct Imlib2.&quot;
else
    echo &quot;Warning: nsxiv might be linking to the wrong Imlib2 library.&quot;
    echo &quot;Current link:&quot;
    ldd &quot;$(which nsxiv)&quot; | grep Imlib2
    echo &quot;Please verify manually.&quot;
fi

echo &quot;----------------------------------------------------------------&quot;
echo &quot;Installation Complete!&quot;
echo &quot;You can now use &#39;nsxiv&#39; to view images.&quot;
echo &quot;Example: nsxiv ~/Pictures&quot;
echo &quot;----------------------------------------------------------------&quot;

exit 0" data-download-link="" data-download-label="Download Bash">
  <code class="language-bash">#!/bin/bash
set -euo pipefail

# Script to build and install nsxiv (Neo Simple X Image Viewer)
# Target: Debian 11 (Bullseye) on ARM64 RK3588
# Purpose: Automates dependencies, Imlib2 compilation (fixing version issues),
#          nsxiv compilation (with optimizations), and post-install configuration.

# --- Configuration Variables ---
BUILD_DIR=&quot;$HOME/build&quot;
NSXIV_REPO_URL=&quot;https://codeberg.org/nsxiv/nsxiv.git&quot;
NSXIV_DIR=&quot;$BUILD_DIR/nsxiv&quot;
CONFIG_DIR=&quot;$HOME/.config/nsxiv/exec&quot;
IMLIB2_VERSION=&quot;1.12.6&quot;
IMLIB2_URL=&quot;https://downloads.sourceforge.net/enlightenment/imlib2-${IMLIB2_VERSION}.tar.xz&quot;
IMLIB2_DIR=&quot;$BUILD_DIR/imlib2-${IMLIB2_VERSION}&quot;
LD_CONF_FILE=&quot;/etc/ld.so.conf.d/local-libs.conf&quot;

# --- Helper Functions ---

# Function to check if a command exists and install its package if missing
ensure_tool_installed() {
    local tool_name=&quot;$1&quot;
    local package_name=&quot;${2:-$tool_name}&quot; # Use second arg as package name if provided, else tool_name
    if ! command -v &quot;$tool_name&quot; &gt;/dev/null 2&gt;&amp;1; then
        echo &quot;Tool &#39;$tool_name&#39; not found. Installing &#39;$package_name&#39;...&quot;
        if ! sudo apt install -y &quot;$package_name&quot;; then
            echo &quot;Error: Failed to install &#39;$package_name&#39;.&quot; &gt;&amp;2
            exit 1
        fi
        echo &quot;&#39;$package_name&#39; installed successfully.&quot;
    else
        echo &quot;Tool &#39;$tool_name&#39; is already installed.&quot;
    fi
}

# Setup trap for cleanup on exit
trap &#39;echo &quot;Script execution finished or interrupted.&quot;&#39; EXIT SIGINT SIGTERM

# --- Main Script ---

echo &quot;Starting nsxiv build and installation script for RK3588...&quot;

# --- Phase 1: Preparation &amp; Dependencies ---

echo &quot;Updating package lists...&quot;
if ! sudo apt update; then
    echo &quot;Error: Failed to update package lists.&quot; &gt;&amp;2
    exit 1
fi
echo &quot;Package lists updated.&quot;

echo &quot;Installing build dependencies and required tools...&quot;
# Core build tools
ensure_tool_installed &quot;git&quot;
ensure_tool_installed &quot;make&quot; &quot;build-essential&quot;
ensure_tool_installed &quot;gcc&quot;
ensure_tool_installed &quot;wget&quot;

# Specific library development headers and runtime tools
# Note: &#39;gimp&#39; and &#39;rawtherapee&#39; are added because the default key-handler script uses them.
PACKAGES_TO_INSTALL=(
    &quot;libx11-dev&quot;
    &quot;libimlib2-dev&quot; # Needed initially for dependencies, will be overridden by custom build
    &quot;libxft-dev&quot;
    &quot;libexif-dev&quot;
    &quot;libfontconfig1-dev&quot;
    &quot;xclip&quot;
    &quot;libjpeg-progs&quot;
    &quot;imagemagick&quot;
    &quot;exiv2&quot;
    &quot;gimp&quot;
    &quot;rawtherapee&quot;
    &quot;libjpeg-dev&quot;
    &quot;libpng-dev&quot;
    &quot;libtiff-dev&quot;
    &quot;libgif-dev&quot;
    &quot;libwebp-dev&quot;
    &quot;libfreetype6-dev&quot;
    &quot;libxext-dev&quot;
    &quot;libxcb1-dev&quot;
)

echo &quot;Installing packages: ${PACKAGES_TO_INSTALL[*]}&quot;
if ! sudo apt install -y &quot;${PACKAGES_TO_INSTALL[@]}&quot;; then
    echo &quot;Error: Failed to install dependencies.&quot; &gt;&amp;2
    exit 1
fi
echo &quot;Dependencies installed successfully.&quot;

# --- Phase 2: Handling Imlib2 Version Issue ---

echo &quot;Checking Imlib2 version requirements...&quot;
# Debian 11 has an old Imlib2. We need to build a newer one.
# Remove system libimlib2-dev to avoid conflicts during build
if dpkg -s libimlib2-dev &gt;/dev/null 2&gt;&amp;1; then
    echo &quot;Removing system libimlib2-dev to prevent conflicts with custom build...&quot;
    if ! sudo apt remove -y libimlib2-dev; then
        echo &quot;Error: Failed to remove libimlib2-dev.&quot; &gt;&amp;2
        exit 1
    fi
    echo &quot;System libimlib2-dev removed.&quot;
fi

# Create build directory
if [ ! -d &quot;$BUILD_DIR&quot; ]; then
    mkdir -p &quot;$BUILD_DIR&quot;
    echo &quot;Created build directory: $BUILD_DIR&quot;
fi

# Download and Extract Imlib2
if [ ! -d &quot;$IMLIB2_DIR&quot; ]; then
    echo &quot;Downloading Imlib2 ${IMLIB2_VERSION}...&quot;
    cd &quot;$BUILD_DIR&quot;
    if ! wget &quot;$IMLIB2_URL&quot;; then
        echo &quot;Error: Failed to download Imlib2.&quot; &gt;&amp;2
        exit 1
    fi
    
    echo &quot;Extracting Imlib2...&quot;
    if ! tar -xf &quot;imlib2-${IMLIB2_VERSION}.tar.xz&quot;; then
        echo &quot;Error: Failed to extract Imlib2.&quot; &gt;&amp;2
        exit 1
    fi
else
    echo &quot;Imlib2 source directory already exists. Skipping download.&quot;
fi

echo &quot;Configuring and compiling Imlib2...&quot;
cd &quot;$IMLIB2_DIR&quot;

# Clean previous builds if any
if [ -f &quot;Makefile&quot; ]; then
    make clean || true
fi

# Configure with specific flags to avoid issues with old system libs (avif, heif, jxl)
# We install to /usr/local to keep it separate from system packages
if ! ./configure --prefix=/usr/local --without-avif --without-heif --without-jxl; then
    echo &quot;Error: Imlib2 configuration failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Compiling Imlib2 (this may take a while)...&quot;
if ! make -j$(nproc); then
    echo &quot;Error: Imlib2 compilation failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Installing Imlib2...&quot;
if ! sudo make install; then
    echo &quot;Error: Imlib2 installation failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Updating library cache...&quot;
# Ensure /usr/local/lib is in the linker search path
if [ ! -f &quot;$LD_CONF_FILE&quot; ]; then
    echo &quot;Creating linker config file $LD_CONF_FILE...&quot;
    echo &quot;/usr/local/lib&quot; | sudo tee &quot;$LD_CONF_FILE&quot; &gt; /dev/null
else
    # Check if it already contains the path
    if ! grep -q &quot;/usr/local/lib&quot; &quot;$LD_CONF_FILE&quot;; then
        echo &quot;/usr/local/lib&quot; | sudo tee -a &quot;$LD_CONF_FILE&quot; &gt; /dev/null
        echo &quot;Added /usr/local/lib to $LD_CONF_FILE&quot;
    fi
fi

if ! sudo ldconfig; then
    echo &quot;Error: Failed to update library cache with ldconfig.&quot; &gt;&amp;2
    exit 1
fi
echo &quot;Imlib2 installed and library cache updated.&quot;

# --- Phase 3: Downloading and Building nsxiv ---

echo &quot;Preparing to build nsxiv...&quot;
if [ ! -d &quot;$NSXIV_DIR&quot; ]; then
    echo &quot;Cloning nsxiv repository...&quot;
    cd &quot;$BUILD_DIR&quot;
    if ! git clone &quot;$NSXIV_REPO_URL&quot;; then
        echo &quot;Error: Failed to clone nsxiv repository.&quot; &gt;&amp;2
        exit 1
    fi
else
    echo &quot;nsxiv repository already exists. Pulling latest changes...&quot;
    cd &quot;$NSXIV_DIR&quot;
    git pull
fi

cd &quot;$NSXIV_DIR&quot;

# Clean previous builds
make clean || true

# Configure config.mk for RK3588 optimization
echo &quot;Configuring config.mk for ARM64 optimization...&quot;
# Replace CFLAGS with optimized version for Cortex-A76/A55
if [ -f &quot;config.mk&quot; ]; then
    sed -i &#39;s/^CFLAGS = -Wall -pedantic -O2 -DNDEBUG/CFLAGS = -Wall -pedantic -O3 -mcpu=native -DNDEBUG/&#39; config.mk
    echo &quot;config.mk updated.&quot;
else
    echo &quot;Error: config.mk not found in nsxiv directory.&quot; &gt;&amp;2
    exit 1
fi

# Generate config.h
echo &quot;Generating config.h...&quot;
if ! make config.h; then
    echo &quot;Error: Failed to generate config.h.&quot; &gt;&amp;2
    exit 1
fi

# Edit config.h settings
echo &quot;Applying custom settings to config.h...&quot;
# Increase cache size to 10% (using flexible regex for whitespace)
sed -i &#39;s/static const int CACHE_SIZE_MEM_PERCENTAGE[[:space:]]*=[[:space:]]*3;/static const int CACHE_SIZE_MEM_PERCENTAGE = 10;/&#39; config.h

# Change font to monospace-10 (using flexible regex)
# Matches: static const char *BAR_FONT[] = { &quot;Nsxiv.bar.font&quot;, &quot;monospace-8&quot; };
sed -i &#39;s/static const char \*BAR_FONT\[\][[:space:]]*=[[:space:]]*{[[:space:]]*&quot;Nsxiv.bar.font&quot;,[[:space:]]*&quot;monospace-8&quot;[[:space:]]*};/static const char *BAR_FONT[] = { &quot;Nsxiv.bar.font&quot;, &quot;monospace-10&quot; };/&#39; config.h

echo &quot;config.h updated.&quot;

# Set environment variables to ensure compiler finds the new Imlib2 headers/libs
export CPATH=&quot;/usr/local/include:${CPATH:-}&quot;
export LIBRARY_PATH=&quot;/usr/local/lib:${LIBRARY_PATH:-}&quot;
export LD_LIBRARY_PATH=&quot;/usr/local/lib:${LD_LIBRARY_PATH:-}&quot;

echo &quot;Compiling nsxiv...&quot;
if ! make; then
    echo &quot;Error: nsxiv compilation failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Installing nsxiv...&quot;
if ! sudo make install-all; then
    echo &quot;Error: nsxiv installation failed.&quot; &gt;&amp;2
    exit 1
fi
echo &quot;nsxiv installed successfully.&quot;

# --- Phase 4: Post-Install Integration ---

echo &quot;Setting up post-install scripts and configuration...&quot;

# Create config directory
if [ ! -d &quot;$CONFIG_DIR&quot; ]; then
    mkdir -p &quot;$CONFIG_DIR&quot;
    echo &quot;Created configuration directory: $CONFIG_DIR&quot;
fi

# Copy example scripts
echo &quot;Copying example scripts...&quot;
if cp etc/examples/* &quot;$CONFIG_DIR/&quot;; then
    echo &quot;Scripts copied.&quot;
else
    echo &quot;Error: Failed to copy example scripts.&quot; &gt;&amp;2
    exit 1
fi

# Make scripts executable
chmod +x &quot;$CONFIG_DIR&quot;/*
echo &quot;Scripts made executable.&quot;

# Fix key-handler script for Alacritty/Zutty support
KEY_HANDLER_SCRIPT=&quot;$CONFIG_DIR/key-handler&quot;
echo &quot;Modifying key-handler script for terminal compatibility...&quot;

# Overwrite key-handler with the corrected content
cat &lt;&lt; &#39;EOF&#39; &gt; &quot;$KEY_HANDLER_SCRIPT&quot;
#!/bin/sh

# Example for $XDG_CONFIG_HOME/nsxiv/exec/key-handler
# Called by nsxiv(1) after the external prefix key (C-x by default) is pressed.
# The next key combo is passed as its first argument. Passed via stdin are the
# images to act upon: all marked images, if in thumbnail mode and at least one
# image has been marked, otherwise the current image. nsxiv(1) will block until
# the handler terminates. It then checks which images have been modified and
# reloads them.

# The key combo argument has the following form: &quot;[C-][M-][S-]KEY&quot;,
# where C/M/S indicate Ctrl/Meta(Alt)/Shift modifier states and KEY is the X
# keysym as listed in /usr/include/X11/keysymdef.h without the &quot;XK_&quot; prefix.
# If KEY has an uppercase equivalent, S-KEY is resolved into it. For instance,
# K replaces S-k and Scedilla replaces S-scedilla, but S-Delete is sent as-is.

# By default nsxiv(1) will send one image per-line to stdin, however when using
# -0 the image list will be NULL separated and the environment variable
# &quot;$NSXIV_USING_NULL&quot; will be set to 1.

[ &quot;$NSXIV_USING_NULL&quot; = 1 ] &amp;&amp; DELIM=&#39;\0&#39; || DELIM=&#39;\n&#39;

rotate() {
	tr &quot;$DELIM&quot; &#39;\0&#39; | xargs -0 realpath -z | sort -z -u | xargs -0 -I {} sh -c &#39;
		degree=&quot;$1&quot;
		case &quot;$(file -b -i &quot;{}&quot;)&quot; in
		image/jpeg*) jpegtran -rotate &quot;$degree&quot; -copy all -outfile &quot;{}&quot; &quot;{}&quot; ;;
		*)           mogrify  -rotate &quot;$degree&quot; &quot;{}&quot; ;;
		esac
	&#39; -- &quot;$1&quot;
}

spawn_term() {
  title=$1
  shift

  # If you set PREF_TERM, we&#39;ll honor it *if available*.
  if [ &quot;${PREF_TERM:-}&quot; = &quot;alacritty&quot; ] &amp;&amp; command -v alacritty &gt;/dev/null 2&gt;&amp;1; then
    alacritty -T &quot;$title&quot; -e &quot;$@&quot;
    return
  fi
  if [ &quot;${PREF_TERM:-}&quot; = &quot;zutty&quot; ] &amp;&amp; command -v zutty &gt;/dev/null 2&gt;&amp;1; then
    zutty -bg &quot;#444&quot; -fg &quot;#eee&quot; -saveLines 0 -title &quot;$title&quot; -e &quot;$@&quot;
    return
  fi

  # Auto-select. If both exist, this prefers alacritty; swap the order if you prefer zutty.
  if command -v alacritty &gt;/dev/null 2&gt;&amp;1; then
    alacritty -T &quot;$title&quot; -e &quot;$@&quot;
  elif command -v zutty &gt;/dev/null 2&gt;&amp;1; then
    zutty -bg &quot;#444&quot; -fg &quot;#eee&quot; -saveLines 0 -title &quot;$title&quot; -e &quot;$@&quot;
  else
    printf &gt;&amp;2 &#39;No supported terminal found (need alacritty and/or zutty)\n&#39;
    return 127
  fi
}

case &quot;$1&quot; in
&quot;C-x&quot;)      xclip -in -filter | tr &#39;\n&#39; &#39; &#39; | xclip -in -selection clipboard ;;
&quot;C-c&quot;)      while read file; do xclip -selection clipboard -target image/png &quot;$file&quot;; done ;;
&quot;C-e&quot;)      if [ &quot;${PREF_TERM:-}&quot; = &quot;alacritty&quot; ] &amp;&amp; command -v alacritty &gt;/dev/null 2&gt;&amp;1; then T=alacritty; elif [ &quot;${PREF_TERM:-}&quot; = &quot;zutty&quot; ] &amp;&amp; command -v zutty &gt;/dev/null 2&gt;&amp;1; then T=zutty; elif command -v alacritty &gt;/dev/null 2&gt;&amp;1; then T=alacritty; elif command -v zutty &gt;/dev/null 2&gt;&amp;1; then T=zutty; else T=; printf &gt;&amp;2 &#39;No supported terminal found (need alacritty and/or zutty)\n&#39;; fi; if [ -n &quot;$T&quot; ]; then while IFS= read -r file; do if [ &quot;$T&quot; = alacritty ]; then alacritty -T &quot;$file&quot; -e sh -c &#39;exiv2 -q -pa pr &quot;$1&quot; | less&#39; sh &quot;$file&quot; &amp; else zutty -bg &quot;#444&quot; -fg &quot;#eee&quot; -saveLines 0 -title &quot;$file&quot; -e sh -c &#39;exiv2 -q -pa pr &quot;$1&quot; | less&#39; sh &quot;$file&quot; &amp; fi; done; fi ;;
&quot;C-g&quot;)      tr &#39;\n&#39; &#39;\0&#39; | xargs -0 gimp &amp; ;;
&quot;C-r&quot;)      while read file; do rawtherapee &quot;$file&quot; &amp; done ;;
&quot;C-comma&quot;)  rotate 270 ;;
&quot;C-period&quot;) rotate  90 ;;
&quot;C-slash&quot;)  rotate 180 ;;
esac
EOF

echo &quot;key-handler script updated.&quot;

# --- Phase 5: Verification ---

echo &quot;Verifying installation...&quot;
if nsxiv -v; then
    echo &quot;nsxiv version check passed.&quot;
else
    echo &quot;Error: nsxiv version check failed.&quot; &gt;&amp;2
    exit 1
fi

echo &quot;Checking library linking...&quot;
if ldd &quot;$(which nsxiv)&quot; | grep -q &quot;/usr/local/lib/libImlib2.so&quot;; then
    echo &quot;Library linking check passed: nsxiv is using the correct Imlib2.&quot;
else
    echo &quot;Warning: nsxiv might be linking to the wrong Imlib2 library.&quot;
    echo &quot;Current link:&quot;
    ldd &quot;$(which nsxiv)&quot; | grep Imlib2
    echo &quot;Please verify manually.&quot;
fi

echo &quot;----------------------------------------------------------------&quot;
echo &quot;Installation Complete!&quot;
echo &quot;You can now use &#39;nsxiv&#39; to view images.&quot;
echo &quot;Example: nsxiv ~/Pictures&quot;
echo &quot;----------------------------------------------------------------&quot;

exit 0</code>
</section>]]></content><author><name></name></author><category term="scratchpad" /></entry><entry><title type="html">MLC-LLM for rk3588</title><link href="https://ib.bsb.br/mlc-llm-rk3588/" rel="alternate" type="text/html" title="MLC-LLM for rk3588" /><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T21:56:32+00:00</updated><id>https://ib.bsb.br/mlc-llm_rk3588</id><content type="html" xml:base="https://ib.bsb.br/mlc-llm-rk3588/"><![CDATA[<p>Please open an issue if you find something that can be improved in this guide</p>

<p>See benchmarks for various models I’ve tested <a href="https://github.com/serialscriptr/Orange-PI-5-Pro-MLC-LLM/blob/main/mlc-llm%20benchmarks.md">here</a></p>

<h2 id="prepare-the-hardware">Prepare the hardware</h2>
<p>While this guide is tailored to the rk3588 it could also be used as a generic guide for other boards using rockchip. Make sure your hardware is properly cooled with a fan and heatsinks as the hardware may overheat or thermal throttle.</p>
<h2 id="install-ubuntu-for-rockchip">Install Ubuntu for Rockchip</h2>
<ul>
  <li>Download the latest version of ubuntu for your device <a href="https://joshua-riek.github.io/ubuntu-rockchip-download/">here</a></li>
  <li>Burn the OS image to a micro SD card using balenaetcher or any other image writing software</li>
  <li>Boot the OS on your device. Optionally connect via SSH for convivence. The default username and password is ubuntu/ubuntu. Once you login for the first time you will be forced to change the password</li>
</ul>

<h2 id="install-os-to-ssd-or-emmc-optional-but-recommended">Install OS to SSD or eMMC (Optional but recommended)</h2>
<p>In order to not experience disk read/write speed bottlenecks when using mlc-llm I highly recommend using a M.2 SSD or eMMC storage module.</p>
<ul>
  <li>Once booted to the OS off the micro SD card run</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>fdisk <span class="nt">-l</span>
</code></pre></div></div>
<p>to find the storage you will be installing the OS on (Highlighted in red is the eMMC module I will be installing my OS on)
   <img width="539" alt="Pasted image 20240910125904" src="https://github.com/user-attachments/assets/c1fbc06f-944f-465b-bade-50967160d4f0" /></p>

<ul>
  <li>Once you found the storage to install the OS on run the following command
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ubuntu-rockchip-install /dev/mmcblk0
</code></pre></div>    </div>
    <p>Where “/dev/mmcblk0” is the storage you wish to install the OS on as shown by fdisk. After the process is done you will need to power off the device, remove the micro SD card and turn the system back on.</p>
  </li>
</ul>

<h2 id="install-opencl-gpu-drivers">Install OpenCL GPU Drivers</h2>
<ul>
  <li>Download and install <code class="language-plaintext highlighter-rouge">libmali-g610.so</code>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /usr/lib <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>wget https://github.com/JeffyCN/mirrors/raw/libmali/lib/aarch64-linux-gnu/libmali-valhall-g610-g6p0-x11-wayland-gbm.so
</code></pre></div>    </div>
  </li>
  <li>Check if file <code class="language-plaintext highlighter-rouge">mali_csffw.bin</code> exist under path <code class="language-plaintext highlighter-rouge">/lib/firmware</code>, if not download it with command:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /lib/firmware <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>wget https://github.com/JeffyCN/mirrors/raw/libmali/firmware/g610/mali_csffw.bin
</code></pre></div>    </div>
  </li>
  <li>Download OpenCL ICD loader and manually add libmali to ICD
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt <span class="nb">install </span>mesa-opencl-icd
<span class="nb">sudo mkdir</span> <span class="nt">-p</span> /etc/OpenCL/vendors
<span class="nb">echo</span> <span class="s2">"/usr/lib/libmali-valhall-g610-g6p0-x11-wayland-gbm.so"</span> | <span class="nb">sudo tee</span> /etc/OpenCL/vendors/mali.icd
</code></pre></div>    </div>
  </li>
  <li>Download and install <code class="language-plaintext highlighter-rouge">libOpenCL</code>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>ocl-icd-opencl-dev
</code></pre></div>    </div>
  </li>
  <li>Download and install dependencies for Mali OpenCL
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>libxcb-dri2-0 libxcb-dri3-0 libwayland-client0 libwayland-server0 libx11-xcb1
</code></pre></div>    </div>
  </li>
  <li>Download and install clinfo to check if OpenCL successfully installed
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>clinfo
</code></pre></div>    </div>
  </li>
  <li>Run clinfo and check the results. We are looking for a mali device like shown below.<img src="https://github.com/user-attachments/assets/e9913f73-8d7b-4186-83e2-859bfd2e15f6" alt="Pasted image 20240910132233" /></li>
</ul>

<h2 id="install-conda---miniconda-optional-but-recommended">Install Conda - miniconda (optional but recommended)</h2>
<p>While not necessary using conda will make managing dependencies for your build environment much easier.</p>
<ul>
  <li>Grab the latest installer script for your hardware <a href="https://docs.anaconda.com/miniconda/">here</a> for the rk3588 I will be using “Miniconda3 Linux-aarch64 64-bit” as the device is using an arm64 CPU.</li>
  <li>Run the following, change the installer script url accordingly
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> ~/miniconda3
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-aarch64.sh <span class="nt">-O</span> ~/miniconda3/miniconda.sh
bash ~/miniconda3/miniconda.sh <span class="nt">-b</span> <span class="nt">-u</span> <span class="nt">-p</span> ~/miniconda3
<span class="nb">rm</span> ~/miniconda3/miniconda.sh
</code></pre></div>    </div>
  </li>
  <li>add/initialize conda in your shell
 for bash:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~/miniconda3/bin/conda init bash
</code></pre></div>    </div>
    <p>for zsh:</p>
    <div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~/miniconda3/bin/conda init zsh
</code></pre></div>    </div>
  </li>
  <li>
    <p>close and restart your shell to activate and start using conda. You should see (base) next to your username <img src="https://github.com/user-attachments/assets/fe7c8885-55a2-417c-9318-69942e9a9fce" alt="Pasted image 20240910134503" /></p>
  </li>
  <li>Update conda
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda update <span class="nt">--yes</span> <span class="nt">-n</span> base <span class="nt">-c</span> defaults conda
</code></pre></div>    </div>
  </li>
  <li><strong>Set libmamba as the dependency solver.</strong> The default dependency solver in conda could be slow in certain scenarios, and it is always recommended to upgrade it to libmamba, a faster solver. Install:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda <span class="nb">install</span> <span class="nt">--yes</span> <span class="nt">-n</span> base conda-libmamba-solver
</code></pre></div>    </div>
    <p>set as default dependency solver:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda config <span class="nt">--set</span> solver libmamba
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="compile-tvm-unity-optional-but-recommended">Compile TVM-Unity (Optional but recommended)</h2>
<p>See instructions here for up to date instructions: https://llm.mlc.ai/docs/install/tvm.html</p>

<p>mlc-llm provides pre-compiles tvm packages which should be fine for our uses but in my personal testing I was unable to get them to work (specifically on the rk3588). If you skip this section and encounter errors related to the “tvm” module I recommend attempting to compile it yourself.</p>

<h3 id="some-prerequisites">Some prerequisites</h3>
<p>Since these packages are required when building mlc-llm I install them with apt install but you could optionally install them to your build environment with conda. Either way make sure these packages are install prior to attempting to compile TVM-Unity</p>
<ul>
  <li>doxygen</li>
  <li>graphviz</li>
  <li>build-essential (ubuntu specific package. Install the equivalent for your OS)</li>
  <li>zlib1g-dev</li>
  <li>libfl-dev</li>
  <li>clang</li>
  <li>libxml2-dev</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>doxygen graphviz build-essential zlib1g-dev libfl-dev clang libxml2-dev
</code></pre></div></div>

<h4 id="pip-prerequisites">PIP prerequisites</h4>
<p>The following python modules are required in order for us to run mlc-llm and test our tvm-unity build. If you are not using conda you will need to install and use python3-pip</p>
<ul>
  <li>numpy</li>
  <li>decorator</li>
  <li>psutil</li>
  <li>typing_extensions</li>
  <li>packaging</li>
  <li>attrs</li>
  <li>cython</li>
</ul>

<p>Using pip</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>numpy decorator psutil typing_extensions packaging attrs cython
</code></pre></div></div>
<p>Using conda</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda <span class="nb">install </span>numpy decorator psutil typing_extensions packaging attrs cython
</code></pre></div></div>
<h3 id="using-conda">Using conda</h3>
<p>The following commands are for setting up a build environment for compiling TVM-Unity. If you skipped the conda installation you can attempt to install these dependencies using apt install. If manually installing these packages with apt install make sure you are installing the correct versions as by default it will install the latest version of each package.</p>

<p>Run the following to create and setup the conda environment</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># make sure to start with a fresh environment</span>
conda <span class="nb">env </span>remove <span class="nt">-n</span> tvm-build-venv
<span class="c"># create the conda environment with build dependency</span>
conda create <span class="nt">-n</span> tvm-build-venv <span class="nt">-c</span> conda-forge <span class="se">\</span>
    <span class="s2">"llvmdev&gt;=15"</span> <span class="se">\</span>
    <span class="s2">"cmake&gt;=3.24"</span> <span class="se">\</span>
    git <span class="se">\</span>
    <span class="nv">python</span><span class="o">=</span>3.11
<span class="c"># enter the build environment</span>
conda activate tvm-build-venv
</code></pre></div></div>

<ul>
  <li>Clone the github repo for tvm-unity (actually mlc-ai/relax temporarily, check link above to see if tvm-unity is recommended now) I recommend cloning in the home directory (~)
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># clone from GitHub</span>
git clone <span class="nt">--recursive</span> https://github.com/mlc-ai/relax.git tvm-unity <span class="o">&amp;&amp;</span> <span class="nb">cd </span>tvm-unity
<span class="c"># create the build directory</span>
<span class="nb">rm</span> <span class="nt">-rf</span> build <span class="o">&amp;&amp;</span> <span class="nb">mkdir </span>build <span class="o">&amp;&amp;</span> <span class="nb">cd </span>build
<span class="c"># specify build requirements in `config.cmake`</span>
<span class="nb">cp</span> ../cmake/config.cmake <span class="nb">.</span>
</code></pre></div>    </div>
  </li>
  <li>configure the cmake.config file which instructs cmake how we want to compile the project. Ensure you are in the build directory created earlier when running these commands.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"set(CMAKE_BUILD_TYPE RelWithDebInfo)"</span> <span class="o">&gt;&gt;</span> config.cmake
<span class="nb">echo</span> <span class="s2">"set(USE_LLVM </span><span class="se">\"</span><span class="s2">llvm-config --ignore-libllvm --link-static</span><span class="se">\"</span><span class="s2">)"</span> <span class="o">&gt;&gt;</span> config.cmake
<span class="nb">echo</span> <span class="s2">"set(HIDE_PRIVATE_SYMBOLS ON)"</span> <span class="o">&gt;&gt;</span> config.cmake
</code></pre></div>    </div>
  </li>
  <li>Set how mlc-llm will run the llm. The options are Cuda (Nvidia), Metal (Apple), Vulkan (AMD) and OpenCL which is what we will be using. If you are using something other than OpenCL make sure you set that to “ON”
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"set(USE_OPENCL ON)"</span> <span class="o">&gt;&gt;</span> config.cmake
</code></pre></div>    </div>
  </li>
  <li>once the config.cmake file is created and configured to our liking we can run the following to build the project. Again ensure you are in the build folder from earlier:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cmake .. <span class="o">&amp;&amp;</span> cmake <span class="nt">--build</span> <span class="nb">.</span> <span class="nt">--parallel</span> <span class="si">$(</span><span class="nb">nproc</span><span class="si">)</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="verify-tvm-compiled-correct">Verify TVM compiled correct</h3>
<p>You may see several warnings or errors during compilation but this should be ok as long as the build doesn’t end with several error messages like the screenshot below which is due to missing libfl-dev <img src="https://github.com/user-attachments/assets/6eac5357-e851-4396-ae45-d554505053b3" alt="Pasted image 20240910152125" /></p>

<p>if you encounter any errors such as the error shown above remediate the errors by installing the required packages and restart the process including and following this command in the guide above. Make sure you are in the tvm-unity directory when running the command below.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> <span class="nt">-rf</span> build <span class="o">&amp;&amp;</span> <span class="nb">mkdir </span>build <span class="o">&amp;&amp;</span> <span class="nb">cd </span>build
</code></pre></div></div>

<p>Example of output when built successfully: <img src="https://github.com/user-attachments/assets/c51bd9fc-f5b1-425e-9495-1088dc34b98c" alt="Pasted image 20240910170713" /></p>

<p>Add the tvm-unity path to your python path variable. Edit the path if your tvm-unity folder is located somewhere else:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">PYTHONPATH</span><span class="o">=</span>/home/ubuntu/tvm-unity/python:<span class="nv">$PYTHONPATH</span>
</code></pre></div></div>
<p>After adding the path to your python path variable run the following. Make sure you have the python modules installed from the pip prerequisites section!</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python <span class="nt">-c</span> <span class="s2">"import tvm; print(tvm.__file__)"</span>
</code></pre></div></div>
<p>which should output something similar to: <img src="https://github.com/user-attachments/assets/ed4880f6-1e75-4f95-bc7f-244c4a4e838d" alt="Pasted image 20240910173413" /></p>

<p>10/10/24: You may see errors about “-mcpu=apple-latest” this is safe to ignore provided the final output is similar to the output shown above. Ex:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>20:09:46] /home/ubuntu/tvm-unity/src/target/llvm/llvm_instance.cc:226: Error: Using LLVM 19.1.1 with <span class="sb">`</span><span class="nt">-mcpu</span><span class="o">=</span>apple-latest<span class="sb">`</span> is not valid <span class="k">in</span> <span class="sb">`</span><span class="nt">-mtriple</span><span class="o">=</span>arm64-apple-macos<span class="sb">`</span>, using default <span class="sb">`</span><span class="nt">-mcpu</span><span class="o">=</span>generic<span class="sb">`</span>
<span class="o">[</span>20:09:46] /home/ubuntu/tvm-unity/src/target/llvm/llvm_instance.cc:226: Error: Using LLVM 19.1.1 with <span class="sb">`</span><span class="nt">-mcpu</span><span class="o">=</span>apple-latest<span class="sb">`</span> is not valid <span class="k">in</span> <span class="sb">`</span><span class="nt">-mtriple</span><span class="o">=</span>arm64-apple-macos<span class="sb">`</span>, using default <span class="sb">`</span><span class="nt">-mcpu</span><span class="o">=</span>generic<span class="sb">`</span>
<span class="o">[</span>20:09:46] /home/ubuntu/tvm-unity/src/target/llvm/llvm_instance.cc:226: Error: Using LLVM 19.1.1 with <span class="sb">`</span><span class="nt">-mcpu</span><span class="o">=</span>apple-latest<span class="sb">`</span> is not valid <span class="k">in</span> <span class="sb">`</span><span class="nt">-mtriple</span><span class="o">=</span>arm64-apple-macos<span class="sb">`</span>, using default <span class="sb">`</span><span class="nt">-mcpu</span><span class="o">=</span>generic<span class="sb">`</span>
</code></pre></div></div>

<p>Now run the following to check the build options used:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python <span class="nt">-c</span> <span class="s2">"import tvm; print('</span><span class="se">\n</span><span class="s2">'.join(f'{k}: {v}' for k, v in tvm.support.libinfo().items()))"</span>
</code></pre></div></div>
<p>We should then be able to see opencl set to “ON”</p>

<p><img width="304" alt="Pasted image 20240910173823" src="https://github.com/user-attachments/assets/e9097e30-664b-4a76-b80e-e13ce060a6f9" /></p>

<h2 id="compile-mlc-llm-from-source">Compile mlc-llm from source</h2>

<h3 id="package-prerequisites">Package prerequisites</h3>
<p>There is only one other package required here compared to the tvm-unity section. If you installed the packages included in the tvm-unity section then you only need to install git-lfs</p>
<ul>
  <li>git-lfs</li>
  <li>Doxygen</li>
  <li>Graphviz</li>
  <li>build-essential (ubuntu specific package. Install the equivalent for your OS)</li>
  <li>zlib1g-dev</li>
  <li>libfl-dev</li>
  <li>clang
    <h4 id="pip-prerequisites-1">PIP prerequisites</h4>
    <p>The following python modules are required in order for us to run mlc-llm. If you are not using conda you will need to install and use python3-pip.</p>
  </li>
  <li>numpy</li>
  <li>decorator</li>
  <li>psutil</li>
  <li>typing_extensions</li>
  <li>packaging</li>
  <li>attrs</li>
  <li>pydantic</li>
  <li>shortuuid</li>
  <li>fastapi</li>
  <li>requests</li>
  <li>tqdm</li>
  <li>prompt_toolkit</li>
  <li>uvicorn</li>
  <li>cython</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>numpy decorator psutil typing_extensions packaging attrs pydantic shortuuid fastapi requests tqdm prompt_toolkit uvicorn cython
</code></pre></div></div>

<h3 id="conda-environment-optional-but-recommended">Conda environment (optional but recommended)</h3>
<p>If you have conda installed from earlier perform the following to setup a build environment for mlc-llm. Note that if you aren’t using conda you need to have the packages installed on your OS with the recommended versions.</p>
<ul>
  <li>Create the environment
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda create <span class="nt">-n</span> mlc-chat-venv <span class="nt">-c</span> conda-forge <span class="se">\</span>
  <span class="s2">"cmake&gt;=3.24"</span> <span class="se">\</span>
  rust <span class="se">\</span>
  git <span class="se">\</span>
  <span class="nv">python</span><span class="o">=</span>3.11
</code></pre></div>    </div>
  </li>
  <li>activate the environment
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda activate mlc-chat-venv
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="clone-and-compile">Clone and compile</h3>
<ul>
  <li>clone the mlc-llm github repo. I recommend cloning it to your home directory to make things easy:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone <span class="nt">--recursive</span> https://github.com/mlc-ai/mlc-llm.git <span class="o">&amp;&amp;</span> <span class="nb">cd </span>mlc-llm/
</code></pre></div>    </div>
  </li>
  <li>create the build directory
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> build <span class="o">&amp;&amp;</span> <span class="nb">cd </span>build
</code></pre></div>    </div>
  </li>
  <li>generate the config.cmake with the following script. Note if you are not using conda you will likely have to replace “python” with “python3”
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python ../cmake/gen_cmake_config.py
</code></pre></div>    </div>
  </li>
  <li>
    <p>for the first option of the script, the tvm location, if you followed the compile tvm-unity instructions from earlier you should use that directory here. Otherwise you can attempt to use the default provided and just leave this option blank. Here in the example below I am using a custom compiled tvm <img src="https://github.com/user-attachments/assets/91853fcf-bf9c-4b5d-8688-3bae6e57a229" alt="Pasted image 20240910175631" /></p>
  </li>
  <li>Use CUDA should be no</li>
  <li>Use CUTLASS should be no</li>
  <li>Use CUBLAS should be no</li>
  <li>Use ROCm should be no</li>
  <li>Use Vulkan should be no</li>
  <li>Use Metal should be no</li>
  <li>Use OpenCL should be Yes</li>
  <li>Use OpenCLHostPtr can be yes or no. From what I understand this has something to do with using storage for opencl cache of some kind but dont have a great understanding of what exactly this means/does.</li>
  <li>Use FlashInfer should be no
Here is my output after running the script:
<img src="https://github.com/user-attachments/assets/bb2e8efb-5ca3-4dfb-a824-ce8ae9c987b3" alt="Pasted image 20240910180223" /></li>
</ul>

<p>Now you are ready to compile. Run the following to build the project. Again keep an eye out for errors and warnings . Warnings and errors may not prevent the project from compiling</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cmake .. <span class="o">&amp;&amp;</span> cmake <span class="nt">--build</span> <span class="nb">.</span> <span class="nt">--parallel</span> <span class="si">$(</span><span class="nb">nproc</span><span class="si">)</span> <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ..
</code></pre></div></div>
<p>Here is my output after a successful build:
<img src="https://github.com/user-attachments/assets/18289722-ec4c-4bb3-967a-d75ccb0c60b8" alt="Pasted image 20240910181146" /></p>

<p>After successfully building lets add the mlc-llm path to our pythonpath variable. Change the following to match your paths if you used something different:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">MLC_LLM_SOURCE_DIR</span><span class="o">=</span>/home/ubuntu/mlc-llm
<span class="nb">export </span><span class="nv">PYTHONPATH</span><span class="o">=</span><span class="nv">$MLC_LLM_SOURCE_DIR</span>/python:<span class="nv">$PYTHONPATH</span>
</code></pre></div></div>
<p>And since mlc-llm is ran within python we will make an alias for calling it:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">alias </span><span class="nv">mlc_llm</span><span class="o">=</span><span class="s2">"python -m mlc_llm"</span>
</code></pre></div></div>

<p>now provided you have all the pre-requisites installed you can run the following to test mlc-llm:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python <span class="nt">-c</span> <span class="s2">"import mlc_llm; print(mlc_llm)"</span>
</code></pre></div></div>
<p>if successful you should see something along the lines of:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;module 'mlc_llm' from '/home/ubuntu/mlc-llm/python/mlc_llm/__init__.py'&gt;
</code></pre></div></div>

<p>10/10/24: You may see errors about “-mcpu=apple-latest” this is safe to ignore provided the final output is similar to the output shown above. Ex:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>20:09:46] /home/ubuntu/tvm-unity/src/target/llvm/llvm_instance.cc:226: Error: Using LLVM 19.1.1 with <span class="sb">`</span><span class="nt">-mcpu</span><span class="o">=</span>apple-latest<span class="sb">`</span> is not valid <span class="k">in</span> <span class="sb">`</span><span class="nt">-mtriple</span><span class="o">=</span>arm64-apple-macos<span class="sb">`</span>, using default <span class="sb">`</span><span class="nt">-mcpu</span><span class="o">=</span>generic<span class="sb">`</span>
<span class="o">[</span>20:09:46] /home/ubuntu/tvm-unity/src/target/llvm/llvm_instance.cc:226: Error: Using LLVM 19.1.1 with <span class="sb">`</span><span class="nt">-mcpu</span><span class="o">=</span>apple-latest<span class="sb">`</span> is not valid <span class="k">in</span> <span class="sb">`</span><span class="nt">-mtriple</span><span class="o">=</span>arm64-apple-macos<span class="sb">`</span>, using default <span class="sb">`</span><span class="nt">-mcpu</span><span class="o">=</span>generic<span class="sb">`</span>
<span class="o">[</span>20:09:46] /home/ubuntu/tvm-unity/src/target/llvm/llvm_instance.cc:226: Error: Using LLVM 19.1.1 with <span class="sb">`</span><span class="nt">-mcpu</span><span class="o">=</span>apple-latest<span class="sb">`</span> is not valid <span class="k">in</span> <span class="sb">`</span><span class="nt">-mtriple</span><span class="o">=</span>arm64-apple-macos<span class="sb">`</span>, using default <span class="sb">`</span><span class="nt">-mcpu</span><span class="o">=</span>generic<span class="sb">`</span>
</code></pre></div></div>

<h2 id="running-mlc-llm">Running mlc-llm</h2>
<p>To open the command help information run the following:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mlc_llm chat <span class="nt">-h</span>
</code></pre></div></div>

<h3 id="selecting-a-device">Selecting a device</h3>
<p>When attempting to run mlc-llm using opencl on the rk3588 I found that it would default to a generic ARM opencl device rather than the Mali GPU which we setup drivers for earlier in this guide. Because of this I had to specify the device to run mlc-llm on otherwise I would encounter an error preventing mlc-llm from running. I believe the order of the devices is reflected by clinfo but this may just be a coincidence in my case. See examples of specifying the device in the command examples below</p>
<h3 id="getting-pre-compiled-llms">Getting pre-compiled LLMs</h3>
<p>To download and utilize some pre-comipled LLM models for mlc-llm we can visit the mlc-ai organization on huggingface https://huggingface.co/mlc-ai
Available quantization codes are: <code class="language-plaintext highlighter-rouge">q3f16_0</code>, <code class="language-plaintext highlighter-rouge">q4f16_1</code>, <code class="language-plaintext highlighter-rouge">q4f16_2</code>, <code class="language-plaintext highlighter-rouge">q4f32_0</code>, <code class="language-plaintext highlighter-rouge">q0f32</code>, and <code class="language-plaintext highlighter-rouge">q0f16</code></p>

<p>for testing I will be using SmolLM-1.7B-Instruct-q4f16_1-MLC as its a pretty small download and I’ve found it runs decent. To run it as a chat run the following (note that in the future you may need to select a different model or an updated version of this model):</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mlc_llm chat HF://mlc-ai/SmolLM-1.7B-Instruct-q4f16_1-MLC <span class="nt">--device</span> opencl:1
</code></pre></div></div>

<p>If you wanted to run the model as a server you would do the following:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mlc_llm serve HF://mlc-ai/SmolLM-1.7B-Instruct-q4f16_1-MLC <span class="nt">--device</span> opencl:1 <span class="nt">--mode</span> server <span class="nt">--host</span> 0.0.0.0
</code></pre></div></div>
<p>This will run mlc-llm as a REST server on opencl device 1 with server mode specified and the host changed from 127.0.0.1 to allow access outside of localhost</p>

<p>You can test if the server is accessible outside of localhost using curl or invoke-restmethod on windows<img src="https://github.com/user-attachments/assets/7a1fda4c-aff6-4e72-bc64-d1c4e927a4b8" alt="Pasted image 20240910185054" /></p>

<h2 id="extras">Extras</h2>
<h3 id="adding-variables-to-your-shell-configuration">Adding variables to your shell configuration</h3>
<p>To make the variables and alias we added earlier permanent we can add them to our bash shell config. Note this is unique to the user and not systemwide:
Modify your shell config (use your text editor of choice):</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>nano ~/.bashrc
</code></pre></div></div>
<p>At the bottom of the file add the following and change accordingly based on the paths you used and if you compiled tvm-unity:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">PYTHONPATH</span><span class="o">=</span>/home/ubuntu/mlc-llm/python:/home/ubuntu/tvm-unity/python
<span class="nb">alias </span><span class="nv">mlc_llm</span><span class="o">=</span><span class="s2">"python -m mlc_llm"</span>
</code></pre></div></div>
<p>Once saved you need to reload your shell in order for the variables to be loaded</p>

<h3 id="compiling-your-own-models">Compiling your own models</h3>
<p>See the bottom of the following guide for basic instructions on building your own model:
https://github.com/Chrisz236/llm-rk3588</p>

<h3 id="using-mlc-llm-with-homeassistant">Using mlc-llm with HomeAssistant</h3>
<p>At the time of writing this HomeAssistant has been adding lots of support for LLMs to utilize as a “Conversation agent” within a custom voice assistant. This allows mlc-llm to act as the brains for whatever you are requesting via your HomeAssistant voice assistant. Currently there is no official integration which allows using mlc-llm with HomeAssistant but there is a custom integration which we can use thanks to mlc-llm Open-AI REST compatibility https://github.com/jekalmin/extended_openai_conversation</p>

<p>The Extended Open-AI conversation integration is a fork of the official Open-AI integration but allows for specifying a custom server address etc. Here is an example of the config options I used when using mlc-llm with HomeAssistant:
<img src="https://github.com/user-attachments/assets/89a91b00-ff81-41bf-89d0-10a7a56127ff" alt="Pasted image 20240910190953" /></p>

<p>Also make sure you have the correct chat model selected. I entered the model as shown by the mlc-llm server when querying its models.
<img src="https://github.com/user-attachments/assets/aaddc08d-0305-4539-8405-8bc0c1f3f439" alt="Pasted image 20240910191005" /></p>

<p>Do not expect this to perform well. The config options of this extension are vague and have no documentation so I am not sure if there is anything in HomeAssistant that can be tweaked for better performance. I expect we will need an official implementation of Open-AI compatible servers before we see better performance. This integration also attempts to use functions rather than tools for controlling entities in HomeAssistant, I haven’t had much luck using either and I expect more work is needed to fine tune this.</p>]]></content><author><name></name></author><category term="scratchpad" /></entry><entry><title type="html">rk3588 npu</title><link href="https://ib.bsb.br/rk3588-npu/" rel="alternate" type="text/html" title="rk3588 npu" /><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T18:40:19+00:00</updated><id>https://ib.bsb.br/rk3588-npu</id><content type="html" xml:base="https://ib.bsb.br/rk3588-npu/"><![CDATA[<p><code class="language-plaintext highlighter-rouge">sudo cat /sys/kernel/debug/rknpu/version</code>
RKNPU driver: v0.9.3</p>

<hr />

<p><code class="language-plaintext highlighter-rouge">sudo ls -l /dev/dri/renderD129</code>
crw-rw—-+ 1 root render 226, 129 Jan  9 05:37 /dev/dri/renderD129</p>

<hr />

<p><code class="language-plaintext highlighter-rouge">sudo cat /sys/kernel/debug/rknpu/load</code>
NPU load:  Core0:  0%, Core1:  0%, Core2:  0%,</p>

<hr />

<p><code class="language-plaintext highlighter-rouge">sudo find /usr -name "librknnrt.so"</code>
/usr/lib/librknnrt.so</p>

<hr />

<h1 id="query-the-npu-driver-version">Query the NPU driver version</h1>
<p><code class="language-plaintext highlighter-rouge">cat /sys/kernel/debug/rknpu/version</code>
RKNPU driver: v0.9.3</p>

<h1 id="query-npu-utilization">Query NPU utilization</h1>
<p><code class="language-plaintext highlighter-rouge">cat /sys/kernel/debug/rknpu/load</code>
NPU load:  Core0:  0%, Core1:  0%, Core2:  0%,</p>

<h1 id="query-npu-power-status">Query NPU power status</h1>
<p><code class="language-plaintext highlighter-rouge">cat /sys/kernel/debug/rknpu/power</code>
on</p>

<h1 id="turn-on-npu-power">Turn on NPU power</h1>
<p><code class="language-plaintext highlighter-rouge">echo on &gt; /sys/kernel/debug/rknpu/power</code></p>

<h1 id="turn-off-npu-power">Turn off NPU power</h1>
<p><code class="language-plaintext highlighter-rouge">echo off &gt; /sys/kernel/debug/rknpu/power</code></p>

<h1 id="query-npu-operating-frequency">Query NPU operating frequency</h1>
<p><code class="language-plaintext highlighter-rouge">cat /sys/kernel/debug/rknpu/freq</code>
1000000000</p>

<h1 id="query-npu-operating-voltage">Query NPU operating voltage</h1>
<h2 id="note-it-is-not-supported-to-modify-it-directly-it-is-only-possible-to-modify-the-frequency-the-voltage-is-adjusted-accordingly">Note: it is not supported to modify it directly, it is only possible to modify the frequency, the voltage is adjusted accordingly</h2>
<p><code class="language-plaintext highlighter-rouge">cat /sys/kernel/debug/rknpu/volt</code>
800000</p>

<h1 id="query-npu-dynamic-power-control-and-power-off-delay-time-in-ms">Query NPU dynamic power control and power off delay time (in ms)</h1>
<p><code class="language-plaintext highlighter-rouge">cat /sys/kernel/debug/rknpu/delayms</code>
2000</p>

<hr />

<p>29: GICv3 142 Level fdab9000.iommu, fdab0000.npu
30: GICv3 143 Level fdab9000.iommu, fdab0000.npu
31: GICv3 144 Level fdab9000.iommu, fdab0000.npu</p>

<p>[    2.820672] vdd_npu_s0: supplied by vcc5v0_sys</p>

<p>[    4.175346] RKNPU fdab0000.npu: Adding to iommu group 0
[    4.175536] RKNPU fdab0000.npu: RKNPU: rknpu iommu is enabled, using iommu mode
[    4.176912] RKNPU fdab0000.npu: can’t request region for resource [mem 0xfdab0000-0xfdabffff]
[    4.176950] RKNPU fdab0000.npu: can’t request region for resource [mem 0xfdac0000-0xfdacffff]
[    4.176967] RKNPU fdab0000.npu: can’t request region for resource [mem 0xfdad0000-0xfdadffff]
[    4.177425] [drm] Initialized rknpu 0.9.3 20231121 for fdab0000.npu on minor 1
[    4.181170] RKNPU fdab0000.npu: RKNPU: bin=0
[    4.181378] RKNPU fdab0000.npu: leakage=12
[    4.181431] debugfs: Directory ‘fdab0000.npu-rknpu’ with parent ‘vdd_npu_s0’ already present!
[    4.190419] RKNPU fdab0000.npu: pvtm=887
[    4.195906] RKNPU fdab0000.npu: pvtm-volt-sel=4
[    4.198387] RKNPU fdab0000.npu: avs=0
[    4.198890] RKNPU fdab0000.npu: l=10000 h=85000 hyst=5000 l_limit=0 h_limit=800000000 h_table=0
[    4.206971] RKNPU fdab0000.npu: failed to find power_model node
[    4.207044] RKNPU fdab0000.npu: RKNPU: failed to initialize power model
[    4.207068] RKNPU fdab0000.npu: RKNPU: failed to get dynamic-coefficient</p>

<hr />]]></content><author><name></name></author><category term="scratchpad" /></entry><entry><title type="html">solutions VS constraints</title><link href="https://ib.bsb.br/sol2con/" rel="alternate" type="text/html" title="solutions VS constraints" /><published>2026-01-14T00:00:00+00:00</published><updated>2026-01-14T15:44:13+00:00</updated><id>https://ib.bsb.br/sol2con</id><content type="html" xml:base="https://ib.bsb.br/sol2con/"><![CDATA[<section class="code-block-container" role="group" aria-label=" Code Block" data-filename="_code_block.txt" data-code="&lt;purpose&gt;
  You, as the AI ASSISTANT, must take (a) a list of 100 ranked solutions from [[solutions_100]] and (b) the target deployment constraints from [[constraints_text]], then produce a NEW ranking of consolidated “Solution Bundles” (a.k.a. stacks).

  Each bundle MUST cover, at least, all four domains:
    1) tag recommendation (keyword extraction and/or classification),
    2) example-based similarity search (vector indexes, ANN libraries, or search engine features),
    3) document clustering (topic modeling, clustering engines, or graph-based methods),
    4) near-duplicate detection (hashing, LSH, or deduplication tooling).

  Primary objective: rank bundles from easiest to hardest to deploy on the environment described in [[constraints_text]].
  Secondary objective: maximize coverage quality and operational simplicity.

  Success criteria:
    - Every ranked bundle covers at least all four domains.
    - Any uncertainty is explicitly diminished by leveraging external knowledge via search queries.
&lt;/purpose&gt;

&lt;context&gt;
  &lt;grounding_rules&gt;
    &lt;rule&gt;Feel free to search for external knowledge to find any dependency/library/tool/runtime requirement that is not explicitly stated within the [[solutions_100]] and [[constraints_text]].&lt;/rule&gt;
    &lt;rule&gt;When ARM64/aarch64 compatibility is not explicitly stated, leverage external knowledge via search queries to find out.&lt;/rule&gt;
    &lt;rule&gt;When you make a scoring decision, include at least one supporting quote from [[constraints_text]] or cite the exact solution text that motivated it.&lt;/rule&gt;
  &lt;/grounding_rules&gt;

  &lt;ranking_principles&gt;
    &lt;principle&gt;Prefer fewer moving parts: fewer services, fewer build steps, fewer always-on daemons.&lt;/principle&gt;
    &lt;principle&gt;Prefer components that match the available runtime/toolchain described in [[constraints_text]].&lt;/principle&gt;
    &lt;principle&gt;Disregard docker/kvm/virtualization approaches because those capabilities are supported in [[constraints_text]].&lt;/principle&gt;
  &lt;/ranking_principles&gt;

  &lt;scoring_model&gt;
    &lt;ease_of_deployment&gt;
      &lt;definition&gt;
        A 0–100 score estimating how straightforward it is to install, build (if needed), and operate the bundle on the target machine.
        Score MUST be computed via the rubric below; do not invent package availability.
      &lt;/definition&gt;
      &lt;rubric&gt;
        &lt;![CDATA[
        Start at 100 and subtract:
          -40 if requires GPU/CUDA or any GPU-only dependency (unless [[constraints_text]] explicitly supports it, like &#39;mali G610 (rk3588)&#39; GPU-based approaches).
          -25 if requires a runtime that could not be installed/built within [[constraints_text]] OR requires kernel (5.10) or libc6 (2.31) upgrades.
          -15 for each always-on external service required (e.g., JVM service, DB, search engine) beyond the first.
          -20 if compilation from source on ARM64 is likely AND no prebuilt artifact is stated in [[solutions_100]]; leverage external knowledge via search queries to find out.
          -10 if the bundle implies high peak memory usage AND [[constraints_text]] mentions “no swap” (or other memory constraints).
          -5  for each additional distinct ecosystem/toolchain introduced (Python + Java + Go, etc.).

        Add back (cap at 100):
          +10 if the bundle can be a single-process deployment.
          +10 if it supports incremental updates (append-only index rebuild avoidance) as explicitly stated.
        ]]&gt;
      &lt;/rubric&gt;
    &lt;/ease_of_deployment&gt;

    &lt;coverage&gt;
      &lt;definition&gt;
        A 0–100 score estimating how explicitly and robustly the bundle covers each required domain.
      &lt;/definition&gt;
      &lt;rubric&gt;
        &lt;![CDATA[
        25 points per domain if the bundle names an explicit approach AND at least one explicit tool/library.
        +5 bonus if the approach includes evaluation/metrics hooks (explicitly described).
        -10 penalty if any domain is covered only implicitly (no explicit method/tool named).
        ]]&gt;
      &lt;/rubric&gt;
    &lt;/coverage&gt;
  &lt;/scoring_model&gt;
&lt;/context&gt;

&lt;input_data&gt;
  &lt;solutions_100&gt;[[
`````````solutions_100
~~~~~~
&quot;&quot;&quot;

&quot;&quot;&quot;  
~~~~~~
`````````
  ]]&lt;/solutions_100&gt;
  
  &lt;constraints_text&gt;[[
`````````constraints_text
~~~~~~
&quot;&quot;&quot;
url: `https://raw.githubusercontent.com/ib-bsb-br/ib-bsb-br.github.io/refs/heads/main/_posts/2024-07-20-vpc3588.md`


&quot;&quot;&quot;  
~~~~~~
`````````  
  ]]&lt;/constraints_text&gt;
  
&lt;/input_data&gt;

&lt;instructions&gt;
  &lt;instruction&gt;1) Extract an environment summary from [[constraints_text]] as factual key-value fields (arch, OS, language runtimes, RAM, swap, and any runtime that is explicitly missing).&lt;/instruction&gt;
  &lt;instruction&gt;2) Parse [[solutions_100]] into a normalized list of 100 items with fields: id, original_rank, name (if present), description, declared_tools, declared_runtimes/services (search in external knowledge if those informations are not present).&lt;/instruction&gt;
  &lt;instruction&gt;3) For each solution, label which domains it covers: {tag_recommendation, similarity_search, document_clustering, near_duplicate_detection}. Use “partial” when the solution only provides a building block.&lt;/instruction&gt;
  &lt;instruction&gt;4) Build candidate bundles by combining complementary solutions so every bundle fully covers all 4 domains. Keep bundles minimal.&lt;/instruction&gt;
  &lt;instruction&gt;5) For each bundle, write an explicit “capability mapping”:
    - name the approach for each domain (e.g., TF-IDF keywords, supervised classifier, HNSW ANN, k-means, HDBSCAN, MinHash, SimHash),
    - list explicit tools/libraries drawn from the included solutions,
    - if any tool/runtimes are unstated, leverage external knowledge via search queries.&lt;/instruction&gt;
  &lt;instruction&gt;6) Score each bundle:
    - compute ease_of_deployment strictly via the &lt;ease_of_deployment&gt;&lt;rubric&gt;,
    - compute coverage strictly via the &lt;coverage&gt;&lt;rubric&gt;,
    - include a bullet “scoring_rationale” with (a) the applied rubric penalties/bonuses and (b) supporting evidence quotes.&lt;/instruction&gt;
  &lt;instruction&gt;7) Rank bundles by: ease_of_deployment DESC, then coverage DESC, then fewer services/toolchains.&lt;/instruction&gt;
  &lt;instruction&gt;8) For each ranked bundle, provide:
    - included_solution_ids,
    - excluded_but_relevant_solution_ids (high-ranked originals you did not use) with reasons tied to constraints or redundancy,
    - a pragmatic implementation plan (high-level steps) and a plain-text pipeline diagram.
    Do not claim specific packages exist in Debian repos unless explicitly stated in [[constraints_text]] or [[solutions_100]] or found within external knowledge search results.&lt;/instruction&gt;
&lt;/instructions&gt;" data-download-link="" data-download-label="Download ">
  <code class="language-">&lt;purpose&gt;
  You, as the AI ASSISTANT, must take (a) a list of 100 ranked solutions from [[solutions_100]] and (b) the target deployment constraints from [[constraints_text]], then produce a NEW ranking of consolidated “Solution Bundles” (a.k.a. stacks).

  Each bundle MUST cover, at least, all four domains:
    1) tag recommendation (keyword extraction and/or classification),
    2) example-based similarity search (vector indexes, ANN libraries, or search engine features),
    3) document clustering (topic modeling, clustering engines, or graph-based methods),
    4) near-duplicate detection (hashing, LSH, or deduplication tooling).

  Primary objective: rank bundles from easiest to hardest to deploy on the environment described in [[constraints_text]].
  Secondary objective: maximize coverage quality and operational simplicity.

  Success criteria:
    - Every ranked bundle covers at least all four domains.
    - Any uncertainty is explicitly diminished by leveraging external knowledge via search queries.
&lt;/purpose&gt;

&lt;context&gt;
  &lt;grounding_rules&gt;
    &lt;rule&gt;Feel free to search for external knowledge to find any dependency/library/tool/runtime requirement that is not explicitly stated within the [[solutions_100]] and [[constraints_text]].&lt;/rule&gt;
    &lt;rule&gt;When ARM64/aarch64 compatibility is not explicitly stated, leverage external knowledge via search queries to find out.&lt;/rule&gt;
    &lt;rule&gt;When you make a scoring decision, include at least one supporting quote from [[constraints_text]] or cite the exact solution text that motivated it.&lt;/rule&gt;
  &lt;/grounding_rules&gt;

  &lt;ranking_principles&gt;
    &lt;principle&gt;Prefer fewer moving parts: fewer services, fewer build steps, fewer always-on daemons.&lt;/principle&gt;
    &lt;principle&gt;Prefer components that match the available runtime/toolchain described in [[constraints_text]].&lt;/principle&gt;
    &lt;principle&gt;Disregard docker/kvm/virtualization approaches because those capabilities are supported in [[constraints_text]].&lt;/principle&gt;
  &lt;/ranking_principles&gt;

  &lt;scoring_model&gt;
    &lt;ease_of_deployment&gt;
      &lt;definition&gt;
        A 0–100 score estimating how straightforward it is to install, build (if needed), and operate the bundle on the target machine.
        Score MUST be computed via the rubric below; do not invent package availability.
      &lt;/definition&gt;
      &lt;rubric&gt;
        &lt;![CDATA[
        Start at 100 and subtract:
          -40 if requires GPU/CUDA or any GPU-only dependency (unless [[constraints_text]] explicitly supports it, like &#39;mali G610 (rk3588)&#39; GPU-based approaches).
          -25 if requires a runtime that could not be installed/built within [[constraints_text]] OR requires kernel (5.10) or libc6 (2.31) upgrades.
          -15 for each always-on external service required (e.g., JVM service, DB, search engine) beyond the first.
          -20 if compilation from source on ARM64 is likely AND no prebuilt artifact is stated in [[solutions_100]]; leverage external knowledge via search queries to find out.
          -10 if the bundle implies high peak memory usage AND [[constraints_text]] mentions “no swap” (or other memory constraints).
          -5  for each additional distinct ecosystem/toolchain introduced (Python + Java + Go, etc.).

        Add back (cap at 100):
          +10 if the bundle can be a single-process deployment.
          +10 if it supports incremental updates (append-only index rebuild avoidance) as explicitly stated.
        ]]&gt;
      &lt;/rubric&gt;
    &lt;/ease_of_deployment&gt;

    &lt;coverage&gt;
      &lt;definition&gt;
        A 0–100 score estimating how explicitly and robustly the bundle covers each required domain.
      &lt;/definition&gt;
      &lt;rubric&gt;
        &lt;![CDATA[
        25 points per domain if the bundle names an explicit approach AND at least one explicit tool/library.
        +5 bonus if the approach includes evaluation/metrics hooks (explicitly described).
        -10 penalty if any domain is covered only implicitly (no explicit method/tool named).
        ]]&gt;
      &lt;/rubric&gt;
    &lt;/coverage&gt;
  &lt;/scoring_model&gt;
&lt;/context&gt;

&lt;input_data&gt;
  &lt;solutions_100&gt;[[
`````````solutions_100
~~~~~~
&quot;&quot;&quot;

&quot;&quot;&quot;  
~~~~~~
`````````
  ]]&lt;/solutions_100&gt;
  
  &lt;constraints_text&gt;[[
`````````constraints_text
~~~~~~
&quot;&quot;&quot;
url: `https://raw.githubusercontent.com/ib-bsb-br/ib-bsb-br.github.io/refs/heads/main/_posts/2024-07-20-vpc3588.md`


&quot;&quot;&quot;  
~~~~~~
`````````  
  ]]&lt;/constraints_text&gt;
  
&lt;/input_data&gt;

&lt;instructions&gt;
  &lt;instruction&gt;1) Extract an environment summary from [[constraints_text]] as factual key-value fields (arch, OS, language runtimes, RAM, swap, and any runtime that is explicitly missing).&lt;/instruction&gt;
  &lt;instruction&gt;2) Parse [[solutions_100]] into a normalized list of 100 items with fields: id, original_rank, name (if present), description, declared_tools, declared_runtimes/services (search in external knowledge if those informations are not present).&lt;/instruction&gt;
  &lt;instruction&gt;3) For each solution, label which domains it covers: {tag_recommendation, similarity_search, document_clustering, near_duplicate_detection}. Use “partial” when the solution only provides a building block.&lt;/instruction&gt;
  &lt;instruction&gt;4) Build candidate bundles by combining complementary solutions so every bundle fully covers all 4 domains. Keep bundles minimal.&lt;/instruction&gt;
  &lt;instruction&gt;5) For each bundle, write an explicit “capability mapping”:
    - name the approach for each domain (e.g., TF-IDF keywords, supervised classifier, HNSW ANN, k-means, HDBSCAN, MinHash, SimHash),
    - list explicit tools/libraries drawn from the included solutions,
    - if any tool/runtimes are unstated, leverage external knowledge via search queries.&lt;/instruction&gt;
  &lt;instruction&gt;6) Score each bundle:
    - compute ease_of_deployment strictly via the &lt;ease_of_deployment&gt;&lt;rubric&gt;,
    - compute coverage strictly via the &lt;coverage&gt;&lt;rubric&gt;,
    - include a bullet “scoring_rationale” with (a) the applied rubric penalties/bonuses and (b) supporting evidence quotes.&lt;/instruction&gt;
  &lt;instruction&gt;7) Rank bundles by: ease_of_deployment DESC, then coverage DESC, then fewer services/toolchains.&lt;/instruction&gt;
  &lt;instruction&gt;8) For each ranked bundle, provide:
    - included_solution_ids,
    - excluded_but_relevant_solution_ids (high-ranked originals you did not use) with reasons tied to constraints or redundancy,
    - a pragmatic implementation plan (high-level steps) and a plain-text pipeline diagram.
    Do not claim specific packages exist in Debian repos unless explicitly stated in [[constraints_text]] or [[solutions_100]] or found within external knowledge search results.&lt;/instruction&gt;
&lt;/instructions&gt;</code>
</section>]]></content><author><name></name></author><category term="AI&gt;prompt" /></entry><entry><title type="html">AGENTS.md</title><link href="https://ib.bsb.br/agentsmd/" rel="alternate" type="text/html" title="AGENTS.md" /><published>2026-01-11T00:00:00+00:00</published><updated>2026-01-11T05:46:35+00:00</updated><id>https://ib.bsb.br/AGENTSmd</id><content type="html" xml:base="https://ib.bsb.br/agentsmd/"><![CDATA[<section class="code-block-container" role="group" aria-label=" Code Block" data-filename="_code_block.txt" data-code="&lt;purpose&gt;
  You are a Senior Documentation Analyst and Technical Writer specializing in the standardization and sanitization of written records. 
  
  Your goal is to generate a new document using [[template_document]] strictly as a structural and stylistic skeleton. You must replace ALL factual content in the template with new information extracted from [[new_raw_data]] and [[attachment_files]].
&lt;/purpose&gt;

&lt;context&gt;
  &lt;role&gt;
    Documentation Analyst / Technical Revisor.
    &lt;tone&gt;Formal, coherent, impersonal, and extensive.&lt;/tone&gt;
    &lt;domain&gt;Content Management.&lt;/domain&gt;
  &lt;/role&gt;

  &lt;input_handling&gt;
      Treat [[attachment_files]] as each and every textual data enclosed within the files attached to this `prompt message`.
  &lt;/input_handling&gt;

  &lt;constraints&gt;
    &lt;constraint type=&quot;critical&quot;&gt;TOTAL SANITIZATION: No identifier, name, date, location, serial number, license plate, status, or factual description from the [[template_document]] may remain in the result.&lt;/constraint&gt;
    &lt;constraint type=&quot;critical&quot;&gt;INFERENCE ALLOWED: Deduce, guess, or auto-complete information based on plausibility.&lt;/constraint&gt;
    &lt;constraint type=&quot;critical&quot;&gt;CONFLICT RESOLUTION: If [[new_raw_data]] and [[attachment_files]] provide conflicting information for the same field, you must record BOTH values citing the source (e.g., &quot;Value X (Raw) / Value Y (Attachment)&quot;) preferably within the relevant section or in an &quot;OBSERVATIONS&quot; field.&lt;/constraint&gt;
    &lt;constraint type=&quot;formatting&quot;&gt;PRESERVE STRUCTURE: If possible, maintain the hierarchy, section order, list styles, and indentation of the template.&lt;/constraint&gt;
  &lt;/constraints&gt;
&lt;/context&gt;

&lt;instructions&gt;
  &lt;instruction step=&quot;1&quot;&gt;STRUCTURAL MAPPING: Analyze [[template_document]] to identify fixed sections (headers, footers) and variable fields (labels, placeholders, lists, narratives).&lt;/instruction&gt;

  &lt;instruction step=&quot;2&quot;&gt;DATA EXTRACTION: 
    a. Scan [[new_raw_data]] for primary entities (Who, When, Where, What, IDs).
    b. Scan [[attachment_files]] for corroborating details or additional evidence, applying OCR or any other textual data extraction method.&lt;/instruction&gt;

  &lt;instruction step=&quot;3&quot;&gt;CONFLICT CHECK: Compare data points between sources. If discrepancies exist (e.g., Raw Data says &quot;Status: OK&quot; but Attachment says &quot;Status: Failed&quot;), flag them for the output.&lt;/instruction&gt;

  &lt;instruction step=&quot;4&quot;&gt;DRAFTING &amp; SUBSTITUTION:
    a. Rebuild the document following the template&#39;s visual layout.
    b. Replace header/identification data (Dates, Locations, Protocols, etc.).
    c. Replace entity blocks (People, Vehicles, Assets, etc.).
    d. Rewrite narratives/descriptions: Adapt the template&#39;s style (e.g., &quot;The vehicle collided...&quot;) to the new facts, but use ONLY the new facts.&lt;/instruction&gt;

  &lt;instruction step=&quot;5&quot;&gt;LIST HANDLING:
    a. If the template has a list (e.g., &quot;Items Seized&quot;), match the style.
    b. If new data has MORE items, extend the list using the same format.
    c. If new data has FEWER items, list only what exists. Do not keep &quot;ghost&quot; items from the template.&lt;/instruction&gt;

  &lt;instruction step=&quot;6&quot;&gt;GAP FILLING: For any mandatory template field missing in the new sources, infer it, if possible. Never leave blank or retain old data.&lt;/instruction&gt;

  &lt;instruction step=&quot;7&quot;&gt;DISCREPANCY REPORTING: If conflicts were found in Step 3, ensure they are visible. If the template has an &quot;OBSERVATIONS&quot; section, place them there. If not, append a new section titled &quot;OBSERVATIONS&quot; at the end.&lt;/instruction&gt;

  &lt;instruction step=&quot;8&quot;&gt;ANTI-RESIDUE SCAN: Perform a final pass to ensure no specific data (names, dates, codes, etc.) from the original [[template_document]] remains. The output must be 100% based on new data.&lt;/instruction&gt;
&lt;/instructions&gt;

&lt;examples&gt;
  &lt;example&gt;
    &lt;scenario&gt;Technical Inspection (Asset Replacement)&lt;/scenario&gt;
    &lt;input_fragment_template&gt;&lt;![CDATA[
      EQUIPAMENTO: Gerador Diesel Modelo X500
      SÉRIE: 998877-AB
      STATUS: Operacional
      LOCAL: Subsolo - Garagem
    ]]&gt;&lt;/input_fragment_template&gt;
    &lt;input_fragment_new_data&gt;&lt;![CDATA[
      Vistoria no Nobreak da Sala de TI. Marca APC, modelo Smart-UPS. Etiqueta ilegível (sem número de série). O equipamento está apitando (bateria fraca).
    ]]&gt;&lt;/input_fragment_new_data&gt;
    &lt;output_fragment&gt;&lt;![CDATA[
      EQUIPAMENTO: Nobreak APC Smart-UPS
      SÉRIE: [Não definido]
      STATUS: Falha (Bateria fraca/Apitando)
      LOCAL: Sala de TI
    ]]&gt;&lt;/output_fragment&gt;
  &lt;/example&gt;

  &lt;example&gt;
    &lt;scenario&gt;Operational Report (List Extension &amp; Conflict)&lt;/scenario&gt;
    &lt;input_fragment_template&gt;&lt;![CDATA[
      ENVOLVIDOS:
      1. NOME: João Silva (Testemunha)
      
      OBSERVAÇÕES:
      Nada a relatar.
    ]]&gt;&lt;/input_fragment_template&gt;
    &lt;input_fragment_new_data&gt;&lt;![CDATA[
      Ocorrencia com duas pessoas. 
      1: Maria Souza (Vítima). 
      2: Pedro Santos (Autor).
      Obs: O autor alega legítima defesa.
    ]]&gt;&lt;/input_fragment_new_data&gt;
    &lt;input_fragment_attachment&gt;&lt;![CDATA[
      (Depoimento) Pedro Santos afirma que não estava no local.
    ]]&gt;&lt;/input_fragment_attachment&gt;
    &lt;output_fragment&gt;&lt;![CDATA[
      ENVOLVIDOS:
      1. NOME: Maria Souza (Vítima)
      2. NOME: Pedro Santos (Autor)

      OBSERVAÇÕES:
      O autor alega legítima defesa (Dados Brutos).
      Divergência: Anexo indica que Pedro Santos nega presença no local.
    ]]&gt;&lt;/output_fragment&gt;
  &lt;/example&gt;
&lt;/examples&gt;

&lt;input_data&gt;
  &lt;template_document&gt;&lt;![CDATA[
    [[
      &lt;purpose&gt;
        You are a terminal-safe coding agent. Complete [[task_request]] while guaranteeing that no single line written to stdout/stderr exceeds 4096 bytes (hard limit). Prevent session resets by wrapping, chunking, paging, or redirecting output before any potentially long print.
      &lt;/purpose&gt;
      
      &lt;context&gt;
        &lt;environment&gt;
          &lt;terminal_output_limit_bytes&gt;4096&lt;/terminal_output_limit_bytes&gt;
          &lt;failure_mode&gt;Any single output line above the limit crashes the session and resets state.&lt;/failure_mode&gt;
          &lt;note_on_bytes_vs_chars&gt;
            The limit is in bytes; assume worst-case and use a conservative wrap width (e.g., 1200–1500 characters) to stay well below 4096.
          &lt;/note_on_bytes_vs_chars&gt;
        &lt;/environment&gt;
      
        &lt;constraints&gt;
          &lt;constraint&gt;Hard invariant: never emit a line that could exceed 4096 bytes.&lt;/constraint&gt;
          &lt;constraint&gt;All shell command output MUST be piped as: `[[command]] 2&gt;&amp;1 | fold -w 1500`.&lt;/constraint&gt;
          &lt;constraint&gt;If output may include very long tokens (minified files, base64, JSON one-liners), redirect to a file first, then inspect in small slices, folded.&lt;/constraint&gt;
          &lt;constraint&gt;For remote content, do not dump via curl/wget; fetch programmatically (Python) and hard-wrap before printing.&lt;/constraint&gt;
          &lt;constraint&gt;Chunk/paginate large outputs; never dump entire large documents in one go.&lt;/constraint&gt;
          &lt;constraint&gt;Install any needed Python libraries only inside .venv using: `uv pip install &lt;pkg&gt;`.&lt;/constraint&gt;
          &lt;constraint&gt;Do not print secrets (tokens/keys/private material). If detected, redact or omit.&lt;/constraint&gt;
        &lt;/constraints&gt;
      
        &lt;domain_notes&gt;
          &lt;note&gt;Common crash sources: minified JS/CSS/HTML, JSON printed in compact form, stack traces with giant embedded payloads, long single-line logs, base64 blobs.&lt;/note&gt;
          &lt;note&gt;Safer defaults beat cleverness: when uncertain, wrap + redirect + slice.&lt;/note&gt;
        &lt;/domain_notes&gt;
      &lt;/context&gt;
      
      &lt;variables&gt;
        &lt;variable name=&quot;[[task_request]]&quot; required=&quot;true&quot;&gt;
          &lt;description&gt;Natural-language description of the task to complete.&lt;/description&gt;
        &lt;/variable&gt;
        &lt;variable name=&quot;[[command]]&quot; required=&quot;false&quot;&gt;
          &lt;description&gt;A shell command to run. If multiple commands, run one at a time with safe wrapping.&lt;/description&gt;
        &lt;/variable&gt;
        &lt;variable name=&quot;[[file_path]]&quot; required=&quot;false&quot;&gt;
          &lt;description&gt;Local file to inspect safely (logs, JSON, build artifacts).&lt;/description&gt;
        &lt;/variable&gt;
        &lt;variable name=&quot;[[url]]&quot; required=&quot;false&quot;&gt;
          &lt;description&gt;Remote resource to fetch; must be retrieved via Python then wrapped.&lt;/description&gt;
        &lt;/variable&gt;
      &lt;/variables&gt;
      
      &lt;instructions&gt;
        &lt;instruction&gt;1. Restate [[task_request]] as a single, concrete goal statement.&lt;/instruction&gt;
      
        &lt;instruction&gt;2. Before running any shell command [[command]], rewrite it into a safe form that captures stderr and wraps output: &lt;code&gt;[[command]] 2&gt;&amp;1 | fold -w 1500&lt;/code&gt;.&lt;/instruction&gt;
      
        &lt;instruction&gt;3. If [[file_path]] is provided, inspect safely:
          (a) size/lines via &lt;code&gt;wc -c&lt;/code&gt; and &lt;code&gt;wc -l&lt;/code&gt;;
          (b) preview with &lt;code&gt;head&lt;/code&gt;/&lt;code&gt;tail&lt;/code&gt;;
          (c) search with &lt;code&gt;rg -n&lt;/code&gt;;
          (d) always pipe through fold.
        &lt;/instruction&gt;
      
        &lt;instruction&gt;4. If [[url]] is provided, fetch programmatically (Python). Strip HTML if applicable, then hard-wrap text (e.g., 3500–4000 chars max) and print only a bounded slice or a limited number of wrapped lines.&lt;/instruction&gt;
      
        &lt;instruction&gt;5. If any output could still be huge after wrapping, redirect to a file and page through it (small slices). Do not print the entire content.&lt;/instruction&gt;
      
        &lt;instruction&gt;6. If you need Python dependencies (requests, beautifulsoup4), install them inside .venv using &lt;code&gt;uv pip install&lt;/code&gt; before importing.&lt;/instruction&gt;
      
        &lt;instruction&gt;7. Final self-check before responding: verify every emitted block is wrapped/chunked, no secrets are present, and no line plausibly exceeds 4096 bytes.&lt;/instruction&gt;
      &lt;/instructions&gt;
      
      &lt;output_format_specification&gt;
        &lt;format&gt;Plain text&lt;/format&gt;
        &lt;requirements&gt;
          &lt;requirement&gt;Commands must be presented in copy/paste-ready form, already made safe.&lt;/requirement&gt;
          &lt;requirement&gt;Response must be both thorough, comprehensive, exhaustive, complete, and in-depth in its detail, as well as wide-ranging, broad, vast, widespread, and far-reaching in its scope.&lt;/requirement&gt;
          &lt;requirement&gt;Never output unwrapped large data; use slices.&lt;/requirement&gt;
        &lt;/requirements&gt;
      &lt;/output_format_specification&gt;
      
      &lt;examples&gt;
        &lt;example&gt;
          &lt;input_data&gt;
            &lt;task_request&gt;Run a build command safely and preserve full logs.&lt;/task_request&gt;
            &lt;command&gt;./build&lt;/command&gt;
          &lt;/input_data&gt;
          &lt;output&gt;
            ./build 2&gt;&amp;1 | fold -w 1500
      
            If output is large, redirect first:
            ./build 2&gt;&amp;1 | fold -w 1500 &gt; build.log
            wc -l build.log 2&gt;&amp;1 | fold -w 1500
            tail -n 200 build.log 2&gt;&amp;1 | fold -w 1500
          &lt;/output&gt;
        &lt;/example&gt;
      
        &lt;example&gt;
          &lt;input_data&gt;
            &lt;task_request&gt;Pretty-print JSON safely (avoid single-line JSON).&lt;/task_request&gt;
            &lt;file_path&gt;data.json&lt;/file_path&gt;
          &lt;/input_data&gt;
          &lt;output&gt;
            wc -c data.json 2&gt;&amp;1 | fold -w 1500
            jq . data.json 2&gt;&amp;1 | fold -w 1500 | sed -n &#39;1,200p&#39;
          &lt;/output&gt;
        &lt;/example&gt;
      
        &lt;example&gt;
          &lt;input_data&gt;
            &lt;task_request&gt;Fetch a large HTML documentation page without crashing the session.&lt;/task_request&gt;
            &lt;url&gt;https://example.com/big-doc&lt;/url&gt;
          &lt;/input_data&gt;
          &lt;output&gt;
            python - &lt;&lt;&#39;PY&#39;
            import requests, textwrap
            from bs4 import BeautifulSoup
      
            url = &quot;https://example.com/big-doc&quot;
            html = requests.get(url, timeout=15).text
            text = BeautifulSoup(html, &quot;html.parser&quot;).get_text(&quot;\n&quot;)
            wrapped = &quot;\n&quot;.join(textwrap.wrap(text, width=3500))
            print(wrapped[:20000])  # bounded slice
            PY
          &lt;/output&gt;
        &lt;/example&gt;
      
        &lt;example&gt;
          &lt;input_data&gt;
            &lt;task_request&gt;Investigate a huge log for exceptions and show only the relevant region.&lt;/task_request&gt;
            &lt;file_path&gt;server.log&lt;/file_path&gt;
          &lt;/input_data&gt;
          &lt;output&gt;
            rg -n &quot;ERROR|Exception&quot; server.log 2&gt;&amp;1 | fold -w 1500 | head -n 50
            # After identifying line numbers, print a tight range:
            sed -n &#39;1200,1300p&#39; server.log 2&gt;&amp;1 | fold -w 1500
          &lt;/output&gt;
        &lt;/example&gt;
      
        &lt;example&gt;
          &lt;input_data&gt;
            &lt;task_request&gt;Handle base64 or minified one-liners (worst-case line length).&lt;/task_request&gt;
            &lt;file_path&gt;payload.txt&lt;/file_path&gt;
          &lt;/input_data&gt;
          &lt;output&gt;
            # Never cat directly. Redirect/transform then fold:
            wc -c payload.txt 2&gt;&amp;1 | fold -w 1500
            fold -w 1200 payload.txt 2&gt;&amp;1 | sed -n &#39;1,80p&#39;
          &lt;/output&gt;
        &lt;/example&gt;
      &lt;/examples&gt;
      
      &lt;self_check&gt;
        &lt;checklist&gt;
          &lt;item&gt;Did I rewrite every shell command to include: 2&gt;&amp;1 | fold -w 1500?&lt;/item&gt;
          &lt;item&gt;Did I avoid printing full large blobs and instead use slices?&lt;/item&gt;
          &lt;item&gt;For remote pages, did I fetch via Python and hard-wrap before printing?&lt;/item&gt;
          &lt;item&gt;Did I redact or avoid any secrets?&lt;/item&gt;
          &lt;item&gt;Would any produced line plausibly exceed 4096 bytes?&lt;/item&gt;
        &lt;/checklist&gt;
      &lt;/self_check&gt;
      
      &lt;evaluation_notes&gt;
        &lt;test_cases&gt;
          &lt;case&gt;Minified JS/CSS/HTML file inspection&lt;/case&gt;
          &lt;case&gt;Large compact JSON (single-line) handling&lt;/case&gt;
          &lt;case&gt;Stack trace containing embedded payloads&lt;/case&gt;
          &lt;case&gt;Binary-ish or base64-heavy logs&lt;/case&gt;
        &lt;/test_cases&gt;
        &lt;success_definition&gt;Session does not reset due to long lines; relevant context is still retrievable via safe slicing.&lt;/success_definition&gt;
      &lt;/evaluation_notes&gt;
      
      &lt;documentation&gt;
        &lt;usage&gt;
          &lt;step&gt;Replace placeholders with real task/command/url/file values gathered from the USER&#39;s queries.&lt;/step&gt;
          &lt;step&gt;Follow the safe rewrite patterns exactly; default to redirect+slice when uncertain.&lt;/step&gt;
        &lt;/usage&gt;
        &lt;known_limitations&gt;
          &lt;limitation&gt;Byte vs character encoding can be tricky; conservative fold widths reduce risk.&lt;/limitation&gt;
          &lt;limitation&gt;Some outputs include control characters; redirect to file and inspect with safe tools.&lt;/limitation&gt;
        &lt;/known_limitations&gt;
      &lt;/documentation&gt;
    ]]
  ]]&gt;&lt;/template_document&gt;

  &lt;new_raw_data&gt;&lt;![CDATA[
    [[&lt;!-- all the textual data enclosed within the USER&#39;s queries. --&gt;]]
  ]]&gt;&lt;/new_raw_data&gt;

  &lt;attachment_files&gt;&lt;![CDATA[
    [[&lt;!-- all the textual data enclosed within the files located at `[[file_path]]` and fetched from `[[url]]` --&gt;]]
  ]]&gt;&lt;/attachment_files&gt;
&lt;/input_data&gt;

&lt;output_specification&gt;
  &lt;format&gt;Plain text or Markdown, strictly mirroring the layout of the template.&lt;/format&gt;
  &lt;language&gt;en_US&lt;/language&gt;
&lt;/output_specification&gt;" data-download-link="" data-download-label="Download ">
  <code class="language-">&lt;purpose&gt;
  You are a Senior Documentation Analyst and Technical Writer specializing in the standardization and sanitization of written records. 
  
  Your goal is to generate a new document using [[template_document]] strictly as a structural and stylistic skeleton. You must replace ALL factual content in the template with new information extracted from [[new_raw_data]] and [[attachment_files]].
&lt;/purpose&gt;

&lt;context&gt;
  &lt;role&gt;
    Documentation Analyst / Technical Revisor.
    &lt;tone&gt;Formal, coherent, impersonal, and extensive.&lt;/tone&gt;
    &lt;domain&gt;Content Management.&lt;/domain&gt;
  &lt;/role&gt;

  &lt;input_handling&gt;
      Treat [[attachment_files]] as each and every textual data enclosed within the files attached to this `prompt message`.
  &lt;/input_handling&gt;

  &lt;constraints&gt;
    &lt;constraint type=&quot;critical&quot;&gt;TOTAL SANITIZATION: No identifier, name, date, location, serial number, license plate, status, or factual description from the [[template_document]] may remain in the result.&lt;/constraint&gt;
    &lt;constraint type=&quot;critical&quot;&gt;INFERENCE ALLOWED: Deduce, guess, or auto-complete information based on plausibility.&lt;/constraint&gt;
    &lt;constraint type=&quot;critical&quot;&gt;CONFLICT RESOLUTION: If [[new_raw_data]] and [[attachment_files]] provide conflicting information for the same field, you must record BOTH values citing the source (e.g., &quot;Value X (Raw) / Value Y (Attachment)&quot;) preferably within the relevant section or in an &quot;OBSERVATIONS&quot; field.&lt;/constraint&gt;
    &lt;constraint type=&quot;formatting&quot;&gt;PRESERVE STRUCTURE: If possible, maintain the hierarchy, section order, list styles, and indentation of the template.&lt;/constraint&gt;
  &lt;/constraints&gt;
&lt;/context&gt;

&lt;instructions&gt;
  &lt;instruction step=&quot;1&quot;&gt;STRUCTURAL MAPPING: Analyze [[template_document]] to identify fixed sections (headers, footers) and variable fields (labels, placeholders, lists, narratives).&lt;/instruction&gt;

  &lt;instruction step=&quot;2&quot;&gt;DATA EXTRACTION: 
    a. Scan [[new_raw_data]] for primary entities (Who, When, Where, What, IDs).
    b. Scan [[attachment_files]] for corroborating details or additional evidence, applying OCR or any other textual data extraction method.&lt;/instruction&gt;

  &lt;instruction step=&quot;3&quot;&gt;CONFLICT CHECK: Compare data points between sources. If discrepancies exist (e.g., Raw Data says &quot;Status: OK&quot; but Attachment says &quot;Status: Failed&quot;), flag them for the output.&lt;/instruction&gt;

  &lt;instruction step=&quot;4&quot;&gt;DRAFTING &amp; SUBSTITUTION:
    a. Rebuild the document following the template&#39;s visual layout.
    b. Replace header/identification data (Dates, Locations, Protocols, etc.).
    c. Replace entity blocks (People, Vehicles, Assets, etc.).
    d. Rewrite narratives/descriptions: Adapt the template&#39;s style (e.g., &quot;The vehicle collided...&quot;) to the new facts, but use ONLY the new facts.&lt;/instruction&gt;

  &lt;instruction step=&quot;5&quot;&gt;LIST HANDLING:
    a. If the template has a list (e.g., &quot;Items Seized&quot;), match the style.
    b. If new data has MORE items, extend the list using the same format.
    c. If new data has FEWER items, list only what exists. Do not keep &quot;ghost&quot; items from the template.&lt;/instruction&gt;

  &lt;instruction step=&quot;6&quot;&gt;GAP FILLING: For any mandatory template field missing in the new sources, infer it, if possible. Never leave blank or retain old data.&lt;/instruction&gt;

  &lt;instruction step=&quot;7&quot;&gt;DISCREPANCY REPORTING: If conflicts were found in Step 3, ensure they are visible. If the template has an &quot;OBSERVATIONS&quot; section, place them there. If not, append a new section titled &quot;OBSERVATIONS&quot; at the end.&lt;/instruction&gt;

  &lt;instruction step=&quot;8&quot;&gt;ANTI-RESIDUE SCAN: Perform a final pass to ensure no specific data (names, dates, codes, etc.) from the original [[template_document]] remains. The output must be 100% based on new data.&lt;/instruction&gt;
&lt;/instructions&gt;

&lt;examples&gt;
  &lt;example&gt;
    &lt;scenario&gt;Technical Inspection (Asset Replacement)&lt;/scenario&gt;
    &lt;input_fragment_template&gt;&lt;![CDATA[
      EQUIPAMENTO: Gerador Diesel Modelo X500
      SÉRIE: 998877-AB
      STATUS: Operacional
      LOCAL: Subsolo - Garagem
    ]]&gt;&lt;/input_fragment_template&gt;
    &lt;input_fragment_new_data&gt;&lt;![CDATA[
      Vistoria no Nobreak da Sala de TI. Marca APC, modelo Smart-UPS. Etiqueta ilegível (sem número de série). O equipamento está apitando (bateria fraca).
    ]]&gt;&lt;/input_fragment_new_data&gt;
    &lt;output_fragment&gt;&lt;![CDATA[
      EQUIPAMENTO: Nobreak APC Smart-UPS
      SÉRIE: [Não definido]
      STATUS: Falha (Bateria fraca/Apitando)
      LOCAL: Sala de TI
    ]]&gt;&lt;/output_fragment&gt;
  &lt;/example&gt;

  &lt;example&gt;
    &lt;scenario&gt;Operational Report (List Extension &amp; Conflict)&lt;/scenario&gt;
    &lt;input_fragment_template&gt;&lt;![CDATA[
      ENVOLVIDOS:
      1. NOME: João Silva (Testemunha)
      
      OBSERVAÇÕES:
      Nada a relatar.
    ]]&gt;&lt;/input_fragment_template&gt;
    &lt;input_fragment_new_data&gt;&lt;![CDATA[
      Ocorrencia com duas pessoas. 
      1: Maria Souza (Vítima). 
      2: Pedro Santos (Autor).
      Obs: O autor alega legítima defesa.
    ]]&gt;&lt;/input_fragment_new_data&gt;
    &lt;input_fragment_attachment&gt;&lt;![CDATA[
      (Depoimento) Pedro Santos afirma que não estava no local.
    ]]&gt;&lt;/input_fragment_attachment&gt;
    &lt;output_fragment&gt;&lt;![CDATA[
      ENVOLVIDOS:
      1. NOME: Maria Souza (Vítima)
      2. NOME: Pedro Santos (Autor)

      OBSERVAÇÕES:
      O autor alega legítima defesa (Dados Brutos).
      Divergência: Anexo indica que Pedro Santos nega presença no local.
    ]]&gt;&lt;/output_fragment&gt;
  &lt;/example&gt;
&lt;/examples&gt;

&lt;input_data&gt;
  &lt;template_document&gt;&lt;![CDATA[
    [[
      &lt;purpose&gt;
        You are a terminal-safe coding agent. Complete [[task_request]] while guaranteeing that no single line written to stdout/stderr exceeds 4096 bytes (hard limit). Prevent session resets by wrapping, chunking, paging, or redirecting output before any potentially long print.
      &lt;/purpose&gt;
      
      &lt;context&gt;
        &lt;environment&gt;
          &lt;terminal_output_limit_bytes&gt;4096&lt;/terminal_output_limit_bytes&gt;
          &lt;failure_mode&gt;Any single output line above the limit crashes the session and resets state.&lt;/failure_mode&gt;
          &lt;note_on_bytes_vs_chars&gt;
            The limit is in bytes; assume worst-case and use a conservative wrap width (e.g., 1200–1500 characters) to stay well below 4096.
          &lt;/note_on_bytes_vs_chars&gt;
        &lt;/environment&gt;
      
        &lt;constraints&gt;
          &lt;constraint&gt;Hard invariant: never emit a line that could exceed 4096 bytes.&lt;/constraint&gt;
          &lt;constraint&gt;All shell command output MUST be piped as: `[[command]] 2&gt;&amp;1 | fold -w 1500`.&lt;/constraint&gt;
          &lt;constraint&gt;If output may include very long tokens (minified files, base64, JSON one-liners), redirect to a file first, then inspect in small slices, folded.&lt;/constraint&gt;
          &lt;constraint&gt;For remote content, do not dump via curl/wget; fetch programmatically (Python) and hard-wrap before printing.&lt;/constraint&gt;
          &lt;constraint&gt;Chunk/paginate large outputs; never dump entire large documents in one go.&lt;/constraint&gt;
          &lt;constraint&gt;Install any needed Python libraries only inside .venv using: `uv pip install &lt;pkg&gt;`.&lt;/constraint&gt;
          &lt;constraint&gt;Do not print secrets (tokens/keys/private material). If detected, redact or omit.&lt;/constraint&gt;
        &lt;/constraints&gt;
      
        &lt;domain_notes&gt;
          &lt;note&gt;Common crash sources: minified JS/CSS/HTML, JSON printed in compact form, stack traces with giant embedded payloads, long single-line logs, base64 blobs.&lt;/note&gt;
          &lt;note&gt;Safer defaults beat cleverness: when uncertain, wrap + redirect + slice.&lt;/note&gt;
        &lt;/domain_notes&gt;
      &lt;/context&gt;
      
      &lt;variables&gt;
        &lt;variable name=&quot;[[task_request]]&quot; required=&quot;true&quot;&gt;
          &lt;description&gt;Natural-language description of the task to complete.&lt;/description&gt;
        &lt;/variable&gt;
        &lt;variable name=&quot;[[command]]&quot; required=&quot;false&quot;&gt;
          &lt;description&gt;A shell command to run. If multiple commands, run one at a time with safe wrapping.&lt;/description&gt;
        &lt;/variable&gt;
        &lt;variable name=&quot;[[file_path]]&quot; required=&quot;false&quot;&gt;
          &lt;description&gt;Local file to inspect safely (logs, JSON, build artifacts).&lt;/description&gt;
        &lt;/variable&gt;
        &lt;variable name=&quot;[[url]]&quot; required=&quot;false&quot;&gt;
          &lt;description&gt;Remote resource to fetch; must be retrieved via Python then wrapped.&lt;/description&gt;
        &lt;/variable&gt;
      &lt;/variables&gt;
      
      &lt;instructions&gt;
        &lt;instruction&gt;1. Restate [[task_request]] as a single, concrete goal statement.&lt;/instruction&gt;
      
        &lt;instruction&gt;2. Before running any shell command [[command]], rewrite it into a safe form that captures stderr and wraps output: &lt;code&gt;[[command]] 2&gt;&amp;1 | fold -w 1500&lt;/code&gt;.&lt;/instruction&gt;
      
        &lt;instruction&gt;3. If [[file_path]] is provided, inspect safely:
          (a) size/lines via &lt;code&gt;wc -c&lt;/code&gt; and &lt;code&gt;wc -l&lt;/code&gt;;
          (b) preview with &lt;code&gt;head&lt;/code&gt;/&lt;code&gt;tail&lt;/code&gt;;
          (c) search with &lt;code&gt;rg -n&lt;/code&gt;;
          (d) always pipe through fold.
        &lt;/instruction&gt;
      
        &lt;instruction&gt;4. If [[url]] is provided, fetch programmatically (Python). Strip HTML if applicable, then hard-wrap text (e.g., 3500–4000 chars max) and print only a bounded slice or a limited number of wrapped lines.&lt;/instruction&gt;
      
        &lt;instruction&gt;5. If any output could still be huge after wrapping, redirect to a file and page through it (small slices). Do not print the entire content.&lt;/instruction&gt;
      
        &lt;instruction&gt;6. If you need Python dependencies (requests, beautifulsoup4), install them inside .venv using &lt;code&gt;uv pip install&lt;/code&gt; before importing.&lt;/instruction&gt;
      
        &lt;instruction&gt;7. Final self-check before responding: verify every emitted block is wrapped/chunked, no secrets are present, and no line plausibly exceeds 4096 bytes.&lt;/instruction&gt;
      &lt;/instructions&gt;
      
      &lt;output_format_specification&gt;
        &lt;format&gt;Plain text&lt;/format&gt;
        &lt;requirements&gt;
          &lt;requirement&gt;Commands must be presented in copy/paste-ready form, already made safe.&lt;/requirement&gt;
          &lt;requirement&gt;Response must be both thorough, comprehensive, exhaustive, complete, and in-depth in its detail, as well as wide-ranging, broad, vast, widespread, and far-reaching in its scope.&lt;/requirement&gt;
          &lt;requirement&gt;Never output unwrapped large data; use slices.&lt;/requirement&gt;
        &lt;/requirements&gt;
      &lt;/output_format_specification&gt;
      
      &lt;examples&gt;
        &lt;example&gt;
          &lt;input_data&gt;
            &lt;task_request&gt;Run a build command safely and preserve full logs.&lt;/task_request&gt;
            &lt;command&gt;./build&lt;/command&gt;
          &lt;/input_data&gt;
          &lt;output&gt;
            ./build 2&gt;&amp;1 | fold -w 1500
      
            If output is large, redirect first:
            ./build 2&gt;&amp;1 | fold -w 1500 &gt; build.log
            wc -l build.log 2&gt;&amp;1 | fold -w 1500
            tail -n 200 build.log 2&gt;&amp;1 | fold -w 1500
          &lt;/output&gt;
        &lt;/example&gt;
      
        &lt;example&gt;
          &lt;input_data&gt;
            &lt;task_request&gt;Pretty-print JSON safely (avoid single-line JSON).&lt;/task_request&gt;
            &lt;file_path&gt;data.json&lt;/file_path&gt;
          &lt;/input_data&gt;
          &lt;output&gt;
            wc -c data.json 2&gt;&amp;1 | fold -w 1500
            jq . data.json 2&gt;&amp;1 | fold -w 1500 | sed -n &#39;1,200p&#39;
          &lt;/output&gt;
        &lt;/example&gt;
      
        &lt;example&gt;
          &lt;input_data&gt;
            &lt;task_request&gt;Fetch a large HTML documentation page without crashing the session.&lt;/task_request&gt;
            &lt;url&gt;https://example.com/big-doc&lt;/url&gt;
          &lt;/input_data&gt;
          &lt;output&gt;
            python - &lt;&lt;&#39;PY&#39;
            import requests, textwrap
            from bs4 import BeautifulSoup
      
            url = &quot;https://example.com/big-doc&quot;
            html = requests.get(url, timeout=15).text
            text = BeautifulSoup(html, &quot;html.parser&quot;).get_text(&quot;\n&quot;)
            wrapped = &quot;\n&quot;.join(textwrap.wrap(text, width=3500))
            print(wrapped[:20000])  # bounded slice
            PY
          &lt;/output&gt;
        &lt;/example&gt;
      
        &lt;example&gt;
          &lt;input_data&gt;
            &lt;task_request&gt;Investigate a huge log for exceptions and show only the relevant region.&lt;/task_request&gt;
            &lt;file_path&gt;server.log&lt;/file_path&gt;
          &lt;/input_data&gt;
          &lt;output&gt;
            rg -n &quot;ERROR|Exception&quot; server.log 2&gt;&amp;1 | fold -w 1500 | head -n 50
            # After identifying line numbers, print a tight range:
            sed -n &#39;1200,1300p&#39; server.log 2&gt;&amp;1 | fold -w 1500
          &lt;/output&gt;
        &lt;/example&gt;
      
        &lt;example&gt;
          &lt;input_data&gt;
            &lt;task_request&gt;Handle base64 or minified one-liners (worst-case line length).&lt;/task_request&gt;
            &lt;file_path&gt;payload.txt&lt;/file_path&gt;
          &lt;/input_data&gt;
          &lt;output&gt;
            # Never cat directly. Redirect/transform then fold:
            wc -c payload.txt 2&gt;&amp;1 | fold -w 1500
            fold -w 1200 payload.txt 2&gt;&amp;1 | sed -n &#39;1,80p&#39;
          &lt;/output&gt;
        &lt;/example&gt;
      &lt;/examples&gt;
      
      &lt;self_check&gt;
        &lt;checklist&gt;
          &lt;item&gt;Did I rewrite every shell command to include: 2&gt;&amp;1 | fold -w 1500?&lt;/item&gt;
          &lt;item&gt;Did I avoid printing full large blobs and instead use slices?&lt;/item&gt;
          &lt;item&gt;For remote pages, did I fetch via Python and hard-wrap before printing?&lt;/item&gt;
          &lt;item&gt;Did I redact or avoid any secrets?&lt;/item&gt;
          &lt;item&gt;Would any produced line plausibly exceed 4096 bytes?&lt;/item&gt;
        &lt;/checklist&gt;
      &lt;/self_check&gt;
      
      &lt;evaluation_notes&gt;
        &lt;test_cases&gt;
          &lt;case&gt;Minified JS/CSS/HTML file inspection&lt;/case&gt;
          &lt;case&gt;Large compact JSON (single-line) handling&lt;/case&gt;
          &lt;case&gt;Stack trace containing embedded payloads&lt;/case&gt;
          &lt;case&gt;Binary-ish or base64-heavy logs&lt;/case&gt;
        &lt;/test_cases&gt;
        &lt;success_definition&gt;Session does not reset due to long lines; relevant context is still retrievable via safe slicing.&lt;/success_definition&gt;
      &lt;/evaluation_notes&gt;
      
      &lt;documentation&gt;
        &lt;usage&gt;
          &lt;step&gt;Replace placeholders with real task/command/url/file values gathered from the USER&#39;s queries.&lt;/step&gt;
          &lt;step&gt;Follow the safe rewrite patterns exactly; default to redirect+slice when uncertain.&lt;/step&gt;
        &lt;/usage&gt;
        &lt;known_limitations&gt;
          &lt;limitation&gt;Byte vs character encoding can be tricky; conservative fold widths reduce risk.&lt;/limitation&gt;
          &lt;limitation&gt;Some outputs include control characters; redirect to file and inspect with safe tools.&lt;/limitation&gt;
        &lt;/known_limitations&gt;
      &lt;/documentation&gt;
    ]]
  ]]&gt;&lt;/template_document&gt;

  &lt;new_raw_data&gt;&lt;![CDATA[
    [[&lt;!-- all the textual data enclosed within the USER&#39;s queries. --&gt;]]
  ]]&gt;&lt;/new_raw_data&gt;

  &lt;attachment_files&gt;&lt;![CDATA[
    [[&lt;!-- all the textual data enclosed within the files located at `[[file_path]]` and fetched from `[[url]]` --&gt;]]
  ]]&gt;&lt;/attachment_files&gt;
&lt;/input_data&gt;

&lt;output_specification&gt;
  &lt;format&gt;Plain text or Markdown, strictly mirroring the layout of the template.&lt;/format&gt;
  &lt;language&gt;en_US&lt;/language&gt;
&lt;/output_specification&gt;</code>
</section>]]></content><author><name></name></author><category term="AI&gt;prompt" /></entry><entry><title type="html">html to markdown</title><link href="https://ib.bsb.br/html2md/" rel="alternate" type="text/html" title="html to markdown" /><published>2026-01-09T00:00:00+00:00</published><updated>2026-01-09T15:25:06+00:00</updated><id>https://ib.bsb.br/html2md</id><content type="html" xml:base="https://ib.bsb.br/html2md/"><![CDATA[<p>It accepts a local file, a URL, or stdin; it can emit Jekyll front matter; and it uses conservative conversion rules that tend to render well on GitHub Pages (kramdown).</p>

<h1 id="key-behaviors">Key behaviors</h1>

<ul>
  <li>Default extraction is <code class="language-plaintext highlighter-rouge">--mode main</code> (tries <code class="language-plaintext highlighter-rouge">&lt;main&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;article&gt;</code>, common content containers, then a “largest text block” heuristic).</li>
  <li>Use <code class="language-plaintext highlighter-rouge">--selector</code> when heuristics pick the wrong container.</li>
  <li>Tables become Markdown tables only when they’re simple; otherwise they become bullets.</li>
</ul>

<h1 id="install-and-run">Install and run</h1>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 <span class="nt">-m</span> pip <span class="nb">install</span> <span class="nt">--user</span> beautifulsoup4 lxml
</code></pre></div></div>

<h2 id="generic-html-file--jekyll-post">Generic HTML file → Jekyll post</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 html_to_jekyll_md.py page.html <span class="nt">-o</span> _posts/2026-01-09-page.md <span class="nt">--layout</span> post <span class="nt">--date-from-meta</span> <span class="nt">--tags</span> imported,html
</code></pre></div></div>

<h2 id="generic-url--jekyll-page">Generic URL → Jekyll page</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 html_to_jekyll_md.py https://example.com/article <span class="nt">-o</span> docs/article.md <span class="nt">--layout</span> page <span class="nt">--permalink</span> /article/ <span class="nt">--date-from-meta</span>
</code></pre></div></div>

<h2 id="when-heuristics-pick-the-wrong-content-container-force-it-with-a-selector">When heuristics pick the wrong content container, force it with a selector</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 html_to_jekyll_md.py page.html <span class="nt">--selector</span> <span class="s2">"article"</span> <span class="nt">-o</span> docs/page.md <span class="nt">--layout</span> page
</code></pre></div></div>

<h1 id="practical-limits">Practical limits</h1>

<ul>
  <li>If the page is JavaScript-rendered (SPA shells), you need a “rendered HTML snapshot” first (browser “Save page as…”, or a headless browser step). This script converts the HTML it is given; it does not run scripts.</li>
  <li>Highly visual layouts won’t “round-trip” cleanly. The goal here is readable Markdown, not pixel-perfect reconstruction.</li>
  <li>Tables are conservative by design: broken tables are worse than bullet lists on GitHub Pages.</li>
</ul>

<h1 id="optional-batch-wrapper-bash">Optional batch wrapper (bash)</h1>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail

<span class="k">in</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">1</span>:?input<span class="p"> (file or URL or </span><span class="s1">'-'</span><span class="p">) required</span><span class="k">}</span><span class="s2">"</span>
<span class="nv">out</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">2</span><span class="k">:-</span><span class="nv">docs</span><span class="p">/</span><span class="si">$(</span><span class="nb">basename</span> <span class="s2">"</span><span class="k">${</span><span class="nv">in</span><span class="p">%.*</span><span class="k">}</span><span class="s2">"</span><span class="si">)</span><span class="p">.md</span><span class="k">}</span><span class="s2">"</span>

python3 ./html_to_jekyll_md.py <span class="s2">"</span><span class="nv">$in</span><span class="s2">"</span> <span class="nt">-o</span> <span class="s2">"</span><span class="nv">$out</span><span class="s2">"</span> <span class="nt">--layout</span> page <span class="nt">--date-from-meta</span>
<span class="nb">echo</span> <span class="s2">"Wrote: </span><span class="nv">$out</span><span class="s2">"</span>
</code></pre></div></div>

<h1 id="python-script">python script</h1>

<section class="code-block-container" role="group" aria-label="Python Code Block" data-filename="python_code_block.py" data-code="#!/usr/bin/env python3
&quot;&quot;&quot;html_to_jekyll_md.py

Universal HTML → Markdown converter with Jekyll front matter.

Goals
- Accept *any* single-page HTML source: local file, URL (http/https), or stdin.
- Emit readable Markdown that works well on GitHub Pages (Jekyll + kramdown).
- Provide an optional HardInfo2 profile (because HardInfo2 uses layout tables).

Install
  python3 -m pip install beautifulsoup4
  (optional, faster/more robust parsing) python3 -m pip install lxml

Examples
  # Local file → Jekyll post
  python3 html_to_jekyll_md.py ./page.html -o _posts/2026-01-09-page.md --layout post --date-from-meta

  # URL → Jekyll page
  python3 html_to_jekyll_md.py https://example.com/article -o docs/article.md --layout page --permalink /article/

  # stdin → stdout
  cat page.html | python3 html_to_jekyll_md.py -

  # HardInfo2 report (auto-detect, or force)
  python3 html_to_jekyll_md.py hardinfo2_report.html --profile hardinfo2 -o docs/hardinfo2.md

Notes
- This converts the HTML it receives; it does not execute JavaScript.
- “Perfect” HTML→Markdown is not generally achievable. This aims for a clean, readable document.
&quot;&quot;&quot;

from __future__ import annotations

import argparse
import re
import sys
import urllib.parse
import urllib.request
from dataclasses import dataclass
from datetime import datetime
from pathlib import Path
from typing import Iterable, List, Optional, Sequence, Tuple


# -----------------------------
# Parsing helpers
# -----------------------------

_WS_RE = re.compile(r&quot;[ \t\r\f\v]+&quot;)


def _require_bs4() -&gt; None:
    try:
        import bs4  # noqa: F401
    except Exception:
        print(
            &quot;ERROR: Missing dependency: beautifulsoup4\n&quot;
            &quot;  Install with: python3 -m pip install beautifulsoup4&quot;,
            file=sys.stderr,
        )
        raise


def _make_soup(html: str):
    from bs4 import BeautifulSoup

    try:
        return BeautifulSoup(html, &quot;lxml&quot;)
    except Exception:
        return BeautifulSoup(html, &quot;html.parser&quot;)


def _norm_ws_keep_newlines(s: str) -&gt; str:
    s = s.replace(&quot;\u00a0&quot;, &quot; &quot;)
    s = s.replace(&quot;\r\n&quot;, &quot;\n&quot;).replace(&quot;\r&quot;, &quot;\n&quot;)
    lines = [_WS_RE.sub(&quot; &quot;, ln).strip() for ln in s.split(&quot;\n&quot;)]
    out = &quot;\n&quot;.join(lines)
    out = re.sub(r&quot;\n{3,}&quot;, &quot;\n\n&quot;, out)
    return out.strip()


def _yaml_quote(s: str) -&gt; str:
    return &#39;&quot;&#39; + s.replace(&quot;\\&quot;, &quot;\\\\&quot;).replace(&#39;&quot;&#39;, &#39;\\&quot;&#39;) + &#39;&quot;&#39;


def _escape_md_inline(s: str) -&gt; str:
    # Minimal escaping; keep it conservative.
    return s.replace(&quot;\\&quot;, &quot;\\\\&quot;).replace(&quot;`&quot;, &quot;\\`&quot;)


def _escape_table_cell(s: str) -&gt; str:
    s = s.replace(&quot;\\&quot;, &quot;\\\\&quot;)
    s = s.replace(&quot;|&quot;, &quot;\\|&quot;)
    s = s.replace(&quot;\n&quot;, &quot;&lt;br /&gt;&quot;)
    return s.strip()


def _collapse_blank_lines(lines: List[str]) -&gt; List[str]:
    out: List[str] = []
    blank = False
    for ln in lines:
        if not ln.strip():
            if not blank:
                out.append(&quot;&quot;)
            blank = True
        else:
            out.append(ln.rstrip())
            blank = False

    while out and out[0] == &quot;&quot;:
        out.pop(0)
    while out and out[-1] == &quot;&quot;:
        out.pop()
    return out


def _indent_lines(lines: Iterable[str], spaces: int) -&gt; List[str]:
    pad = &quot; &quot; * spaces
    return [(pad + ln) if ln else &quot;&quot; for ln in lines]


def _inline_or_codeblock(text: str) -&gt; Tuple[str, Optional[List[str]]]:
    text = _norm_ws_keep_newlines(text)
    if not text:
        return &quot;&quot;, None

    lines = [ln.rstrip() for ln in text.splitlines() if ln.strip()]
    if len(lines) &lt;= 1:
        return (lines[0] if lines else &quot;&quot;), None

    total = sum(len(ln) for ln in lines)
    if len(lines) &lt;= 3 and total &lt;= 140:
        return &quot; ; &quot;.join(lines), None

    return &quot;&quot;, [&quot;```text&quot;, *lines, &quot;```&quot;]


# -----------------------------
# Input loading
# -----------------------------


def _read_input(input_arg: str, user_agent: str = &quot;html_to_jekyll_md/1.1&quot;) -&gt; Tuple[str, Optional[str]]:
    &quot;&quot;&quot;Return (html, base_url).

    base_url is used to resolve relative links/images.
    - stdin: None
    - file: None
    - URL: the URL
    &quot;&quot;&quot;

    if input_arg == &quot;-&quot;:
        return sys.stdin.read(), None

    if re.match(r&quot;^https?://&quot;, input_arg, flags=re.IGNORECASE):
        req = urllib.request.Request(input_arg, headers={&quot;User-Agent&quot;: user_agent})
        with urllib.request.urlopen(req) as resp:
            charset = resp.headers.get_content_charset() or &quot;utf-8&quot;
            data = resp.read()
            try:
                html = data.decode(charset, errors=&quot;replace&quot;)
            except Exception:
                html = data.decode(&quot;utf-8&quot;, errors=&quot;replace&quot;)
        return html, input_arg

    path = Path(input_arg)
    return path.read_text(encoding=&quot;utf-8&quot;, errors=&quot;replace&quot;), None


def _extract_base_href(soup) -&gt; Optional[str]:
    base = soup.find(&quot;base&quot;)
    if base and base.get(&quot;href&quot;):
        return _norm_ws_keep_newlines(base[&quot;href&quot;]) or None
    return None


# -----------------------------
# Jekyll front matter
# -----------------------------


@dataclass
class FrontMatter:
    layout: str = &quot;post&quot;
    title: str = &quot;Document&quot;
    date: Optional[str] = None
    categories: Optional[List[str]] = None
    tags: Optional[List[str]] = None
    permalink: Optional[str] = None

    def render(self) -&gt; str:
        lines = [&quot;---&quot;, f&quot;layout: {self.layout}&quot;, f&quot;title: {_yaml_quote(self.title)}&quot;]
        if self.date:
            lines.append(f&quot;date: {_yaml_quote(self.date)}&quot;)
        if self.categories:
            lines.append(&quot;categories:&quot;)
            for c in self.categories:
                lines.append(f&quot;  - {c}&quot;)
        if self.tags:
            lines.append(&quot;tags:&quot;)
            for t in self.tags:
                lines.append(f&quot;  - {t}&quot;)
        if self.permalink:
            lines.append(f&quot;permalink: {self.permalink}&quot;)
        lines.append(&quot;---&quot;)
        return &quot;\n&quot;.join(lines) + &quot;\n\n&quot;


def _extract_title(soup, override: Optional[str] = None) -&gt; str:
    if override:
        return override

    t = soup.find(&quot;title&quot;)
    if t and t.get_text(strip=True):
        return _norm_ws_keep_newlines(t.get_text())

    h1 = soup.find(&quot;h1&quot;)
    if h1 and h1.get_text(strip=True):
        return _norm_ws_keep_newlines(h1.get_text())

    return &quot;Document&quot;


def _extract_date_hint(soup) -&gt; Optional[str]:
    meta_props = [
        (&quot;property&quot;, &quot;article:published_time&quot;),
        (&quot;name&quot;, &quot;date&quot;),
        (&quot;name&quot;, &quot;publish-date&quot;),
        (&quot;name&quot;, &quot;pubdate&quot;),
        (&quot;itemprop&quot;, &quot;datePublished&quot;),
    ]

    for attr, key in meta_props:
        m = soup.find(&quot;meta&quot;, attrs={attr: key})
        if m and m.get(&quot;content&quot;):
            return _norm_ws_keep_newlines(m[&quot;content&quot;])

    tm = soup.find(&quot;time&quot;)
    if tm and tm.get(&quot;datetime&quot;):
        return _norm_ws_keep_newlines(tm[&quot;datetime&quot;])

    return None


def _now_with_tz() -&gt; str:
    return datetime.now().astimezone().strftime(&quot;%Y-%m-%d %H:%M:%S %z&quot;)


# -----------------------------
# Content selection
# -----------------------------


def _strip_non_content(soup) -&gt; None:
    # Keep it conservative; do not drop “head” here.
    for sel in [&quot;script&quot;, &quot;style&quot;, &quot;noscript&quot;, &quot;template&quot;, &quot;iframe&quot;]:
        for tag in soup.select(sel):
            tag.decompose()


def _maybe_strip_chrome(root) -&gt; None:
    for sel in [&quot;nav&quot;, &quot;header&quot;, &quot;footer&quot;, &quot;aside&quot;]:
        for tag in root.find_all(sel):
            tag.decompose()


def _text_len(tag) -&gt; int:
    return len(tag.get_text(&quot; &quot;, strip=True))


def _score_candidate(tag) -&gt; int:
    text = tag.get_text(&quot; &quot;, strip=True)
    if not text:
        return 0
    text_len = len(text)
    link_text = &quot; &quot;.join(a.get_text(&quot; &quot;, strip=True) for a in tag.find_all(&quot;a&quot;))
    return max(0, text_len - int(0.7 * len(link_text)))


def _select_root(soup, mode: str, selector: Optional[str]):
    body = soup.body or soup

    if selector:
        found = soup.select_one(selector)
        return found or body

    if mode == &quot;body&quot;:
        return body

    # mode == &quot;main&quot;
    for tagname in [&quot;main&quot;, &quot;article&quot;]:
        t = body.find(tagname)
        if t and _text_len(t) &gt; 50:
            _maybe_strip_chrome(t)
            return t

    for css in [&quot;#content&quot;, &quot;#main&quot;, &quot;.content&quot;, &quot;.main&quot;, &quot;.post&quot;, &quot;.article&quot;, &quot;.entry-content&quot;]:
        t = body.select_one(css)
        if t and _text_len(t) &gt; 80:
            _maybe_strip_chrome(t)
            return t

    candidates = body.find_all([&quot;div&quot;, &quot;section&quot;, &quot;article&quot;, &quot;main&quot;], limit=250)
    best = body
    best_score = _score_candidate(body)
    for c in candidates:
        sc = _score_candidate(c)
        if sc &gt; best_score:
            best, best_score = c, sc

    _maybe_strip_chrome(best)
    return best


# -----------------------------
# HardInfo2 profile (optional)
# -----------------------------


def _looks_like_hardinfo2(soup) -&gt; bool:
    # HardInfo2 exports layout tables with these classes.
    return bool(soup.find(&quot;td&quot;, class_=&quot;stitle&quot;) or soup.find(&quot;h1&quot;, class_=&quot;title&quot;))


def _hardinfo2_text(tag) -&gt; str:
    # HardInfo2 uses &lt;br&gt; and &lt;tt&gt; blocks; preserve newlines.
    return _norm_ws_keep_newlines(tag.get_text(&quot;\n&quot;, strip=True))


def _hardinfo2_iter_rows(table):
    tbody = table.find(&quot;tbody&quot;, recursive=False)
    container = tbody if tbody else table

    for tr in container.find_all(&quot;tr&quot;, recursive=False):
        tds = tr.find_all(&quot;td&quot;, recursive=False)
        if not tds:
            continue

        if any(&quot;stitle&quot; in (td.get(&quot;class&quot;) or []) for td in tds):
            continue

        sst = tr.find(&quot;td&quot;, class_=&quot;sstitle&quot;)
        if sst:
            yield (&quot;sstitle&quot;, _hardinfo2_text(sst))
            continue

        nested_tables = tr.find_all(&quot;table&quot;)
        if nested_tables and len(tds) == 1 and tds[0].get(&quot;colspan&quot;):
            yield (&quot;details&quot;, nested_tables)
            continue

        # Drop icon columns
        data = []
        for td in tds:
            cls = td.get(&quot;class&quot;) or []
            if &quot;icon&quot; in cls or &quot;icon_subtitle&quot; in cls:
                continue
            data.append(td)
        if not data:
            continue

        if &quot;field&quot; in (data[0].get(&quot;class&quot;) or []):
            field = _hardinfo2_text(data[0])
            vals = [_hardinfo2_text(td) for td in data[1:]]
            yield (&quot;kv&quot;, (field, vals, tr.find_all(&quot;table&quot;) or None))
        else:
            yield (&quot;raw&quot;, [_hardinfo2_text(td) for td in data])


def _hardinfo2_render_table(table, heading_level: int) -&gt; List[str]:
    lines: List[str] = []

    st = table.find(&quot;td&quot;, class_=&quot;stitle&quot;)
    title = _hardinfo2_text(st) if st else None
    if title:
        lines.append(&quot;#&quot; * heading_level + f&quot; {_escape_md_inline(title)}&quot;)
        lines.append(&quot;&quot;)

    def render_details(details_table, indent=2) -&gt; List[str]:
        out: List[str] = []
        for kind, payload in _hardinfo2_iter_rows(details_table):
            if kind == &quot;sstitle&quot;:
                out.append(&quot; &quot; * indent + f&quot;- **{_escape_md_inline(payload)}**&quot;)
                continue

            if kind == &quot;details&quot;:
                for t in payload:
                    out.extend(render_details(t, indent=indent + 2))
                continue

            if kind == &quot;kv&quot;:
                field, vals, nested = payload
                val_text = &quot; | &quot;.join(v for v in vals if v)
                inline, code = _inline_or_codeblock(val_text)
                if inline:
                    out.append(&quot; &quot; * indent + f&quot;- **{_escape_md_inline(field)}:** {_escape_md_inline(inline)}&quot;)
                else:
                    out.append(&quot; &quot; * indent + f&quot;- **{_escape_md_inline(field)}:**&quot;)
                    out.extend(_indent_lines(code or [], indent + 4))
                if nested:
                    for t in nested:
                        out.extend(render_details(t, indent=indent + 2))
                continue

            if kind == &quot;raw&quot;:
                txt = &quot; | &quot;.join(payload)
                inline, code = _inline_or_codeblock(txt)
                if inline:
                    out.append(&quot; &quot; * indent + f&quot;- {_escape_md_inline(inline)}&quot;)
                else:
                    out.append(&quot; &quot; * indent + &quot;-&quot;)
                    out.extend(_indent_lines(code or [], indent + 4))

        return out

    for kind, payload in _hardinfo2_iter_rows(table):
        if kind == &quot;sstitle&quot;:
            lines.append(&quot;#&quot; * (heading_level + 1) + f&quot; {_escape_md_inline(payload)}&quot;)
            lines.append(&quot;&quot;)
            continue

        if kind == &quot;details&quot;:
            lines.append(&quot;- **Details:**&quot;)
            for t in payload:
                lines.extend(render_details(t, indent=2))
            lines.append(&quot;&quot;)
            continue

        if kind == &quot;kv&quot;:
            field, vals, nested = payload
            val_text = &quot; | &quot;.join(v for v in vals if v)
            inline, code = _inline_or_codeblock(val_text)
            if inline:
                lines.append(f&quot;- **{_escape_md_inline(field)}:** {_escape_md_inline(inline)}&quot;)
            else:
                lines.append(f&quot;- **{_escape_md_inline(field)}:**&quot;)
                lines.extend(_indent_lines(code or [], 4))
            if nested:
                for t in nested:
                    lines.extend(render_details(t, indent=2))
            continue

        if kind == &quot;raw&quot;:
            txt = &quot; | &quot;.join(payload)
            inline, code = _inline_or_codeblock(txt)
            if inline:
                lines.append(f&quot;- {_escape_md_inline(inline)}&quot;)
            else:
                lines.append(&quot;-&quot;)
                lines.extend(_indent_lines(code or [], 4))

    lines.append(&quot;&quot;)
    return lines


def _hardinfo2_convert(html: str, section_heading_level: int = 2) -&gt; str:
    soup = _make_soup(html)
    root = soup.body or soup

    out: List[str] = []
    for el in root.find_all([&quot;h1&quot;, &quot;table&quot;], recursive=True):
        if el.name == &quot;h1&quot; and &quot;title&quot; in (el.get(&quot;class&quot;) or []):
            out.append(&quot;#&quot; * section_heading_level + f&quot; {_escape_md_inline(_hardinfo2_text(el))}&quot;)
            out.append(&quot;&quot;)
        elif el.name == &quot;table&quot; and el.find_parent(&quot;table&quot;) is None:
            out.extend(_hardinfo2_render_table(el, heading_level=section_heading_level + 1))

    return &quot;\n&quot;.join(_collapse_blank_lines(out)) + &quot;\n&quot;


# -----------------------------
# Generic HTML → Markdown
# -----------------------------


BLOCK_TAGS = {
    &quot;p&quot;,
    &quot;div&quot;,
    &quot;section&quot;,
    &quot;article&quot;,
    &quot;main&quot;,
    &quot;pre&quot;,
    &quot;blockquote&quot;,
    &quot;ul&quot;,
    &quot;ol&quot;,
    &quot;table&quot;,
    &quot;hr&quot;,
    &quot;h1&quot;,
    &quot;h2&quot;,
    &quot;h3&quot;,
    &quot;h4&quot;,
    &quot;h5&quot;,
    &quot;h6&quot;,
}


class _Ctx:
    def __init__(
        self,
        base_url: Optional[str],
        keep_images: bool,
        heading_offset: int,
        max_heading_level: int,
    ):
        self.base_url = base_url
        self.keep_images = keep_images
        self.heading_offset = heading_offset
        self.max_heading_level = max_heading_level


def _resolve_url(href: str, base_url: Optional[str]) -&gt; str:
    if not href:
        return &quot;&quot;
    return urllib.parse.urljoin(base_url, href) if base_url else href


def _extract_text(tag) -&gt; str:
    return _norm_ws_keep_newlines(tag.get_text(&quot; &quot;, strip=True))


def _convert_children(tag, ctx: _Ctx) -&gt; List[str]:
    from bs4 import NavigableString, Tag

    out: List[str] = []
    for child in tag.children:
        if isinstance(child, NavigableString):
            txt = _norm_ws_keep_newlines(str(child))
            if txt:
                out.append(txt)
            continue
        if isinstance(child, Tag):
            out.extend(_convert_node(child, ctx))
    return out


def _convert_children_inline(tag, ctx: _Ctx) -&gt; List[str]:
    from bs4 import NavigableString, Tag

    out: List[str] = []
    for child in tag.children:
        if isinstance(child, NavigableString):
            txt = _norm_ws_keep_newlines(str(child))
            if txt:
                out.append(txt)
            continue
        if isinstance(child, Tag):
            out.append(_convert_inline(child, ctx))
    return out


def _convert_inline(tag, ctx: _Ctx) -&gt; str:
    name = tag.name.lower()

    if name in (&quot;span&quot;, &quot;label&quot;, &quot;small&quot;, &quot;sup&quot;, &quot;sub&quot;):
        return &quot;&quot;.join(_convert_children_inline(tag, ctx))

    if name in (&quot;strong&quot;, &quot;b&quot;):
        inner = &quot;&quot;.join(_convert_children_inline(tag, ctx)).strip()
        return f&quot;**{inner}**&quot; if inner else &quot;&quot;

    if name in (&quot;em&quot;, &quot;i&quot;):
        inner = &quot;&quot;.join(_convert_children_inline(tag, ctx)).strip()
        return f&quot;*{inner}*&quot; if inner else &quot;&quot;

    if name == &quot;code&quot;:
        inner = _extract_text(tag)
        if &quot;`&quot; in inner:
            return f&quot;``{inner}``&quot;
        return f&quot;`{inner}`&quot;

    if name == &quot;br&quot;:
        return &quot;  \n&quot;

    if name == &quot;a&quot;:
        href = _resolve_url(tag.get(&quot;href&quot;, &quot;&quot;), ctx.base_url)
        text = &quot;&quot;.join(_convert_children_inline(tag, ctx)).strip() or href
        return f&quot;[{text}]({href})&quot; if href else text

    if name == &quot;img&quot;:
        if not ctx.keep_images:
            return &quot;&quot;
        alt = (tag.get(&quot;alt&quot;) or &quot;image&quot;).strip() or &quot;image&quot;
        src = _resolve_url(tag.get(&quot;src&quot;, &quot;&quot;), ctx.base_url)
        return f&quot;![{_escape_md_inline(alt)}]({src})&quot; if src else &quot;&quot;

    return &quot;&quot;.join(_convert_children_inline(tag, ctx))


def _table_to_bullets(table, ctx: _Ctx) -&gt; List[str]:
    lines: List[str] = []
    tbody = table.find(&quot;tbody&quot;, recursive=False)
    container = tbody if tbody else table

    for tr in container.find_all(&quot;tr&quot;, recursive=False):
        cells = tr.find_all([&quot;th&quot;, &quot;td&quot;], recursive=False)
        if not cells:
            continue
        vals = [_extract_text(td) for td in cells]
        vals = [v for v in vals if v]
        if not vals:
            continue
        txt = &quot; | &quot;.join(vals)
        inline, code = _inline_or_codeblock(txt)
        if inline:
            lines.append(f&quot;- {_escape_md_inline(inline)}&quot;)
        else:
            lines.append(&quot;-&quot;)
            lines.extend(_indent_lines(code or [], 4))

    lines.append(&quot;&quot;)
    return lines


def _table_to_md(table, ctx: _Ctx) -&gt; List[str]:
    if table.find(&quot;table&quot;):
        return _table_to_bullets(table, ctx)

    rows: List[List[str]] = []
    tbody = table.find(&quot;tbody&quot;, recursive=False)
    container = tbody if tbody else table

    for tr in container.find_all(&quot;tr&quot;, recursive=False):
        cells = tr.find_all([&quot;th&quot;, &quot;td&quot;], recursive=False)
        if not cells:
            continue
        rows.append([_extract_text(td) for td in cells])

    if not rows:
        return []

    has_th = bool(table.find(&quot;th&quot;))
    header = rows[0] if has_th else None
    body_rows = rows[1:] if has_th else rows

    if header is None:
        first = rows[0]
        if first and all(len(c) &lt;= 40 for c in first) and len(first) &lt;= 6:
            header = first
            body_rows = rows[1:]
        else:
            header = [f&quot;Col {i+1}&quot; for i in range(len(rows[0]))]
            body_rows = rows

    col_count = max(len(header), *(len(r) for r in body_rows))

    def pad(r: List[str]) -&gt; List[str]:
        return (r + [&quot;&quot;] * col_count)[:col_count]

    header = pad(header)

    lines: List[str] = []
    lines.append(&quot;| &quot; + &quot; | &quot;.join(_escape_table_cell(c) for c in header) + &quot; |&quot;)
    lines.append(&quot;|&quot; + &quot;|&quot;.join([&quot;---&quot;] * col_count) + &quot;|&quot;)

    for r in body_rows:
        r = pad(r)
        if any(&quot;\n&quot; in c for c in r):
            return _table_to_bullets(table, ctx)
        lines.append(&quot;| &quot; + &quot; | &quot;.join(_escape_table_cell(c) for c in r) + &quot; |&quot;)

    lines.append(&quot;&quot;)
    return lines


def _list_to_md(list_tag, ordered: bool, ctx: _Ctx, indent: int = 0) -&gt; List[str]:
    from bs4 import Tag

    lines: List[str] = []
    items = [li for li in list_tag.find_all(&quot;li&quot;, recursive=False) if isinstance(li, Tag)]

    for idx, li in enumerate(items, start=1):
        prefix = f&quot;{idx}. &quot; if ordered else &quot;- &quot;
        cont_indent = indent + len(prefix)

        # Build “main line” from inline-ish children and the first paragraph-ish block.
        main_fragments: List[str] = []
        extra_blocks: List[List[str]] = []

        for child in li.children:
            if isinstance(child, Tag) and child.name.lower() in (&quot;ul&quot;, &quot;ol&quot;):
                continue

            if isinstance(child, Tag) and child.name.lower() in BLOCK_TAGS:
                block_lines = _convert_node(child, ctx)
                block_lines = _collapse_blank_lines(block_lines)
                if block_lines:
                    if not main_fragments:
                        # Use first non-empty line as the main line.
                        first_line = next((x for x in block_lines if x.strip()), &quot;&quot;)
                        if first_line:
                            main_fragments.append(first_line)
                        rest = [x for x in block_lines if x.strip()][1:]
                        if rest:
                            extra_blocks.append(rest)
                    else:
                        extra_blocks.append([x for x in block_lines if x.strip()])
                continue

            if isinstance(child, Tag):
                main_fragments.append(_convert_inline(child, ctx))
            else:
                txt = _norm_ws_keep_newlines(str(child))
                if txt:
                    main_fragments.append(txt)

        main_line = _norm_ws_keep_newlines(&quot;&quot;.join(main_fragments)).strip()
        lines.append(&quot; &quot; * indent + prefix + main_line)

        for block in extra_blocks:
            for ln in block:
                lines.append(&quot; &quot; * cont_indent + ln)

        for child in li.find_all([&quot;ul&quot;, &quot;ol&quot;], recursive=False):
            lines.extend(_list_to_md(child, ordered=(child.name.lower() == &quot;ol&quot;), ctx=ctx, indent=indent + 2))

    lines.append(&quot;&quot;)
    return lines


def _convert_node(tag, ctx: _Ctx) -&gt; List[str]:
    name = tag.name.lower()

    if name in (&quot;script&quot;, &quot;style&quot;, &quot;noscript&quot;, &quot;template&quot;):
        return []

    if name in (&quot;h1&quot;, &quot;h2&quot;, &quot;h3&quot;, &quot;h4&quot;, &quot;h5&quot;, &quot;h6&quot;):
        lvl = int(name[1]) + ctx.heading_offset
        lvl = max(1, min(ctx.max_heading_level, lvl))
        text = &quot;&quot;.join(_convert_children_inline(tag, ctx)).strip()
        text = _norm_ws_keep_newlines(text)
        return [&quot;#&quot; * lvl + f&quot; {_escape_md_inline(text)}&quot;, &quot;&quot;] if text else []

    if name == &quot;p&quot;:
        text = &quot;&quot;.join(_convert_children_inline(tag, ctx)).strip()
        text = _norm_ws_keep_newlines(text)
        return [text, &quot;&quot;] if text else []

    if name == &quot;hr&quot;:
        return [&quot;---&quot;, &quot;&quot;]

    if name == &quot;blockquote&quot;:
        inner = _collapse_blank_lines(_convert_children(tag, ctx))
        quoted: List[str] = []
        for ln in inner:
            quoted.append(&quot;&gt;&quot; if not ln.strip() else &quot;&gt; &quot; + ln)
        quoted.append(&quot;&quot;)
        return quoted

    if name == &quot;pre&quot;:
        # Try to infer a language from pre/code classes.
        lang = &quot;&quot;
        cls = &quot; &quot;.join(tag.get(&quot;class&quot;) or [])
        m = re.search(r&quot;language-([a-zA-Z0-9_+-]+)&quot;, cls)
        if not m:
            code = tag.find(&quot;code&quot;)
            if code:
                cls2 = &quot; &quot;.join(code.get(&quot;class&quot;) or [])
                m = re.search(r&quot;language-([a-zA-Z0-9_+-]+)&quot;, cls2)
        if m:
            lang = m.group(1)

        code_text = tag.get_text(&quot;\n&quot;, strip=False).replace(&quot;\r\n&quot;, &quot;\n&quot;).replace(&quot;\r&quot;, &quot;\n&quot;)
        lines = code_text.splitlines()
        while lines and not lines[0].strip():
            lines.pop(0)
        while lines and not lines[-1].strip():
            lines.pop()
        return [f&quot;```{lang}&quot;.rstrip(), *lines, &quot;```&quot;, &quot;&quot;]

    if name == &quot;ul&quot;:
        return _list_to_md(tag, ordered=False, ctx=ctx)

    if name == &quot;ol&quot;:
        return _list_to_md(tag, ordered=True, ctx=ctx)

    if name == &quot;table&quot;:
        return _table_to_md(tag, ctx)

    if name == &quot;img&quot;:
        inline = _convert_inline(tag, ctx)
        return [inline, &quot;&quot;] if inline else []

    if name in (&quot;div&quot;, &quot;section&quot;, &quot;article&quot;, &quot;main&quot;, &quot;body&quot;):
        return _convert_children(tag, ctx)

    inline = _convert_inline(tag, ctx).strip()
    return [inline] if inline else []


def _generic_convert(
    html: str,
    *,
    base_url: Optional[str],
    mode: str,
    selector: Optional[str],
    keep_images: bool,
    heading_offset: int,
    max_heading_level: int,
) -&gt; str:
    soup = _make_soup(html)
    _strip_non_content(soup)

    root = _select_root(soup, mode=mode, selector=selector)
    ctx = _Ctx(
        base_url=base_url,
        keep_images=keep_images,
        heading_offset=heading_offset,
        max_heading_level=max_heading_level,
    )

    lines = _convert_children(root, ctx)
    lines = _collapse_blank_lines(lines)
    return &quot;\n&quot;.join(lines) + &quot;\n&quot;


def convert_html_to_markdown(
    html: str,
    *,
    base_url: Optional[str] = None,
    mode: str = &quot;main&quot;,  # main|body
    selector: Optional[str] = None,
    keep_images: bool = False,
    heading_offset: int = 0,
    max_heading_level: int = 6,
    profile: str = &quot;auto&quot;,  # auto|generic|hardinfo2
    hardinfo_section_level: int = 2,
) -&gt; str:
    soup = _make_soup(html)
    _strip_non_content(soup)

    if profile == &quot;hardinfo2&quot; or (profile == &quot;auto&quot; and _looks_like_hardinfo2(soup)):
        return _hardinfo2_convert(html, section_heading_level=max(1, hardinfo_section_level))

    return _generic_convert(
        html,
        base_url=base_url,
        mode=mode,
        selector=selector,
        keep_images=keep_images,
        heading_offset=heading_offset,
        max_heading_level=max(1, max_heading_level),
    )


# -----------------------------
# CLI
# -----------------------------


def main(argv: Optional[Sequence[str]] = None) -&gt; int:
    _require_bs4()

    p = argparse.ArgumentParser(description=&quot;Convert HTML (file/URL/stdin) to Jekyll-friendly Markdown&quot;)
    p.add_argument(&quot;input&quot;, help=&quot;Path, URL, or &#39;-&#39; for stdin&quot;)
    p.add_argument(&quot;-o&quot;, &quot;--output&quot;, type=Path, default=None, help=&quot;Output .md file (default: stdout)&quot;)

    # Front matter
    p.add_argument(&quot;--no-front-matter&quot;, action=&quot;store_true&quot;, help=&quot;Do not emit YAML front matter&quot;)
    p.add_argument(&quot;--layout&quot;, default=&quot;post&quot;, help=&quot;Front matter layout (default: post)&quot;)
    p.add_argument(&quot;--title&quot;, default=None, help=&quot;Front matter title override&quot;)
    p.add_argument(&quot;--date&quot;, default=None, help=&quot;Front matter date override&quot;)
    p.add_argument(&quot;--date-from-meta&quot;, action=&quot;store_true&quot;, help=&quot;Try to extract date from meta/time tags&quot;)
    p.add_argument(&quot;--categories&quot;, default=None, help=&quot;Comma-separated categories&quot;)
    p.add_argument(&quot;--tags&quot;, default=None, help=&quot;Comma-separated tags&quot;)
    p.add_argument(&quot;--permalink&quot;, default=None, help=&quot;Front matter permalink&quot;)

    # Conversion knobs
    p.add_argument(&quot;--mode&quot;, choices=[&quot;main&quot;, &quot;body&quot;], default=&quot;main&quot;, help=&quot;Content selection mode&quot;)
    p.add_argument(&quot;--selector&quot;, default=None, help=&quot;CSS selector to choose content root (overrides --mode)&quot;)
    p.add_argument(&quot;--base-url&quot;, default=None, help=&quot;Base URL for resolving relative links/images&quot;)
    p.add_argument(&quot;--keep-images&quot;, action=&quot;store_true&quot;, help=&quot;Include &lt;img&gt; as Markdown images&quot;)
    p.add_argument(&quot;--heading-offset&quot;, type=int, default=0, help=&quot;Add to heading levels (e.g., 1 makes h1→h2)&quot;)
    p.add_argument(&quot;--max-heading-level&quot;, type=int, default=6, help=&quot;Clamp max heading depth (default: 6)&quot;)

    # Profiles
    p.add_argument(
        &quot;--profile&quot;,
        choices=[&quot;auto&quot;, &quot;generic&quot;, &quot;hardinfo2&quot;],
        default=&quot;auto&quot;,
        help=&quot;auto detects HardInfo2; otherwise force generic/hardinfo2&quot;,
    )
    p.add_argument(
        &quot;--hardinfo-section-level&quot;,
        type=int,
        default=2,
        help=&quot;Heading level for HardInfo2 section titles (default: 2)&quot;,
    )

    args = p.parse_args(argv)

    html, inferred_base = _read_input(args.input)
    soup = _make_soup(html)

    # Base URL: CLI &gt; &lt;base href&gt; &gt; inferred (URL input)
    base_url = args.base_url or _extract_base_href(soup) or inferred_base

    fm = None
    if not args.no_front_matter:
        title = _extract_title(soup, args.title)
        date = args.date
        if not date and args.date_from_meta:
            date = _extract_date_hint(soup)
        if not date:
            date = _now_with_tz()

        fm = FrontMatter(
            layout=args.layout,
            title=title,
            date=date,
            categories=[c.strip() for c in (args.categories or &quot;&quot;).split(&quot;,&quot;) if c.strip()] or None,
            tags=[t.strip() for t in (args.tags or &quot;&quot;).split(&quot;,&quot;) if t.strip()] or None,
            permalink=args.permalink,
        )

    md_body = convert_html_to_markdown(
        html,
        base_url=base_url,
        mode=args.mode,
        selector=args.selector,
        keep_images=args.keep_images,
        heading_offset=args.heading_offset,
        max_heading_level=args.max_heading_level,
        profile=args.profile,
        hardinfo_section_level=args.hardinfo_section_level,
    )

    out_text = (fm.render() if fm else &quot;&quot;) + md_body

    if args.output:
        args.output.parent.mkdir(parents=True, exist_ok=True)
        args.output.write_text(out_text, encoding=&quot;utf-8&quot;)
    else:
        sys.stdout.write(out_text)

    return 0


if __name__ == &quot;__main__&quot;:
    raise SystemExit(main())" data-download-link="" data-download-label="Download Python">
  <code class="language-python">#!/usr/bin/env python3
&quot;&quot;&quot;html_to_jekyll_md.py

Universal HTML → Markdown converter with Jekyll front matter.

Goals
- Accept *any* single-page HTML source: local file, URL (http/https), or stdin.
- Emit readable Markdown that works well on GitHub Pages (Jekyll + kramdown).
- Provide an optional HardInfo2 profile (because HardInfo2 uses layout tables).

Install
  python3 -m pip install beautifulsoup4
  (optional, faster/more robust parsing) python3 -m pip install lxml

Examples
  # Local file → Jekyll post
  python3 html_to_jekyll_md.py ./page.html -o _posts/2026-01-09-page.md --layout post --date-from-meta

  # URL → Jekyll page
  python3 html_to_jekyll_md.py https://example.com/article -o docs/article.md --layout page --permalink /article/

  # stdin → stdout
  cat page.html | python3 html_to_jekyll_md.py -

  # HardInfo2 report (auto-detect, or force)
  python3 html_to_jekyll_md.py hardinfo2_report.html --profile hardinfo2 -o docs/hardinfo2.md

Notes
- This converts the HTML it receives; it does not execute JavaScript.
- “Perfect” HTML→Markdown is not generally achievable. This aims for a clean, readable document.
&quot;&quot;&quot;

from __future__ import annotations

import argparse
import re
import sys
import urllib.parse
import urllib.request
from dataclasses import dataclass
from datetime import datetime
from pathlib import Path
from typing import Iterable, List, Optional, Sequence, Tuple


# -----------------------------
# Parsing helpers
# -----------------------------

_WS_RE = re.compile(r&quot;[ \t\r\f\v]+&quot;)


def _require_bs4() -&gt; None:
    try:
        import bs4  # noqa: F401
    except Exception:
        print(
            &quot;ERROR: Missing dependency: beautifulsoup4\n&quot;
            &quot;  Install with: python3 -m pip install beautifulsoup4&quot;,
            file=sys.stderr,
        )
        raise


def _make_soup(html: str):
    from bs4 import BeautifulSoup

    try:
        return BeautifulSoup(html, &quot;lxml&quot;)
    except Exception:
        return BeautifulSoup(html, &quot;html.parser&quot;)


def _norm_ws_keep_newlines(s: str) -&gt; str:
    s = s.replace(&quot;\u00a0&quot;, &quot; &quot;)
    s = s.replace(&quot;\r\n&quot;, &quot;\n&quot;).replace(&quot;\r&quot;, &quot;\n&quot;)
    lines = [_WS_RE.sub(&quot; &quot;, ln).strip() for ln in s.split(&quot;\n&quot;)]
    out = &quot;\n&quot;.join(lines)
    out = re.sub(r&quot;\n{3,}&quot;, &quot;\n\n&quot;, out)
    return out.strip()


def _yaml_quote(s: str) -&gt; str:
    return &#39;&quot;&#39; + s.replace(&quot;\\&quot;, &quot;\\\\&quot;).replace(&#39;&quot;&#39;, &#39;\\&quot;&#39;) + &#39;&quot;&#39;


def _escape_md_inline(s: str) -&gt; str:
    # Minimal escaping; keep it conservative.
    return s.replace(&quot;\\&quot;, &quot;\\\\&quot;).replace(&quot;`&quot;, &quot;\\`&quot;)


def _escape_table_cell(s: str) -&gt; str:
    s = s.replace(&quot;\\&quot;, &quot;\\\\&quot;)
    s = s.replace(&quot;|&quot;, &quot;\\|&quot;)
    s = s.replace(&quot;\n&quot;, &quot;&lt;br /&gt;&quot;)
    return s.strip()


def _collapse_blank_lines(lines: List[str]) -&gt; List[str]:
    out: List[str] = []
    blank = False
    for ln in lines:
        if not ln.strip():
            if not blank:
                out.append(&quot;&quot;)
            blank = True
        else:
            out.append(ln.rstrip())
            blank = False

    while out and out[0] == &quot;&quot;:
        out.pop(0)
    while out and out[-1] == &quot;&quot;:
        out.pop()
    return out


def _indent_lines(lines: Iterable[str], spaces: int) -&gt; List[str]:
    pad = &quot; &quot; * spaces
    return [(pad + ln) if ln else &quot;&quot; for ln in lines]


def _inline_or_codeblock(text: str) -&gt; Tuple[str, Optional[List[str]]]:
    text = _norm_ws_keep_newlines(text)
    if not text:
        return &quot;&quot;, None

    lines = [ln.rstrip() for ln in text.splitlines() if ln.strip()]
    if len(lines) &lt;= 1:
        return (lines[0] if lines else &quot;&quot;), None

    total = sum(len(ln) for ln in lines)
    if len(lines) &lt;= 3 and total &lt;= 140:
        return &quot; ; &quot;.join(lines), None

    return &quot;&quot;, [&quot;```text&quot;, *lines, &quot;```&quot;]


# -----------------------------
# Input loading
# -----------------------------


def _read_input(input_arg: str, user_agent: str = &quot;html_to_jekyll_md/1.1&quot;) -&gt; Tuple[str, Optional[str]]:
    &quot;&quot;&quot;Return (html, base_url).

    base_url is used to resolve relative links/images.
    - stdin: None
    - file: None
    - URL: the URL
    &quot;&quot;&quot;

    if input_arg == &quot;-&quot;:
        return sys.stdin.read(), None

    if re.match(r&quot;^https?://&quot;, input_arg, flags=re.IGNORECASE):
        req = urllib.request.Request(input_arg, headers={&quot;User-Agent&quot;: user_agent})
        with urllib.request.urlopen(req) as resp:
            charset = resp.headers.get_content_charset() or &quot;utf-8&quot;
            data = resp.read()
            try:
                html = data.decode(charset, errors=&quot;replace&quot;)
            except Exception:
                html = data.decode(&quot;utf-8&quot;, errors=&quot;replace&quot;)
        return html, input_arg

    path = Path(input_arg)
    return path.read_text(encoding=&quot;utf-8&quot;, errors=&quot;replace&quot;), None


def _extract_base_href(soup) -&gt; Optional[str]:
    base = soup.find(&quot;base&quot;)
    if base and base.get(&quot;href&quot;):
        return _norm_ws_keep_newlines(base[&quot;href&quot;]) or None
    return None


# -----------------------------
# Jekyll front matter
# -----------------------------


@dataclass
class FrontMatter:
    layout: str = &quot;post&quot;
    title: str = &quot;Document&quot;
    date: Optional[str] = None
    categories: Optional[List[str]] = None
    tags: Optional[List[str]] = None
    permalink: Optional[str] = None

    def render(self) -&gt; str:
        lines = [&quot;---&quot;, f&quot;layout: {self.layout}&quot;, f&quot;title: {_yaml_quote(self.title)}&quot;]
        if self.date:
            lines.append(f&quot;date: {_yaml_quote(self.date)}&quot;)
        if self.categories:
            lines.append(&quot;categories:&quot;)
            for c in self.categories:
                lines.append(f&quot;  - {c}&quot;)
        if self.tags:
            lines.append(&quot;tags:&quot;)
            for t in self.tags:
                lines.append(f&quot;  - {t}&quot;)
        if self.permalink:
            lines.append(f&quot;permalink: {self.permalink}&quot;)
        lines.append(&quot;---&quot;)
        return &quot;\n&quot;.join(lines) + &quot;\n\n&quot;


def _extract_title(soup, override: Optional[str] = None) -&gt; str:
    if override:
        return override

    t = soup.find(&quot;title&quot;)
    if t and t.get_text(strip=True):
        return _norm_ws_keep_newlines(t.get_text())

    h1 = soup.find(&quot;h1&quot;)
    if h1 and h1.get_text(strip=True):
        return _norm_ws_keep_newlines(h1.get_text())

    return &quot;Document&quot;


def _extract_date_hint(soup) -&gt; Optional[str]:
    meta_props = [
        (&quot;property&quot;, &quot;article:published_time&quot;),
        (&quot;name&quot;, &quot;date&quot;),
        (&quot;name&quot;, &quot;publish-date&quot;),
        (&quot;name&quot;, &quot;pubdate&quot;),
        (&quot;itemprop&quot;, &quot;datePublished&quot;),
    ]

    for attr, key in meta_props:
        m = soup.find(&quot;meta&quot;, attrs={attr: key})
        if m and m.get(&quot;content&quot;):
            return _norm_ws_keep_newlines(m[&quot;content&quot;])

    tm = soup.find(&quot;time&quot;)
    if tm and tm.get(&quot;datetime&quot;):
        return _norm_ws_keep_newlines(tm[&quot;datetime&quot;])

    return None


def _now_with_tz() -&gt; str:
    return datetime.now().astimezone().strftime(&quot;%Y-%m-%d %H:%M:%S %z&quot;)


# -----------------------------
# Content selection
# -----------------------------


def _strip_non_content(soup) -&gt; None:
    # Keep it conservative; do not drop “head” here.
    for sel in [&quot;script&quot;, &quot;style&quot;, &quot;noscript&quot;, &quot;template&quot;, &quot;iframe&quot;]:
        for tag in soup.select(sel):
            tag.decompose()


def _maybe_strip_chrome(root) -&gt; None:
    for sel in [&quot;nav&quot;, &quot;header&quot;, &quot;footer&quot;, &quot;aside&quot;]:
        for tag in root.find_all(sel):
            tag.decompose()


def _text_len(tag) -&gt; int:
    return len(tag.get_text(&quot; &quot;, strip=True))


def _score_candidate(tag) -&gt; int:
    text = tag.get_text(&quot; &quot;, strip=True)
    if not text:
        return 0
    text_len = len(text)
    link_text = &quot; &quot;.join(a.get_text(&quot; &quot;, strip=True) for a in tag.find_all(&quot;a&quot;))
    return max(0, text_len - int(0.7 * len(link_text)))


def _select_root(soup, mode: str, selector: Optional[str]):
    body = soup.body or soup

    if selector:
        found = soup.select_one(selector)
        return found or body

    if mode == &quot;body&quot;:
        return body

    # mode == &quot;main&quot;
    for tagname in [&quot;main&quot;, &quot;article&quot;]:
        t = body.find(tagname)
        if t and _text_len(t) &gt; 50:
            _maybe_strip_chrome(t)
            return t

    for css in [&quot;#content&quot;, &quot;#main&quot;, &quot;.content&quot;, &quot;.main&quot;, &quot;.post&quot;, &quot;.article&quot;, &quot;.entry-content&quot;]:
        t = body.select_one(css)
        if t and _text_len(t) &gt; 80:
            _maybe_strip_chrome(t)
            return t

    candidates = body.find_all([&quot;div&quot;, &quot;section&quot;, &quot;article&quot;, &quot;main&quot;], limit=250)
    best = body
    best_score = _score_candidate(body)
    for c in candidates:
        sc = _score_candidate(c)
        if sc &gt; best_score:
            best, best_score = c, sc

    _maybe_strip_chrome(best)
    return best


# -----------------------------
# HardInfo2 profile (optional)
# -----------------------------


def _looks_like_hardinfo2(soup) -&gt; bool:
    # HardInfo2 exports layout tables with these classes.
    return bool(soup.find(&quot;td&quot;, class_=&quot;stitle&quot;) or soup.find(&quot;h1&quot;, class_=&quot;title&quot;))


def _hardinfo2_text(tag) -&gt; str:
    # HardInfo2 uses &lt;br&gt; and &lt;tt&gt; blocks; preserve newlines.
    return _norm_ws_keep_newlines(tag.get_text(&quot;\n&quot;, strip=True))


def _hardinfo2_iter_rows(table):
    tbody = table.find(&quot;tbody&quot;, recursive=False)
    container = tbody if tbody else table

    for tr in container.find_all(&quot;tr&quot;, recursive=False):
        tds = tr.find_all(&quot;td&quot;, recursive=False)
        if not tds:
            continue

        if any(&quot;stitle&quot; in (td.get(&quot;class&quot;) or []) for td in tds):
            continue

        sst = tr.find(&quot;td&quot;, class_=&quot;sstitle&quot;)
        if sst:
            yield (&quot;sstitle&quot;, _hardinfo2_text(sst))
            continue

        nested_tables = tr.find_all(&quot;table&quot;)
        if nested_tables and len(tds) == 1 and tds[0].get(&quot;colspan&quot;):
            yield (&quot;details&quot;, nested_tables)
            continue

        # Drop icon columns
        data = []
        for td in tds:
            cls = td.get(&quot;class&quot;) or []
            if &quot;icon&quot; in cls or &quot;icon_subtitle&quot; in cls:
                continue
            data.append(td)
        if not data:
            continue

        if &quot;field&quot; in (data[0].get(&quot;class&quot;) or []):
            field = _hardinfo2_text(data[0])
            vals = [_hardinfo2_text(td) for td in data[1:]]
            yield (&quot;kv&quot;, (field, vals, tr.find_all(&quot;table&quot;) or None))
        else:
            yield (&quot;raw&quot;, [_hardinfo2_text(td) for td in data])


def _hardinfo2_render_table(table, heading_level: int) -&gt; List[str]:
    lines: List[str] = []

    st = table.find(&quot;td&quot;, class_=&quot;stitle&quot;)
    title = _hardinfo2_text(st) if st else None
    if title:
        lines.append(&quot;#&quot; * heading_level + f&quot; {_escape_md_inline(title)}&quot;)
        lines.append(&quot;&quot;)

    def render_details(details_table, indent=2) -&gt; List[str]:
        out: List[str] = []
        for kind, payload in _hardinfo2_iter_rows(details_table):
            if kind == &quot;sstitle&quot;:
                out.append(&quot; &quot; * indent + f&quot;- **{_escape_md_inline(payload)}**&quot;)
                continue

            if kind == &quot;details&quot;:
                for t in payload:
                    out.extend(render_details(t, indent=indent + 2))
                continue

            if kind == &quot;kv&quot;:
                field, vals, nested = payload
                val_text = &quot; | &quot;.join(v for v in vals if v)
                inline, code = _inline_or_codeblock(val_text)
                if inline:
                    out.append(&quot; &quot; * indent + f&quot;- **{_escape_md_inline(field)}:** {_escape_md_inline(inline)}&quot;)
                else:
                    out.append(&quot; &quot; * indent + f&quot;- **{_escape_md_inline(field)}:**&quot;)
                    out.extend(_indent_lines(code or [], indent + 4))
                if nested:
                    for t in nested:
                        out.extend(render_details(t, indent=indent + 2))
                continue

            if kind == &quot;raw&quot;:
                txt = &quot; | &quot;.join(payload)
                inline, code = _inline_or_codeblock(txt)
                if inline:
                    out.append(&quot; &quot; * indent + f&quot;- {_escape_md_inline(inline)}&quot;)
                else:
                    out.append(&quot; &quot; * indent + &quot;-&quot;)
                    out.extend(_indent_lines(code or [], indent + 4))

        return out

    for kind, payload in _hardinfo2_iter_rows(table):
        if kind == &quot;sstitle&quot;:
            lines.append(&quot;#&quot; * (heading_level + 1) + f&quot; {_escape_md_inline(payload)}&quot;)
            lines.append(&quot;&quot;)
            continue

        if kind == &quot;details&quot;:
            lines.append(&quot;- **Details:**&quot;)
            for t in payload:
                lines.extend(render_details(t, indent=2))
            lines.append(&quot;&quot;)
            continue

        if kind == &quot;kv&quot;:
            field, vals, nested = payload
            val_text = &quot; | &quot;.join(v for v in vals if v)
            inline, code = _inline_or_codeblock(val_text)
            if inline:
                lines.append(f&quot;- **{_escape_md_inline(field)}:** {_escape_md_inline(inline)}&quot;)
            else:
                lines.append(f&quot;- **{_escape_md_inline(field)}:**&quot;)
                lines.extend(_indent_lines(code or [], 4))
            if nested:
                for t in nested:
                    lines.extend(render_details(t, indent=2))
            continue

        if kind == &quot;raw&quot;:
            txt = &quot; | &quot;.join(payload)
            inline, code = _inline_or_codeblock(txt)
            if inline:
                lines.append(f&quot;- {_escape_md_inline(inline)}&quot;)
            else:
                lines.append(&quot;-&quot;)
                lines.extend(_indent_lines(code or [], 4))

    lines.append(&quot;&quot;)
    return lines


def _hardinfo2_convert(html: str, section_heading_level: int = 2) -&gt; str:
    soup = _make_soup(html)
    root = soup.body or soup

    out: List[str] = []
    for el in root.find_all([&quot;h1&quot;, &quot;table&quot;], recursive=True):
        if el.name == &quot;h1&quot; and &quot;title&quot; in (el.get(&quot;class&quot;) or []):
            out.append(&quot;#&quot; * section_heading_level + f&quot; {_escape_md_inline(_hardinfo2_text(el))}&quot;)
            out.append(&quot;&quot;)
        elif el.name == &quot;table&quot; and el.find_parent(&quot;table&quot;) is None:
            out.extend(_hardinfo2_render_table(el, heading_level=section_heading_level + 1))

    return &quot;\n&quot;.join(_collapse_blank_lines(out)) + &quot;\n&quot;


# -----------------------------
# Generic HTML → Markdown
# -----------------------------


BLOCK_TAGS = {
    &quot;p&quot;,
    &quot;div&quot;,
    &quot;section&quot;,
    &quot;article&quot;,
    &quot;main&quot;,
    &quot;pre&quot;,
    &quot;blockquote&quot;,
    &quot;ul&quot;,
    &quot;ol&quot;,
    &quot;table&quot;,
    &quot;hr&quot;,
    &quot;h1&quot;,
    &quot;h2&quot;,
    &quot;h3&quot;,
    &quot;h4&quot;,
    &quot;h5&quot;,
    &quot;h6&quot;,
}


class _Ctx:
    def __init__(
        self,
        base_url: Optional[str],
        keep_images: bool,
        heading_offset: int,
        max_heading_level: int,
    ):
        self.base_url = base_url
        self.keep_images = keep_images
        self.heading_offset = heading_offset
        self.max_heading_level = max_heading_level


def _resolve_url(href: str, base_url: Optional[str]) -&gt; str:
    if not href:
        return &quot;&quot;
    return urllib.parse.urljoin(base_url, href) if base_url else href


def _extract_text(tag) -&gt; str:
    return _norm_ws_keep_newlines(tag.get_text(&quot; &quot;, strip=True))


def _convert_children(tag, ctx: _Ctx) -&gt; List[str]:
    from bs4 import NavigableString, Tag

    out: List[str] = []
    for child in tag.children:
        if isinstance(child, NavigableString):
            txt = _norm_ws_keep_newlines(str(child))
            if txt:
                out.append(txt)
            continue
        if isinstance(child, Tag):
            out.extend(_convert_node(child, ctx))
    return out


def _convert_children_inline(tag, ctx: _Ctx) -&gt; List[str]:
    from bs4 import NavigableString, Tag

    out: List[str] = []
    for child in tag.children:
        if isinstance(child, NavigableString):
            txt = _norm_ws_keep_newlines(str(child))
            if txt:
                out.append(txt)
            continue
        if isinstance(child, Tag):
            out.append(_convert_inline(child, ctx))
    return out


def _convert_inline(tag, ctx: _Ctx) -&gt; str:
    name = tag.name.lower()

    if name in (&quot;span&quot;, &quot;label&quot;, &quot;small&quot;, &quot;sup&quot;, &quot;sub&quot;):
        return &quot;&quot;.join(_convert_children_inline(tag, ctx))

    if name in (&quot;strong&quot;, &quot;b&quot;):
        inner = &quot;&quot;.join(_convert_children_inline(tag, ctx)).strip()
        return f&quot;**{inner}**&quot; if inner else &quot;&quot;

    if name in (&quot;em&quot;, &quot;i&quot;):
        inner = &quot;&quot;.join(_convert_children_inline(tag, ctx)).strip()
        return f&quot;*{inner}*&quot; if inner else &quot;&quot;

    if name == &quot;code&quot;:
        inner = _extract_text(tag)
        if &quot;`&quot; in inner:
            return f&quot;``{inner}``&quot;
        return f&quot;`{inner}`&quot;

    if name == &quot;br&quot;:
        return &quot;  \n&quot;

    if name == &quot;a&quot;:
        href = _resolve_url(tag.get(&quot;href&quot;, &quot;&quot;), ctx.base_url)
        text = &quot;&quot;.join(_convert_children_inline(tag, ctx)).strip() or href
        return f&quot;[{text}]({href})&quot; if href else text

    if name == &quot;img&quot;:
        if not ctx.keep_images:
            return &quot;&quot;
        alt = (tag.get(&quot;alt&quot;) or &quot;image&quot;).strip() or &quot;image&quot;
        src = _resolve_url(tag.get(&quot;src&quot;, &quot;&quot;), ctx.base_url)
        return f&quot;![{_escape_md_inline(alt)}]({src})&quot; if src else &quot;&quot;

    return &quot;&quot;.join(_convert_children_inline(tag, ctx))


def _table_to_bullets(table, ctx: _Ctx) -&gt; List[str]:
    lines: List[str] = []
    tbody = table.find(&quot;tbody&quot;, recursive=False)
    container = tbody if tbody else table

    for tr in container.find_all(&quot;tr&quot;, recursive=False):
        cells = tr.find_all([&quot;th&quot;, &quot;td&quot;], recursive=False)
        if not cells:
            continue
        vals = [_extract_text(td) for td in cells]
        vals = [v for v in vals if v]
        if not vals:
            continue
        txt = &quot; | &quot;.join(vals)
        inline, code = _inline_or_codeblock(txt)
        if inline:
            lines.append(f&quot;- {_escape_md_inline(inline)}&quot;)
        else:
            lines.append(&quot;-&quot;)
            lines.extend(_indent_lines(code or [], 4))

    lines.append(&quot;&quot;)
    return lines


def _table_to_md(table, ctx: _Ctx) -&gt; List[str]:
    if table.find(&quot;table&quot;):
        return _table_to_bullets(table, ctx)

    rows: List[List[str]] = []
    tbody = table.find(&quot;tbody&quot;, recursive=False)
    container = tbody if tbody else table

    for tr in container.find_all(&quot;tr&quot;, recursive=False):
        cells = tr.find_all([&quot;th&quot;, &quot;td&quot;], recursive=False)
        if not cells:
            continue
        rows.append([_extract_text(td) for td in cells])

    if not rows:
        return []

    has_th = bool(table.find(&quot;th&quot;))
    header = rows[0] if has_th else None
    body_rows = rows[1:] if has_th else rows

    if header is None:
        first = rows[0]
        if first and all(len(c) &lt;= 40 for c in first) and len(first) &lt;= 6:
            header = first
            body_rows = rows[1:]
        else:
            header = [f&quot;Col {i+1}&quot; for i in range(len(rows[0]))]
            body_rows = rows

    col_count = max(len(header), *(len(r) for r in body_rows))

    def pad(r: List[str]) -&gt; List[str]:
        return (r + [&quot;&quot;] * col_count)[:col_count]

    header = pad(header)

    lines: List[str] = []
    lines.append(&quot;| &quot; + &quot; | &quot;.join(_escape_table_cell(c) for c in header) + &quot; |&quot;)
    lines.append(&quot;|&quot; + &quot;|&quot;.join([&quot;---&quot;] * col_count) + &quot;|&quot;)

    for r in body_rows:
        r = pad(r)
        if any(&quot;\n&quot; in c for c in r):
            return _table_to_bullets(table, ctx)
        lines.append(&quot;| &quot; + &quot; | &quot;.join(_escape_table_cell(c) for c in r) + &quot; |&quot;)

    lines.append(&quot;&quot;)
    return lines


def _list_to_md(list_tag, ordered: bool, ctx: _Ctx, indent: int = 0) -&gt; List[str]:
    from bs4 import Tag

    lines: List[str] = []
    items = [li for li in list_tag.find_all(&quot;li&quot;, recursive=False) if isinstance(li, Tag)]

    for idx, li in enumerate(items, start=1):
        prefix = f&quot;{idx}. &quot; if ordered else &quot;- &quot;
        cont_indent = indent + len(prefix)

        # Build “main line” from inline-ish children and the first paragraph-ish block.
        main_fragments: List[str] = []
        extra_blocks: List[List[str]] = []

        for child in li.children:
            if isinstance(child, Tag) and child.name.lower() in (&quot;ul&quot;, &quot;ol&quot;):
                continue

            if isinstance(child, Tag) and child.name.lower() in BLOCK_TAGS:
                block_lines = _convert_node(child, ctx)
                block_lines = _collapse_blank_lines(block_lines)
                if block_lines:
                    if not main_fragments:
                        # Use first non-empty line as the main line.
                        first_line = next((x for x in block_lines if x.strip()), &quot;&quot;)
                        if first_line:
                            main_fragments.append(first_line)
                        rest = [x for x in block_lines if x.strip()][1:]
                        if rest:
                            extra_blocks.append(rest)
                    else:
                        extra_blocks.append([x for x in block_lines if x.strip()])
                continue

            if isinstance(child, Tag):
                main_fragments.append(_convert_inline(child, ctx))
            else:
                txt = _norm_ws_keep_newlines(str(child))
                if txt:
                    main_fragments.append(txt)

        main_line = _norm_ws_keep_newlines(&quot;&quot;.join(main_fragments)).strip()
        lines.append(&quot; &quot; * indent + prefix + main_line)

        for block in extra_blocks:
            for ln in block:
                lines.append(&quot; &quot; * cont_indent + ln)

        for child in li.find_all([&quot;ul&quot;, &quot;ol&quot;], recursive=False):
            lines.extend(_list_to_md(child, ordered=(child.name.lower() == &quot;ol&quot;), ctx=ctx, indent=indent + 2))

    lines.append(&quot;&quot;)
    return lines


def _convert_node(tag, ctx: _Ctx) -&gt; List[str]:
    name = tag.name.lower()

    if name in (&quot;script&quot;, &quot;style&quot;, &quot;noscript&quot;, &quot;template&quot;):
        return []

    if name in (&quot;h1&quot;, &quot;h2&quot;, &quot;h3&quot;, &quot;h4&quot;, &quot;h5&quot;, &quot;h6&quot;):
        lvl = int(name[1]) + ctx.heading_offset
        lvl = max(1, min(ctx.max_heading_level, lvl))
        text = &quot;&quot;.join(_convert_children_inline(tag, ctx)).strip()
        text = _norm_ws_keep_newlines(text)
        return [&quot;#&quot; * lvl + f&quot; {_escape_md_inline(text)}&quot;, &quot;&quot;] if text else []

    if name == &quot;p&quot;:
        text = &quot;&quot;.join(_convert_children_inline(tag, ctx)).strip()
        text = _norm_ws_keep_newlines(text)
        return [text, &quot;&quot;] if text else []

    if name == &quot;hr&quot;:
        return [&quot;---&quot;, &quot;&quot;]

    if name == &quot;blockquote&quot;:
        inner = _collapse_blank_lines(_convert_children(tag, ctx))
        quoted: List[str] = []
        for ln in inner:
            quoted.append(&quot;&gt;&quot; if not ln.strip() else &quot;&gt; &quot; + ln)
        quoted.append(&quot;&quot;)
        return quoted

    if name == &quot;pre&quot;:
        # Try to infer a language from pre/code classes.
        lang = &quot;&quot;
        cls = &quot; &quot;.join(tag.get(&quot;class&quot;) or [])
        m = re.search(r&quot;language-([a-zA-Z0-9_+-]+)&quot;, cls)
        if not m:
            code = tag.find(&quot;code&quot;)
            if code:
                cls2 = &quot; &quot;.join(code.get(&quot;class&quot;) or [])
                m = re.search(r&quot;language-([a-zA-Z0-9_+-]+)&quot;, cls2)
        if m:
            lang = m.group(1)

        code_text = tag.get_text(&quot;\n&quot;, strip=False).replace(&quot;\r\n&quot;, &quot;\n&quot;).replace(&quot;\r&quot;, &quot;\n&quot;)
        lines = code_text.splitlines()
        while lines and not lines[0].strip():
            lines.pop(0)
        while lines and not lines[-1].strip():
            lines.pop()
        return [f&quot;```{lang}&quot;.rstrip(), *lines, &quot;```&quot;, &quot;&quot;]

    if name == &quot;ul&quot;:
        return _list_to_md(tag, ordered=False, ctx=ctx)

    if name == &quot;ol&quot;:
        return _list_to_md(tag, ordered=True, ctx=ctx)

    if name == &quot;table&quot;:
        return _table_to_md(tag, ctx)

    if name == &quot;img&quot;:
        inline = _convert_inline(tag, ctx)
        return [inline, &quot;&quot;] if inline else []

    if name in (&quot;div&quot;, &quot;section&quot;, &quot;article&quot;, &quot;main&quot;, &quot;body&quot;):
        return _convert_children(tag, ctx)

    inline = _convert_inline(tag, ctx).strip()
    return [inline] if inline else []


def _generic_convert(
    html: str,
    *,
    base_url: Optional[str],
    mode: str,
    selector: Optional[str],
    keep_images: bool,
    heading_offset: int,
    max_heading_level: int,
) -&gt; str:
    soup = _make_soup(html)
    _strip_non_content(soup)

    root = _select_root(soup, mode=mode, selector=selector)
    ctx = _Ctx(
        base_url=base_url,
        keep_images=keep_images,
        heading_offset=heading_offset,
        max_heading_level=max_heading_level,
    )

    lines = _convert_children(root, ctx)
    lines = _collapse_blank_lines(lines)
    return &quot;\n&quot;.join(lines) + &quot;\n&quot;


def convert_html_to_markdown(
    html: str,
    *,
    base_url: Optional[str] = None,
    mode: str = &quot;main&quot;,  # main|body
    selector: Optional[str] = None,
    keep_images: bool = False,
    heading_offset: int = 0,
    max_heading_level: int = 6,
    profile: str = &quot;auto&quot;,  # auto|generic|hardinfo2
    hardinfo_section_level: int = 2,
) -&gt; str:
    soup = _make_soup(html)
    _strip_non_content(soup)

    if profile == &quot;hardinfo2&quot; or (profile == &quot;auto&quot; and _looks_like_hardinfo2(soup)):
        return _hardinfo2_convert(html, section_heading_level=max(1, hardinfo_section_level))

    return _generic_convert(
        html,
        base_url=base_url,
        mode=mode,
        selector=selector,
        keep_images=keep_images,
        heading_offset=heading_offset,
        max_heading_level=max(1, max_heading_level),
    )


# -----------------------------
# CLI
# -----------------------------


def main(argv: Optional[Sequence[str]] = None) -&gt; int:
    _require_bs4()

    p = argparse.ArgumentParser(description=&quot;Convert HTML (file/URL/stdin) to Jekyll-friendly Markdown&quot;)
    p.add_argument(&quot;input&quot;, help=&quot;Path, URL, or &#39;-&#39; for stdin&quot;)
    p.add_argument(&quot;-o&quot;, &quot;--output&quot;, type=Path, default=None, help=&quot;Output .md file (default: stdout)&quot;)

    # Front matter
    p.add_argument(&quot;--no-front-matter&quot;, action=&quot;store_true&quot;, help=&quot;Do not emit YAML front matter&quot;)
    p.add_argument(&quot;--layout&quot;, default=&quot;post&quot;, help=&quot;Front matter layout (default: post)&quot;)
    p.add_argument(&quot;--title&quot;, default=None, help=&quot;Front matter title override&quot;)
    p.add_argument(&quot;--date&quot;, default=None, help=&quot;Front matter date override&quot;)
    p.add_argument(&quot;--date-from-meta&quot;, action=&quot;store_true&quot;, help=&quot;Try to extract date from meta/time tags&quot;)
    p.add_argument(&quot;--categories&quot;, default=None, help=&quot;Comma-separated categories&quot;)
    p.add_argument(&quot;--tags&quot;, default=None, help=&quot;Comma-separated tags&quot;)
    p.add_argument(&quot;--permalink&quot;, default=None, help=&quot;Front matter permalink&quot;)

    # Conversion knobs
    p.add_argument(&quot;--mode&quot;, choices=[&quot;main&quot;, &quot;body&quot;], default=&quot;main&quot;, help=&quot;Content selection mode&quot;)
    p.add_argument(&quot;--selector&quot;, default=None, help=&quot;CSS selector to choose content root (overrides --mode)&quot;)
    p.add_argument(&quot;--base-url&quot;, default=None, help=&quot;Base URL for resolving relative links/images&quot;)
    p.add_argument(&quot;--keep-images&quot;, action=&quot;store_true&quot;, help=&quot;Include &lt;img&gt; as Markdown images&quot;)
    p.add_argument(&quot;--heading-offset&quot;, type=int, default=0, help=&quot;Add to heading levels (e.g., 1 makes h1→h2)&quot;)
    p.add_argument(&quot;--max-heading-level&quot;, type=int, default=6, help=&quot;Clamp max heading depth (default: 6)&quot;)

    # Profiles
    p.add_argument(
        &quot;--profile&quot;,
        choices=[&quot;auto&quot;, &quot;generic&quot;, &quot;hardinfo2&quot;],
        default=&quot;auto&quot;,
        help=&quot;auto detects HardInfo2; otherwise force generic/hardinfo2&quot;,
    )
    p.add_argument(
        &quot;--hardinfo-section-level&quot;,
        type=int,
        default=2,
        help=&quot;Heading level for HardInfo2 section titles (default: 2)&quot;,
    )

    args = p.parse_args(argv)

    html, inferred_base = _read_input(args.input)
    soup = _make_soup(html)

    # Base URL: CLI &gt; &lt;base href&gt; &gt; inferred (URL input)
    base_url = args.base_url or _extract_base_href(soup) or inferred_base

    fm = None
    if not args.no_front_matter:
        title = _extract_title(soup, args.title)
        date = args.date
        if not date and args.date_from_meta:
            date = _extract_date_hint(soup)
        if not date:
            date = _now_with_tz()

        fm = FrontMatter(
            layout=args.layout,
            title=title,
            date=date,
            categories=[c.strip() for c in (args.categories or &quot;&quot;).split(&quot;,&quot;) if c.strip()] or None,
            tags=[t.strip() for t in (args.tags or &quot;&quot;).split(&quot;,&quot;) if t.strip()] or None,
            permalink=args.permalink,
        )

    md_body = convert_html_to_markdown(
        html,
        base_url=base_url,
        mode=args.mode,
        selector=args.selector,
        keep_images=args.keep_images,
        heading_offset=args.heading_offset,
        max_heading_level=args.max_heading_level,
        profile=args.profile,
        hardinfo_section_level=args.hardinfo_section_level,
    )

    out_text = (fm.render() if fm else &quot;&quot;) + md_body

    if args.output:
        args.output.parent.mkdir(parents=True, exist_ok=True)
        args.output.write_text(out_text, encoding=&quot;utf-8&quot;)
    else:
        sys.stdout.write(out_text)

    return 0


if __name__ == &quot;__main__&quot;:
    raise SystemExit(main())</code>
</section>]]></content><author><name></name></author><category term="scratchpad" /></entry><entry><title type="html">RK3588 DXB LP4 V10 Device Tree Source</title><link href="https://ib.bsb.br/rk3588-dts/" rel="alternate" type="text/html" title="RK3588 DXB LP4 V10 Device Tree Source" /><published>2026-01-09T00:00:00+00:00</published><updated>2026-01-09T16:13:58+00:00</updated><id>https://ib.bsb.br/rk3588-dts</id><content type="html" xml:base="https://ib.bsb.br/rk3588-dts/"><![CDATA[<p>/dts-v1/;</p>

<p>/ {
	compatible = “rockchip,rk3588-dxb-hdmi-v10\0rockchip,rk3588”;
	interrupt-parent = &lt;0x01&gt;;
	#address-cells = &lt;0x02&gt;;
	#size-cells = &lt;0x02&gt;;
	model = “Rockchip RK3588 DXB LP4 V10 Board”;</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aliases {
	csi2dcphy0 = "/csi2-dcphy0";
	csi2dcphy1 = "/csi2-dcphy1";
	csi2dphy0 = "/csi2-dphy0";
	csi2dphy1 = "/csi2-dphy1";
	csi2dphy2 = "/csi2-dphy2";
	csi2dphy3 = "/csi2-dphy3";
	csi2dphy4 = "/csi2-dphy4";
	csi2dphy5 = "/csi2-dphy5";
	dsi0 = "/dsi@fde20000";
	dsi1 = "/dsi@fde30000";
	ethernet1 = "/ethernet@fe1c0000";
	gpio0 = "/pinctrl/gpio@fd8a0000";
	gpio1 = "/pinctrl/gpio@fec20000";
	gpio2 = "/pinctrl/gpio@fec30000";
	gpio3 = "/pinctrl/gpio@fec40000";
	gpio4 = "/pinctrl/gpio@fec50000";
	i2c0 = "/i2c@fd880000";
	i2c1 = "/i2c@fea90000";
	i2c2 = "/i2c@feaa0000";
	i2c3 = "/i2c@feab0000";
	i2c4 = "/i2c@feac0000";
	i2c5 = "/i2c@fead0000";
	i2c6 = "/i2c@fec80000";
	i2c7 = "/i2c@fec90000";
	i2c8 = "/i2c@feca0000";
	rkcif_mipi_lvds0 = "/rkcif-mipi-lvds";
	rkcif_mipi_lvds1 = "/rkcif-mipi-lvds1";
	rkcif_mipi_lvds2 = "/rkcif-mipi-lvds2";
	rkcif_mipi_lvds3 = "/rkcif-mipi-lvds3";
	rkvdec0 = "/rkvdec-core@fdc38000";
	rkvdec1 = "/rkvdec-core@fdc48000";
	rkvenc0 = "/rkvenc-core@fdbd0000";
	rkvenc1 = "/rkvenc-core@fdbe0000";
	jpege0 = "/jpege-core@fdba0000";
	jpege1 = "/jpege-core@fdba4000";
	jpege2 = "/jpege-core@fdba8000";
	jpege3 = "/jpege-core@fdbac000";
	serial0 = "/serial@fd890000";
	serial1 = "/serial@feb40000";
	serial2 = "/serial@feb50000";
	serial3 = "/serial@feb60000";
	serial4 = "/serial@feb70000";
	serial5 = "/serial@feb80000";
	serial6 = "/serial@feb90000";
	serial7 = "/serial@feba0000";
	serial8 = "/serial@febb0000";
	serial9 = "/serial@febc0000";
	spi0 = "/spi@feb00000";
	spi1 = "/spi@feb10000";
	spi2 = "/spi@feb20000";
	spi3 = "/spi@feb30000";
	spi4 = "/spi@fecb0000";
	spi5 = "/spi@fe2b0000";
	hdcp0 = "/hdcp@fde40000";
	hdcp1 = "/hdcp@fde70000";
	dp0 = "/dp@fde50000";
	dp1 = "/dp@fde60000";
	edp0 = "/edp@fdec0000";
	edp1 = "/edp@fded0000";
	ethernet0 = "/ethernet@fe1b0000";
	hdptx0 = "/phy@fed60000";
	hdptx1 = "/phy@fed70000";
	hdptxhdmi0 = "/hdmiphy@fed60000";
	hdptxhdmi1 = "/hdmiphy@fed70000";
	hdmi0 = "/hdmi@fde80000";
	hdmi1 = "/hdmi@fdea0000";
	hdmirx0 = "/hdmirx-controller@fdee0000";
	rkcif_mipi_lvds4 = "/rkcif-mipi-lvds4";
	rkcif_mipi_lvds5 = "/rkcif-mipi-lvds5";
	usbdp0 = "/phy@fed80000";
	usbdp1 = "/phy@fed90000";
	mmc0 = "/mmc@fe2e0000";
	mmc1 = "/mmc@fe2c0000";
	mmc2 = "/mmc@fe2d0000";
};

clocks {
	compatible = "simple-bus";
	#address-cells = &lt;0x02&gt;;
	#size-cells = &lt;0x02&gt;;
	ranges;

	spll {
		compatible = "fixed-clock";
		#clock-cells = &lt;0x00&gt;;
		clock-frequency = &lt;0x29d7ab80&gt;;
		clock-output-names = "spll";
	};

	xin32k {
		compatible = "fixed-clock";
		#clock-cells = &lt;0x00&gt;;
		clock-frequency = &lt;0x8000&gt;;
		clock-output-names = "xin32k";
		phandle = &lt;0x1d2&gt;;
	};

	xin24m {
		compatible = "fixed-clock";
		#clock-cells = &lt;0x00&gt;;
		clock-frequency = &lt;0x16e3600&gt;;
		clock-output-names = "xin24m";
	};

	hclk_vo1@fd7c08ec {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08ec 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x264&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
		phandle = &lt;0x05&gt;;
	};

	aclk_vdpu_low_pre@fd7c08b0 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08b0 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x1bc&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	hclk_vo0@fd7c08dc {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08dc 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x26d&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
		phandle = &lt;0x04&gt;;
	};

	hclk_usb@fd7c08a8 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08a8 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x264&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	hclk_nvm@fd7c087c {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c087c 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x141&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
		phandle = &lt;0x03&gt;;
	};

	aclk_usb@fd7c08a8 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08a8 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x263&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
		phandle = &lt;0x62&gt;;
	};

	hclk_isp1_pre@fd7c0868 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c0868 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x1e1&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	aclk_isp1_pre@fd7c0868 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c0868 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x1e0&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	aclk_rkvdec0_pre@fd7c08a0 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08a0 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x1bc&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	hclk_rkvdec0_pre@fd7c08a0 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08a0 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x1be&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	aclk_rkvdec1_pre@fd7c08a4 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08a4 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x1bc&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	hclk_rkvdec1_pre@fd7c08a4 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08a4 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x1be&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	aclk_jpeg_decoder_pre@fd7c08b0 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08b0 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x1bc&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	aclk_rkvenc1_pre@fd7c08c0 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08c0 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x1c5&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	hclk_rkvenc1_pre@fd7c08c0 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08c0 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x1c4&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	aclk_hdcp0_pre@fd7c08dc {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08dc 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x26c&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	aclk_hdcp1_pre@fd7c08ec {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08ec 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x263&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	pclk_av1_pre@fd7c0910 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c0910 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x1be&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	aclk_av1_pre@fd7c0910 {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c0910 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x02 0x1bc&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	hclk_sdio_pre@fd7c092c {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c092c 0x00 0x10&gt;;
		clock-names = "link";
		clocks = &lt;0x03&gt;;
		#power-domain-cells = &lt;0x01&gt;;
		#clock-cells = &lt;0x00&gt;;
	};

	pclk_vo0_grf@fd7c08dc {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08dc 0x00 0x04&gt;;
		clocks = &lt;0x04&gt;;
		clock-names = "link";
		#clock-cells = &lt;0x00&gt;;
		phandle = &lt;0x6a&gt;;
	};

	pclk_vo1_grf@fd7c08ec {
		compatible = "rockchip,rk3588-clock-gate-link";
		reg = &lt;0x00 0xfd7c08ec 0x00 0x04&gt;;
		clocks = &lt;0x05&gt;;
		clock-names = "link";
		#clock-cells = &lt;0x00&gt;;
		phandle = &lt;0x6b&gt;;
	};

	mclkin-i2s0 {
		compatible = "fixed-clock";
		#clock-cells = &lt;0x00&gt;;
		clock-frequency = &lt;0x00&gt;;
		clock-output-names = "i2s0_mclkin";
	};

	mclkin-i2s1 {
		compatible = "fixed-clock";
		#clock-cells = &lt;0x00&gt;;
		clock-frequency = &lt;0x00&gt;;
		clock-output-names = "i2s1_mclkin";
	};

	mclkin-i2s2 {
		compatible = "fixed-clock";
		#clock-cells = &lt;0x00&gt;;
		clock-frequency = &lt;0x00&gt;;
		clock-output-names = "i2s2_mclkin";
	};

	mclkin-i2s3 {
		compatible = "fixed-clock";
		#clock-cells = &lt;0x00&gt;;
		clock-frequency = &lt;0x00&gt;;
		clock-output-names = "i2s3_mclkin";
	};

	mclkout-i2s0@fd58c318 {
		compatible = "rockchip,clk-out";
		reg = &lt;0x00 0xfd58c318 0x00 0x04&gt;;
		clocks = &lt;0x02 0x39&gt;;
		#clock-cells = &lt;0x00&gt;;
		clock-output-names = "i2s0_mclkout_to_io";
		rockchip,bit-shift = &lt;0x00&gt;;
		rockchip,bit-set-to-disable;
		rockchip,clk-ignore-unused;
		phandle = &lt;0x174&gt;;
	};

	mclkout-i2s1@fd58c318 {
		compatible = "rockchip,clk-out";
		reg = &lt;0x00 0xfd58c318 0x00 0x04&gt;;
		clocks = &lt;0x02 0x291&gt;;
		#clock-cells = &lt;0x00&gt;;
		clock-output-names = "i2s1_mclkout_to_io";
		rockchip,bit-shift = &lt;0x01&gt;;
		rockchip,bit-set-to-disable;
		rockchip,clk-ignore-unused;
	};

	mclkout-i2s1@fd58a000 {
		compatible = "rockchip,clk-out";
		reg = &lt;0x00 0xfd58a000 0x00 0x04&gt;;
		clocks = &lt;0x02 0x291&gt;;
		#clock-cells = &lt;0x00&gt;;
		clock-output-names = "i2s1m1_mclkout_to_io";
		rockchip,bit-shift = &lt;0x06&gt;;
		rockchip,clk-ignore-unused;
	};

	mclkout-i2s2@fd58c318 {
		compatible = "rockchip,clk-out";
		reg = &lt;0x00 0xfd58c318 0x00 0x04&gt;;
		clocks = &lt;0x02 0x28&gt;;
		#clock-cells = &lt;0x00&gt;;
		clock-output-names = "i2s2_mclkout_to_io";
		rockchip,bit-shift = &lt;0x02&gt;;
		rockchip,bit-set-to-disable;
		rockchip,clk-ignore-unused;
	};

	mclkout-i2s3@fd58c318 {
		compatible = "rockchip,clk-out";
		reg = &lt;0x00 0xfd58c318 0x00 0x04&gt;;
		clocks = &lt;0x02 0x2e&gt;;
		#clock-cells = &lt;0x00&gt;;
		clock-output-names = "i2s3_mclkout_to_io";
		rockchip,bit-shift = &lt;0x07&gt;;
		rockchip,bit-set-to-disable;
		rockchip,clk-ignore-unused;
	};
};

cpus {
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;

	cpu-map {

		cluster0 {

			core0 {
				cpu = &lt;0x06&gt;;
			};

			core1 {
				cpu = &lt;0x07&gt;;
			};

			core2 {
				cpu = &lt;0x08&gt;;
			};

			core3 {
				cpu = &lt;0x09&gt;;
			};
		};

		cluster1 {

			core0 {
				cpu = &lt;0x0a&gt;;
			};

			core1 {
				cpu = &lt;0x0b&gt;;
			};
		};

		cluster2 {

			core0 {
				cpu = &lt;0x0c&gt;;
			};

			core1 {
				cpu = &lt;0x0d&gt;;
			};
		};
	};

	cpu@0 {
		device_type = "cpu";
		compatible = "arm,cortex-a55";
		reg = &lt;0x00&gt;;
		enable-method = "psci";
		capacity-dmips-mhz = &lt;0x212&gt;;
		clocks = &lt;0x0e 0x00&gt;;
		operating-points-v2 = &lt;0x0f&gt;;
		cpu-idle-states = &lt;0x10&gt;;
		i-cache-size = &lt;0x8000&gt;;
		i-cache-line-size = &lt;0x40&gt;;
		i-cache-sets = &lt;0x80&gt;;
		d-cache-size = &lt;0x8000&gt;;
		d-cache-line-size = &lt;0x40&gt;;
		d-cache-sets = &lt;0x80&gt;;
		next-level-cache = &lt;0x11&gt;;
		#cooling-cells = &lt;0x02&gt;;
		dynamic-power-coefficient = &lt;0x64&gt;;
		cpu-supply = &lt;0x12&gt;;
		mem-supply = &lt;0x12&gt;;
		phandle = &lt;0x06&gt;;
	};

	cpu@100 {
		device_type = "cpu";
		compatible = "arm,cortex-a55";
		reg = &lt;0x100&gt;;
		enable-method = "psci";
		capacity-dmips-mhz = &lt;0x212&gt;;
		clocks = &lt;0x0e 0x00&gt;;
		operating-points-v2 = &lt;0x0f&gt;;
		cpu-idle-states = &lt;0x10&gt;;
		i-cache-size = &lt;0x8000&gt;;
		i-cache-line-size = &lt;0x40&gt;;
		i-cache-sets = &lt;0x80&gt;;
		d-cache-size = &lt;0x8000&gt;;
		d-cache-line-size = &lt;0x40&gt;;
		d-cache-sets = &lt;0x80&gt;;
		next-level-cache = &lt;0x13&gt;;
		phandle = &lt;0x07&gt;;
	};

	cpu@200 {
		device_type = "cpu";
		compatible = "arm,cortex-a55";
		reg = &lt;0x200&gt;;
		enable-method = "psci";
		capacity-dmips-mhz = &lt;0x212&gt;;
		clocks = &lt;0x0e 0x00&gt;;
		operating-points-v2 = &lt;0x0f&gt;;
		cpu-idle-states = &lt;0x10&gt;;
		i-cache-size = &lt;0x8000&gt;;
		i-cache-line-size = &lt;0x40&gt;;
		i-cache-sets = &lt;0x80&gt;;
		d-cache-size = &lt;0x8000&gt;;
		d-cache-line-size = &lt;0x40&gt;;
		d-cache-sets = &lt;0x80&gt;;
		next-level-cache = &lt;0x14&gt;;
		phandle = &lt;0x08&gt;;
	};

	cpu@300 {
		device_type = "cpu";
		compatible = "arm,cortex-a55";
		reg = &lt;0x300&gt;;
		enable-method = "psci";
		capacity-dmips-mhz = &lt;0x212&gt;;
		clocks = &lt;0x0e 0x00&gt;;
		operating-points-v2 = &lt;0x0f&gt;;
		cpu-idle-states = &lt;0x10&gt;;
		i-cache-size = &lt;0x8000&gt;;
		i-cache-line-size = &lt;0x40&gt;;
		i-cache-sets = &lt;0x80&gt;;
		d-cache-size = &lt;0x8000&gt;;
		d-cache-line-size = &lt;0x40&gt;;
		d-cache-sets = &lt;0x80&gt;;
		next-level-cache = &lt;0x15&gt;;
		phandle = &lt;0x09&gt;;
	};

	cpu@400 {
		device_type = "cpu";
		compatible = "arm,cortex-a76";
		reg = &lt;0x400&gt;;
		enable-method = "psci";
		capacity-dmips-mhz = &lt;0x400&gt;;
		clocks = &lt;0x0e 0x02&gt;;
		operating-points-v2 = &lt;0x16&gt;;
		cpu-idle-states = &lt;0x10&gt;;
		i-cache-size = &lt;0x10000&gt;;
		i-cache-line-size = &lt;0x40&gt;;
		i-cache-sets = &lt;0x100&gt;;
		d-cache-size = &lt;0x10000&gt;;
		d-cache-line-size = &lt;0x40&gt;;
		d-cache-sets = &lt;0x100&gt;;
		next-level-cache = &lt;0x17&gt;;
		#cooling-cells = &lt;0x02&gt;;
		dynamic-power-coefficient = &lt;0x12c&gt;;
		cpu-supply = &lt;0x18&gt;;
		mem-supply = &lt;0x18&gt;;
		phandle = &lt;0x0a&gt;;
	};

	cpu@500 {
		device_type = "cpu";
		compatible = "arm,cortex-a76";
		reg = &lt;0x500&gt;;
		enable-method = "psci";
		capacity-dmips-mhz = &lt;0x400&gt;;
		clocks = &lt;0x0e 0x02&gt;;
		operating-points-v2 = &lt;0x16&gt;;
		cpu-idle-states = &lt;0x10&gt;;
		i-cache-size = &lt;0x10000&gt;;
		i-cache-line-size = &lt;0x40&gt;;
		i-cache-sets = &lt;0x100&gt;;
		d-cache-size = &lt;0x10000&gt;;
		d-cache-line-size = &lt;0x40&gt;;
		d-cache-sets = &lt;0x100&gt;;
		next-level-cache = &lt;0x19&gt;;
		phandle = &lt;0x0b&gt;;
	};

	cpu@600 {
		device_type = "cpu";
		compatible = "arm,cortex-a76";
		reg = &lt;0x600&gt;;
		enable-method = "psci";
		capacity-dmips-mhz = &lt;0x400&gt;;
		clocks = &lt;0x0e 0x03&gt;;
		operating-points-v2 = &lt;0x1a&gt;;
		cpu-idle-states = &lt;0x10&gt;;
		i-cache-size = &lt;0x10000&gt;;
		i-cache-line-size = &lt;0x40&gt;;
		i-cache-sets = &lt;0x100&gt;;
		d-cache-size = &lt;0x10000&gt;;
		d-cache-line-size = &lt;0x40&gt;;
		d-cache-sets = &lt;0x100&gt;;
		next-level-cache = &lt;0x1b&gt;;
		#cooling-cells = &lt;0x02&gt;;
		dynamic-power-coefficient = &lt;0x12c&gt;;
		cpu-supply = &lt;0x1c&gt;;
		mem-supply = &lt;0x1c&gt;;
		phandle = &lt;0x0c&gt;;
	};

	cpu@700 {
		device_type = "cpu";
		compatible = "arm,cortex-a76";
		reg = &lt;0x700&gt;;
		enable-method = "psci";
		capacity-dmips-mhz = &lt;0x400&gt;;
		clocks = &lt;0x0e 0x03&gt;;
		operating-points-v2 = &lt;0x1a&gt;;
		cpu-idle-states = &lt;0x10&gt;;
		i-cache-size = &lt;0x10000&gt;;
		i-cache-line-size = &lt;0x40&gt;;
		i-cache-sets = &lt;0x100&gt;;
		d-cache-size = &lt;0x10000&gt;;
		d-cache-line-size = &lt;0x40&gt;;
		d-cache-sets = &lt;0x100&gt;;
		next-level-cache = &lt;0x1d&gt;;
		phandle = &lt;0x0d&gt;;
	};

	idle-states {
		entry-method = "psci";

		cpu-sleep {
			compatible = "arm,idle-state";
			local-timer-stop;
			arm,psci-suspend-param = &lt;0x10000&gt;;
			entry-latency-us = &lt;0x64&gt;;
			exit-latency-us = &lt;0x78&gt;;
			min-residency-us = &lt;0x3e8&gt;;
			phandle = &lt;0x10&gt;;
		};
	};

	l2-cache-l0 {
		compatible = "cache";
		cache-size = &lt;0x20000&gt;;
		cache-line-size = &lt;0x40&gt;;
		cache-sets = &lt;0x200&gt;;
		next-level-cache = &lt;0x1e&gt;;
		phandle = &lt;0x11&gt;;
	};

	l2-cache-l1 {
		compatible = "cache";
		cache-size = &lt;0x20000&gt;;
		cache-line-size = &lt;0x40&gt;;
		cache-sets = &lt;0x200&gt;;
		next-level-cache = &lt;0x1e&gt;;
		phandle = &lt;0x13&gt;;
	};

	l2-cache-l2 {
		compatible = "cache";
		cache-size = &lt;0x20000&gt;;
		cache-line-size = &lt;0x40&gt;;
		cache-sets = &lt;0x200&gt;;
		next-level-cache = &lt;0x1e&gt;;
		phandle = &lt;0x14&gt;;
	};

	l2-cache-l3 {
		compatible = "cache";
		cache-size = &lt;0x20000&gt;;
		cache-line-size = &lt;0x40&gt;;
		cache-sets = &lt;0x200&gt;;
		next-level-cache = &lt;0x1e&gt;;
		phandle = &lt;0x15&gt;;
	};

	l2-cache-b0 {
		compatible = "cache";
		cache-size = &lt;0x80000&gt;;
		cache-line-size = &lt;0x40&gt;;
		cache-sets = &lt;0x400&gt;;
		next-level-cache = &lt;0x1e&gt;;
		phandle = &lt;0x17&gt;;
	};

	l2-cache-b1 {
		compatible = "cache";
		cache-size = &lt;0x80000&gt;;
		cache-line-size = &lt;0x40&gt;;
		cache-sets = &lt;0x400&gt;;
		next-level-cache = &lt;0x1e&gt;;
		phandle = &lt;0x19&gt;;
	};

	l2-cache-b2 {
		compatible = "cache";
		cache-size = &lt;0x80000&gt;;
		cache-line-size = &lt;0x40&gt;;
		cache-sets = &lt;0x400&gt;;
		next-level-cache = &lt;0x1e&gt;;
		phandle = &lt;0x1b&gt;;
	};

	l2-cache-b3 {
		compatible = "cache";
		cache-size = &lt;0x80000&gt;;
		cache-line-size = &lt;0x40&gt;;
		cache-sets = &lt;0x400&gt;;
		next-level-cache = &lt;0x1e&gt;;
		phandle = &lt;0x1d&gt;;
	};

	l3-cache {
		compatible = "cache";
		cache-size = &lt;0x300000&gt;;
		cache-line-size = &lt;0x40&gt;;
		cache-sets = &lt;0x1000&gt;;
		phandle = &lt;0x1e&gt;;
	};
};

cluster0-opp-table {
	compatible = "operating-points-v2";
	opp-shared;
	nvmem-cells = &lt;0x1f 0x20 0x21&gt;;
	nvmem-cell-names = "leakage\0opp-info\0specification_serial_number";
	rockchip,supported-hw;
	rockchip,opp-shared-dsu;
	rockchip,pvtm-hw = &lt;0x06&gt;;
	rockchip,pvtm-voltage-sel-hw = &lt;0x00 0x555 0x00 0x556 0x56b 0x01 0x56c 0x581 0x02 0x582 0x597 0x03 0x598 0x5ad 0x04 0x5ae 0x5c3 0x05 0x5c4 0x270f 0x06&gt;;
	rockchip,pvtm-voltage-sel = &lt;0x00 0x582 0x00 0x583 0x59a 0x01 0x59b 0x5b2 0x02 0x5b3 0x5ca 0x03 0x5cb 0x5e2 0x04 0x5e3 0x5fa 0x05 0x5fb 0x270f 0x06&gt;;
	rockchip,pvtm-pvtpll;
	rockchip,pvtm-offset = &lt;0x64&gt;;
	rockchip,pvtm-sample-time = &lt;0x44c&gt;;
	rockchip,pvtm-freq = &lt;0x159b40&gt;;
	rockchip,pvtm-volt = &lt;0xb71b0&gt;;
	rockchip,pvtm-ref-temp = &lt;0x19&gt;;
	rockchip,pvtm-temp-prop = &lt;0xf4 0xf4&gt;;
	rockchip,pvtm-thermal-zone = "soc-thermal";
	rockchip,grf = &lt;0x22&gt;;
	rockchip,dsu-grf = &lt;0x23&gt;;
	volt-mem-read-margin = &lt;0xd0bd8 0x01 0xbac48 0x02 0xa4cb8 0x03 0x78d98 0x04&gt;;
	low-volt-mem-read-margin = &lt;0x04&gt;;
	intermediate-threshold-freq = &lt;0xf6180&gt;;
	rockchip,reboot-freq = &lt;0x159b40&gt;;
	rockchip,temp-hysteresis = &lt;0x1388&gt;;
	rockchip,low-temp = &lt;0x2710&gt;;
	rockchip,low-temp-min-volt = &lt;0xb71b0&gt;;
	rockchip,high-temp = &lt;0x14c08&gt;;
	rockchip,high-temp-max-freq = &lt;0x188940&gt;;
	phandle = &lt;0x0f&gt;;

	opp-408000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x18519600&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xe7ef0 0xa4cb8 0xa4cb8 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-600000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x23c34600&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xe7ef0 0xa4cb8 0xa4cb8 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-816000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x30a32c00&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xe7ef0 0xa4cb8 0xa4cb8 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1008000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x3c14dc00&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xe7ef0 0xa4cb8 0xa4cb8 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1200000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x47868c00&gt;;
		opp-microvolt = &lt;0xadf34 0xadf34 0xe7ef0 0xadf34 0xadf34 0xe7ef0&gt;;
		opp-microvolt-L1 = &lt;0xaae60 0xaae60 0xe7ef0 0xaae60 0xaae60 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xaae60 0xaae60 0xe7ef0 0xaae60 0xaae60 0xe7ef0&gt;;
		opp-microvolt-L3 = &lt;0xa7d8c 0xa7d8c 0xe7ef0 0xa7d8c 0xa7d8c 0xe7ef0&gt;;
		opp-microvolt-L4 = &lt;0xa4cb8 0xa4cb8 0xe7ef0 0xa4cb8 0xa4cb8 0xe7ef0&gt;;
		opp-microvolt-L5 = &lt;0xa4cb8 0xa4cb8 0xe7ef0 0xa4cb8 0xa4cb8 0xe7ef0&gt;;
		opp-microvolt-L6 = &lt;0xa4cb8 0xa4cb8 0xe7ef0 0xa4cb8 0xa4cb8 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1416000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x54667200&gt;;
		opp-microvolt = &lt;0xba284 0xba284 0xe7ef0 0xba284 0xba284 0xe7ef0&gt;;
		opp-microvolt-L1 = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xb40dc 0xb40dc 0xe7ef0 0xb40dc 0xb40dc 0xe7ef0&gt;;
		opp-microvolt-L3 = &lt;0xb1008 0xb1008 0xe7ef0 0xb1008 0xb1008 0xe7ef0&gt;;
		opp-microvolt-L4 = &lt;0xb1008 0xb1008 0xe7ef0 0xb1008 0xb1008 0xe7ef0&gt;;
		opp-microvolt-L5 = &lt;0xadf34 0xadf34 0xe7ef0 0xadf34 0xadf34 0xe7ef0&gt;;
		opp-microvolt-L6 = &lt;0xadf34 0xadf34 0xe7ef0 0xadf34 0xadf34 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
		opp-suspend;
	};

	opp-1608000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x5fd82200&gt;;
		opp-microvolt = &lt;0xcf850 0xcf850 0xe7ef0 0xcf850 0xcf850 0xe7ef0&gt;;
		opp-microvolt-L1 = &lt;0xcc77c 0xcc77c 0xe7ef0 0xcc77c 0xcc77c 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xc96a8 0xc96a8 0xe7ef0 0xc96a8 0xc96a8 0xe7ef0&gt;;
		opp-microvolt-L3 = &lt;0xc65d4 0xc65d4 0xe7ef0 0xc65d4 0xc65d4 0xe7ef0&gt;;
		opp-microvolt-L4 = &lt;0xc3500 0xc3500 0xe7ef0 0xc3500 0xc3500 0xe7ef0&gt;;
		opp-microvolt-L5 = &lt;0xc3500 0xc3500 0xe7ef0 0xc3500 0xc3500 0xe7ef0&gt;;
		opp-microvolt-L6 = &lt;0xc042c 0xc042c 0xe7ef0 0xc042c 0xc042c 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1800000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x6b49d200&gt;;
		opp-microvolt = &lt;0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0&gt;;
		opp-microvolt-L1 = &lt;0xe4e1c 0xe4e1c 0xe7ef0 0xe4e1c 0xe4e1c 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xe1d48 0xe1d48 0xe7ef0 0xe1d48 0xe1d48 0xe7ef0&gt;;
		opp-microvolt-L3 = &lt;0xdec74 0xdec74 0xe7ef0 0xdec74 0xdec74 0xe7ef0&gt;;
		opp-microvolt-L4 = &lt;0xdbba0 0xdbba0 0xe7ef0 0xdbba0 0xdbba0 0xe7ef0&gt;;
		opp-microvolt-L5 = &lt;0xd8acc 0xd8acc 0xe7ef0 0xd8acc 0xd8acc 0xe7ef0&gt;;
		opp-microvolt-L6 = &lt;0xd59f8 0xd59f8 0xe7ef0 0xd59f8 0xd59f8 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-408000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x18519600&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-600000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x23c34600&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-816000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x30a32c00&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-1008000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x3c14dc00&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-1200000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x47868c00&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-1296000000 {
		opp-supported-hw = &lt;0x04 0xffff&gt;;
		opp-hz = &lt;0x00 0x4d3f6400&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		opp-microvolt-L0 = &lt;0xbd358 0xbd358 0xe7ef0 0xbd358 0xbd358 0xe7ef0&gt;;
		opp-microvolt-L1 = &lt;0xba284 0xba284 0xe7ef0 0xba284 0xba284 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-1416000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x54667200&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		opp-microvolt-L0 = &lt;0xc042c 0xc042c 0xe7ef0 0xc042c 0xc042c 0xe7ef0&gt;;
		opp-microvolt-L1 = &lt;0xbd358 0xbd358 0xe7ef0 0xbd358 0xbd358 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xba284 0xba284 0xe7ef0 0xba284 0xba284 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
		opp-suspend;
	};

	opp-j-m-1608000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x5fd82200&gt;;
		opp-microvolt = &lt;0xd8acc 0xd8acc 0xe7ef0 0xd8acc 0xd8acc 0xe7ef0&gt;;
		opp-microvolt-L1 = &lt;0xd59f8 0xd59f8 0xe7ef0 0xd59f8 0xd59f8 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xd2924 0xd2924 0xe7ef0 0xd2924 0xd2924 0xe7ef0&gt;;
		opp-microvolt-L3 = &lt;0xcf850 0xcf850 0xe7ef0 0xcf850 0xcf850 0xe7ef0&gt;;
		opp-microvolt-L4 = &lt;0xcc77c 0xcc77c 0xe7ef0 0xcc77c 0xcc77c 0xe7ef0&gt;;
		opp-microvolt-L5 = &lt;0xc96a8 0xc96a8 0xe7ef0 0xc96a8 0xc96a8 0xe7ef0&gt;;
		opp-microvolt-L6 = &lt;0xc65d4 0xc65d4 0xe7ef0 0xc65d4 0xc65d4 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-1704000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x6590fa00&gt;;
		opp-microvolt = &lt;0xe4e1c 0xe4e1c 0xe7ef0 0xe4e1c 0xe4e1c 0xe7ef0&gt;;
		opp-microvolt-L1 = &lt;0xe1d48 0xe1d48 0xe7ef0 0xe1d48 0xe1d48 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xdec74 0xdec74 0xe7ef0 0xdec74 0xdec74 0xe7ef0&gt;;
		opp-microvolt-L3 = &lt;0xdbba0 0xdbba0 0xe7ef0 0xdbba0 0xdbba0 0xe7ef0&gt;;
		opp-microvolt-L4 = &lt;0xd8acc 0xd8acc 0xe7ef0 0xd8acc 0xd8acc 0xe7ef0&gt;;
		opp-microvolt-L5 = &lt;0xd59f8 0xd59f8 0xe7ef0 0xd59f8 0xd59f8 0xe7ef0&gt;;
		opp-microvolt-L6 = &lt;0xd2924 0xd2924 0xe7ef0 0xd2924 0xd2924 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};
};

cluster1-opp-table {
	compatible = "operating-points-v2";
	opp-shared;
	nvmem-cells = &lt;0x24 0x25 0x21&gt;;
	nvmem-cell-names = "leakage\0opp-info\0specification_serial_number";
	rockchip,supported-hw;
	rockchip,pvtm-hw = &lt;0x06&gt;;
	rockchip,pvtm-voltage-sel-hw = &lt;0x00 0x603 0x00 0x604 0x61c 0x01 0x61d 0x635 0x02 0x636 0x64e 0x03 0x64f 0x66c 0x04 0x66d 0x68a 0x05 0x68b 0x6a8 0x06 0x6a9 0x270f 0x07&gt;;
	rockchip,pvtm-voltage-sel = &lt;0x00 0x63b 0x00 0x63c 0x64f 0x01 0x650 0x668 0x02 0x669 0x68b 0x03 0x68c 0x6ae 0x04 0x6af 0x6cf 0x05 0x6d0 0x6f0 0x06 0x6f1 0x270f 0x07&gt;;
	rockchip,pvtm-pvtpll;
	rockchip,pvtm-offset = &lt;0x18&gt;;
	rockchip,pvtm-sample-time = &lt;0x44c&gt;;
	rockchip,pvtm-freq = &lt;0x188940&gt;;
	rockchip,pvtm-volt = &lt;0xb71b0&gt;;
	rockchip,pvtm-ref-temp = &lt;0x19&gt;;
	rockchip,pvtm-temp-prop = &lt;0x10e 0x10e&gt;;
	rockchip,pvtm-thermal-zone = "soc-thermal";
	rockchip,pvtm-low-len-sel = &lt;0x03&gt;;
	rockchip,grf = &lt;0x26&gt;;
	volt-mem-read-margin = &lt;0xd0bd8 0x01 0xbac48 0x02 0xa4cb8 0x03 0x78d98 0x04&gt;;
	low-volt-mem-read-margin = &lt;0x04&gt;;
	intermediate-threshold-freq = &lt;0xf6180&gt;;
	rockchip,idle-threshold-freq = &lt;0x21b100&gt;;
	rockchip,reboot-freq = &lt;0x1b7740&gt;;
	rockchip,temp-hysteresis = &lt;0x1388&gt;;
	rockchip,low-temp = &lt;0x2710&gt;;
	rockchip,low-temp-min-volt = &lt;0xb71b0&gt;;
	rockchip,high-temp = &lt;0x14c08&gt;;
	rockchip,high-temp-max-freq = &lt;0x21b100&gt;;
	phandle = &lt;0x16&gt;;

	opp-408000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x18519600&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
		opp-suspend;
	};

	opp-600000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x23c34600&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-816000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x30a32c00&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1008000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x3c14dc00&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1200000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x47868c00&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1416000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x54667200&gt;;
		opp-microvolt = &lt;0xb1008 0xb1008 0xf4240 0xb1008 0xb1008 0xf4240&gt;;
		opp-microvolt-L2 = &lt;0xadf34 0xadf34 0xf4240 0xadf34 0xadf34 0xf4240&gt;;
		opp-microvolt-L3 = &lt;0xaae60 0xaae60 0xf4240 0xaae60 0xaae60 0xf4240&gt;;
		opp-microvolt-L4 = &lt;0xaae60 0xaae60 0xf4240 0xaae60 0xaae60 0xf4240&gt;;
		opp-microvolt-L5 = &lt;0xa7d8c 0xa7d8c 0xf4240 0xa7d8c 0xa7d8c 0xf4240&gt;;
		opp-microvolt-L6 = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		opp-microvolt-L7 = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1608000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x5fd82200&gt;;
		opp-microvolt = &lt;0xba284 0xba284 0xf4240 0xba284 0xba284 0xf4240&gt;;
		opp-microvolt-L2 = &lt;0xb71b0 0xb71b0 0xf4240 0xb71b0 0xb71b0 0xf4240&gt;;
		opp-microvolt-L3 = &lt;0xb40dc 0xb40dc 0xf4240 0xb40dc 0xb40dc 0xf4240&gt;;
		opp-microvolt-L4 = &lt;0xb1008 0xb1008 0xf4240 0xb1008 0xb1008 0xf4240&gt;;
		opp-microvolt-L5 = &lt;0xadf34 0xadf34 0xf4240 0xadf34 0xadf34 0xf4240&gt;;
		opp-microvolt-L6 = &lt;0xaae60 0xaae60 0xf4240 0xaae60 0xaae60 0xf4240&gt;;
		opp-microvolt-L7 = &lt;0xaae60 0xaae60 0xf4240 0xaae60 0xaae60 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1800000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x6b49d200&gt;;
		opp-microvolt = &lt;0xcf850 0xcf850 0xf4240 0xcf850 0xcf850 0xf4240&gt;;
		opp-microvolt-L1 = &lt;0xcc77c 0xcc77c 0xf4240 0xcc77c 0xcc77c 0xf4240&gt;;
		opp-microvolt-L2 = &lt;0xc96a8 0xc96a8 0xf4240 0xc96a8 0xc96a8 0xf4240&gt;;
		opp-microvolt-L3 = &lt;0xc65d4 0xc65d4 0xf4240 0xc65d4 0xc65d4 0xf4240&gt;;
		opp-microvolt-L4 = &lt;0xc3500 0xc3500 0xf4240 0xc3500 0xc3500 0xf4240&gt;;
		opp-microvolt-L5 = &lt;0xc042c 0xc042c 0xf4240 0xc042c 0xc042c 0xf4240&gt;;
		opp-microvolt-L6 = &lt;0xbd358 0xbd358 0xf4240 0xbd358 0xbd358 0xf4240&gt;;
		opp-microvolt-L7 = &lt;0xba284 0xba284 0xf4240 0xba284 0xba284 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-2016000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x7829b800&gt;;
		opp-microvolt = &lt;0xe1d48 0xe1d48 0xf4240 0xe1d48 0xe1d48 0xf4240&gt;;
		opp-microvolt-L1 = &lt;0xdec74 0xdec74 0xf4240 0xdec74 0xdec74 0xf4240&gt;;
		opp-microvolt-L2 = &lt;0xdbba0 0xdbba0 0xf4240 0xdbba0 0xdbba0 0xf4240&gt;;
		opp-microvolt-L3 = &lt;0xd8acc 0xd8acc 0xf4240 0xd8acc 0xd8acc 0xf4240&gt;;
		opp-microvolt-L4 = &lt;0xd59f8 0xd59f8 0xf4240 0xd59f8 0xd59f8 0xf4240&gt;;
		opp-microvolt-L5 = &lt;0xd2924 0xd2924 0xf4240 0xd2924 0xd2924 0xf4240&gt;;
		opp-microvolt-L6 = &lt;0xcf850 0xcf850 0xf4240 0xcf850 0xcf850 0xf4240&gt;;
		opp-microvolt-L7 = &lt;0xcc77c 0xcc77c 0xf4240 0xcc77c 0xcc77c 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-2208000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x839b6800&gt;;
		opp-microvolt = &lt;0xf116c 0xf116c 0xf4240 0xf116c 0xf116c 0xf4240&gt;;
		opp-microvolt-L1 = &lt;0xee098 0xee098 0xf4240 0xee098 0xee098 0xf4240&gt;;
		opp-microvolt-L2 = &lt;0xeafc4 0xeafc4 0xf4240 0xeafc4 0xeafc4 0xf4240&gt;;
		opp-microvolt-L3 = &lt;0xe7ef0 0xe7ef0 0xf4240 0xe7ef0 0xe7ef0 0xf4240&gt;;
		opp-microvolt-L4 = &lt;0xeafc4 0xeafc4 0xf4240 0xeafc4 0xeafc4 0xf4240&gt;;
		opp-microvolt-L5 = &lt;0xe7ef0 0xe7ef0 0xf4240 0xe7ef0 0xe7ef0 0xf4240&gt;;
		opp-microvolt-L6 = &lt;0xe1d48 0xe1d48 0xf4240 0xe1d48 0xe1d48 0xf4240&gt;;
		opp-microvolt-L7 = &lt;0xdec74 0xdec74 0xf4240 0xdec74 0xdec74 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-2256000000 {
		opp-supported-hw = &lt;0xf9 0x13&gt;;
		opp-hz = &lt;0x00 0x8677d400&gt;;
		opp-microvolt = &lt;0xf4240 0xf4240 0xf4240 0xf4240 0xf4240 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-2304000000 {
		opp-supported-hw = &lt;0xf9 0x24&gt;;
		opp-hz = &lt;0x00 0x89544000&gt;;
		opp-microvolt = &lt;0xf4240 0xf4240 0xf4240 0xf4240 0xf4240 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-2352000000 {
		opp-supported-hw = &lt;0xf9 0x48&gt;;
		opp-hz = &lt;0x00 0x8c30ac00&gt;;
		opp-microvolt = &lt;0xf4240 0xf4240 0xf4240 0xf4240 0xf4240 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-2400000000 {
		opp-supported-hw = &lt;0xf9 0x80&gt;;
		opp-hz = &lt;0x00 0x8f0d1800&gt;;
		opp-microvolt = &lt;0xf4240 0xf4240 0xf4240 0xf4240 0xf4240 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-408000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x18519600&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-600000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x23c34600&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-816000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x30a32c00&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-1008000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x3c14dc00&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-1200000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x47868c00&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-1416000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x54667200&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		opp-microvolt-L0 = &lt;0xba284 0xba284 0xe7ef0 0xba284 0xba284 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
		opp-suspend;
	};

	opp-j-m-1608000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x5fd82200&gt;;
		opp-microvolt = &lt;0xc042c 0xc042c 0xe7ef0 0xc042c 0xc042c 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xbd358 0xbd358 0xe7ef0 0xbd358 0xbd358 0xe7ef0&gt;;
		opp-microvolt-L3 = &lt;0xba284 0xba284 0xe7ef0 0xba284 0xba284 0xe7ef0&gt;;
		opp-microvolt-L4 = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		opp-microvolt-L5 = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		opp-microvolt-L6 = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		opp-microvolt-L7 = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-1800000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x6b49d200&gt;;
		opp-microvolt = &lt;0xd59f8 0xd59f8 0xe7ef0 0xd59f8 0xd59f8 0xe7ef0&gt;;
		opp-microvolt-L1 = &lt;0xd2924 0xd2924 0xe7ef0 0xd2924 0xd2924 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xcf850 0xcf850 0xe7ef0 0xcf850 0xcf850 0xe7ef0&gt;;
		opp-microvolt-L3 = &lt;0xcc77c 0xcc77c 0xe7ef0 0xcc77c 0xcc77c 0xe7ef0&gt;;
		opp-microvolt-L4 = &lt;0xc96a8 0xc96a8 0xe7ef0 0xc96a8 0xc96a8 0xe7ef0&gt;;
		opp-microvolt-L5 = &lt;0xc65d4 0xc65d4 0xe7ef0 0xc65d4 0xc65d4 0xe7ef0&gt;;
		opp-microvolt-L6 = &lt;0xc3500 0xc3500 0xe7ef0 0xc3500 0xc3500 0xe7ef0&gt;;
		opp-microvolt-L7 = &lt;0xc042c 0xc042c 0xe7ef0 0xc042c 0xc042c 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-2016000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x7829b800&gt;;
		opp-microvolt = &lt;0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0&gt;;
		opp-microvolt-L1 = &lt;0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xe4e1c 0xe4e1c 0xe7ef0 0xe4e1c 0xe4e1c 0xe7ef0&gt;;
		opp-microvolt-L3 = &lt;0xe1d48 0xe1d48 0xe7ef0 0xe1d48 0xe1d48 0xe7ef0&gt;;
		opp-microvolt-L4 = &lt;0xdec74 0xdec74 0xe7ef0 0xdec74 0xdec74 0xe7ef0&gt;;
		opp-microvolt-L5 = &lt;0xdbba0 0xdbba0 0xe7ef0 0xdbba0 0xdbba0 0xe7ef0&gt;;
		opp-microvolt-L6 = &lt;0xd8acc 0xd8acc 0xe7ef0 0xd8acc 0xd8acc 0xe7ef0&gt;;
		opp-microvolt-L7 = &lt;0xd59f8 0xd59f8 0xe7ef0 0xd59f8 0xd59f8 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};
};

cluster2-opp-table {
	compatible = "operating-points-v2";
	opp-shared;
	nvmem-cells = &lt;0x27 0x28 0x21&gt;;
	nvmem-cell-names = "leakage\0opp-info\0specification_serial_number";
	rockchip,supported-hw;
	rockchip,pvtm-hw = &lt;0x06&gt;;
	rockchip,pvtm-voltage-sel-hw = &lt;0x00 0x603 0x00 0x604 0x61c 0x01 0x61d 0x635 0x02 0x636 0x64e 0x03 0x64f 0x66c 0x04 0x66d 0x68a 0x05 0x68b 0x6a8 0x06 0x6a9 0x270f 0x07&gt;;
	rockchip,pvtm-voltage-sel = &lt;0x00 0x63b 0x00 0x63c 0x64f 0x01 0x650 0x668 0x02 0x669 0x68b 0x03 0x68c 0x6ae 0x04 0x6af 0x6cf 0x05 0x6d0 0x6f0 0x06 0x6f1 0x270f 0x07&gt;;
	rockchip,pvtm-pvtpll;
	rockchip,pvtm-offset = &lt;0x18&gt;;
	rockchip,pvtm-sample-time = &lt;0x44c&gt;;
	rockchip,pvtm-freq = &lt;0x188940&gt;;
	rockchip,pvtm-volt = &lt;0xb71b0&gt;;
	rockchip,pvtm-ref-temp = &lt;0x19&gt;;
	rockchip,pvtm-temp-prop = &lt;0x10e 0x10e&gt;;
	rockchip,pvtm-thermal-zone = "soc-thermal";
	rockchip,pvtm-low-len-sel = &lt;0x03&gt;;
	rockchip,grf = &lt;0x29&gt;;
	volt-mem-read-margin = &lt;0xd0bd8 0x01 0xbac48 0x02 0xa4cb8 0x03 0x78d98 0x04&gt;;
	low-volt-mem-read-margin = &lt;0x04&gt;;
	intermediate-threshold-freq = &lt;0xf6180&gt;;
	rockchip,idle-threshold-freq = &lt;0x21b100&gt;;
	rockchip,reboot-freq = &lt;0x1b7740&gt;;
	rockchip,temp-hysteresis = &lt;0x1388&gt;;
	rockchip,low-temp = &lt;0x2710&gt;;
	rockchip,low-temp-min-volt = &lt;0xb71b0&gt;;
	rockchip,high-temp = &lt;0x14c08&gt;;
	rockchip,high-temp-max-freq = &lt;0x21b100&gt;;
	phandle = &lt;0x1a&gt;;

	opp-408000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x18519600&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
		opp-suspend;
	};

	opp-600000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x23c34600&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-816000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x30a32c00&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1008000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x3c14dc00&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1200000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x47868c00&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1416000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x54667200&gt;;
		opp-microvolt = &lt;0xb1008 0xb1008 0xf4240 0xb1008 0xb1008 0xf4240&gt;;
		opp-microvolt-L2 = &lt;0xadf34 0xadf34 0xf4240 0xadf34 0xadf34 0xf4240&gt;;
		opp-microvolt-L3 = &lt;0xaae60 0xaae60 0xf4240 0xaae60 0xaae60 0xf4240&gt;;
		opp-microvolt-L4 = &lt;0xaae60 0xaae60 0xf4240 0xaae60 0xaae60 0xf4240&gt;;
		opp-microvolt-L5 = &lt;0xa7d8c 0xa7d8c 0xf4240 0xa7d8c 0xa7d8c 0xf4240&gt;;
		opp-microvolt-L6 = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		opp-microvolt-L7 = &lt;0xa4cb8 0xa4cb8 0xf4240 0xa4cb8 0xa4cb8 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1608000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x5fd82200&gt;;
		opp-microvolt = &lt;0xba284 0xba284 0xf4240 0xba284 0xba284 0xf4240&gt;;
		opp-microvolt-L2 = &lt;0xb71b0 0xb71b0 0xf4240 0xb71b0 0xb71b0 0xf4240&gt;;
		opp-microvolt-L3 = &lt;0xb40dc 0xb40dc 0xf4240 0xb40dc 0xb40dc 0xf4240&gt;;
		opp-microvolt-L4 = &lt;0xb1008 0xb1008 0xf4240 0xb1008 0xb1008 0xf4240&gt;;
		opp-microvolt-L5 = &lt;0xadf34 0xadf34 0xf4240 0xadf34 0xadf34 0xf4240&gt;;
		opp-microvolt-L6 = &lt;0xaae60 0xaae60 0xf4240 0xaae60 0xaae60 0xf4240&gt;;
		opp-microvolt-L7 = &lt;0xaae60 0xaae60 0xf4240 0xaae60 0xaae60 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-1800000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x6b49d200&gt;;
		opp-microvolt = &lt;0xcf850 0xcf850 0xf4240 0xcf850 0xcf850 0xf4240&gt;;
		opp-microvolt-L1 = &lt;0xcc77c 0xcc77c 0xf4240 0xcc77c 0xcc77c 0xf4240&gt;;
		opp-microvolt-L2 = &lt;0xc96a8 0xc96a8 0xf4240 0xc96a8 0xc96a8 0xf4240&gt;;
		opp-microvolt-L3 = &lt;0xc65d4 0xc65d4 0xf4240 0xc65d4 0xc65d4 0xf4240&gt;;
		opp-microvolt-L4 = &lt;0xc3500 0xc3500 0xf4240 0xc3500 0xc3500 0xf4240&gt;;
		opp-microvolt-L5 = &lt;0xc042c 0xc042c 0xf4240 0xc042c 0xc042c 0xf4240&gt;;
		opp-microvolt-L6 = &lt;0xbd358 0xbd358 0xf4240 0xbd358 0xbd358 0xf4240&gt;;
		opp-microvolt-L7 = &lt;0xba284 0xba284 0xf4240 0xba284 0xba284 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-2016000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x7829b800&gt;;
		opp-microvolt = &lt;0xe1d48 0xe1d48 0xf4240 0xe1d48 0xe1d48 0xf4240&gt;;
		opp-microvolt-L1 = &lt;0xdec74 0xdec74 0xf4240 0xdec74 0xdec74 0xf4240&gt;;
		opp-microvolt-L2 = &lt;0xdbba0 0xdbba0 0xf4240 0xdbba0 0xdbba0 0xf4240&gt;;
		opp-microvolt-L3 = &lt;0xd8acc 0xd8acc 0xf4240 0xd8acc 0xd8acc 0xf4240&gt;;
		opp-microvolt-L4 = &lt;0xd59f8 0xd59f8 0xf4240 0xd59f8 0xd59f8 0xf4240&gt;;
		opp-microvolt-L5 = &lt;0xd2924 0xd2924 0xf4240 0xd2924 0xd2924 0xf4240&gt;;
		opp-microvolt-L6 = &lt;0xcf850 0xcf850 0xf4240 0xcf850 0xcf850 0xf4240&gt;;
		opp-microvolt-L7 = &lt;0xcc77c 0xcc77c 0xf4240 0xcc77c 0xcc77c 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-2208000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x839b6800&gt;;
		opp-microvolt = &lt;0xf116c 0xf116c 0xf4240 0xf116c 0xf116c 0xf4240&gt;;
		opp-microvolt-L3 = &lt;0xee098 0xee098 0xf4240 0xee098 0xee098 0xf4240&gt;;
		opp-microvolt-L4 = &lt;0xeafc4 0xeafc4 0xf4240 0xeafc4 0xeafc4 0xf4240&gt;;
		opp-microvolt-L5 = &lt;0xe7ef0 0xe7ef0 0xf4240 0xe7ef0 0xe7ef0 0xf4240&gt;;
		opp-microvolt-L6 = &lt;0xe1d48 0xe1d48 0xf4240 0xe1d48 0xe1d48 0xf4240&gt;;
		opp-microvolt-L7 = &lt;0xdec74 0xdec74 0xf4240 0xdec74 0xdec74 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-2256000000 {
		opp-supported-hw = &lt;0xf9 0x13&gt;;
		opp-hz = &lt;0x00 0x8677d400&gt;;
		opp-microvolt = &lt;0xf4240 0xf4240 0xf4240 0xf4240 0xf4240 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-2304000000 {
		opp-supported-hw = &lt;0xf9 0x24&gt;;
		opp-hz = &lt;0x00 0x89544000&gt;;
		opp-microvolt = &lt;0xf4240 0xf4240 0xf4240 0xf4240 0xf4240 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-2352000000 {
		opp-supported-hw = &lt;0xf9 0x48&gt;;
		opp-hz = &lt;0x00 0x8c30ac00&gt;;
		opp-microvolt = &lt;0xf4240 0xf4240 0xf4240 0xf4240 0xf4240 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-2400000000 {
		opp-supported-hw = &lt;0xf9 0x80&gt;;
		opp-hz = &lt;0x00 0x8f0d1800&gt;;
		opp-microvolt = &lt;0xf4240 0xf4240 0xf4240 0xf4240 0xf4240 0xf4240&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-408000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x18519600&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-600000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x23c34600&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-816000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x30a32c00&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-1008000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x3c14dc00&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-1200000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x47868c00&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-1416000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x54667200&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		opp-microvolt-L0 = &lt;0xba284 0xba284 0xe7ef0 0xba284 0xba284 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
		opp-suspend;
	};

	opp-j-m-1608000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x5fd82200&gt;;
		opp-microvolt = &lt;0xc042c 0xc042c 0xe7ef0 0xc042c 0xc042c 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xbd358 0xbd358 0xe7ef0 0xbd358 0xbd358 0xe7ef0&gt;;
		opp-microvolt-L3 = &lt;0xba284 0xba284 0xe7ef0 0xba284 0xba284 0xe7ef0&gt;;
		opp-microvolt-L4 = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		opp-microvolt-L5 = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		opp-microvolt-L6 = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		opp-microvolt-L7 = &lt;0xb71b0 0xb71b0 0xe7ef0 0xb71b0 0xb71b0 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-1800000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x6b49d200&gt;;
		opp-microvolt = &lt;0xd59f8 0xd59f8 0xe7ef0 0xd59f8 0xd59f8 0xe7ef0&gt;;
		opp-microvolt-L1 = &lt;0xd2924 0xd2924 0xe7ef0 0xd2924 0xd2924 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xcf850 0xcf850 0xe7ef0 0xcf850 0xcf850 0xe7ef0&gt;;
		opp-microvolt-L3 = &lt;0xcc77c 0xcc77c 0xe7ef0 0xcc77c 0xcc77c 0xe7ef0&gt;;
		opp-microvolt-L4 = &lt;0xc96a8 0xc96a8 0xe7ef0 0xc96a8 0xc96a8 0xe7ef0&gt;;
		opp-microvolt-L5 = &lt;0xc65d4 0xc65d4 0xe7ef0 0xc65d4 0xc65d4 0xe7ef0&gt;;
		opp-microvolt-L6 = &lt;0xc3500 0xc3500 0xe7ef0 0xc3500 0xc3500 0xe7ef0&gt;;
		opp-microvolt-L7 = &lt;0xc042c 0xc042c 0xe7ef0 0xc042c 0xc042c 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};

	opp-j-m-2016000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x7829b800&gt;;
		opp-microvolt = &lt;0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0&gt;;
		opp-microvolt-L1 = &lt;0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0 0xe7ef0&gt;;
		opp-microvolt-L2 = &lt;0xe4e1c 0xe4e1c 0xe7ef0 0xe4e1c 0xe4e1c 0xe7ef0&gt;;
		opp-microvolt-L3 = &lt;0xe1d48 0xe1d48 0xe7ef0 0xe1d48 0xe1d48 0xe7ef0&gt;;
		opp-microvolt-L4 = &lt;0xdec74 0xdec74 0xe7ef0 0xdec74 0xdec74 0xe7ef0&gt;;
		opp-microvolt-L5 = &lt;0xdbba0 0xdbba0 0xe7ef0 0xdbba0 0xdbba0 0xe7ef0&gt;;
		opp-microvolt-L6 = &lt;0xd8acc 0xd8acc 0xe7ef0 0xd8acc 0xd8acc 0xe7ef0&gt;;
		opp-microvolt-L7 = &lt;0xd59f8 0xd59f8 0xe7ef0 0xd59f8 0xd59f8 0xe7ef0&gt;;
		clock-latency-ns = &lt;0x9c40&gt;;
	};
};

arm-pmu {
	compatible = "arm,armv8-pmuv3";
	interrupts = &lt;0x01 0x07 0x08&gt;;
	interrupt-affinity = &lt;0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d&gt;;
};

cpuinfo {
	compatible = "rockchip,cpuinfo";
	nvmem-cells = &lt;0x2a 0x2b 0x2c&gt;;
	nvmem-cell-names = "id\0cpu-version\0cpu-code";
};

csi2-dcphy0 {
	compatible = "rockchip,rk3588-csi2-dphy";
	rockchip,hw = &lt;0x2d 0x2e&gt;;
	phys = &lt;0x2f 0x30&gt;;
	phy-names = "dcphy0\0dcphy1";
	status = "disabled";
};

csi2-dcphy1 {
	compatible = "rockchip,rk3588-csi2-dphy";
	rockchip,hw = &lt;0x2d 0x2e&gt;;
	phys = &lt;0x2f 0x30&gt;;
	phy-names = "dcphy0\0dcphy1";
	status = "disabled";
};

csi2-dphy0 {
	compatible = "rockchip,rk3588-csi2-dphy";
	rockchip,hw = &lt;0x2d 0x2e&gt;;
	phys = &lt;0x2f 0x30&gt;;
	phy-names = "dcphy0\0dcphy1";
	status = "disabled";
};

csi2-dphy1 {
	compatible = "rockchip,rk3588-csi2-dphy";
	rockchip,hw = &lt;0x2d 0x2e&gt;;
	phys = &lt;0x2f 0x30&gt;;
	phy-names = "dcphy0\0dcphy1";
	status = "disabled";
};

csi2-dphy2 {
	compatible = "rockchip,rk3588-csi2-dphy";
	rockchip,hw = &lt;0x2d 0x2e&gt;;
	phys = &lt;0x2f 0x30&gt;;
	phy-names = "dcphy0\0dcphy1";
	status = "disabled";
};

csi2-dphy3 {
	compatible = "rockchip,rk3588-csi2-dphy";
	rockchip,hw = &lt;0x2d 0x2e&gt;;
	phys = &lt;0x2f 0x30&gt;;
	phy-names = "dcphy0\0dcphy1";
	status = "disabled";
};

csi2-dphy4 {
	compatible = "rockchip,rk3588-csi2-dphy";
	rockchip,hw = &lt;0x2d 0x2e&gt;;
	phys = &lt;0x2f 0x30&gt;;
	phy-names = "dcphy0\0dcphy1";
	status = "disabled";
};

csi2-dphy5 {
	compatible = "rockchip,rk3588-csi2-dphy";
	rockchip,hw = &lt;0x2d 0x2e&gt;;
	phys = &lt;0x2f 0x30&gt;;
	phy-names = "dcphy0\0dcphy1";
	status = "disabled";
};

display-subsystem {
	compatible = "rockchip,display-subsystem";
	ports = &lt;0x31&gt;;
	clocks = &lt;0x32 0x33&gt;;
	clock-names = "hdmi0_phy_pll\0hdmi1_phy_pll";
	memory-region = &lt;0x34&gt;;
	memory-region-names = "drm-logo";

	route {

		route-dp0 {
			status = "disabled";
			logo,uboot = "logo.bmp";
			logo,kernel = "logo_kernel.bmp";
			logo,mode = "center";
			charge_logo,mode = "center";
			connect = &lt;0x35&gt;;
		};

		route-dsi0 {
			status = "disabled";
			logo,uboot = "logo.bmp";
			logo,kernel = "logo_kernel.bmp";
			logo,mode = "center";
			charge_logo,mode = "center";
			connect = &lt;0x36&gt;;
		};

		route-dsi1 {
			status = "disabled";
			logo,uboot = "logo.bmp";
			logo,kernel = "logo_kernel.bmp";
			logo,mode = "center";
			charge_logo,mode = "center";
			connect = &lt;0x37&gt;;
		};

		route-edp0 {
			status = "disabled";
			logo,uboot = "logo.bmp";
			logo,kernel = "logo_kernel.bmp";
			logo,mode = "center";
			charge_logo,mode = "center";
			connect = &lt;0x38&gt;;
		};

		route-edp1 {
			status = "disabled";
			logo,uboot = "logo.bmp";
			logo,kernel = "logo_kernel.bmp";
			logo,mode = "center";
			charge_logo,mode = "center";
		};

		route-hdmi0 {
			status = "disabled";
			logo,uboot = "logo.bmp";
			logo,kernel = "logo_kernel.bmp";
			logo,mode = "center";
			charge_logo,mode = "center";
			connect = &lt;0x39&gt;;
		};

		route-rgb {
			status = "disabled";
			logo,uboot = "logo.bmp";
			logo,kernel = "logo_kernel.bmp";
			logo,mode = "center";
			charge_logo,mode = "center";
			connect = &lt;0x3a&gt;;
		};

		route-dp1 {
			status = "disabled";
			logo,uboot = "logo.bmp";
			logo,kernel = "logo_kernel.bmp";
			logo,mode = "center";
			charge_logo,mode = "center";
			connect = &lt;0x3b&gt;;
		};

		route-hdmi1 {
			status = "disabled";
			logo,uboot = "logo.bmp";
			logo,kernel = "logo_kernel.bmp";
			logo,mode = "center";
			charge_logo,mode = "center";
			connect = &lt;0x3c&gt;;
		};
	};
};

dmc {
	compatible = "rockchip,rk3588-dmc";
	interrupts = &lt;0x00 0x49 0x04&gt;;
	interrupt-names = "complete";
	devfreq-events = &lt;0x3d&gt;;
	clocks = &lt;0x0e 0x04&gt;;
	clock-names = "dmc_clk";
	operating-points-v2 = &lt;0x3e&gt;;
	upthreshold = &lt;0x28&gt;;
	downdifferential = &lt;0x14&gt;;
	system-status-level = &lt;0x01 0x04 0x08 0x08 0x02 0x01 0x10 0x04 0x10000 0x04 0x80000 0x04 0x1000 0x08 0x4000 0x08 0x2000 0x08 0xc00 0x08 0x40000 0x08 0x200000 0x08&gt;;
	auto-freq-en = &lt;0x01&gt;;
	status = "okay";
	center-supply = &lt;0x3f&gt;;
	mem-supply = &lt;0x40&gt;;
};

dmc-opp-table {
	compatible = "operating-points-v2";
	nvmem-cells = &lt;0x41 0x42 0x21&gt;;
	nvmem-cell-names = "leakage\0opp-info\0specification_serial_number";
	rockchip,supported-hw;
	rockchip,leakage-voltage-sel = &lt;0x01 0x1f 0x00 0x20 0x2c 0x01 0x2d 0x39 0x02 0x3a 0xfe 0x03&gt;;
	rockchip,temp-hysteresis = &lt;0x1388&gt;;
	rockchip,low-temp = &lt;0x2710&gt;;
	rockchip,low-temp-min-volt = &lt;0xb71b0&gt;;
	phandle = &lt;0x3e&gt;;

	opp-528000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x1f78a400&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xd59f8 0xb1008 0xb1008 0xb71b0&gt;;
		opp-microvolt-L1 = &lt;0xa4cb8 0xa4cb8 0xd59f8 0xaae60 0xaae60 0xb71b0&gt;;
		opp-microvolt-L2 = &lt;0xa4cb8 0xa4cb8 0xd59f8 0xa7d8c 0xa7d8c 0xb71b0&gt;;
		opp-microvolt-L3 = &lt;0xa4cb8 0xa4cb8 0xd59f8 0xa4cb8 0xa4cb8 0xb71b0&gt;;
	};

	opp-1068000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x3fa86300&gt;;
		opp-microvolt = &lt;0xb1008 0xb1008 0xd59f8 0xb40dc 0xb40dc 0xb71b0&gt;;
		opp-microvolt-L1 = &lt;0xaae60 0xaae60 0xd59f8 0xadf34 0xadf34 0xb71b0&gt;;
		opp-microvolt-L2 = &lt;0xa4cb8 0xa4cb8 0xd59f8 0xaae60 0xaae60 0xb71b0&gt;;
		opp-microvolt-L3 = &lt;0xa4cb8 0xa4cb8 0xd59f8 0xa7d8c 0xa7d8c 0xb71b0&gt;;
	};

	opp-1560000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x5cfbb600&gt;;
		opp-microvolt = &lt;0xc3500 0xc3500 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
		opp-microvolt-L1 = &lt;0xbd358 0xbd358 0xd59f8 0xb1008 0xb1008 0xb71b0&gt;;
		opp-microvolt-L2 = &lt;0xb71b0 0xb71b0 0xd59f8 0xadf34 0xadf34 0xb71b0&gt;;
		opp-microvolt-L3 = &lt;0xb1008 0xb1008 0xd59f8 0xaae60 0xaae60 0xb71b0&gt;;
	};

	opp-2750000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0xa3e9ab80&gt;;
		opp-microvolt = &lt;0xd59f8 0xd59f8 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
		opp-microvolt-L1 = &lt;0xcf850 0xcf850 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
		opp-microvolt-L2 = &lt;0xcc77c 0xcc77c 0xd59f8 0xb1008 0xb1008 0xb71b0&gt;;
		opp-microvolt-L3 = &lt;0xc96a8 0xc8320 0xd59f8 0xaae60 0xaae60 0xb71b0&gt;;
	};

	opp-j-m-528000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x1f78a400&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
	};

	opp-j-m-1068000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x3fa86300&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
	};

	opp-j-m-1560000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x5cfbb600&gt;;
		opp-microvolt = &lt;0xc3500 0xc3500 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
		opp-microvolt-L1 = &lt;0xbd358 0xbd358 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
		opp-microvolt-L2 = &lt;0xb71b0 0xb71b0 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
		opp-microvolt-L3 = &lt;0xb71b0 0xb71b0 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
	};

	opp-j-m-2750000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0xa3e9ab80&gt;;
		opp-microvolt = &lt;0xd59f8 0xd59f8 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
		opp-microvolt-L1 = &lt;0xcf850 0xcf850 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
		opp-microvolt-L2 = &lt;0xcc77c 0xcc77c 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
		opp-microvolt-L3 = &lt;0xc96a8 0xc8320 0xd59f8 0xb71b0 0xb71b0 0xb71b0&gt;;
	};
};

firmware {

	scmi {
		compatible = "arm,scmi-smc";
		shmem = &lt;0x43&gt;;
		arm,smc-id = &lt;0x82000010&gt;;
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;

		protocol@14 {
			reg = &lt;0x14&gt;;
			#clock-cells = &lt;0x01&gt;;
			assigned-clocks = &lt;0x0e 0x00 0x0e 0x02 0x0e 0x03&gt;;
			assigned-clock-rates = &lt;0x30a32c00 0x30a32c00 0x30a32c00&gt;;
			phandle = &lt;0x0e&gt;;
		};

		protocol@16 {
			reg = &lt;0x16&gt;;
			#reset-cells = &lt;0x01&gt;;
			phandle = &lt;0x113&gt;;
		};
	};

	sdei {
		compatible = "arm,sdei-1.0";
		method = "smc";
	};

	optee {
		compatible = "linaro,optee-tz";
		method = "smc";
	};
};

jpege-ccu {
	compatible = "rockchip,vpu-jpege-ccu";
	status = "okay";
	phandle = &lt;0xb3&gt;;
};

mipi0-csi2 {
	compatible = "rockchip,rk3588-mipi-csi2";
	rockchip,hw = &lt;0x44 0x45 0x46 0x47 0x48 0x49&gt;;
	status = "disabled";
};

mipi1-csi2 {
	compatible = "rockchip,rk3588-mipi-csi2";
	rockchip,hw = &lt;0x44 0x45 0x46 0x47 0x48 0x49&gt;;
	status = "disabled";
};

mipi2-csi2 {
	compatible = "rockchip,rk3588-mipi-csi2";
	rockchip,hw = &lt;0x44 0x45 0x46 0x47 0x48 0x49&gt;;
	status = "disabled";
};

mipi3-csi2 {
	compatible = "rockchip,rk3588-mipi-csi2";
	rockchip,hw = &lt;0x44 0x45 0x46 0x47 0x48 0x49&gt;;
	status = "disabled";
};

mipi4-csi2 {
	compatible = "rockchip,rk3588-mipi-csi2";
	rockchip,hw = &lt;0x44 0x45 0x46 0x47 0x48 0x49&gt;;
	status = "disabled";
};

mipi5-csi2 {
	compatible = "rockchip,rk3588-mipi-csi2";
	rockchip,hw = &lt;0x44 0x45 0x46 0x47 0x48 0x49&gt;;
	status = "disabled";
};

mpp-srv {
	compatible = "rockchip,mpp-service";
	rockchip,taskqueue-count = &lt;0x0c&gt;;
	rockchip,resetgroup-count = &lt;0x01&gt;;
	status = "okay";
	phandle = &lt;0xae&gt;;
};

psci {
	compatible = "arm,psci-1.0";
	method = "smc";
};

rkcif-dvp {
	compatible = "rockchip,rkcif-dvp";
	rockchip,hw = &lt;0x4a&gt;;
	iommus = &lt;0x4b&gt;;
	status = "disabled";
	phandle = &lt;0x4c&gt;;
};

rkcif-dvp-sditf {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4c&gt;;
	status = "disabled";
};

rkcif-mipi-lvds {
	compatible = "rockchip,rkcif-mipi-lvds";
	rockchip,hw = &lt;0x4a&gt;;
	iommus = &lt;0x4b&gt;;
	status = "disabled";
	phandle = &lt;0x4d&gt;;
};

rkcif-mipi-lvds-sditf {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4d&gt;;
	status = "disabled";
};

rkcif-mipi-lvds-sditf-vir1 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4d&gt;;
	status = "disabled";
};

rkcif-mipi-lvds-sditf-vir2 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4d&gt;;
	status = "disabled";
};

rkcif-mipi-lvds-sditf-vir3 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4d&gt;;
	status = "disabled";
};

rkcif-mipi-lvds1 {
	compatible = "rockchip,rkcif-mipi-lvds";
	rockchip,hw = &lt;0x4a&gt;;
	iommus = &lt;0x4b&gt;;
	status = "disabled";
	phandle = &lt;0x4e&gt;;
};

rkcif-mipi-lvds1-sditf {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4e&gt;;
	status = "disabled";
};

rkcif-mipi-lvds1-sditf-vir1 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4e&gt;;
	status = "disabled";
};

rkcif-mipi-lvds1-sditf-vir2 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4e&gt;;
	status = "disabled";
};

rkcif-mipi-lvds1-sditf-vir3 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4e&gt;;
	status = "disabled";
};

rkcif-mipi-lvds2 {
	compatible = "rockchip,rkcif-mipi-lvds";
	rockchip,hw = &lt;0x4a&gt;;
	iommus = &lt;0x4b&gt;;
	status = "disabled";
	phandle = &lt;0x4f&gt;;
};

rkcif-mipi-lvds2-sditf {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4f&gt;;
	status = "disabled";
};

rkcif-mipi-lvds2-sditf-vir1 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4f&gt;;
	status = "disabled";
};

rkcif-mipi-lvds2-sditf-vir2 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4f&gt;;
	status = "disabled";
};

rkcif-mipi-lvds2-sditf-vir3 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x4f&gt;;
	status = "disabled";
};

rkcif-mipi-lvds3 {
	compatible = "rockchip,rkcif-mipi-lvds";
	rockchip,hw = &lt;0x4a&gt;;
	iommus = &lt;0x4b&gt;;
	status = "disabled";
	phandle = &lt;0x50&gt;;
};

rkcif-mipi-lvds3-sditf {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x50&gt;;
	status = "disabled";
};

rkcif-mipi-lvds3-sditf-vir1 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x50&gt;;
	status = "disabled";
};

rkcif-mipi-lvds3-sditf-vir2 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x50&gt;;
	status = "disabled";
};

rkcif-mipi-lvds3-sditf-vir3 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x50&gt;;
	status = "disabled";
};

rkisp0-vir0 {
	compatible = "rockchip,rkisp-vir";
	rockchip,hw = &lt;0x51&gt;;
	status = "disabled";
};

rkisp0-vir1 {
	compatible = "rockchip,rkisp-vir";
	rockchip,hw = &lt;0x51&gt;;
	status = "disabled";
};

rkisp0-vir2 {
	compatible = "rockchip,rkisp-vir";
	rockchip,hw = &lt;0x51&gt;;
	status = "disabled";
};

rkisp0-vir3 {
	compatible = "rockchip,rkisp-vir";
	rockchip,hw = &lt;0x51&gt;;
	status = "disabled";
};

rkisp1-vir0 {
	compatible = "rockchip,rkisp-vir";
	rockchip,hw = &lt;0x52&gt;;
	status = "disabled";
};

rkisp1-vir1 {
	compatible = "rockchip,rkisp-vir";
	rockchip,hw = &lt;0x52&gt;;
	status = "disabled";
};

rkisp1-vir2 {
	compatible = "rockchip,rkisp-vir";
	rockchip,hw = &lt;0x52&gt;;
	status = "disabled";
};

rkisp1-vir3 {
	compatible = "rockchip,rkisp-vir";
	rockchip,hw = &lt;0x52&gt;;
	status = "disabled";
};

rkispp0-vir0 {
	compatible = "rockchip,rk3588-rkispp-vir";
	rockchip,hw = &lt;0x53&gt;;
	status = "disabled";
};

rkispp1-vir0 {
	compatible = "rockchip,rk3588-rkispp-vir";
	rockchip,hw = &lt;0x54&gt;;
	status = "disabled";
};

rkvenc-ccu {
	compatible = "rockchip,rkv-encoder-v2-ccu";
	status = "okay";
	phandle = &lt;0xb9&gt;;
};

rkvtunnel {
	compatible = "rockchip,video-tunnel";
	status = "disabled";
};

rockchip-suspend {
	compatible = "rockchip,pm-rk3588";
	status = "okay";
	rockchip,sleep-debug-en = &lt;0x01&gt;;
	rockchip,sleep-mode-config = &lt;0x1000608&gt;;
	rockchip,wakeup-config = &lt;0x100&gt;;
};

rockchip-system-monitor {
	compatible = "rockchip,system-monitor";
	rockchip,thermal-zone = "soc-thermal";
};

thermal-zones {

	soc-thermal {
		polling-delay-passive = &lt;0x14&gt;;
		polling-delay = &lt;0x3e8&gt;;
		sustainable-power = &lt;0x834&gt;;
		thermal-sensors = &lt;0x55 0x00&gt;;

		trips {

			trip-point-0 {
				temperature = &lt;0x124f8&gt;;
				hysteresis = &lt;0x7d0&gt;;
				type = "passive";
			};

			trip-point-1 {
				temperature = &lt;0x14c08&gt;;
				hysteresis = &lt;0x7d0&gt;;
				type = "passive";
				phandle = &lt;0x56&gt;;
			};

			soc-crit {
				temperature = &lt;0x1c138&gt;;
				hysteresis = &lt;0x7d0&gt;;
				type = "critical";
			};
		};

		cooling-maps {

			map0 {
				trip = &lt;0x56&gt;;
				cooling-device = &lt;0x06 0xffffffff 0xffffffff&gt;;
				contribution = &lt;0x400&gt;;
			};

			map1 {
				trip = &lt;0x56&gt;;
				cooling-device = &lt;0x0a 0xffffffff 0xffffffff&gt;;
				contribution = &lt;0x400&gt;;
			};

			map2 {
				trip = &lt;0x56&gt;;
				cooling-device = &lt;0x0c 0xffffffff 0xffffffff&gt;;
				contribution = &lt;0x400&gt;;
			};

			map3 {
				trip = &lt;0x56&gt;;
				cooling-device = &lt;0x57 0xffffffff 0xffffffff&gt;;
				contribution = &lt;0x400&gt;;
			};
		};
	};

	bigcore0-thermal {
		polling-delay-passive = &lt;0x14&gt;;
		polling-delay = &lt;0x3e8&gt;;
		thermal-sensors = &lt;0x55 0x01&gt;;
	};

	bigcore1-thermal {
		polling-delay-passive = &lt;0x14&gt;;
		polling-delay = &lt;0x3e8&gt;;
		thermal-sensors = &lt;0x55 0x02&gt;;
	};

	littlecore-thermal {
		polling-delay-passive = &lt;0x14&gt;;
		polling-delay = &lt;0x3e8&gt;;
		thermal-sensors = &lt;0x55 0x03&gt;;
	};

	center-thermal {
		polling-delay-passive = &lt;0x14&gt;;
		polling-delay = &lt;0x3e8&gt;;
		thermal-sensors = &lt;0x55 0x04&gt;;
	};

	gpu-thermal {
		polling-delay-passive = &lt;0x14&gt;;
		polling-delay = &lt;0x3e8&gt;;
		thermal-sensors = &lt;0x55 0x05&gt;;
	};

	npu-thermal {
		polling-delay-passive = &lt;0x14&gt;;
		polling-delay = &lt;0x3e8&gt;;
		thermal-sensors = &lt;0x55 0x06&gt;;
	};
};

timer {
	compatible = "arm,armv8-timer";
	interrupts = &lt;0x01 0x0d 0xf04 0x01 0x0e 0xf04 0x01 0x0b 0xf04 0x01 0x0a 0xf04&gt;;
};

sram@10f000 {
	compatible = "mmio-sram";
	reg = &lt;0x00 0x10f000 0x00 0x100&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x01&gt;;
	ranges = &lt;0x00 0x00 0x10f000 0x100&gt;;

	sram@0 {
		compatible = "arm,scmi-shmem";
		reg = &lt;0x00 0x100&gt;;
		phandle = &lt;0x43&gt;;
	};
};

gpu@fb000000 {
	compatible = "arm,mali-bifrost";
	reg = &lt;0x00 0xfb000000 0x00 0x200000&gt;;
	interrupts = &lt;0x00 0x5e 0x04 0x00 0x5d 0x04 0x00 0x5c 0x04&gt;;
	interrupt-names = "GPU\0MMU\0JOB";
	clocks = &lt;0x0e 0x05 0x02 0x115 0x02 0x116 0x02 0x114&gt;;
	clock-names = "clk_mali\0clk_gpu_coregroup\0clk_gpu_stacks\0clk_gpu";
	assigned-clocks = &lt;0x0e 0x05&gt;;
	assigned-clock-rates = &lt;0xbebc200&gt;;
	power-domains = &lt;0x58 0x0c&gt;;
	operating-points-v2 = &lt;0x59&gt;;
	#cooling-cells = &lt;0x02&gt;;
	dynamic-power-coefficient = &lt;0xba6&gt;;
	upthreshold = &lt;0x1e&gt;;
	downdifferential = &lt;0x0a&gt;;
	status = "okay";
	mali-supply = &lt;0x5a&gt;;
	mem-supply = &lt;0x5a&gt;;
	phandle = &lt;0x57&gt;;
};

gpu-opp-table {
	compatible = "operating-points-v2";
	nvmem-cells = &lt;0x5b 0x5c 0x21&gt;;
	nvmem-cell-names = "leakage\0opp-info\0specification_serial_number";
	rockchip,supported-hw;
	rockchip,pvtm-hw = &lt;0x04&gt;;
	rockchip,pvtm-voltage-sel-hw = &lt;0x00 0x31f 0x00 0x320 0x333 0x01 0x334 0x34c 0x02 0x34d 0x365 0x03 0x366 0x37e 0x04 0x37f 0x270f 0x05&gt;;
	rockchip,pvtm-voltage-sel = &lt;0x00 0x32f 0x00 0x330 0x343 0x01 0x344 0x35c 0x02 0x35d 0x375 0x03 0x376 0x38e 0x04 0x38f 0x270f 0x05&gt;;
	rockchip,pvtm-pvtpll;
	rockchip,pvtm-offset = &lt;0x1c&gt;;
	rockchip,pvtm-sample-time = &lt;0x44c&gt;;
	rockchip,pvtm-freq = &lt;0xc3500&gt;;
	rockchip,pvtm-volt = &lt;0xb71b0&gt;;
	rockchip,pvtm-ref-temp = &lt;0x19&gt;;
	rockchip,pvtm-temp-prop = &lt;0xffffff79 0xffffff79&gt;;
	rockchip,pvtm-thermal-zone = "gpu-thermal";
	rockchip,opp-clocks = &lt;0x02 0x114&gt;;
	rockchip,grf = &lt;0x5d&gt;;
	volt-mem-read-margin = &lt;0xd0bd8 0x01 0xbac48 0x02 0xa4cb8 0x03 0x78d98 0x04&gt;;
	low-volt-mem-read-margin = &lt;0x04&gt;;
	intermediate-threshold-freq = &lt;0x61a80&gt;;
	rockchip,temp-hysteresis = &lt;0x1388&gt;;
	rockchip,low-temp = &lt;0x2710&gt;;
	rockchip,low-temp-min-volt = &lt;0xb71b0&gt;;
	rockchip,high-temp = &lt;0x14c08&gt;;
	rockchip,high-temp-max-freq = &lt;0xc3500&gt;;
	phandle = &lt;0x59&gt;;

	opp-300000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x11e1a300&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
	};

	opp-400000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x17d78400&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
	};

	opp-500000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x1dcd6500&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
	};

	opp-600000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x23c34600&gt;;
		opp-microvolt = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
	};

	opp-700000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x29b92700&gt;;
		opp-microvolt = &lt;0xaae60 0xaae60 0xcf850 0xaae60 0xaae60 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xa7d8c 0xa7d8c 0xcf850 0xa7d8c 0xa7d8c 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
	};

	opp-800000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x2faf0800&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xb40dc 0xb40dc 0xcf850 0xb40dc 0xb40dc 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xb1008 0xb1008 0xcf850 0xb1008 0xb1008 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xadf34 0xadf34 0xcf850 0xadf34 0xadf34 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xaae60 0xaae60 0xcf850 0xaae60 0xaae60 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xaae60 0xaae60 0xcf850 0xaae60 0xaae60 0xcf850&gt;;
	};

	opp-900000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x35a4e900&gt;;
		opp-microvolt = &lt;0xc3500 0xc3500 0xcf850 0xc3500 0xc3500 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xc042c 0xc042c 0xcf850 0xc042c 0xc042c 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xbd358 0xbd358 0xcf850 0xbd358 0xbd358 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xba284 0xba284 0xcf850 0xba284 0xba284 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xb40dc 0xb40dc 0xcf850 0xb40dc 0xb40dc 0xcf850&gt;;
	};

	opp-1000000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x3b9aca00&gt;;
		opp-microvolt = &lt;0xcf850 0xcf850 0xcf850 0xcf850 0xcf850 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xcc77c 0xcc77c 0xcf850 0xcc77c 0xcc77c 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xc96a8 0xc96a8 0xcf850 0xc96a8 0xc96a8 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xc65d4 0xc65d4 0xcf850 0xc65d4 0xc65d4 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xc3500 0xc3500 0xcf850 0xc3500 0xc3500 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xc042c 0xc042c 0xcf850 0xc042c 0xc042c 0xcf850&gt;;
	};

	opp-j-m-300000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x11e1a300&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-j-m-400000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x17d78400&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-j-m-500000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x1dcd6500&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-j-m-600000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x23c34600&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-j-m-700000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x29b92700&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-j-850000000 {
		opp-supported-hw = &lt;0x04 0xffff&gt;;
		opp-hz = &lt;0x00 0x32a9f880&gt;;
		opp-microvolt = &lt;0xc042c 0xc042c 0xcf850 0xc042c 0xc042c 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xbd358 0xbd358 0xcf850 0xbd358 0xbd358 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xba284 0xba284 0xcf850 0xba284 0xba284 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-m-800000000 {
		opp-supported-hw = &lt;0x02 0xffff&gt;;
		opp-hz = &lt;0x00 0x2faf0800&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-m-900000000 {
		opp-supported-hw = &lt;0x02 0xffff&gt;;
		opp-hz = &lt;0x00 0x35a4e900&gt;;
		opp-microvolt = &lt;0xc3500 0xc3500 0xcf850 0xc3500 0xc3500 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xc042c 0xc042c 0xcf850 0xc042c 0xc042c 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xbd358 0xbd358 0xcf850 0xbd358 0xbd358 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xba284 0xba284 0xcf850 0xba284 0xba284 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-m-1000000000 {
		opp-supported-hw = &lt;0x02 0xffff&gt;;
		opp-hz = &lt;0x00 0x3b9aca00&gt;;
		opp-microvolt = &lt;0xcf850 0xcf850 0xcf850 0xcf850 0xcf850 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xcc77c 0xcc77c 0xcf850 0xcc77c 0xcc77c 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xc96a8 0xc96a8 0xcf850 0xc96a8 0xc96a8 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xc65d4 0xc65d4 0xcf850 0xc65d4 0xc65d4 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xc3500 0xc3500 0xcf850 0xc3500 0xc3500 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xc042c 0xc042c 0xcf850 0xc042c 0xc042c 0xcf850&gt;;
	};
};

usbdrd3_0 {
	compatible = "rockchip,rk3588-dwc3\0rockchip,rk3399-dwc3";
	clocks = &lt;0x02 0x1a3 0x02 0x1a2 0x02 0x1a1&gt;;
	clock-names = "ref\0suspend\0bus";
	#address-cells = &lt;0x02&gt;;
	#size-cells = &lt;0x02&gt;;
	ranges;
	status = "okay";

	usb@fc000000 {
		compatible = "snps,dwc3";
		reg = &lt;0x00 0xfc000000 0x00 0x400000&gt;;
		interrupts = &lt;0x00 0xdc 0x04&gt;;
		power-domains = &lt;0x58 0x1f&gt;;
		resets = &lt;0x02 0x2a4&gt;;
		reset-names = "usb3-otg";
		dr_mode = "otg";
		phys = &lt;0x5e 0x5f&gt;;
		phy-names = "usb2-phy\0usb3-phy";
		phy_type = "utmi_wide";
		snps,dis_enblslpm_quirk;
		snps,dis-u1-entry-quirk;
		snps,dis-u2-entry-quirk;
		snps,dis-u2-freeclk-exists-quirk;
		snps,dis-del-phy-power-chg-quirk;
		snps,dis-tx-ipgap-linecheck-quirk;
		snps,parkmode-disable-hs-quirk;
		snps,parkmode-disable-ss-quirk;
		quirk-skip-phy-init;
		status = "okay";
		extcon = &lt;0x60&gt;;
	};
};

usb@fc800000 {
	compatible = "rockchip,rk3588-ehci\0generic-ehci";
	reg = &lt;0x00 0xfc800000 0x00 0x40000&gt;;
	interrupts = &lt;0x00 0xd7 0x04&gt;;
	clocks = &lt;0x02 0x19d 0x02 0x19e 0x61 0x62&gt;;
	clock-names = "usbhost\0arbiter\0utmi\0alk_usb";
	companion = &lt;0x63&gt;;
	phys = &lt;0x64&gt;;
	phy-names = "usb2-phy";
	power-domains = &lt;0x58 0x1f&gt;;
	status = "okay";
};

usb@fc840000 {
	compatible = "rockchip,rk3588-ohci\0generic-ohci";
	reg = &lt;0x00 0xfc840000 0x00 0x40000&gt;;
	interrupts = &lt;0x00 0xd8 0x04&gt;;
	clocks = &lt;0x02 0x19d 0x02 0x19e 0x61 0x62&gt;;
	clock-names = "usbhost\0arbiter\0utmi\0alk_usb";
	phys = &lt;0x64&gt;;
	phy-names = "usb2-phy";
	power-domains = &lt;0x58 0x1f&gt;;
	status = "okay";
	phandle = &lt;0x63&gt;;
};

usb@fc880000 {
	compatible = "rockchip,rk3588-ehci\0generic-ehci";
	reg = &lt;0x00 0xfc880000 0x00 0x40000&gt;;
	interrupts = &lt;0x00 0xda 0x04&gt;;
	clocks = &lt;0x02 0x19f 0x02 0x1a0 0x65 0x62&gt;;
	clock-names = "usbhost\0arbiter\0utmi\0alk_usb";
	companion = &lt;0x66&gt;;
	phys = &lt;0x67&gt;;
	phy-names = "usb2-phy";
	power-domains = &lt;0x58 0x1f&gt;;
	status = "okay";
};

usb@fc8c0000 {
	compatible = "rockchip,rk3588-ohci\0generic-ohci";
	reg = &lt;0x00 0xfc8c0000 0x00 0x40000&gt;;
	interrupts = &lt;0x00 0xdb 0x04&gt;;
	clocks = &lt;0x02 0x19f 0x02 0x1a0 0x65 0x62&gt;;
	clock-names = "usbhost\0arbiter\0utmi\0alk_usb";
	phys = &lt;0x67&gt;;
	phy-names = "usb2-phy";
	power-domains = &lt;0x58 0x1f&gt;;
	status = "okay";
	phandle = &lt;0x66&gt;;
};

iommu@fc900000 {
	compatible = "arm,smmu-v3";
	reg = &lt;0x00 0xfc900000 0x00 0x200000&gt;;
	interrupts = &lt;0x00 0x171 0x04 0x00 0x173 0x04 0x00 0x176 0x04 0x00 0x16f 0x04&gt;;
	interrupt-names = "eventq\0gerror\0priq\0cmdq-sync";
	#iommu-cells = &lt;0x01&gt;;
	status = "disabled";
};

iommu@fcb00000 {
	compatible = "arm,smmu-v3";
	reg = &lt;0x00 0xfcb00000 0x00 0x200000&gt;;
	interrupts = &lt;0x00 0x17d 0x04 0x00 0x17f 0x04 0x00 0x182 0x04 0x00 0x17b 0x04&gt;;
	interrupt-names = "eventq\0gerror\0priq\0cmdq-sync";
	#iommu-cells = &lt;0x01&gt;;
	status = "disabled";
};

usbhost3_0 {
	compatible = "rockchip,rk3588-dwc3\0rockchip,rk3399-dwc3";
	clocks = &lt;0x02 0x179 0x02 0x178 0x02 0x177 0x02 0x17a 0x02 0x166 0x02 0x181&gt;;
	clock-names = "ref\0suspend\0bus\0utmi\0php\0pipe";
	#address-cells = &lt;0x02&gt;;
	#size-cells = &lt;0x02&gt;;
	ranges;
	status = "disabled";

	usb@fcd00000 {
		compatible = "snps,dwc3";
		reg = &lt;0x00 0xfcd00000 0x00 0x400000&gt;;
		interrupts = &lt;0x00 0xde 0x04&gt;;
		resets = &lt;0x02 0x237&gt;;
		reset-names = "usb3-host";
		dr_mode = "host";
		phys = &lt;0x68 0x04&gt;;
		phy-names = "usb3-phy";
		phy_type = "utmi_wide";
		snps,dis_enblslpm_quirk;
		snps,dis-u2-freeclk-exists-quirk;
		snps,dis-del-phy-power-chg-quirk;
		snps,dis-tx-ipgap-linecheck-quirk;
		snps,dis_rxdet_inp3_quirk;
		snps,parkmode-disable-hs-quirk;
		snps,parkmode-disable-ss-quirk;
		status = "disabled";
	};
};

syscon@fd588000 {
	compatible = "rockchip,rk3588-pmu0-grf\0syscon\0simple-mfd";
	reg = &lt;0x00 0xfd588000 0x00 0x2000&gt;;

	reboot-mode {
		compatible = "syscon-reboot-mode";
		offset = &lt;0x80&gt;;
		mode-bootloader = &lt;0x5242c301&gt;;
		mode-charge = &lt;0x5242c30b&gt;;
		mode-fastboot = &lt;0x5242c309&gt;;
		mode-loader = &lt;0x5242c301&gt;;
		mode-normal = &lt;0x5242c300&gt;;
		mode-recovery = &lt;0x5242c303&gt;;
		mode-ums = &lt;0x5242c30c&gt;;
		mode-panic = &lt;0x5242c307&gt;;
		mode-watchdog = &lt;0x5242c308&gt;;
		mode-quiescent = &lt;0x5242c30e&gt;;
		mode-winusb = &lt;0x5242c30f&gt;;
	};
};

syscon@fd58a000 {
	compatible = "rockchip,rk3588-pmu1-grf\0syscon";
	reg = &lt;0x00 0xfd58a000 0x00 0x2000&gt;;
	phandle = &lt;0xfb&gt;;
};

syscon@fd58c000 {
	compatible = "rockchip,rk3588-sys-grf\0syscon\0simple-mfd";
	reg = &lt;0x00 0xfd58c000 0x00 0x1000&gt;;
	phandle = &lt;0xbf&gt;;

	rgb {
		compatible = "rockchip,rk3588-rgb";
		pinctrl-names = "default";
		pinctrl-0 = &lt;0x69&gt;;
		status = "disabled";

		ports {
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;

			port@0 {
				reg = &lt;0x00&gt;;
				#address-cells = &lt;0x01&gt;;
				#size-cells = &lt;0x00&gt;;

				endpoint@2 {
					reg = &lt;0x02&gt;;
					remote-endpoint = &lt;0x3a&gt;;
					status = "disabled";
					phandle = &lt;0xe7&gt;;
				};
			};
		};
	};
};

syscon@fd590000 {
	compatible = "rockchip,rk3588-bigcore0-grf\0syscon";
	reg = &lt;0x00 0xfd590000 0x00 0x100&gt;;
	phandle = &lt;0x26&gt;;
};

syscon@fd592000 {
	compatible = "rockchip,rk3588-bigcore1-grf\0syscon";
	reg = &lt;0x00 0xfd592000 0x00 0x100&gt;;
	phandle = &lt;0x29&gt;;
};

syscon@fd594000 {
	compatible = "rockchip,rk3588-litcore-grf\0syscon";
	reg = &lt;0x00 0xfd594000 0x00 0x100&gt;;
	phandle = &lt;0x22&gt;;
};

syscon@fd598000 {
	compatible = "rockchip,rk3588-dsu-grf\0syscon";
	reg = &lt;0x00 0xfd598000 0x00 0x100&gt;;
	phandle = &lt;0x23&gt;;
};

syscon@fd5a0000 {
	compatible = "rockchip,rk3588-gpu-grf\0syscon";
	reg = &lt;0x00 0xfd5a0000 0x00 0x100&gt;;
	phandle = &lt;0x5d&gt;;
};

syscon@fd5a2000 {
	compatible = "rockchip,rk3588-npu-grf\0syscon";
	reg = &lt;0x00 0xfd5a2000 0x00 0x100&gt;;
	phandle = &lt;0xac&gt;;
};

syscon@fd5a4000 {
	compatible = "rockchip,rk3588-vop-grf\0syscon";
	reg = &lt;0x00 0xfd5a4000 0x00 0x2000&gt;;
	phandle = &lt;0xce&gt;;
};

syscon@fd5a6000 {
	compatible = "rockchip,rk3588-vo-grf\0syscon";
	reg = &lt;0x00 0xfd5a6000 0x00 0x2000&gt;;
	clocks = &lt;0x6a&gt;;
	phandle = &lt;0xec&gt;;
};

syscon@fd5a8000 {
	compatible = "rockchip,rk3588-vo-grf\0syscon";
	reg = &lt;0x00 0xfd5a8000 0x00 0x100&gt;;
	clocks = &lt;0x6b&gt;;
	phandle = &lt;0xcf&gt;;
};

syscon@fd5ac000 {
	compatible = "rockchip,rk3588-usb-grf\0syscon";
	reg = &lt;0x00 0xfd5ac000 0x00 0x4000&gt;;
	phandle = &lt;0x6c&gt;;
};

syscon@fd5b0000 {
	compatible = "rockchip,rk3588-php-grf\0syscon";
	reg = &lt;0x00 0xfd5b0000 0x00 0x1000&gt;;
	phandle = &lt;0x6f&gt;;
};

syscon@fd5b4000 {
	compatible = "rockchip,mipi-dphy-grf\0syscon";
	reg = &lt;0x00 0xfd5b4000 0x00 0x1000&gt;;
	phandle = &lt;0x17f&gt;;
};

syscon@fd5b5000 {
	compatible = "rockchip,mipi-dphy-grf\0syscon";
	reg = &lt;0x00 0xfd5b5000 0x00 0x1000&gt;;
	phandle = &lt;0x180&gt;;
};

syscon@fd5bc000 {
	compatible = "rockchip,pipe-phy-grf\0syscon";
	reg = &lt;0x00 0xfd5bc000 0x00 0x100&gt;;
	phandle = &lt;0x181&gt;;
};

syscon@fd5c4000 {
	compatible = "rockchip,pipe-phy-grf\0syscon";
	reg = &lt;0x00 0xfd5c4000 0x00 0x100&gt;;
	phandle = &lt;0x182&gt;;
};

syscon@fd5c8000 {
	compatible = "rockchip,rk3588-usbdpphy-grf\0syscon";
	reg = &lt;0x00 0xfd5c8000 0x00 0x4000&gt;;
	phandle = &lt;0x17c&gt;;
};

syscon@fd5d0000 {
	compatible = "rockchip,rk3588-usb2phy-grf\0syscon\0simple-mfd";
	reg = &lt;0x00 0xfd5d0000 0x00 0x4000&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x01&gt;;
	phandle = &lt;0x17b&gt;;

	usb2-phy@0 {
		compatible = "rockchip,rk3588-usb2phy";
		reg = &lt;0x00 0x10&gt;;
		interrupts = &lt;0x00 0x189 0x04&gt;;
		resets = &lt;0x02 0xc0047 0x02 0x488&gt;;
		reset-names = "phy\0apb";
		clocks = &lt;0x02 0x2b5&gt;;
		clock-names = "phyclk";
		clock-output-names = "usb480m_phy0";
		#clock-cells = &lt;0x00&gt;;
		rockchip,usbctrl-grf = &lt;0x6c&gt;;
		status = "okay";
		phandle = &lt;0x60&gt;;

		otg-port {
			#phy-cells = &lt;0x00&gt;;
			status = "okay";
			phy-supply = &lt;0x6d&gt;;
			phandle = &lt;0x5e&gt;;
		};
	};
};

syscon@fd5d8000 {
	compatible = "rockchip,rk3588-usb2phy-grf\0syscon\0simple-mfd";
	reg = &lt;0x00 0xfd5d8000 0x00 0x4000&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x01&gt;;

	usb2-phy@8000 {
		compatible = "rockchip,rk3588-usb2phy";
		reg = &lt;0x8000 0x10&gt;;
		interrupts = &lt;0x00 0x187 0x04&gt;;
		resets = &lt;0x02 0xc0049 0x02 0x48a&gt;;
		reset-names = "phy\0apb";
		clocks = &lt;0x02 0x2b5&gt;;
		clock-names = "phyclk";
		clock-output-names = "usb480m_phy2";
		#clock-cells = &lt;0x00&gt;;
		status = "okay";
		phandle = &lt;0x61&gt;;

		host-port {
			#phy-cells = &lt;0x00&gt;;
			status = "okay";
			phy-supply = &lt;0x6e&gt;;
			phandle = &lt;0x64&gt;;
		};
	};
};

syscon@fd5dc000 {
	compatible = "rockchip,rk3588-usb2phy-grf\0syscon\0simple-mfd";
	reg = &lt;0x00 0xfd5dc000 0x00 0x4000&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x01&gt;;

	usb2-phy@c000 {
		compatible = "rockchip,rk3588-usb2phy";
		reg = &lt;0xc000 0x10&gt;;
		interrupts = &lt;0x00 0x188 0x04&gt;;
		resets = &lt;0x02 0xc004a 0x02 0x48b&gt;;
		reset-names = "phy\0apb";
		clocks = &lt;0x02 0x2b5&gt;;
		clock-names = "phyclk";
		clock-output-names = "usb480m_phy3";
		#clock-cells = &lt;0x00&gt;;
		status = "okay";
		phandle = &lt;0x65&gt;;

		host-port {
			#phy-cells = &lt;0x00&gt;;
			status = "okay";
			phy-supply = &lt;0x6e&gt;;
			phandle = &lt;0x67&gt;;
		};
	};
};

syscon@fd5e0000 {
	compatible = "rockchip,rk3588-hdptxphy-grf\0syscon";
	reg = &lt;0x00 0xfd5e0000 0x00 0x100&gt;;
	phandle = &lt;0x17a&gt;;
};

syscon@fd5e8000 {
	compatible = "rockchip,mipi-dcphy-grf\0syscon";
	reg = &lt;0x00 0xfd5e8000 0x00 0x4000&gt;;
	phandle = &lt;0x17d&gt;;
};

syscon@fd5ec000 {
	compatible = "rockchip,mipi-dcphy-grf\0syscon";
	reg = &lt;0x00 0xfd5ec000 0x00 0x4000&gt;;
	phandle = &lt;0x17e&gt;;
};

syscon@fd5f0000 {
	compatible = "rockchip,rk3588-ioc\0syscon";
	reg = &lt;0x00 0xfd5f0000 0x00 0x10000&gt;;
	phandle = &lt;0x183&gt;;
};

clock-controller@fd7c0000 {
	compatible = "rockchip,rk3588-cru";
	rockchip,grf = &lt;0x6f&gt;;
	reg = &lt;0x00 0xfd7c0000 0x00 0x5c000&gt;;
	#clock-cells = &lt;0x01&gt;;
	#reset-cells = &lt;0x01&gt;;
	assigned-clocks = &lt;0x02 0x09 0x02 0x05 0x02 0x08 0x02 0x07 0x02 0xd8 0x02 0xda 0x02 0xd9 0x02 0x10e 0x02 0x10f 0x02 0x110 0x02 0x299 0x02 0x29a 0x02 0x7b 0x02 0xec 0x02 0x114 0x02 0x208 0x02 0x20e 0x02 0x21f 0x02 0x77&gt;;
	assigned-clock-rates = &lt;0x4190ab00 0x2ee00000 0x32a9f880 0x46cf7100 0x29d7ab80 0x17d78400 0x1dcd6500 0x2cb41780 0x5f5e100 0x17d78400 0x5f5e100 0xbebc200 0x165a0bc0 0x8f0d180 0xbebc200 0xb71b00 0xb71b00 0x5e69ec0 0x1312d00&gt;;
	phandle = &lt;0x02&gt;;
};

i2c@fd880000 {
	compatible = "rockchip,rk3588-i2c\0rockchip,rk3399-i2c";
	reg = &lt;0x00 0xfd880000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x287 0x02 0x286&gt;;
	clock-names = "i2c\0pclk";
	interrupts = &lt;0x00 0x13d 0x04&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x70&gt;;
	resets = &lt;0x02 0xc0022 0x02 0xc0021&gt;;
	reset-names = "i2c\0apb";
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	status = "okay";

	rk8602@42 {
		compatible = "rockchip,rk8602";
		reg = &lt;0x42&gt;;
		vin-supply = &lt;0x71&gt;;
		regulator-compatible = "rk860x-reg";
		regulator-name = "vdd_cpu_big0_s0";
		regulator-min-microvolt = &lt;0x86470&gt;;
		regulator-max-microvolt = &lt;0x100590&gt;;
		regulator-ramp-delay = &lt;0x8fc&gt;;
		rockchip,suspend-voltage-selector = &lt;0x01&gt;;
		regulator-boot-on;
		regulator-always-on;
		phandle = &lt;0x18&gt;;

		regulator-state-mem {
			regulator-off-in-suspend;
		};
	};

	rk8603@43 {
		compatible = "rockchip,rk8603";
		reg = &lt;0x43&gt;;
		vin-supply = &lt;0x71&gt;;
		regulator-compatible = "rk860x-reg";
		regulator-name = "vdd_cpu_big1_s0";
		regulator-min-microvolt = &lt;0x86470&gt;;
		regulator-max-microvolt = &lt;0x100590&gt;;
		regulator-ramp-delay = &lt;0x8fc&gt;;
		rockchip,suspend-voltage-selector = &lt;0x01&gt;;
		regulator-boot-on;
		regulator-always-on;
		phandle = &lt;0x1c&gt;;

		regulator-state-mem {
			regulator-off-in-suspend;
		};
	};
};

serial@fd890000 {
	compatible = "rockchip,rk3588-uart\0snps,dw-apb-uart";
	reg = &lt;0x00 0xfd890000 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x14b 0x04&gt;;
	clocks = &lt;0x02 0x2ae 0x02 0x2af&gt;;
	clock-names = "baudclk\0apb_pclk";
	reg-shift = &lt;0x02&gt;;
	reg-io-width = &lt;0x04&gt;;
	dmas = &lt;0x72 0x06 0x72 0x07&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x73&gt;;
	status = "okay";
};

pwm@fd8b0000 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfd8b0000 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x158 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x74&gt;;
	clocks = &lt;0x02 0x2a5 0x02 0x2a4&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@fd8b0010 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfd8b0010 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x158 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x75&gt;;
	clocks = &lt;0x02 0x2a5 0x02 0x2a4&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@fd8b0020 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfd8b0020 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x158 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x76&gt;;
	clocks = &lt;0x02 0x2a5 0x02 0x2a4&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@fd8b0030 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfd8b0030 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x158 0x04 0x00 0x159 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x77&gt;;
	clocks = &lt;0x02 0x2a5 0x02 0x2a4&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

power-management@fd8d8000 {
	compatible = "rockchip,rk3588-pmu\0syscon\0simple-mfd";
	reg = &lt;0x00 0xfd8d8000 0x00 0x400&gt;;
	phandle = &lt;0xd0&gt;;

	power-controller {
		compatible = "rockchip,rk3588-power-controller";
		#power-domain-cells = &lt;0x01&gt;;
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;
		status = "okay";
		phandle = &lt;0x58&gt;;

		power-domain@8 {
			reg = &lt;0x08&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;

			power-domain@9 {
				reg = &lt;0x09&gt;;
				#address-cells = &lt;0x01&gt;;
				#size-cells = &lt;0x00&gt;;
				clocks = &lt;0x02 0x12f 0x02 0x131 0x02 0x130 0x02 0x126&gt;;
				pm_qos = &lt;0x78 0x79 0x7a&gt;;

				power-domain@10 {
					reg = &lt;0x0a&gt;;
					clocks = &lt;0x02 0x12f 0x02 0x131 0x02 0x130&gt;;
					pm_qos = &lt;0x7b&gt;;
				};

				power-domain@11 {
					reg = &lt;0x0b&gt;;
					clocks = &lt;0x02 0x12f 0x02 0x131 0x02 0x130&gt;;
					pm_qos = &lt;0x7c&gt;;
				};
			};
		};

		power-domain@12 {
			reg = &lt;0x0c&gt;;
			clocks = &lt;0x02 0x114 0x02 0x115 0x02 0x116&gt;;
			pm_qos = &lt;0x7d 0x7e 0x7f 0x80&gt;;
		};

		power-domain@13 {
			reg = &lt;0x0d&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;

			power-domain@14 {
				reg = &lt;0x0e&gt;;
				clocks = &lt;0x02 0x18f 0x02 0x1be 0x02 0x1bc 0x02 0x190 0x02 0x18e&gt;;
				pm_qos = &lt;0x81&gt;;
			};

			power-domain@15 {
				reg = &lt;0x0f&gt;;
				clocks = &lt;0x02 0x194 0x02 0x1be 0x02 0x1bc 0x02 0x195&gt;;
				pm_qos = &lt;0x82&gt;;
			};

			power-domain@16 {
				reg = &lt;0x10&gt;;
				#address-cells = &lt;0x01&gt;;
				#size-cells = &lt;0x00&gt;;
				clocks = &lt;0x02 0x1c4 0x02 0x1c5&gt;;
				pm_qos = &lt;0x83 0x84 0x85&gt;;

				power-domain@17 {
					reg = &lt;0x11&gt;;
					clocks = &lt;0x02 0x1c9 0x02 0x1c4 0x02 0x1c5 0x02 0x1ca&gt;;
					pm_qos = &lt;0x86 0x87 0x88&gt;;
				};
			};
		};

		power-domain@21 {
			reg = &lt;0x15&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;
			clocks = &lt;0x02 0x1be 0x02 0x1bd 0x02 0x1bc 0x02 0x1bf 0x02 0x1aa 0x02 0x1a9 0x02 0x1ac 0x02 0x1ad 0x02 0x1ae 0x02 0x1af 0x02 0x1b0 0x02 0x1b1 0x02 0x1b2 0x02 0x1b3 0x02 0x1b4 0x02 0x1b5 0x02 0x1b7 0x02 0x1b6&gt;;
			pm_qos = &lt;0x89 0x8a 0x8b 0x8c 0x8d 0x8e 0x8f 0x90&gt;;

			power-domain@23 {
				reg = &lt;0x17&gt;;
				clocks = &lt;0x02 0x4b 0x02 0x49 0x02 0x1be&gt;;
				pm_qos = &lt;0x91&gt;;
			};

			power-domain@14 {
				reg = &lt;0x0e&gt;;
				clocks = &lt;0x02 0x18f 0x02 0x1be 0x02 0x1bc 0x02 0x190&gt;;
				pm_qos = &lt;0x81&gt;;
			};

			power-domain@15 {
				reg = &lt;0x0f&gt;;
				clocks = &lt;0x02 0x194 0x02 0x1be 0x02 0x1bc&gt;;
				pm_qos = &lt;0x82&gt;;
			};

			power-domain@22 {
				reg = &lt;0x16&gt;;
				clocks = &lt;0x02 0x1ba 0x02 0x1b9&gt;;
				pm_qos = &lt;0x92&gt;;
			};
		};

		power-domain@24 {
			reg = &lt;0x18&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;
			clocks = &lt;0x02 0x26e 0x02 0x26d 0x02 0x270&gt;;
			pm_qos = &lt;0x93 0x94&gt;;

			power-domain@25 {
				reg = &lt;0x19&gt;;
				clocks = &lt;0x02 0x1f6 0x02 0x1f7 0x02 0x1f5 0x02 0x1f3 0x02 0x1ee 0x02 0x1ed 0x02 0x26d&gt;;
				pm_qos = &lt;0x95&gt;;
			};
		};

		power-domain@26 {
			reg = &lt;0x1a&gt;;
			clocks = &lt;0x02 0x22e 0x02 0x22f 0x02 0x22d 0x02 0x218 0x02 0x217 0x02 0x22b 0x02 0x264&gt;;
			pm_qos = &lt;0x96 0x97&gt;;
		};

		power-domain@27 {
			reg = &lt;0x1b&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;
			clocks = &lt;0x02 0x1e1 0x02 0x1e2 0x02 0x1df 0x02 0x1de 0x02 0x1e5 0x02 0x1e4&gt;;
			pm_qos = &lt;0x98 0x99 0x9a 0x9b&gt;;

			power-domain@28 {
				reg = &lt;0x1c&gt;;
				clocks = &lt;0x02 0x121 0x02 0x120 0x02 0x1e1 0x02 0x1e2&gt;;
				pm_qos = &lt;0x9c 0x9d&gt;;
			};

			power-domain@29 {
				reg = &lt;0x1d&gt;;
				clocks = &lt;0x02 0x1d6 0x02 0x1d5 0x02 0x1d9 0x02 0x1d8 0x02 0x1e2&gt;;
				pm_qos = &lt;0x9e 0x9f&gt;;
			};
		};

		power-domain@30 {
			reg = &lt;0x1e&gt;;
			clocks = &lt;0x02 0x189 0x02 0x18a&gt;;
			pm_qos = &lt;0xa0&gt;;
		};

		power-domain@31 {
			reg = &lt;0x1f&gt;;
			clocks = &lt;0x02 0x166 0x02 0x1a1 0x02 0x1a4 0x02 0x19d 0x02 0x19e 0x02 0x19f 0x02 0x1a0&gt;;
			pm_qos = &lt;0xa1 0xa2 0xa3 0xa4&gt;;
		};

		power-domain@33 {
			reg = &lt;0x21&gt;;
			clocks = &lt;0x02 0x166 0x02 0x169 0x02 0x16a&gt;;
		};

		power-domain@34 {
			reg = &lt;0x22&gt;;
			clocks = &lt;0x02 0x166 0x02 0x169 0x02 0x16a&gt;;
		};

		power-domain@37 {
			reg = &lt;0x25&gt;;
			clocks = &lt;0x02 0x199 0x02 0x140&gt;;
			pm_qos = &lt;0xa5&gt;;
		};

		power-domain@38 {
			reg = &lt;0x26&gt;;
			clocks = &lt;0x02 0x3c 0x02 0x3d&gt;;
		};

		power-domain@40 {
			reg = &lt;0x28&gt;;
			pm_qos = &lt;0xa6&gt;;
		};
	};
};

pvtm@fda40000 {
	compatible = "rockchip,rk3588-bigcore0-pvtm";
	reg = &lt;0x00 0xfda40000 0x00 0x100&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;

	pvtm@0 {
		reg = &lt;0x00&gt;;
		clocks = &lt;0x02 0x2c6 0x02 0x15&gt;;
		clock-names = "clk\0pclk";
	};
};

pvtm@fda50000 {
	compatible = "rockchip,rk3588-bigcore1-pvtm";
	reg = &lt;0x00 0xfda50000 0x00 0x100&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;

	pvtm@1 {
		reg = &lt;0x01&gt;;
		clocks = &lt;0x02 0x2c8 0x02 0x17&gt;;
		clock-names = "clk\0pclk";
	};
};

pvtm@fda60000 {
	compatible = "rockchip,rk3588-litcore-pvtm";
	reg = &lt;0x00 0xfda60000 0x00 0x100&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;

	pvtm@2 {
		reg = &lt;0x02&gt;;
		clocks = &lt;0x02 0x2ca 0x02 0x1b&gt;;
		clock-names = "clk\0pclk";
	};
};

pvtm@fdaf0000 {
	compatible = "rockchip,rk3588-npu-pvtm";
	reg = &lt;0x00 0xfdaf0000 0x00 0x100&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;

	pvtm@3 {
		reg = &lt;0x03&gt;;
		clocks = &lt;0x02 0x12b 0x02 0x129&gt;;
		clock-names = "clk\0pclk";
		resets = &lt;0x02 0x1de 0x02 0x1dc&gt;;
		reset-names = "rts\0rst-p";
	};
};

pvtm@fdb30000 {
	compatible = "rockchip,rk3588-gpu-pvtm";
	reg = &lt;0x00 0xfdb30000 0x00 0x100&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;

	pvtm@4 {
		reg = &lt;0x04&gt;;
		clocks = &lt;0x02 0x118&gt;;
		clock-names = "clk";
		resets = &lt;0x02 0x430 0x02 0x42f&gt;;
		reset-names = "rts\0rst-p";
	};
};

npu@fdab0000 {
	compatible = "rockchip,rk3588-rknpu";
	reg = &lt;0x00 0xfdab0000 0x00 0x10000 0x00 0xfdac0000 0x00 0x10000 0x00 0xfdad0000 0x00 0x10000&gt;;
	interrupts = &lt;0x00 0x6e 0x04 0x00 0x6f 0x04 0x00 0x70 0x04&gt;;
	interrupt-names = "npu0_irq\0npu1_irq\0npu2_irq";
	clocks = &lt;0x0e 0x06 0x02 0x12d 0x02 0x122 0x02 0x124 0x02 0x12e 0x02 0x123 0x02 0x125 0x02 0x131&gt;;
	clock-names = "clk_npu\0aclk0\0aclk1\0aclk2\0hclk0\0hclk1\0hclk2\0pclk";
	assigned-clocks = &lt;0x0e 0x06&gt;;
	assigned-clock-rates = &lt;0xbebc200&gt;;
	resets = &lt;0x02 0x1e6 0x02 0x1b0 0x02 0x1c0 0x02 0x1e8 0x02 0x1b2 0x02 0x1c2&gt;;
	reset-names = "srst_a0\0srst_a1\0srst_a2\0srst_h0\0srst_h1\0srst_h2";
	power-domains = &lt;0x58 0x09 0x58 0x0a 0x58 0x0b&gt;;
	power-domain-names = "npu0\0npu1\0npu2";
	operating-points-v2 = &lt;0xa7&gt;;
	iommus = &lt;0xa8&gt;;
	status = "okay";
	rknpu-supply = &lt;0xa9&gt;;
	mem-supply = &lt;0xa9&gt;;
};

npu-opp-table {
	compatible = "operating-points-v2";
	nvmem-cells = &lt;0xaa 0xab 0x21&gt;;
	nvmem-cell-names = "leakage\0opp-info\0specification_serial_number";
	rockchip,supported-hw;
	rockchip,pvtm-hw = &lt;0x06&gt;;
	rockchip,pvtm-voltage-sel-hw = &lt;0x00 0x31f 0x00 0x320 0x333 0x01 0x334 0x34c 0x02 0x34d 0x365 0x03 0x366 0x37e 0x04 0x37f 0x270f 0x05&gt;;
	rockchip,pvtm-voltage-sel = &lt;0x00 0x32f 0x00 0x330 0x343 0x01 0x344 0x35c 0x02 0x35d 0x375 0x03 0x376 0x38e 0x04 0x38f 0x270f 0x05&gt;;
	rockchip,pvtm-pvtpll;
	rockchip,pvtm-offset = &lt;0x50&gt;;
	rockchip,pvtm-sample-time = &lt;0x44c&gt;;
	rockchip,pvtm-freq = &lt;0xc3500&gt;;
	rockchip,pvtm-volt = &lt;0xb71b0&gt;;
	rockchip,pvtm-ref-temp = &lt;0x19&gt;;
	rockchip,pvtm-temp-prop = &lt;0xffffff8f 0xffffff8f&gt;;
	rockchip,pvtm-thermal-zone = "npu-thermal";
	rockchip,opp-clocks = &lt;0x02 0x12a 0x02 0x12f&gt;;
	rockchip,grf = &lt;0xac&gt;;
	volt-mem-read-margin = &lt;0xd0bd8 0x01 0xbac48 0x02 0xa4cb8 0x03 0x78d98 0x04&gt;;
	low-volt-mem-read-margin = &lt;0x04&gt;;
	intermediate-threshold-freq = &lt;0x7a120&gt;;
	rockchip,init-freq = &lt;0xf4240&gt;;
	rockchip,temp-hysteresis = &lt;0x1388&gt;;
	rockchip,low-temp = &lt;0x2710&gt;;
	rockchip,low-temp-min-volt = &lt;0xb71b0&gt;;
	rockchip,high-temp = &lt;0x14c08&gt;;
	rockchip,high-temp-max-freq = &lt;0xc3500&gt;;
	phandle = &lt;0xa7&gt;;

	opp-300000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x11e1a300&gt;;
		opp-microvolt = &lt;0xaae60 0xaae60 0xcf850 0xaae60 0xaae60 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xa7d8c 0xa7d8c 0xcf850 0xa7d8c 0xa7d8c 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
	};

	opp-400000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x17d78400&gt;;
		opp-microvolt = &lt;0xaae60 0xaae60 0xcf850 0xaae60 0xaae60 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xa7d8c 0xa7d8c 0xcf850 0xa7d8c 0xa7d8c 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
	};

	opp-500000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x1dcd6500&gt;;
		opp-microvolt = &lt;0xaae60 0xaae60 0xcf850 0xaae60 0xaae60 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xa7d8c 0xa7d8c 0xcf850 0xa7d8c 0xa7d8c 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
	};

	opp-600000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x23c34600&gt;;
		opp-microvolt = &lt;0xaae60 0xaae60 0xcf850 0xaae60 0xaae60 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xa7d8c 0xa7d8c 0xcf850 0xa7d8c 0xa7d8c 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
	};

	opp-700000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x29b92700&gt;;
		opp-microvolt = &lt;0xaae60 0xaae60 0xcf850 0xaae60 0xaae60 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xa7d8c 0xa7d8c 0xcf850 0xa7d8c 0xa7d8c 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xa4cb8 0xa4cb8 0xcf850 0xa4cb8 0xa4cb8 0xcf850&gt;;
	};

	opp-800000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x2faf0800&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xb40dc 0xb40dc 0xcf850 0xb40dc 0xb40dc 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xb1008 0xb1008 0xcf850 0xb1008 0xb1008 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xadf34 0xadf34 0xcf850 0xadf34 0xadf34 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xaae60 0xaae60 0xcf850 0xaae60 0xaae60 0xcf850&gt;;
	};

	opp-900000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x35a4e900&gt;;
		opp-microvolt = &lt;0xc3500 0xc3500 0xcf850 0xc3500 0xc3500 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xc042c 0xc042c 0xcf850 0xc042c 0xc042c 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xbd358 0xbd358 0xcf850 0xbd358 0xbd358 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xba284 0xba284 0xcf850 0xba284 0xba284 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xb40dc 0xb40dc 0xcf850 0xb40dc 0xb40dc 0xcf850&gt;;
	};

	opp-1000000000 {
		opp-supported-hw = &lt;0xf9 0xffff&gt;;
		opp-hz = &lt;0x00 0x3b9aca00&gt;;
		opp-microvolt = &lt;0xcf850 0xcf850 0xcf850 0xcf850 0xcf850 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xcc77c 0xcc77c 0xcf850 0xcc77c 0xcc77c 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xc96a8 0xc96a8 0xcf850 0xc96a8 0xc96a8 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xc65d4 0xc65d4 0xcf850 0xc65d4 0xc65d4 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xc3500 0xc3500 0xcf850 0xc3500 0xc3500 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xc042c 0xc042c 0xcf850 0xc042c 0xc042c 0xcf850&gt;;
	};

	opp-j-m-300000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x11e1a300&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-j-m-400000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x17d78400&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-j-m-500000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x1dcd6500&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-j-m-600000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x23c34600&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-j-m-700000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x29b92700&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-j-m-800000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x2faf0800&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};

	opp-j-m-950000000 {
		opp-supported-hw = &lt;0x06 0xffff&gt;;
		opp-hz = &lt;0x00 0x389fd980&gt;;
		opp-microvolt = &lt;0xcc77c 0xcc77c 0xcf850 0xcc77c 0xcc77c 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xc96a8 0xc96a8 0xcf850 0xc96a8 0xc96a8 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xc65d4 0xc65d4 0xcf850 0xc65d4 0xc65d4 0xcf850&gt;;
		opp-microvolt-L3 = &lt;0xc3500 0xc3500 0xcf850 0xc3500 0xc3500 0xcf850&gt;;
		opp-microvolt-L4 = &lt;0xc042c 0xc042c 0xcf850 0xc042c 0xc042c 0xcf850&gt;;
		opp-microvolt-L5 = &lt;0xbd358 0xbd358 0xcf850 0xbd358 0xbd358 0xcf850&gt;;
	};
};

iommu@fdab9000 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdab9000 0x00 0x100 0x00 0xfdaba000 0x00 0x100 0x00 0xfdaca000 0x00 0x100 0x00 0xfdada000 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x6e 0x04 0x00 0x6f 0x04 0x00 0x70 0x04&gt;;
	interrupt-names = "npu0_mmu\0npu1_mmu\0npu2_mmu";
	clocks = &lt;0x02 0x12d 0x02 0x122 0x02 0x124 0x02 0x12e 0x02 0x123 0x02 0x125&gt;;
	clock-names = "aclk0\0aclk1\0aclk2\0iface0\0iface1\0iface2";
	#iommu-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0xa8&gt;;
};

vepu@fdb50000 {
	compatible = "rockchip,vpu-encoder-v2";
	reg = &lt;0x00 0xfdb50000 0x00 0x400&gt;;
	interrupts = &lt;0x00 0x78 0x04&gt;;
	interrupt-names = "irq_vepu";
	clocks = &lt;0x02 0x1c0 0x02 0x1c1&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec";
	rockchip,normal-rates = &lt;0x2367b880 0x00&gt;;
	assigned-clocks = &lt;0x02 0x1c0&gt;;
	assigned-clock-rates = &lt;0x2367b880&gt;;
	resets = &lt;0x02 0x2c8 0x02 0x2c9&gt;;
	reset-names = "shared_video_a\0shared_video_h";
	rockchip,skip-pmu-idle-request;
	rockchip,disable-auto-freq;
	iommus = &lt;0xad&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,taskqueue-node = &lt;0x00&gt;;
	rockchip,resetgroup-node = &lt;0x00&gt;;
	power-domains = &lt;0x58 0x15&gt;;
	status = "okay";
};

vdpu@fdb50400 {
	compatible = "rockchip,vpu-decoder-v2";
	reg = &lt;0x00 0xfdb50400 0x00 0x400&gt;;
	interrupts = &lt;0x00 0x77 0x04&gt;;
	interrupt-names = "irq_vdpu";
	clocks = &lt;0x02 0x1c0 0x02 0x1c1&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec";
	rockchip,normal-rates = &lt;0x2367b880 0x00&gt;;
	assigned-clocks = &lt;0x02 0x1c0&gt;;
	assigned-clock-rates = &lt;0x2367b880&gt;;
	resets = &lt;0x02 0x2c8 0x02 0x2c9&gt;;
	reset-names = "shared_video_a\0shared_video_h";
	rockchip,skip-pmu-idle-request;
	rockchip,disable-auto-freq;
	iommus = &lt;0xad&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,taskqueue-node = &lt;0x00&gt;;
	rockchip,resetgroup-node = &lt;0x00&gt;;
	power-domains = &lt;0x58 0x15&gt;;
	status = "okay";
};

iommu@fdb50800 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdb50800 0x00 0x40&gt;;
	interrupts = &lt;0x00 0x76 0x04&gt;;
	interrupt-names = "irq_vdpu_mmu";
	clocks = &lt;0x02 0x1c0 0x02 0x1c1&gt;;
	clock-names = "aclk\0iface";
	power-domains = &lt;0x58 0x15&gt;;
	#iommu-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0xad&gt;;
};

avsd-plus@fdb51000 {
	compatible = "rockchip,avs-plus-decoder";
	reg = &lt;0x00 0xfdb51000 0x00 0x200&gt;;
	interrupts = &lt;0x00 0x77 0x04&gt;;
	interrupt-names = "irq_avsd";
	clocks = &lt;0x02 0x1c0 0x02 0x1c1&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec";
	rockchip,normal-rates = &lt;0x2367b880 0x00&gt;;
	assigned-clocks = &lt;0x02 0x1c0&gt;;
	assigned-clock-rates = &lt;0x2367b880&gt;;
	resets = &lt;0x02 0x2c8 0x02 0x2c9&gt;;
	reset-names = "shared_video_a\0shared_video_h";
	rockchip,skip-pmu-idle-request;
	rockchip,disable-auto-freq;
	iommus = &lt;0xad&gt;;
	power-domains = &lt;0x58 0x15&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,taskqueue-node = &lt;0x00&gt;;
	rockchip,resetgroup-node = &lt;0x00&gt;;
	status = "okay";
};

rga@fdb60000 {
	compatible = "rockchip,rga3_core0";
	reg = &lt;0x00 0xfdb60000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0x72 0x04&gt;;
	interrupt-names = "rga3_core0_irq";
	clocks = &lt;0x02 0x1ba 0x02 0x1b9 0x02 0x1bb&gt;;
	clock-names = "aclk_rga3_0\0hclk_rga3_0\0clk_rga3_0";
	power-domains = &lt;0x58 0x16&gt;;
	iommus = &lt;0xaf&gt;;
	status = "okay";
};

iommu@fdb60f00 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdb60f00 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x72 0x04&gt;;
	interrupt-names = "rga3_0_mmu";
	clocks = &lt;0x02 0x1ba 0x02 0x1b9&gt;;
	clock-names = "aclk\0iface";
	power-domains = &lt;0x58 0x16&gt;;
	#iommu-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0xaf&gt;;
};

rga@fdb70000 {
	compatible = "rockchip,rga3_core1";
	reg = &lt;0x00 0xfdb70000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0x73 0x04&gt;;
	interrupt-names = "rga3_core1_irq";
	clocks = &lt;0x02 0x18a 0x02 0x189 0x02 0x18b&gt;;
	clock-names = "aclk_rga3_1\0hclk_rga3_1\0clk_rga3_1";
	power-domains = &lt;0x58 0x1e&gt;;
	iommus = &lt;0xb0&gt;;
	status = "okay";
};

iommu@fdb70f00 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdb70f00 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x73 0x04&gt;;
	interrupt-names = "rga3_1_mmu";
	clocks = &lt;0x02 0x18a 0x02 0x189&gt;;
	clock-names = "aclk\0iface";
	power-domains = &lt;0x58 0x1e&gt;;
	#iommu-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0xb0&gt;;
};

rga@fdb80000 {
	compatible = "rockchip,rga2_core0";
	reg = &lt;0x00 0xfdb80000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0x74 0x04&gt;;
	interrupt-names = "rga2_irq";
	clocks = &lt;0x02 0x1b7 0x02 0x1b6 0x02 0x1b8&gt;;
	clock-names = "aclk_rga2\0hclk_rga2\0clk_rga2";
	power-domains = &lt;0x58 0x15&gt;;
	status = "okay";
};

jpegd@fdb90000 {
	compatible = "rockchip,rkv-jpeg-decoder-v1";
	reg = &lt;0x00 0xfdb90000 0x00 0x400&gt;;
	interrupts = &lt;0x00 0x81 0x04&gt;;
	interrupt-names = "irq_jpegd";
	clocks = &lt;0x02 0x1b4 0x02 0x1b5&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec";
	rockchip,normal-rates = &lt;0x23c34600 0x00&gt;;
	assigned-clocks = &lt;0x02 0x1b4&gt;;
	assigned-clock-rates = &lt;0x23c34600&gt;;
	resets = &lt;0x02 0x2d2 0x02 0x2d3&gt;;
	reset-names = "video_a\0video_h";
	rockchip,skip-pmu-idle-request;
	iommus = &lt;0xb1&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,taskqueue-node = &lt;0x01&gt;;
	power-domains = &lt;0x58 0x15&gt;;
	status = "okay";
};

iommu@fdb90480 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdb90480 0x00 0x40&gt;;
	interrupts = &lt;0x00 0x82 0x04&gt;;
	interrupt-names = "irq_jpegd_mmu";
	clocks = &lt;0x02 0x1b4 0x02 0x1b5&gt;;
	clock-names = "aclk\0iface";
	power-domains = &lt;0x58 0x15&gt;;
	#iommu-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0xb1&gt;;
};

jpege-core@fdba0000 {
	compatible = "rockchip,vpu-jpege-core";
	reg = &lt;0x00 0xfdba0000 0x00 0x400&gt;;
	interrupts = &lt;0x00 0x7a 0x04&gt;;
	interrupt-names = "irq_jpege0";
	clocks = &lt;0x02 0x1ac 0x02 0x1ad&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec";
	rockchip,normal-rates = &lt;0x2367b880 0x00&gt;;
	assigned-clocks = &lt;0x02 0x1ac&gt;;
	assigned-clock-rates = &lt;0x2367b880&gt;;
	resets = &lt;0x02 0x2ca 0x02 0x2cb&gt;;
	reset-names = "video_a\0video_h";
	rockchip,skip-pmu-idle-request;
	rockchip,disable-auto-freq;
	iommus = &lt;0xb2&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,taskqueue-node = &lt;0x02&gt;;
	rockchip,ccu = &lt;0xb3&gt;;
	power-domains = &lt;0x58 0x15&gt;;
	status = "okay";
};

iommu@fdba0800 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdba0800 0x00 0x40&gt;;
	interrupts = &lt;0x00 0x79 0x04&gt;;
	interrupt-names = "irq_jpege0_mmu";
	clocks = &lt;0x02 0x1ac 0x02 0x1ad&gt;;
	clock-names = "aclk\0iface";
	power-domains = &lt;0x58 0x15&gt;;
	#iommu-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0xb2&gt;;
};

jpege-core@fdba4000 {
	compatible = "rockchip,vpu-jpege-core";
	reg = &lt;0x00 0xfdba4000 0x00 0x400&gt;;
	interrupts = &lt;0x00 0x7c 0x04&gt;;
	interrupt-names = "irq_jpege1";
	clocks = &lt;0x02 0x1ae 0x02 0x1af&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec";
	rockchip,normal-rates = &lt;0x2367b880 0x00&gt;;
	assigned-clocks = &lt;0x02 0x1ae&gt;;
	assigned-clock-rates = &lt;0x2367b880&gt;;
	resets = &lt;0x02 0x2cc 0x02 0x2cd&gt;;
	reset-names = "video_a\0video_h";
	rockchip,skip-pmu-idle-request;
	rockchip,disable-auto-freq;
	iommus = &lt;0xb4&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,taskqueue-node = &lt;0x02&gt;;
	rockchip,ccu = &lt;0xb3&gt;;
	power-domains = &lt;0x58 0x15&gt;;
	status = "okay";
};

iommu@fdba4800 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdba4800 0x00 0x40&gt;;
	interrupts = &lt;0x00 0x7b 0x04&gt;;
	interrupt-names = "irq_jpege1_mmu";
	clocks = &lt;0x02 0x1ae 0x02 0x1af&gt;;
	clock-names = "aclk\0iface";
	power-domains = &lt;0x58 0x15&gt;;
	#iommu-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0xb4&gt;;
};

jpege-core@fdba8000 {
	compatible = "rockchip,vpu-jpege-core";
	reg = &lt;0x00 0xfdba8000 0x00 0x400&gt;;
	interrupts = &lt;0x00 0x7e 0x04&gt;;
	interrupt-names = "irq_jpege2";
	clocks = &lt;0x02 0x1b0 0x02 0x1b1&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec";
	rockchip,normal-rates = &lt;0x2367b880 0x00&gt;;
	assigned-clocks = &lt;0x02 0x1b0&gt;;
	assigned-clock-rates = &lt;0x2367b880&gt;;
	resets = &lt;0x02 0x2ce 0x02 0x2cf&gt;;
	reset-names = "video_a\0video_h";
	rockchip,skip-pmu-idle-request;
	rockchip,disable-auto-freq;
	iommus = &lt;0xb5&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,taskqueue-node = &lt;0x02&gt;;
	rockchip,ccu = &lt;0xb3&gt;;
	power-domains = &lt;0x58 0x15&gt;;
	status = "okay";
};

iommu@fdba8800 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdba8800 0x00 0x40&gt;;
	interrupts = &lt;0x00 0x7d 0x04&gt;;
	interrupt-names = "irq_jpege2_mmu";
	clocks = &lt;0x02 0x1b0 0x02 0x1b1&gt;;
	clock-names = "aclk\0iface";
	power-domains = &lt;0x58 0x15&gt;;
	#iommu-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0xb5&gt;;
};

jpege-core@fdbac000 {
	compatible = "rockchip,vpu-jpege-core";
	reg = &lt;0x00 0xfdbac000 0x00 0x400&gt;;
	interrupts = &lt;0x00 0x80 0x04&gt;;
	interrupt-names = "irq_jpege3";
	clocks = &lt;0x02 0x1b2 0x02 0x1b3&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec";
	rockchip,normal-rates = &lt;0x2367b880 0x00&gt;;
	assigned-clocks = &lt;0x02 0x1b2&gt;;
	assigned-clock-rates = &lt;0x2367b880&gt;;
	resets = &lt;0x02 0x2d0 0x02 0x2d1&gt;;
	reset-names = "video_a\0video_h";
	rockchip,skip-pmu-idle-request;
	rockchip,disable-auto-freq;
	iommus = &lt;0xb6&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,taskqueue-node = &lt;0x02&gt;;
	rockchip,ccu = &lt;0xb3&gt;;
	power-domains = &lt;0x58 0x15&gt;;
	status = "okay";
};

iommu@fdbac800 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdbac800 0x00 0x40&gt;;
	interrupts = &lt;0x00 0x7f 0x04&gt;;
	interrupt-names = "irq_jpege3_mmu";
	clocks = &lt;0x02 0x1b2 0x02 0x1b3&gt;;
	clock-names = "aclk\0iface";
	power-domains = &lt;0x58 0x15&gt;;
	#iommu-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0xb6&gt;;
};

iep@fdbb0000 {
	compatible = "rockchip,iep-v2";
	reg = &lt;0x00 0xfdbb0000 0x00 0x500&gt;;
	interrupts = &lt;0x00 0x75 0x04&gt;;
	interrupt-names = "irq_iep";
	clocks = &lt;0x02 0x1aa 0x02 0x1a9 0x02 0x1ab&gt;;
	clock-names = "aclk\0hclk\0sclk";
	rockchip,normal-rates = &lt;0x2367b880 0x00&gt;;
	assigned-clocks = &lt;0x02 0x1aa&gt;;
	assigned-clock-rates = &lt;0x2367b880&gt;;
	resets = &lt;0x02 0x2d5 0x02 0x2d4 0x02 0x2d6&gt;;
	reset-names = "rst_a\0rst_h\0rst_s";
	rockchip,skip-pmu-idle-request;
	rockchip,disable-auto-freq;
	power-domains = &lt;0x58 0x15&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,taskqueue-node = &lt;0x06&gt;;
	iommus = &lt;0xb7&gt;;
	status = "okay";
};

iommu@fdbb0800 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdbb0800 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x75 0x04&gt;;
	interrupt-names = "irq_iep_mmu";
	clocks = &lt;0x02 0x1aa 0x02 0x1a9&gt;;
	clock-names = "aclk\0iface";
	#iommu-cells = &lt;0x00&gt;;
	power-domains = &lt;0x58 0x15&gt;;
	status = "okay";
	phandle = &lt;0xb7&gt;;
};

rkvenc-core@fdbd0000 {
	compatible = "rockchip,rkv-encoder-v2-core";
	reg = &lt;0x00 0xfdbd0000 0x00 0x6000&gt;;
	interrupts = &lt;0x00 0x65 0x04&gt;;
	interrupt-names = "irq_rkvenc0";
	clocks = &lt;0x02 0x1c5 0x02 0x1c4 0x02 0x1c6&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec\0clk_core";
	rockchip,normal-rates = &lt;0x1dcd6500 0x00 0x2faf0800&gt;;
	assigned-clocks = &lt;0x02 0x1c5 0x02 0x1c6&gt;;
	assigned-clock-rates = &lt;0x1dcd6500 0x2faf0800&gt;;
	resets = &lt;0x02 0x2f5 0x02 0x2f4 0x02 0x2f6&gt;;
	reset-names = "video_a\0video_h\0video_core";
	rockchip,skip-pmu-idle-request;
	iommus = &lt;0xb8&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,ccu = &lt;0xb9&gt;;
	rockchip,taskqueue-node = &lt;0x07&gt;;
	rockchip,task-capacity = &lt;0x08&gt;;
	power-domains = &lt;0x58 0x10&gt;;
	operating-points-v2 = &lt;0xba&gt;;
	status = "okay";
	venc-supply = &lt;0xbb&gt;;
	mem-supply = &lt;0xbb&gt;;
};

iommu@fdbdf000 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdbdf000 0x00 0x40 0x00 0xfdbdf040 0x00 0x40&gt;;
	interrupts = &lt;0x00 0x63 0x04 0x00 0x64 0x04&gt;;
	interrupt-names = "irq_rkvenc0_mmu0\0irq_rkvenc0_mmu1";
	clocks = &lt;0x02 0x1c5 0x02 0x1c4&gt;;
	clock-names = "aclk\0iface";
	rockchip,disable-mmu-reset;
	rockchip,enable-cmd-retry;
	rockchip,shootdown-entire;
	#iommu-cells = &lt;0x00&gt;;
	power-domains = &lt;0x58 0x10&gt;;
	status = "okay";
	phandle = &lt;0xb8&gt;;
};

rkvenc-core@fdbe0000 {
	compatible = "rockchip,rkv-encoder-v2-core";
	reg = &lt;0x00 0xfdbe0000 0x00 0x6000&gt;;
	interrupts = &lt;0x00 0x68 0x04&gt;;
	interrupt-names = "irq_rkvenc1";
	clocks = &lt;0x02 0x1ca 0x02 0x1c9 0x02 0x1cb&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec\0clk_core";
	rockchip,normal-rates = &lt;0x1dcd6500 0x00 0x2faf0800&gt;;
	assigned-clocks = &lt;0x02 0x1ca 0x02 0x1cb&gt;;
	assigned-clock-rates = &lt;0x1dcd6500 0x2faf0800&gt;;
	resets = &lt;0x02 0x305 0x02 0x304 0x02 0x306&gt;;
	reset-names = "video_a\0video_h\0video_core";
	rockchip,skip-pmu-idle-request;
	iommus = &lt;0xbc&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,ccu = &lt;0xb9&gt;;
	rockchip,taskqueue-node = &lt;0x07&gt;;
	rockchip,task-capacity = &lt;0x08&gt;;
	power-domains = &lt;0x58 0x11&gt;;
	operating-points-v2 = &lt;0xba&gt;;
	status = "okay";
	venc-supply = &lt;0xbb&gt;;
	mem-supply = &lt;0xbb&gt;;
};

iommu@fdbef000 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdbef000 0x00 0x40 0x00 0xfdbef040 0x00 0x40&gt;;
	interrupts = &lt;0x00 0x66 0x04 0x00 0x67 0x04&gt;;
	interrupt-names = "irq_rkvenc1_mmu0\0irq_rkvenc1_mmu1";
	clocks = &lt;0x02 0x1ca 0x02 0x1c9&gt;;
	lock-names = "aclk\0iface";
	rockchip,disable-mmu-reset;
	rockchip,enable-cmd-retry;
	rockchip,shootdown-entire;
	#iommu-cells = &lt;0x00&gt;;
	power-domains = &lt;0x58 0x11&gt;;
	status = "okay";
	phandle = &lt;0xbc&gt;;
};

venc-opp-table {
	compatible = "operating-points-v2";
	nvmem-cells = &lt;0xbd 0xbe&gt;;
	nvmem-cell-names = "leakage\0opp-info";
	rockchip,leakage-voltage-sel = &lt;0x01 0x0f 0x00 0x10 0x19 0x01 0x1a 0xfe 0x02&gt;;
	rockchip,grf = &lt;0xbf&gt;;
	volt-mem-read-margin = &lt;0xd0bd8 0x01 0xbac48 0x02 0xa4cb8 0x03 0x78d98 0x04&gt;;
	phandle = &lt;0xba&gt;;

	opp-800000000 {
		opp-hz = &lt;0x00 0x2faf0800&gt;;
		opp-microvolt = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
		opp-microvolt-L0 = &lt;0xc3500 0xc3500 0xcf850 0xc3500 0xc3500 0xcf850&gt;;
		opp-microvolt-L1 = &lt;0xbd358 0xbd358 0xcf850 0xbd358 0xbd358 0xcf850&gt;;
		opp-microvolt-L2 = &lt;0xb71b0 0xb71b0 0xcf850 0xb71b0 0xb71b0 0xcf850&gt;;
	};
};

rkvdec-ccu@fdc30000 {
	compatible = "rockchip,rkv-decoder-v2-ccu";
	reg = &lt;0x00 0xfdc30000 0x00 0x100&gt;;
	reg-names = "ccu";
	clocks = &lt;0x02 0x18e&gt;;
	clock-names = "aclk_ccu";
	assigned-clocks = &lt;0x02 0x18e&gt;;
	assigned-clock-rates = &lt;0x23c34600&gt;;
	resets = &lt;0x02 0x282&gt;;
	reset-names = "video_ccu";
	rockchip,skip-pmu-idle-request;
	rockchip,ccu-mode = &lt;0x01&gt;;
	power-domains = &lt;0x58 0x0e&gt;;
	status = "okay";
	phandle = &lt;0xc1&gt;;
};

rkvdec-core@fdc38000 {
	compatible = "rockchip,rkv-decoder-v2";
	reg = &lt;0x00 0xfdc38100 0x00 0x400 0x00 0xfdc38000 0x00 0x100&gt;;
	reg-names = "regs\0link";
	interrupts = &lt;0x00 0x5f 0x04&gt;;
	interrupt-names = "irq_rkvdec0";
	clocks = &lt;0x02 0x190 0x02 0x18f 0x02 0x193 0x02 0x191 0x02 0x192&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec\0clk_core\0clk_cabac\0clk_hevc_cabac";
	rockchip,normal-rates = &lt;0x2faf0800 0x00 0x23c34600 0x23c34600 0x3b9aca00&gt;;
	assigned-clocks = &lt;0x02 0x190 0x02 0x193 0x02 0x191 0x02 0x192&gt;;
	assigned-clock-rates = &lt;0x2faf0800 0x23c34600 0x23c34600 0x3b9aca00&gt;;
	resets = &lt;0x02 0x284 0x02 0x283 0x02 0x289 0x02 0x287 0x02 0x288&gt;;
	reset-names = "video_a\0video_h\0video_core\0video_cabac\0video_hevc_cabac";
	rockchip,skip-pmu-idle-request;
	iommus = &lt;0xc0&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,ccu = &lt;0xc1&gt;;
	rockchip,core-mask = &lt;0x10001&gt;;
	rockchip,task-capacity = &lt;0x10&gt;;
	rockchip,taskqueue-node = &lt;0x09&gt;;
	rockchip,sram = &lt;0xc2&gt;;
	rockchip,rcb-iova = &lt;0xfff00000 0x100000&gt;;
	rockchip,rcb-info = &lt;0x88 0x6000 0x89 0xc000 0x8d 0x16000 0x8c 0xc000 0x8b 0x2c000 0x85 0xc000 0x86 0x2000 0x87 0x1100 0x8a 0x3300 0x8e 0x47300&gt;;
	rockchip,rcb-min-width = &lt;0x200&gt;;
	power-domains = &lt;0x58 0x0e&gt;;
	status = "okay";
};

iommu@fdc38700 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdc38700 0x00 0x40 0x00 0xfdc38740 0x00 0x40&gt;;
	interrupts = &lt;0x00 0x60 0x04&gt;;
	interrupt-names = "irq_rkvdec0_mmu";
	clocks = &lt;0x02 0x190 0x02 0x18f&gt;;
	clock-names = "aclk\0iface";
	rockchip,disable-mmu-reset;
	rockchip,enable-cmd-retry;
	rockchip,shootdown-entire;
	rockchip,master-handle-irq;
	#iommu-cells = &lt;0x00&gt;;
	power-domains = &lt;0x58 0x0e&gt;;
	status = "okay";
	phandle = &lt;0xc0&gt;;
};

rkvdec-core@fdc48000 {
	compatible = "rockchip,rkv-decoder-v2";
	reg = &lt;0x00 0xfdc48100 0x00 0x400 0x00 0xfdc48000 0x00 0x100&gt;;
	reg-names = "regs\0link";
	interrupts = &lt;0x00 0x61 0x04&gt;;
	interrupt-names = "irq_rkvdec1";
	clocks = &lt;0x02 0x195 0x02 0x194 0x02 0x198 0x02 0x196 0x02 0x197&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec\0clk_core\0clk_cabac\0clk_hevc_cabac";
	rockchip,normal-rates = &lt;0x2faf0800 0x00 0x23c34600 0x23c34600 0x3b9aca00&gt;;
	assigned-clocks = &lt;0x02 0x195 0x02 0x198 0x02 0x196 0x02 0x197&gt;;
	assigned-clock-rates = &lt;0x2faf0800 0x23c34600 0x23c34600 0x3b9aca00&gt;;
	resets = &lt;0x02 0x293 0x02 0x292 0x02 0x298 0x02 0x296 0x02 0x297&gt;;
	reset-names = "video_a\0video_h\0video_core\0video_cabac\0video_hevc_cabac";
	rockchip,skip-pmu-idle-request;
	iommus = &lt;0xc3&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,ccu = &lt;0xc1&gt;;
	rockchip,core-mask = &lt;0x20002&gt;;
	rockchip,task-capacity = &lt;0x10&gt;;
	rockchip,taskqueue-node = &lt;0x09&gt;;
	rockchip,sram = &lt;0xc4&gt;;
	rockchip,rcb-iova = &lt;0xffe00000 0x100000&gt;;
	rockchip,rcb-info = &lt;0x88 0x6000 0x89 0xc000 0x8d 0x16000 0x8c 0xc000 0x8b 0x2c000 0x85 0xc000 0x86 0x2000 0x87 0x1100 0x8a 0x3300 0x8e 0x47300&gt;;
	rockchip,rcb-min-width = &lt;0x200&gt;;
	power-domains = &lt;0x58 0x0f&gt;;
	status = "okay";
};

iommu@fdc48700 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdc48700 0x00 0x40 0x00 0xfdc48740 0x00 0x40&gt;;
	interrupts = &lt;0x00 0x62 0x04&gt;;
	interrupt-names = "irq_rkvdec1_mmu";
	clocks = &lt;0x02 0x195 0x02 0x194&gt;;
	clock-names = "aclk\0iface";
	rockchip,disable-mmu-reset;
	rockchip,enable-cmd-retry;
	rockchip,shootdown-entire;
	rockchip,master-handle-irq;
	#iommu-cells = &lt;0x00&gt;;
	power-domains = &lt;0x58 0x0f&gt;;
	status = "okay";
	phandle = &lt;0xc3&gt;;
};

av1d@fdc70000 {
	compatible = "rockchip,av1-decoder";
	reg = &lt;0x00 0xfdc70000 0x00 0x800 0x00 0xfdc80000 0x00 0x400 0x00 0xfdc90000 0x00 0x400&gt;;
	reg-names = "vcd\0cache\0afbc";
	interrupts = &lt;0x00 0x6c 0x04 0x00 0x6b 0x04 0x00 0x6a 0x04&gt;;
	interrupt-names = "irq_av1d\0irq_cache\0irq_afbc";
	clocks = &lt;0x02 0x49 0x02 0x4b&gt;;
	clock-names = "aclk_vcodec\0hclk_vcodec";
	rockchip,normal-rates = &lt;0x17d78400 0x17d78400&gt;;
	assigned-clocks = &lt;0x02 0x49 0x02 0x4b&gt;;
	assigned-clock-rates = &lt;0x17d78400 0x17d78400&gt;;
	resets = &lt;0x02 0x442 0x02 0x445&gt;;
	reset-names = "video_a\0video_h";
	iommus = &lt;0xc5&gt;;
	rockchip,srv = &lt;0xae&gt;;
	rockchip,taskqueue-node = &lt;0x0b&gt;;
	power-domains = &lt;0x58 0x17&gt;;
	status = "disabled";
};

iommu@fdca0000 {
	compatible = "rockchip,iommu-av1";
	reg = &lt;0x00 0xfdca0000 0x00 0x600&gt;;
	interrupts = &lt;0x00 0x6d 0x04&gt;;
	interrupt-names = "irq_av1d_mmu";
	clocks = &lt;0x02 0x49 0x02 0x4b&gt;;
	clock-names = "aclk\0iface";
	#iommu-cells = &lt;0x00&gt;;
	power-domains = &lt;0x58 0x17&gt;;
	status = "okay";
	phandle = &lt;0xc5&gt;;
};

rkisp-unite@fdcb0000 {
	compatible = "rockchip,rk3588-rkisp-unite";
	reg = &lt;0x00 0xfdcb0000 0x00 0x10000 0x00 0xfdcc0000 0x00 0x10000&gt;;
	interrupts = &lt;0x00 0x87 0x04 0x00 0x89 0x04 0x00 0x8a 0x04&gt;;
	interrupt-names = "isp_irq\0mi_irq\0mipi_irq";
	clocks = &lt;0x02 0x1de 0x02 0x1df 0x02 0x1db 0x02 0x1dc 0x02 0x1dd 0x02 0x120 0x02 0x121 0x02 0x11d 0x02 0x11e 0x02 0x11f&gt;;
	clock-names = "aclk_isp0\0hclk_isp0\0clk_isp_core0\0clk_isp_core_marvin0\0clk_isp_core_vicap0\0aclk_isp1\0hclk_isp1\0clk_isp_core1\0clk_isp_core_marvin1\0clk_isp_core_vicap1";
	power-domains = &lt;0x58 0x1c&gt;;
	iommus = &lt;0xc6&gt;;
	status = "disabled";
};

rkisp@fdcb0000 {
	compatible = "rockchip,rk3588-rkisp";
	reg = &lt;0x00 0xfdcb0000 0x00 0x7f00&gt;;
	interrupts = &lt;0x00 0x83 0x04 0x00 0x85 0x04 0x00 0x86 0x04&gt;;
	interrupt-names = "isp_irq\0mi_irq\0mipi_irq";
	clocks = &lt;0x02 0x1de 0x02 0x1df 0x02 0x1db 0x02 0x1dc 0x02 0x1dd&gt;;
	clock-names = "aclk_isp\0hclk_isp\0clk_isp_core\0clk_isp_core_marvin\0clk_isp_core_vicap";
	power-domains = &lt;0x58 0x1b&gt;;
	iommus = &lt;0xc7&gt;;
	status = "disabled";
	phandle = &lt;0x51&gt;;
};

rkisp-unite-mmu@fdcb7f00 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdcb7f00 0x00 0x100 0x00 0xfdcc7f00 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x84 0x04 0x00 0x88 0x04&gt;;
	interrupt-names = "isp0_mmu\0isp1_mmu";
	clocks = &lt;0x02 0x1de 0x02 0x1df 0x02 0x120 0x02 0x121&gt;;
	clock-names = "aclk0\0iface0\0aclk1\0iface1";
	power-domains = &lt;0x58 0x1c&gt;;
	#iommu-cells = &lt;0x00&gt;;
	rockchip,disable-mmu-reset;
	status = "disabled";
	phandle = &lt;0xc6&gt;;
};

iommu@fdcb7f00 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdcb7f00 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x84 0x04&gt;;
	interrupt-names = "isp0_mmu";
	clocks = &lt;0x02 0x1de 0x02 0x1df&gt;;
	clock-names = "aclk\0iface";
	power-domains = &lt;0x58 0x1b&gt;;
	#iommu-cells = &lt;0x00&gt;;
	rockchip,disable-mmu-reset;
	status = "disabled";
	phandle = &lt;0xc7&gt;;
};

rkisp@fdcc0000 {
	compatible = "rockchip,rk3588-rkisp";
	reg = &lt;0x00 0xfdcc0000 0x00 0x7f00&gt;;
	interrupts = &lt;0x00 0x87 0x04 0x00 0x89 0x04 0x00 0x8a 0x04&gt;;
	interrupt-names = "isp_irq\0mi_irq\0mipi_irq";
	clocks = &lt;0x02 0x120 0x02 0x121 0x02 0x11d 0x02 0x11e 0x02 0x11f&gt;;
	clock-names = "aclk_isp\0hclk_isp\0clk_isp_core\0clk_isp_core_marvin\0clk_isp_core_vicap";
	power-domains = &lt;0x58 0x1c&gt;;
	iommus = &lt;0xc8&gt;;
	status = "disabled";
	phandle = &lt;0x52&gt;;
};

iommu@fdcc7f00 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdcc7f00 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x88 0x04&gt;;
	interrupt-names = "isp1_mmu";
	clocks = &lt;0x02 0x120 0x02 0x121&gt;;
	clock-names = "aclk\0iface";
	power-domains = &lt;0x58 0x1c&gt;;
	#iommu-cells = &lt;0x00&gt;;
	rockchip,disable-mmu-reset;
	status = "disabled";
	phandle = &lt;0xc8&gt;;
};

rkispp@fdcd0000 {
	compatible = "rockchip,rk3588-rkispp";
	reg = &lt;0x00 0xfdcd0000 0x00 0xf00&gt;;
	interrupts = &lt;0x00 0x8b 0x04&gt;;
	interrupt-names = "fec_irq";
	clocks = &lt;0x02 0x1d5 0x02 0x1d6 0x02 0x1d7&gt;;
	clock-names = "aclk_ispp\0hclk_ispp\0clk_ispp";
	assigned-clocks = &lt;0x02 0x1d6&gt;;
	assigned-clock-rates = &lt;0x5f5e100&gt;;
	power-domains = &lt;0x58 0x1d&gt;;
	iommus = &lt;0xc9&gt;;
	status = "disabled";
	phandle = &lt;0x53&gt;;
};

iommu@fdcd0f00 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdcd0f00 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x8c 0x04&gt;;
	interrupt-names = "fec0_mmu";
	clocks = &lt;0x02 0x1d5 0x02 0x1d6 0x02 0x1d7&gt;;
	clock-names = "aclk\0iface\0pclk";
	power-domains = &lt;0x58 0x1d&gt;;
	#iommu-cells = &lt;0x00&gt;;
	rockchip,disable-mmu-reset;
	status = "disabled";
	phandle = &lt;0xc9&gt;;
};

rkispp@fdcd8000 {
	compatible = "rockchip,rk3588-rkispp";
	reg = &lt;0x00 0xfdcd8000 0x00 0xf00&gt;;
	interrupts = &lt;0x00 0x8d 0x04&gt;;
	interrupt-names = "fec_irq";
	clocks = &lt;0x02 0x1d8 0x02 0x1d9 0x02 0x1da&gt;;
	clock-names = "aclk_ispp\0hclk_ispp\0clk_ispp";
	assigned-clocks = &lt;0x02 0x1d9&gt;;
	assigned-clock-rates = &lt;0x5f5e100&gt;;
	power-domains = &lt;0x58 0x1d&gt;;
	iommus = &lt;0xca&gt;;
	status = "disabled";
	phandle = &lt;0x54&gt;;
};

iommu@fdcd8f00 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdcd8f00 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x8e 0x04&gt;;
	interrupt-names = "fec1_mmu";
	clocks = &lt;0x02 0x1d8 0x02 0x1d9 0x02 0x1da&gt;;
	clock-names = "aclk\0iface\0pclk";
	power-domains = &lt;0x58 0x1d&gt;;
	#iommu-cells = &lt;0x00&gt;;
	rockchip,disable-mmu-reset;
	status = "disabled";
	phandle = &lt;0xca&gt;;
};

rkcif@fdce0000 {
	compatible = "rockchip,rk3588-cif";
	reg = &lt;0x00 0xfdce0000 0x00 0x800&gt;;
	reg-names = "cif_regs";
	interrupts = &lt;0x00 0x9b 0x04&gt;;
	interrupt-names = "cif-intr";
	clocks = &lt;0x02 0x1e4 0x02 0x1e5 0x02 0x1e3 0x02 0x1cd 0x02 0x1ce&gt;;
	clock-names = "aclk_cif\0hclk_cif\0dclk_cif\0iclk_host0\0iclk_host1";
	resets = &lt;0x02 0x317 0x02 0x318 0x02 0x316 0x02 0x334 0x02 0x335 0x02 0x336 0x02 0x337 0x02 0x338 0x02 0x339&gt;;
	reset-names = "rst_cif_a\0rst_cif_h\0rst_cif_d\0rst_cif_host0\0rst_cif_host1\0rst_cif_host2\0rst_cif_host3\0rst_cif_host4\0rst_cif_host5";
	assigned-clocks = &lt;0x02 0x1e3&gt;;
	assigned-clock-rates = &lt;0x23c34600&gt;;
	power-domains = &lt;0x58 0x1b&gt;;
	rockchip,grf = &lt;0xbf&gt;;
	iommus = &lt;0x4b&gt;;
	nvmem-cells = &lt;0x21 0xcb 0xcc&gt;;
	nvmem-cell-names = "specification\0package_low\0package_high";
	status = "disabled";
	phandle = &lt;0x4a&gt;;
};

iommu@fdce0800 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdce0800 0x00 0x100 0x00 0xfdce0900 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x71 0x04&gt;;
	interrupt-names = "cif_mmu";
	clocks = &lt;0x02 0x1e4 0x02 0x1e5&gt;;
	clock-names = "aclk\0iface";
	power-domains = &lt;0x58 0x1b&gt;;
	rockchip,disable-mmu-reset;
	#iommu-cells = &lt;0x00&gt;;
	status = "disabled";
	phandle = &lt;0x4b&gt;;
};

mipi0-csi2-hw@fdd10000 {
	compatible = "rockchip,rk3588-mipi-csi2-hw";
	reg = &lt;0x00 0xfdd10000 0x00 0x10000&gt;;
	reg-names = "csihost_regs";
	interrupts = &lt;0x00 0x8f 0x04 0x00 0x90 0x04&gt;;
	interrupt-names = "csi-intr1\0csi-intr2";
	clocks = &lt;0x02 0x1cf&gt;;
	clock-names = "pclk_csi2host";
	resets = &lt;0x02 0x324&gt;;
	reset-names = "srst_csihost_p";
	status = "okay";
	phandle = &lt;0x44&gt;;
};

mipi1-csi2-hw@fdd20000 {
	compatible = "rockchip,rk3588-mipi-csi2-hw";
	reg = &lt;0x00 0xfdd20000 0x00 0x10000&gt;;
	reg-names = "csihost_regs";
	interrupts = &lt;0x00 0x91 0x04 0x00 0x92 0x04&gt;;
	interrupt-names = "csi-intr1\0csi-intr2";
	clocks = &lt;0x02 0x1d0&gt;;
	clock-names = "pclk_csi2host";
	resets = &lt;0x02 0x325&gt;;
	reset-names = "srst_csihost_p";
	status = "okay";
	phandle = &lt;0x45&gt;;
};

mipi2-csi2-hw@fdd30000 {
	compatible = "rockchip,rk3588-mipi-csi2-hw";
	reg = &lt;0x00 0xfdd30000 0x00 0x10000&gt;;
	reg-names = "csihost_regs";
	interrupts = &lt;0x00 0x93 0x04 0x00 0x94 0x04&gt;;
	interrupt-names = "csi-intr1\0csi-intr2";
	clocks = &lt;0x02 0x1d1&gt;;
	clock-names = "pclk_csi2host";
	resets = &lt;0x02 0x326&gt;;
	reset-names = "srst_csihost_p";
	status = "okay";
	phandle = &lt;0x46&gt;;
};

mipi3-csi2-hw@fdd40000 {
	compatible = "rockchip,rk3588-mipi-csi2-hw";
	reg = &lt;0x00 0xfdd40000 0x00 0x10000&gt;;
	reg-names = "csihost_regs";
	interrupts = &lt;0x00 0x95 0x04 0x00 0x96 0x04&gt;;
	interrupt-names = "csi-intr1\0csi-intr2";
	clocks = &lt;0x02 0x1d2&gt;;
	clock-names = "pclk_csi2host";
	resets = &lt;0x02 0x327&gt;;
	reset-names = "srst_csihost_p";
	status = "okay";
	phandle = &lt;0x47&gt;;
};

mipi4-csi2-hw@fdd50000 {
	compatible = "rockchip,rk3588-mipi-csi2-hw";
	reg = &lt;0x00 0xfdd50000 0x00 0x10000&gt;;
	reg-names = "csihost_regs";
	interrupts = &lt;0x00 0x97 0x04 0x00 0x98 0x04&gt;;
	interrupt-names = "csi-intr1\0csi-intr2";
	clocks = &lt;0x02 0x1d3&gt;;
	clock-names = "pclk_csi2host";
	resets = &lt;0x02 0x328&gt;;
	reset-names = "srst_csihost_p";
	status = "okay";
	phandle = &lt;0x48&gt;;
};

mipi5-csi2-hw@fdd60000 {
	compatible = "rockchip,rk3588-mipi-csi2-hw";
	reg = &lt;0x00 0xfdd60000 0x00 0x10000&gt;;
	reg-names = "csihost_regs";
	interrupts = &lt;0x00 0x99 0x04 0x00 0x9a 0x04&gt;;
	interrupt-names = "csi-intr1\0csi-intr2";
	clocks = &lt;0x02 0x1d4&gt;;
	clock-names = "pclk_csi2host";
	resets = &lt;0x02 0x329&gt;;
	reset-names = "srst_csihost_p";
	status = "okay";
	phandle = &lt;0x49&gt;;
};

vop@fdd90000 {
	compatible = "rockchip,rk3588-vop";
	reg = &lt;0x00 0xfdd90000 0x00 0x4200 0x00 0xfdd95000 0x00 0x1000&gt;;
	reg-names = "regs\0gamma_lut";
	interrupts = &lt;0x00 0x9c 0x04&gt;;
	clocks = &lt;0x02 0x270 0x02 0x26f 0x02 0x274 0x02 0x275 0x02 0x276 0x02 0x277 0x02 0x26e 0x02 0x271 0x02 0x272 0x02 0x273&gt;;
	clock-names = "aclk_vop\0hclk_vop\0dclk_vp0\0dclk_vp1\0dclk_vp2\0dclk_vp3\0pclk_vop\0dclk_src_vp0\0dclk_src_vp1\0dclk_src_vp2";
	assigned-clocks = &lt;0x02 0x270&gt;;
	assigned-clock-rates = &lt;0x2cb41780&gt;;
	resets = &lt;0x02 0x349 0x02 0x348 0x02 0x34d 0x02 0x350 0x02 0x351 0x02 0x352&gt;;
	reset-names = "axi\0ahb\0dclk_vp0\0dclk_vp1\0dclk_vp2\0dclk_vp3";
	iommus = &lt;0xcd&gt;;
	power-domains = &lt;0x58 0x18&gt;;
	rockchip,grf = &lt;0xbf&gt;;
	rockchip,vop-grf = &lt;0xce&gt;;
	rockchip,vo1-grf = &lt;0xcf&gt;;
	rockchip,pmu = &lt;0xd0&gt;;
	status = "okay";

	ports {
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;
		phandle = &lt;0x31&gt;;

		port@0 {
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;
			reg = &lt;0x00&gt;;
			rockchip,plane-mask = &lt;0x05&gt;;
			rockchip,primary-plane = &lt;0x02&gt;;
			cursor-win-id = &lt;0x00&gt;;

			endpoint@0 {
				reg = &lt;0x00&gt;;
				remote-endpoint = &lt;0xd1&gt;;
				phandle = &lt;0xee&gt;;
			};

			endpoint@1 {
				reg = &lt;0x01&gt;;
				remote-endpoint = &lt;0xd2&gt;;
				phandle = &lt;0xf9&gt;;
			};

			endpoint@2 {
				reg = &lt;0x02&gt;;
				remote-endpoint = &lt;0xd3&gt;;
				phandle = &lt;0x39&gt;;
			};

			endpoint@3 {
				reg = &lt;0x03&gt;;
				remote-endpoint = &lt;0xd4&gt;;
				phandle = &lt;0x194&gt;;
			};

			endpoint@4 {
				reg = &lt;0x04&gt;;
				remote-endpoint = &lt;0xd5&gt;;
				phandle = &lt;0x19d&gt;;
			};

			endpoint@5 {
				reg = &lt;0x05&gt;;
				remote-endpoint = &lt;0xd6&gt;;
				phandle = &lt;0x19a&gt;;
			};
		};

		port@1 {
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;
			reg = &lt;0x01&gt;;
			rockchip,plane-mask = &lt;0x0a&gt;;
			rockchip,primary-plane = &lt;0x03&gt;;
			cursor-win-id = &lt;0x01&gt;;

			endpoint@0 {
				reg = &lt;0x00&gt;;
				remote-endpoint = &lt;0xd7&gt;;
				phandle = &lt;0x35&gt;;
			};

			endpoint@1 {
				reg = &lt;0x01&gt;;
				remote-endpoint = &lt;0xd8&gt;;
				phandle = &lt;0xfa&gt;;
			};

			endpoint@2 {
				reg = &lt;0x02&gt;;
				remote-endpoint = &lt;0xd9&gt;;
				phandle = &lt;0xf6&gt;;
			};

			endpoint@3 {
				reg = &lt;0x03&gt;;
				remote-endpoint = &lt;0xda&gt;;
				phandle = &lt;0x3b&gt;;
			};

			endpoint@4 {
				reg = &lt;0x04&gt;;
				remote-endpoint = &lt;0xdb&gt;;
				phandle = &lt;0x19e&gt;;
			};

			endpoint@5 {
				reg = &lt;0x05&gt;;
				remote-endpoint = &lt;0xdc&gt;;
				phandle = &lt;0x3c&gt;;
			};
		};

		port@2 {
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;
			reg = &lt;0x02&gt;;
			assigned-clocks = &lt;0x02 0x273&gt;;
			assigned-clock-parents = &lt;0x02 0x04&gt;;
			rockchip,plane-mask = &lt;0x140&gt;;
			rockchip,primary-plane = &lt;0x08&gt;;
			cursor-win-id = &lt;0x06&gt;;

			endpoint@0 {
				reg = &lt;0x00&gt;;
				remote-endpoint = &lt;0xdd&gt;;
				phandle = &lt;0xef&gt;;
			};

			endpoint@1 {
				reg = &lt;0x01&gt;;
				remote-endpoint = &lt;0xde&gt;;
				phandle = &lt;0x38&gt;;
			};

			endpoint@2 {
				reg = &lt;0x02&gt;;
				remote-endpoint = &lt;0xdf&gt;;
				phandle = &lt;0xf7&gt;;
			};

			endpoint@3 {
				reg = &lt;0x03&gt;;
				remote-endpoint = &lt;0xe0&gt;;
				phandle = &lt;0xea&gt;;
			};

			endpoint@4 {
				reg = &lt;0x04&gt;;
				remote-endpoint = &lt;0xe1&gt;;
				phandle = &lt;0xeb&gt;;
			};

			endpoint@5 {
				reg = &lt;0x05&gt;;
				remote-endpoint = &lt;0xe2&gt;;
				phandle = &lt;0x195&gt;;
			};

			endpoint@6 {
				reg = &lt;0x06&gt;;
				remote-endpoint = &lt;0xe3&gt;;
				phandle = &lt;0x19f&gt;;
			};

			endpoint@7 {
				reg = &lt;0x07&gt;;
				remote-endpoint = &lt;0xe4&gt;;
				phandle = &lt;0x19b&gt;;
			};
		};

		port@3 {
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;
			reg = &lt;0x03&gt;;
			rockchip,plane-mask = &lt;0x280&gt;;
			rockchip,primary-plane = &lt;0x09&gt;;
			cursor-win-id = &lt;0x07&gt;;

			endpoint@0 {
				reg = &lt;0x00&gt;;
				remote-endpoint = &lt;0xe5&gt;;
				phandle = &lt;0x36&gt;;
			};

			endpoint@1 {
				reg = &lt;0x01&gt;;
				remote-endpoint = &lt;0xe6&gt;;
				phandle = &lt;0x37&gt;;
			};

			endpoint@2 {
				reg = &lt;0x02&gt;;
				remote-endpoint = &lt;0xe7&gt;;
				phandle = &lt;0x3a&gt;;
			};
		};
	};
};

iommu@fdd97e00 {
	compatible = "rockchip,iommu-v2";
	reg = &lt;0x00 0xfdd97e00 0x00 0x100 0x00 0xfdd97f00 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x9c 0x04&gt;;
	interrupt-names = "vop_mmu";
	clocks = &lt;0x02 0x270 0x02 0x26f&gt;;
	clock-names = "aclk\0iface";
	#iommu-cells = &lt;0x00&gt;;
	rockchip,disable-device-link-resume;
	rockchip,shootdown-entire;
	status = "okay";
	phandle = &lt;0xcd&gt;;
};

spdif-tx@fddb0000 {
	compatible = "rockchip,rk3588-spdif\0rockchip,rk3568-spdif";
	reg = &lt;0x00 0xfddb0000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xc3 0x04&gt;;
	dmas = &lt;0xe8 0x06&gt;;
	dma-names = "tx";
	clock-names = "mclk\0hclk";
	clocks = &lt;0x02 0x209 0x02 0x204&gt;;
	assigned-clocks = &lt;0x02 0x205&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	power-domains = &lt;0x58 0x19&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
	phandle = &lt;0x1b9&gt;;
};

i2s@fddc0000 {
	compatible = "rockchip,rk3588-i2s-tdm";
	reg = &lt;0x00 0xfddc0000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xb8 0x04&gt;;
	clocks = &lt;0x02 0x1fb 0x02 0x1fb 0x02 0x1f0&gt;;
	clock-names = "mclk_tx\0mclk_rx\0hclk";
	assigned-clocks = &lt;0x02 0x1f9&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	dmas = &lt;0xe9 0x00&gt;;
	dma-names = "tx";
	power-domains = &lt;0x58 0x19&gt;;
	resets = &lt;0x02 0x38d&gt;;
	reset-names = "tx-m";
	rockchip,playback-only;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

spdif-tx@fdde0000 {
	compatible = "rockchip,rk3588-spdif\0rockchip,rk3568-spdif";
	reg = &lt;0x00 0xfdde0000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xc4 0x04&gt;;
	dmas = &lt;0xe8 0x07&gt;;
	dma-names = "tx";
	clock-names = "mclk\0hclk";
	clocks = &lt;0x02 0x257 0x02 0x253&gt;;
	assigned-clocks = &lt;0x02 0x254&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	power-domains = &lt;0x58 0x1a&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

i2s@fddf0000 {
	compatible = "rockchip,rk3588-i2s-tdm";
	reg = &lt;0x00 0xfddf0000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xb9 0x04&gt;;
	clocks = &lt;0x02 0x246 0x02 0x246 0x02 0x248&gt;;
	clock-names = "mclk_tx\0mclk_rx\0hclk";
	assigned-clocks = &lt;0x02 0x243&gt;;
	assigned-clock-parents = &lt;0x02 0x07&gt;;
	dmas = &lt;0xe9 0x02&gt;;
	dma-names = "tx";
	power-domains = &lt;0x58 0x1a&gt;;
	resets = &lt;0x02 0x3e8&gt;;
	reset-names = "tx-m";
	rockchip,always-on;
	rockchip,hdmi-path;
	rockchip,playback-only;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0x1b5&gt;;
};

i2s@fddfc000 {
	compatible = "rockchip,rk3588-i2s-tdm";
	reg = &lt;0x00 0xfddfc000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xbd 0x04&gt;;
	clocks = &lt;0x02 0x242 0x02 0x242 0x02 0x23e&gt;;
	clock-names = "mclk_tx\0mclk_rx\0hclk";
	assigned-clocks = &lt;0x02 0x23f&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	dmas = &lt;0xe9 0x17&gt;;
	dma-names = "rx";
	power-domains = &lt;0x58 0x1a&gt;;
	resets = &lt;0x02 0x413&gt;;
	reset-names = "rx-m";
	rockchip,capture-only;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

spdif-rx@fde08000 {
	compatible = "rockchip,rk3588-spdifrx\0rockchip,rk3308-spdifrx";
	reg = &lt;0x00 0xfde08000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xc7 0x04&gt;;
	clocks = &lt;0x02 0x25e 0x02 0x25d&gt;;
	clock-names = "mclk\0hclk";
	assigned-clocks = &lt;0x02 0x25e&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	dmas = &lt;0x72 0x15&gt;;
	dma-names = "rx";
	power-domains = &lt;0x58 0x1a&gt;;
	resets = &lt;0x02 0x3fd&gt;;
	reset-names = "spdifrx-m";
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

dsi@fde20000 {
	compatible = "rockchip,rk3588-mipi-dsi2";
	reg = &lt;0x00 0xfde20000 0x00 0x10000&gt;;
	interrupts = &lt;0x00 0xa7 0x04&gt;;
	clocks = &lt;0x02 0x278 0x02 0x27a&gt;;
	clock-names = "pclk\0sys_clk";
	resets = &lt;0x02 0x354&gt;;
	reset-names = "apb";
	power-domains = &lt;0x58 0x18&gt;;
	phys = &lt;0x2f&gt;;
	phy-names = "dcphy";
	rockchip,grf = &lt;0xce&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	status = "disabled";

	ports {
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;

		port@0 {
			reg = &lt;0x00&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;

			endpoint@0 {
				reg = &lt;0x00&gt;;
				remote-endpoint = &lt;0xea&gt;;
				status = "disabled";
				phandle = &lt;0xe0&gt;;
			};

			endpoint@1 {
				reg = &lt;0x01&gt;;
				remote-endpoint = &lt;0x36&gt;;
				status = "disabled";
				phandle = &lt;0xe5&gt;;
			};
		};
	};
};

dsi@fde30000 {
	compatible = "rockchip,rk3588-mipi-dsi2";
	reg = &lt;0x00 0xfde30000 0x00 0x10000&gt;;
	interrupts = &lt;0x00 0xa8 0x04&gt;;
	clocks = &lt;0x02 0x279 0x02 0x27b&gt;;
	clock-names = "pclk\0sys_clk";
	resets = &lt;0x02 0x355&gt;;
	reset-names = "apb";
	power-domains = &lt;0x58 0x18&gt;;
	phys = &lt;0x30&gt;;
	phy-names = "dcphy";
	rockchip,grf = &lt;0xce&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	status = "disabled";

	ports {
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;

		port@0 {
			reg = &lt;0x00&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;

			endpoint@0 {
				reg = &lt;0x00&gt;;
				remote-endpoint = &lt;0xeb&gt;;
				status = "disabled";
				phandle = &lt;0xe1&gt;;
			};

			endpoint@1 {
				reg = &lt;0x01&gt;;
				remote-endpoint = &lt;0x37&gt;;
				status = "disabled";
				phandle = &lt;0xe6&gt;;
			};
		};
	};
};

hdcp@fde40000 {
	compatible = "rockchip,rk3588-hdcp";
	reg = &lt;0x00 0xfde40000 0x00 0x80&gt;;
	interrupts = &lt;0x00 0x9f 0x04&gt;;
	clocks = &lt;0x02 0x1ed 0x02 0x1ef 0x02 0x1ee 0x02 0x1ec 0x02 0x1f1 0x02 0x1f2&gt;;
	clock-names = "aclk\0pclk\0hclk\0hclk_key\0aclk_trng\0pclk_trng";
	resets = &lt;0x02 0x37f 0x02 0x37d 0x02 0x37c 0x02 0x37b 0x02 0x381&gt;;
	reset-names = "hdcp\0h_hdcp\0a_hdcp\0hdcp_key\0trng";
	power-domains = &lt;0x58 0x19&gt;;
	rockchip,vo-grf = &lt;0xec&gt;;
	status = "disabled";
};

dp@fde50000 {
	compatible = "rockchip,rk3588-dp";
	reg = &lt;0x00 0xfde50000 0x00 0x4000&gt;;
	interrupts = &lt;0x00 0xa1 0x04&gt;;
	clocks = &lt;0x02 0x1e6 0x02 0x2cc 0x02 0x1fb 0x02 0x207 0x04 0x02 0x1ea&gt;;
	clock-names = "apb\0aux\0i2s\0spdif\0hclk\0hdcp";
	assigned-clocks = &lt;0x02 0x2cc&gt;;
	assigned-clock-rates = &lt;0xf42400&gt;;
	resets = &lt;0x02 0x388&gt;;
	phys = &lt;0xed&gt;;
	power-domains = &lt;0x58 0x19&gt;;
	#sound-dai-cells = &lt;0x01&gt;;
	status = "disabled";
	phandle = &lt;0x1ba&gt;;

	ports {
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;

		port@0 {
			reg = &lt;0x00&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;

			endpoint@0 {
				reg = &lt;0x00&gt;;
				remote-endpoint = &lt;0xee&gt;;
				status = "disabled";
				phandle = &lt;0xd1&gt;;
			};

			endpoint@1 {
				reg = &lt;0x01&gt;;
				remote-endpoint = &lt;0x35&gt;;
				status = "disabled";
				phandle = &lt;0xd7&gt;;
			};

			endpoint@2 {
				reg = &lt;0x02&gt;;
				remote-endpoint = &lt;0xef&gt;;
				status = "disabled";
				phandle = &lt;0xdd&gt;;
			};
		};

		port@1 {
			reg = &lt;0x01&gt;;

			endpoint {
			};
		};
	};
};

hdcp@fde70000 {
	compatible = "rockchip,rk3588-hdcp";
	reg = &lt;0x00 0xfde70000 0x00 0x80&gt;;
	interrupts = &lt;0x00 0xa0 0x04&gt;;
	clocks = &lt;0x02 0x217 0x02 0x219 0x02 0x218 0x02 0x216 0x02 0x228 0x02 0x229&gt;;
	clock-names = "aclk\0pclk\0hclk\0hclk_key\0aclk_trng\0pclk_trng";
	resets = &lt;0x02 0x3c8 0x02 0x3c6 0x02 0x3c5 0x02 0x3c4 0x02 0x3ca&gt;;
	reset-names = "hdcp\0h_hdcp\0a_hdcp\0hdcp_key\0trng";
	power-domains = &lt;0x58 0x1a&gt;;
	rockchip,vo-grf = &lt;0xcf&gt;;
	status = "disabled";
};

hdmi@fde80000 {
	compatible = "rockchip,rk3588-dw-hdmi";
	reg = &lt;0x00 0xfde80000 0x00 0x10000 0x00 0xfde90000 0x00 0x10000&gt;;
	interrupts = &lt;0x00 0xa9 0x04 0x00 0xaa 0x04 0x00 0xab 0x04 0x00 0xac 0x04 0x00 0x168 0x04&gt;;
	clocks = &lt;0x02 0x221 0x02 0x265 0x02 0x222 0x02 0x223 0x02 0x246 0x02 0x274 0x02 0x275 0x02 0x276 0x02 0x277 0x05 0x32&gt;;
	clock-names = "pclk\0hpd\0earc\0hdmitx_ref\0aud\0dclk_vp0\0dclk_vp1\0dclk_vp2\0dclk_vp3\0hclk_vo1\0link_clk";
	resets = &lt;0x02 0x3d0 0x02 0x49c&gt;;
	reset-names = "ref\0hdp";
	power-domains = &lt;0x58 0x1a&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0xf0 0xf1 0xf2 0xf3&gt;;
	reg-io-width = &lt;0x04&gt;;
	rockchip,grf = &lt;0xbf&gt;;
	rockchip,vo1_grf = &lt;0xcf&gt;;
	phys = &lt;0xf4&gt;;
	phy-names = "hdmi";
	#sound-dai-cells = &lt;0x00&gt;;
	status = "okay";
	enable-gpios = &lt;0xf5 0x01 0x00&gt;;
	force_output_bus_format_RGB;
	phandle = &lt;0x1b6&gt;;

	ports {
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;

		port@0 {
			reg = &lt;0x00&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;

			endpoint@0 {
				reg = &lt;0x00&gt;;
				remote-endpoint = &lt;0x39&gt;;
				status = "okay";
				phandle = &lt;0xd3&gt;;
			};

			endpoint@1 {
				reg = &lt;0x01&gt;;
				remote-endpoint = &lt;0xf6&gt;;
				status = "disabled";
				phandle = &lt;0xd9&gt;;
			};

			endpoint@2 {
				reg = &lt;0x02&gt;;
				remote-endpoint = &lt;0xf7&gt;;
				status = "disabled";
				phandle = &lt;0xdf&gt;;
			};
		};
	};
};

edp@fdec0000 {
	compatible = "rockchip,rk3588-edp";
	reg = &lt;0x00 0xfdec0000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xa3 0x04&gt;;
	clocks = &lt;0x02 0x211 0x02 0x210 0x02 0x212 0x05&gt;;
	clock-names = "dp\0pclk\0spdif\0hclk";
	resets = &lt;0x02 0x3e1 0x02 0x3e0&gt;;
	reset-names = "dp\0apb";
	phys = &lt;0xf8&gt;;
	phy-names = "dp";
	power-domains = &lt;0x58 0x1a&gt;;
	rockchip,grf = &lt;0xcf&gt;;
	status = "disabled";

	ports {
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;

		port@0 {
			reg = &lt;0x00&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;

			endpoint@0 {
				reg = &lt;0x00&gt;;
				remote-endpoint = &lt;0xf9&gt;;
				status = "disabled";
				phandle = &lt;0xd2&gt;;
			};

			endpoint@1 {
				reg = &lt;0x01&gt;;
				remote-endpoint = &lt;0xfa&gt;;
				status = "disabled";
				phandle = &lt;0xd8&gt;;
			};

			endpoint@2 {
				reg = &lt;0x02&gt;;
				remote-endpoint = &lt;0x38&gt;;
				status = "disabled";
				phandle = &lt;0xde&gt;;
			};
		};

		port@1 {
			reg = &lt;0x01&gt;;

			endpoint {
			};
		};
	};
};

qos@fdf35000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf35000 0x00 0x20&gt;;
	phandle = &lt;0x7d&gt;;
};

qos@fdf35200 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf35200 0x00 0x20&gt;;
	phandle = &lt;0x7e&gt;;
};

qos@fdf35400 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf35400 0x00 0x20&gt;;
	phandle = &lt;0x7f&gt;;
};

qos@fdf35600 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf35600 0x00 0x20&gt;;
	phandle = &lt;0x80&gt;;
};

qos@fdf36000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf36000 0x00 0x20&gt;;
	phandle = &lt;0xa0&gt;;
};

qos@fdf39000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf39000 0x00 0x20&gt;;
	phandle = &lt;0xa5&gt;;
};

qos@fdf3d800 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf3d800 0x00 0x20&gt;;
	phandle = &lt;0xa6&gt;;
};

qos@fdf3e000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf3e000 0x00 0x20&gt;;
	phandle = &lt;0xa2&gt;;
};

qos@fdf3e200 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf3e200 0x00 0x20&gt;;
	phandle = &lt;0xa1&gt;;
};

qos@fdf3e400 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf3e400 0x00 0x20&gt;;
	phandle = &lt;0xa3&gt;;
};

qos@fdf3e600 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf3e600 0x00 0x20&gt;;
	phandle = &lt;0xa4&gt;;
};

qos@fdf40000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf40000 0x00 0x20&gt;;
	phandle = &lt;0x9e&gt;;
};

qos@fdf40200 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf40200 0x00 0x20&gt;;
	phandle = &lt;0x9f&gt;;
};

qos@fdf40400 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf40400 0x00 0x20&gt;;
	phandle = &lt;0x98&gt;;
};

qos@fdf40500 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf40500 0x00 0x20&gt;;
	phandle = &lt;0x99&gt;;
};

qos@fdf40600 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf40600 0x00 0x20&gt;;
	phandle = &lt;0x9a&gt;;
};

qos@fdf40800 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf40800 0x00 0x20&gt;;
	phandle = &lt;0x9b&gt;;
};

qos@fdf41000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf41000 0x00 0x20&gt;;
	phandle = &lt;0x9c&gt;;
};

qos@fdf41100 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf41100 0x00 0x20&gt;;
	phandle = &lt;0x9d&gt;;
};

qos@fdf60000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf60000 0x00 0x20&gt;;
	phandle = &lt;0x83&gt;;
};

qos@fdf60200 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf60200 0x00 0x20&gt;;
	phandle = &lt;0x84&gt;;
};

qos@fdf60400 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf60400 0x00 0x20&gt;;
	phandle = &lt;0x85&gt;;
};

qos@fdf61000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf61000 0x00 0x20&gt;;
	phandle = &lt;0x86&gt;;
};

qos@fdf61200 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf61200 0x00 0x20&gt;;
	phandle = &lt;0x87&gt;;
};

qos@fdf61400 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf61400 0x00 0x20&gt;;
	phandle = &lt;0x88&gt;;
};

qos@fdf62000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf62000 0x00 0x20&gt;;
	phandle = &lt;0x81&gt;;
};

qos@fdf63000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf63000 0x00 0x20&gt;;
	phandle = &lt;0x82&gt;;
};

qos@fdf64000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf64000 0x00 0x20&gt;;
	phandle = &lt;0x91&gt;;
};

qos@fdf66000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf66000 0x00 0x20&gt;;
	phandle = &lt;0x89&gt;;
};

qos@fdf66200 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf66200 0x00 0x20&gt;;
	phandle = &lt;0x8a&gt;;
};

qos@fdf66400 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf66400 0x00 0x20&gt;;
	phandle = &lt;0x8b&gt;;
};

qos@fdf66600 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf66600 0x00 0x20&gt;;
	phandle = &lt;0x8c&gt;;
};

qos@fdf66800 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf66800 0x00 0x20&gt;;
	phandle = &lt;0x8d&gt;;
};

qos@fdf66a00 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf66a00 0x00 0x20&gt;;
	phandle = &lt;0x8e&gt;;
};

qos@fdf66c00 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf66c00 0x00 0x20&gt;;
	phandle = &lt;0x8f&gt;;
};

qos@fdf66e00 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf66e00 0x00 0x20&gt;;
	phandle = &lt;0x90&gt;;
};

qos@fdf67000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf67000 0x00 0x20&gt;;
	phandle = &lt;0x92&gt;;
};

qos@fdf67200 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf67200 0x00 0x20&gt;;
};

qos@fdf70000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf70000 0x00 0x20&gt;;
	phandle = &lt;0x7b&gt;;
};

qos@fdf71000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf71000 0x00 0x20&gt;;
	phandle = &lt;0x7c&gt;;
};

qos@fdf72000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf72000 0x00 0x20&gt;;
	phandle = &lt;0x78&gt;;
};

qos@fdf72200 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf72200 0x00 0x20&gt;;
	phandle = &lt;0x79&gt;;
};

qos@fdf72400 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf72400 0x00 0x20&gt;;
	phandle = &lt;0x7a&gt;;
};

qos@fdf80000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf80000 0x00 0x20&gt;;
	phandle = &lt;0x95&gt;;
};

qos@fdf81000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf81000 0x00 0x20&gt;;
	phandle = &lt;0x96&gt;;
};

qos@fdf81200 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf81200 0x00 0x20&gt;;
	phandle = &lt;0x97&gt;;
};

qos@fdf82000 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf82000 0x00 0x20&gt;;
	phandle = &lt;0x93&gt;;
};

qos@fdf82200 {
	compatible = "syscon";
	reg = &lt;0x00 0xfdf82200 0x00 0x20&gt;;
	phandle = &lt;0x94&gt;;
};

dfi@fe060000 {
	compatible = "rockchip,rk3588-dfi";
	reg = &lt;0x00 0xfe060000 0x00 0x10000&gt;;
	rockchip,pmu_grf = &lt;0xfb&gt;;
	status = "okay";
	phandle = &lt;0x3d&gt;;
};

pcie@fe180000 {
	compatible = "rockchip,rk3588-pcie\0snps,dw-pcie";
	#address-cells = &lt;0x03&gt;;
	#size-cells = &lt;0x02&gt;;
	bus-range = &lt;0x30 0x3f&gt;;
	clocks = &lt;0x02 0x151 0x02 0x156 0x02 0x14c 0x02 0x15c 0x02 0x161 0x02 0x2c5&gt;;
	clock-names = "aclk_mst\0aclk_slv\0aclk_dbi\0pclk\0aux\0pipe";
	device_type = "pci";
	interrupts = &lt;0x00 0xf8 0x04 0x00 0xf7 0x04 0x00 0xf6 0x04 0x00 0xf5 0x04 0x00 0xf4 0x04&gt;;
	interrupt-names = "sys\0pmc\0msg\0legacy\0err";
	#interrupt-cells = &lt;0x01&gt;;
	interrupt-map-mask = &lt;0x00 0x00 0x00 0x07&gt;;
	interrupt-map = &lt;0x00 0x00 0x00 0x01 0xfc 0x00 0x00 0x00 0x00 0x02 0xfc 0x01 0x00 0x00 0x00 0x03 0xfc 0x02 0x00 0x00 0x00 0x04 0xfc 0x03&gt;;
	linux,pci-domain = &lt;0x03&gt;;
	num-ib-windows = &lt;0x08&gt;;
	num-ob-windows = &lt;0x08&gt;;
	num-viewport = &lt;0x04&gt;;
	max-link-speed = &lt;0x02&gt;;
	msi-map = &lt;0x3000 0xfd 0x3000 0x1000&gt;;
	num-lanes = &lt;0x01&gt;;
	phys = &lt;0x68 0x02&gt;;
	phy-names = "pcie-phy";
	ranges = &lt;0x800 0x00 0xf3000000 0x00 0xf3000000 0x00 0x100000 0x81000000 0x00 0xf3100000 0x00 0xf3100000 0x00 0x100000 0x82000000 0x00 0xf3200000 0x00 0xf3200000 0x00 0xe00000 0xc3000000 0x09 0xc0000000 0x09 0xc0000000 0x00 0x40000000&gt;;
	reg = &lt;0x00 0xfe180000 0x00 0x10000 0x0a 0x40c00000 0x00 0x400000&gt;;
	reg-names = "pcie-apb\0pcie-dbi";
	resets = &lt;0x02 0x210 0x02 0x21f&gt;;
	reset-names = "pcie\0periph";
	rockchip,pipe-grf = &lt;0x6f&gt;;
	status = "disabled";

	legacy-interrupt-controller {
		interrupt-controller;
		#address-cells = &lt;0x00&gt;;
		#interrupt-cells = &lt;0x01&gt;;
		interrupt-parent = &lt;0x01&gt;;
		interrupts = &lt;0x00 0xf5 0x01&gt;;
		phandle = &lt;0xfc&gt;;
	};
};

pcie@fe190000 {
	compatible = "rockchip,rk3588-pcie\0snps,dw-pcie";
	#address-cells = &lt;0x03&gt;;
	#size-cells = &lt;0x02&gt;;
	bus-range = &lt;0x40 0x4f&gt;;
	clocks = &lt;0x02 0x152 0x02 0x157 0x02 0x14d 0x02 0x15d 0x02 0x162 0x02 0x182&gt;;
	clock-names = "aclk_mst\0aclk_slv\0aclk_dbi\0pclk\0aux\0pipe";
	device_type = "pci";
	interrupts = &lt;0x00 0xfd 0x04 0x00 0xfc 0x04 0x00 0xfb 0x04 0x00 0xfa 0x04 0x00 0xf9 0x04&gt;;
	interrupt-names = "sys\0pmc\0msg\0legacy\0err";
	#interrupt-cells = &lt;0x01&gt;;
	interrupt-map-mask = &lt;0x00 0x00 0x00 0x07&gt;;
	interrupt-map = &lt;0x00 0x00 0x00 0x01 0xfe 0x00 0x00 0x00 0x00 0x02 0xfe 0x01 0x00 0x00 0x00 0x03 0xfe 0x02 0x00 0x00 0x00 0x04 0xfe 0x03&gt;;
	linux,pci-domain = &lt;0x04&gt;;
	num-ib-windows = &lt;0x08&gt;;
	num-ob-windows = &lt;0x08&gt;;
	num-viewport = &lt;0x04&gt;;
	max-link-speed = &lt;0x02&gt;;
	msi-map = &lt;0x4000 0xfd 0x4000 0x1000&gt;;
	num-lanes = &lt;0x01&gt;;
	phys = &lt;0xff 0x02&gt;;
	phy-names = "pcie-phy";
	ranges = &lt;0x800 0x00 0xf4000000 0x00 0xf4000000 0x00 0x100000 0x81000000 0x00 0xf4100000 0x00 0xf4100000 0x00 0x100000 0x82000000 0x00 0xf4200000 0x00 0xf4200000 0x00 0xe00000 0xc3000000 0x0a 0x00 0x0a 0x00 0x00 0x40000000&gt;;
	reg = &lt;0x00 0xfe190000 0x00 0x10000 0x0a 0x41000000 0x00 0x400000&gt;;
	reg-names = "pcie-apb\0pcie-dbi";
	resets = &lt;0x02 0x211 0x02 0x220&gt;;
	reset-names = "pcie\0periph";
	rockchip,pipe-grf = &lt;0x6f&gt;;
	status = "disabled";

	legacy-interrupt-controller {
		interrupt-controller;
		#address-cells = &lt;0x00&gt;;
		#interrupt-cells = &lt;0x01&gt;;
		interrupt-parent = &lt;0x01&gt;;
		interrupts = &lt;0x00 0xfa 0x01&gt;;
		phandle = &lt;0xfe&gt;;
	};
};

uio@fe1c0000 {
	compatible = "rockchip,uio-gmac";
	reg = &lt;0x00 0xfe1c0000 0x00 0x10000&gt;;
	rockchip,ethernet = &lt;0x100&gt;;
	status = "disabled";
};

ethernet@fe1c0000 {
	compatible = "rockchip,rk3588-gmac\0snps,dwmac-4.20a";
	reg = &lt;0x00 0xfe1c0000 0x00 0x10000&gt;;
	interrupts = &lt;0x00 0xea 0x04 0x00 0xe9 0x04&gt;;
	interrupt-names = "macirq\0eth_wake_irq";
	rockchip,grf = &lt;0xbf&gt;;
	rockchip,php_grf = &lt;0x6f&gt;;
	clocks = &lt;0x02 0x144 0x02 0x145 0x02 0x168 0x02 0x16d 0x02 0x143&gt;;
	clock-names = "stmmaceth\0clk_mac_ref\0pclk_mac\0aclk_mac\0ptp_ref";
	resets = &lt;0x02 0x20b&gt;;
	reset-names = "stmmaceth";
	power-domains = &lt;0x58 0x21&gt;;
	snps,mixed-burst;
	snps,tso;
	snps,axi-config = &lt;0x101&gt;;
	snps,mtl-rx-config = &lt;0x102&gt;;
	snps,mtl-tx-config = &lt;0x103&gt;;
	status = "okay";
	phy-mode = "rgmii-rxid";
	clock_in_out = "output";
	snps,reset-gpio = &lt;0x104 0x0f 0x01&gt;;
	snps,reset-active-low;
	snps,reset-delays-us = &lt;0x00 0x4e20 0x186a0&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x105 0x106 0x107 0x108 0x109&gt;;
	tx_delay = &lt;0x38&gt;;
	phy-handle = &lt;0x10a&gt;;
	phandle = &lt;0x100&gt;;

	mdio {
		compatible = "snps,dwmac-mdio";
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;

		phy@1 {
			compatible = "ethernet-phy-ieee802.3-c22";
			reg = &lt;0x01&gt;;
			phandle = &lt;0x10a&gt;;
		};
	};

	stmmac-axi-config {
		snps,wr_osr_lmt = &lt;0x04&gt;;
		snps,rd_osr_lmt = &lt;0x08&gt;;
		snps,blen = &lt;0x00 0x00 0x00 0x00 0x10 0x08 0x04&gt;;
		phandle = &lt;0x101&gt;;
	};

	rx-queues-config {
		snps,rx-queues-to-use = &lt;0x01&gt;;
		phandle = &lt;0x102&gt;;

		queue0 {
		};
	};

	tx-queues-config {
		snps,tx-queues-to-use = &lt;0x01&gt;;
		phandle = &lt;0x103&gt;;

		queue0 {
		};
	};
};

sata@fe210000 {
	compatible = "rockchip,rk-ahci\0snps,dwc-ahci";
	reg = &lt;0x00 0xfe210000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x171 0x02 0x16e 0x02 0x174 0x02 0x163 0x02 0x17e&gt;;
	clock-names = "sata\0pmalive\0rxoob\0ref\0asic";
	interrupts = &lt;0x00 0x111 0x04&gt;;
	interrupt-names = "hostc";
	phys = &lt;0xff 0x01&gt;;
	phy-names = "sata-phy";
	ports-implemented = &lt;0x01&gt;;
	status = "okay";
};

sata@fe230000 {
	compatible = "rockchip,rk-ahci\0snps,dwc-ahci";
	reg = &lt;0x00 0xfe230000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x173 0x02 0x170 0x02 0x176 0x02 0x165 0x02 0x180&gt;;
	clock-names = "sata\0pmalive\0rxoob\0ref\0asic";
	interrupts = &lt;0x00 0x113 0x04&gt;;
	interrupt-names = "hostc";
	phys = &lt;0x68 0x01&gt;;
	phy-names = "sata-phy";
	ports-implemented = &lt;0x01&gt;;
	status = "disabled";
};

spi@fe2b0000 {
	compatible = "rockchip,sfc";
	reg = &lt;0x00 0xfe2b0000 0x00 0x4000&gt;;
	interrupts = &lt;0x00 0xce 0x04&gt;;
	clocks = &lt;0x02 0x13d 0x02 0x13e&gt;;
	clock-names = "clk_sfc\0hclk_sfc";
	assigned-clocks = &lt;0x02 0x13d&gt;;
	assigned-clock-rates = &lt;0x5f5e100&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	status = "disabled";
};

mmc@fe2c0000 {
	compatible = "rockchip,rk3588-dw-mshc\0rockchip,rk3288-dw-mshc";
	reg = &lt;0x00 0xfe2c0000 0x00 0x4000&gt;;
	interrupts = &lt;0x00 0xcb 0x04&gt;;
	clocks = &lt;0x0e 0x17 0x0e 0x09 0x02 0x2c2 0x02 0x2c3&gt;;
	clock-names = "biu\0ciu\0ciu-drive\0ciu-sample";
	fifo-depth = &lt;0x100&gt;;
	max-frequency = &lt;0x8f0d180&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x10b 0x10c 0x10d 0x10e&gt;;
	power-domains = &lt;0x58 0x28&gt;;
	status = "okay";
	no-sdio;
	no-mmc;
	bus-width = &lt;0x04&gt;;
	cap-mmc-highspeed;
	cap-sd-highspeed;
	disable-wp;
	sd-uhs-sdr104;
	vqmmc-supply = &lt;0x10f&gt;;
	vmmc-supply = &lt;0x110&gt;;
};

mmc@fe2d0000 {
	compatible = "rockchip,rk3588-dw-mshc\0rockchip,rk3288-dw-mshc";
	reg = &lt;0x00 0xfe2d0000 0x00 0x4000&gt;;
	interrupts = &lt;0x00 0xcc 0x04&gt;;
	clocks = &lt;0x02 0x199 0x02 0x19a 0x02 0x2c0 0x02 0x2c1&gt;;
	clock-names = "biu\0ciu\0ciu-drive\0ciu-sample";
	fifo-depth = &lt;0x100&gt;;
	max-frequency = &lt;0x8f0d180&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x111&gt;;
	power-domains = &lt;0x58 0x25&gt;;
	status = "okay";
	no-sd;
	no-mmc;
	bus-width = &lt;0x04&gt;;
	disable-wp;
	cap-sd-highspeed;
	cap-sdio-irq;
	keep-power-in-suspend;
	mmc-pwrseq = &lt;0x112&gt;;
	non-removable;
};

mmc@fe2e0000 {
	compatible = "rockchip,rk3588-dwcmshc\0rockchip,dwcmshc-sdhci";
	reg = &lt;0x00 0xfe2e0000 0x00 0x10000&gt;;
	interrupts = &lt;0x00 0xcd 0x04&gt;;
	assigned-clocks = &lt;0x02 0x13b 0x02 0x13c 0x02 0x13a&gt;;
	assigned-clock-rates = &lt;0xbebc200 0x16e3600 0xbebc200&gt;;
	clocks = &lt;0x02 0x13a 0x02 0x138 0x02 0x139 0x02 0x13b 0x02 0x13c&gt;;
	clock-names = "core\0bus\0axi\0block\0timer";
	resets = &lt;0x02 0x1f6 0x02 0x1f4 0x02 0x1f5 0x02 0x1f7 0x02 0x1f8&gt;;
	reset-names = "core\0bus\0axi\0block\0timer";
	max-frequency = &lt;0xbebc200&gt;;
	status = "okay";
	bus-width = &lt;0x08&gt;;
	no-sdio;
	no-sd;
	non-removable;
	mmc-hs400-1_8v;
	mmc-hs400-enhanced-strobe;
	full-pwr-cycle-in-suspend;
};

crypto@fe370000 {
	compatible = "rockchip,rk3588-crypto";
	reg = &lt;0x00 0xfe370000 0x00 0x2000&gt;;
	interrupts = &lt;0x00 0xd1 0x04&gt;;
	clocks = &lt;0x0e 0x0b 0x0e 0x0c 0x0e 0x14 0x0e 0x15&gt;;
	clock-names = "aclk\0hclk\0sclk\0pka";
	resets = &lt;0x113 0x0f&gt;;
	reset-names = "crypto-rst";
	status = "disabled";
};

rng@fe378000 {
	compatible = "rockchip,trngv1";
	reg = &lt;0x00 0xfe378000 0x00 0x200&gt;;
	interrupts = &lt;0x00 0x190 0x04&gt;;
	clocks = &lt;0x0e 0x0c&gt;;
	clock-names = "hclk_trng";
	resets = &lt;0x113 0x30&gt;;
	reset-names = "reset";
	status = "okay";
};

i2s@fe470000 {
	compatible = "rockchip,rk3588-i2s-tdm";
	reg = &lt;0x00 0xfe470000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xb4 0x04&gt;;
	clocks = &lt;0x02 0x33 0x02 0x37 0x02 0x30&gt;;
	clock-names = "mclk_tx\0mclk_rx\0hclk";
	assigned-clocks = &lt;0x02 0x31 0x02 0x35&gt;;
	assigned-clock-parents = &lt;0x02 0x05 0x02 0x05&gt;;
	dmas = &lt;0x72 0x00 0x72 0x01&gt;;
	dma-names = "tx\0rx";
	power-domains = &lt;0x58 0x26&gt;;
	resets = &lt;0x02 0x77 0x02 0x7a&gt;;
	reset-names = "tx-m\0rx-m";
	rockchip,clk-trcm = &lt;0x01&gt;;
	pinctrl-names = "default\0idle\0clk";
	pinctrl-0 = &lt;0x114 0x115 0x116 0x117&gt;;
	pinctrl-1 = &lt;0x118&gt;;
	pinctrl-2 = &lt;0x114 0x115&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0x1c5&gt;;
};

i2s@fe480000 {
	compatible = "rockchip,rk3588-i2s-tdm";
	reg = &lt;0x00 0xfe480000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xb5 0x04&gt;;
	clocks = &lt;0x02 0x28c 0x02 0x290 0x02 0x288&gt;;
	clock-names = "mclk_tx\0mclk_rx\0hclk";
	dmas = &lt;0x72 0x02 0x72 0x03&gt;;
	dma-names = "tx\0rx";
	resets = &lt;0x02 0xc002a 0x02 0xc002d&gt;;
	reset-names = "tx-m\0rx-m";
	rockchip,clk-trcm = &lt;0x01&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x119 0x11a 0x11b 0x11c 0x11d 0x11e 0x11f 0x120 0x121 0x122&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

i2s@fe490000 {
	compatible = "rockchip,rk3588-i2s\0rockchip,rk3066-i2s";
	reg = &lt;0x00 0xfe490000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xb6 0x04&gt;;
	clocks = &lt;0x02 0x27 0x02 0x22&gt;;
	clock-names = "i2s_clk\0i2s_hclk";
	assigned-clocks = &lt;0x02 0x24&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	dmas = &lt;0xe8 0x00 0xe8 0x01&gt;;
	dma-names = "tx\0rx";
	power-domains = &lt;0x58 0x26&gt;;
	rockchip,clk-trcm = &lt;0x01&gt;;
	pinctrl-names = "default\0idle\0clk";
	pinctrl-0 = &lt;0x123 0x124&gt;;
	pinctrl-1 = &lt;0x125&gt;;
	pinctrl-2 = &lt;0x126 0x127&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

i2s@fe4a0000 {
	compatible = "rockchip,rk3588-i2s\0rockchip,rk3066-i2s";
	reg = &lt;0x00 0xfe4a0000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xb7 0x04&gt;;
	clocks = &lt;0x02 0x2d 0x02 0x23&gt;;
	clock-names = "i2s_clk\0i2s_hclk";
	assigned-clocks = &lt;0x02 0x2a&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	dmas = &lt;0xe8 0x02 0xe8 0x03&gt;;
	dma-names = "tx\0rx";
	power-domains = &lt;0x58 0x26&gt;;
	rockchip,clk-trcm = &lt;0x01&gt;;
	pinctrl-names = "default\0idle\0clk";
	pinctrl-0 = &lt;0x128 0x129&gt;;
	pinctrl-1 = &lt;0x12a&gt;;
	pinctrl-2 = &lt;0x12b 0x12c&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

pdm@fe4b0000 {
	compatible = "rockchip,rk3588-pdm";
	reg = &lt;0x00 0xfe4b0000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x29f 0x02 0x29e&gt;;
	clock-names = "pdm_clk\0pdm_hclk";
	dmas = &lt;0x72 0x04&gt;;
	dma-names = "rx";
	pinctrl-names = "default\0idle\0clk";
	pinctrl-0 = &lt;0x12d 0x12e 0x12f 0x130&gt;;
	pinctrl-1 = &lt;0x131&gt;;
	pinctrl-2 = &lt;0x132 0x133&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

pdm@fe4c0000 {
	compatible = "rockchip,rk3588-pdm";
	reg = &lt;0x00 0xfe4c0000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x3b 0x02 0x3a&gt;;
	clock-names = "pdm_clk\0pdm_hclk";
	assigned-clocks = &lt;0x02 0x3b&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	dmas = &lt;0xe8 0x04&gt;;
	dma-names = "rx";
	power-domains = &lt;0x58 0x26&gt;;
	pinctrl-names = "default\0idle\0clk";
	pinctrl-0 = &lt;0x134 0x135 0x136 0x137&gt;;
	pinctrl-1 = &lt;0x138&gt;;
	pinctrl-2 = &lt;0x139 0x13a&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

vad@fe4d0000 {
	compatible = "rockchip,rk3588-vad";
	reg = &lt;0x00 0xfe4d0000 0x00 0x1000&gt;;
	reg-names = "vad";
	clocks = &lt;0x02 0x2a0&gt;;
	clock-names = "hclk";
	interrupts = &lt;0x00 0xca 0x04&gt;;
	rockchip,audio-src = &lt;0x00&gt;;
	rockchip,det-channel = &lt;0x00&gt;;
	rockchip,mode = &lt;0x00&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

spdif-tx@fe4e0000 {
	compatible = "rockchip,rk3588-spdif\0rockchip,rk3568-spdif";
	reg = &lt;0x00 0xfe4e0000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xc1 0x04&gt;;
	dmas = &lt;0x72 0x05&gt;;
	dma-names = "tx";
	clock-names = "mclk\0hclk";
	clocks = &lt;0x02 0x41 0x02 0x3e&gt;;
	assigned-clocks = &lt;0x02 0x3f&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	power-domains = &lt;0x58 0x26&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x13b&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
	phandle = &lt;0x1bd&gt;;
};

spdif-tx@fe4f0000 {
	compatible = "rockchip,rk3588-spdif\0rockchip,rk3568-spdif";
	reg = &lt;0x00 0xfe4f0000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xc2 0x04&gt;;
	dmas = &lt;0xe8 0x05&gt;;
	dma-names = "tx";
	clock-names = "mclk\0hclk";
	clocks = &lt;0x02 0x47 0x02 0x44&gt;;
	assigned-clocks = &lt;0x02 0x45&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	power-domains = &lt;0x58 0x26&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x13c&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
	phandle = &lt;0x1bf&gt;;
};

codec-digital@fe500000 {
	compatible = "rockchip,rk3588-codec-digital\0rockchip,codec-digital-v1";
	reg = &lt;0x00 0xfe500000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x29 0x02 0x2f&gt;;
	clock-names = "dac\0pclk";
	power-domains = &lt;0x58 0x26&gt;;
	resets = &lt;0x02 0x84&gt;;
	reset-names = "reset";
	rockchip,grf = &lt;0xbf&gt;;
	rockchip,pwm-output-mode;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x13d&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

hwspinlock@fe5a0000 {
	compatible = "rockchip,hwspinlock";
	reg = &lt;0x00 0xfe5a0000 0x00 0x100&gt;;
	#hwlock-cells = &lt;0x01&gt;;
};

interrupt-controller@fe600000 {
	compatible = "arm,gic-v3";
	#interrupt-cells = &lt;0x03&gt;;
	#address-cells = &lt;0x02&gt;;
	#size-cells = &lt;0x02&gt;;
	ranges;
	interrupt-controller;
	reg = &lt;0x00 0xfe600000 0x00 0x10000 0x00 0xfe680000 0x00 0x100000&gt;;
	interrupts = &lt;0x01 0x09 0x04&gt;;
	phandle = &lt;0x01&gt;;

	msi-controller@fe640000 {
		compatible = "arm,gic-v3-its";
		msi-controller;
		#msi-cells = &lt;0x01&gt;;
		reg = &lt;0x00 0xfe640000 0x00 0x20000&gt;;
		phandle = &lt;0xfd&gt;;
	};

	msi-controller@fe660000 {
		compatible = "arm,gic-v3-its";
		msi-controller;
		#msi-cells = &lt;0x01&gt;;
		reg = &lt;0x00 0xfe660000 0x00 0x20000&gt;;
		phandle = &lt;0x1a4&gt;;
	};
};

dma-controller@fea10000 {
	compatible = "arm,pl330\0arm,primecell";
	reg = &lt;0x00 0xfea10000 0x00 0x4000&gt;;
	interrupts = &lt;0x00 0x56 0x04 0x00 0x57 0x04&gt;;
	clocks = &lt;0x02 0x78&gt;;
	clock-names = "apb_pclk";
	#dma-cells = &lt;0x01&gt;;
	arm,pl330-periph-burst;
	phandle = &lt;0x72&gt;;
};

dma-controller@fea30000 {
	compatible = "arm,pl330\0arm,primecell";
	reg = &lt;0x00 0xfea30000 0x00 0x4000&gt;;
	interrupts = &lt;0x00 0x58 0x04 0x00 0x59 0x04&gt;;
	clocks = &lt;0x02 0x79&gt;;
	clock-names = "apb_pclk";
	#dma-cells = &lt;0x01&gt;;
	arm,pl330-periph-burst;
	phandle = &lt;0xe8&gt;;
};

can@fea50000 {
	compatible = "rockchip,can-2.0";
	reg = &lt;0x00 0xfea50000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0x155 0x04&gt;;
	clocks = &lt;0x02 0x70 0x02 0x6f&gt;;
	clock-names = "baudclk\0apb_pclk";
	resets = &lt;0x02 0xb9 0x02 0xb8&gt;;
	reset-names = "can\0can-apb";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x13e&gt;;
	tx-fifo-depth = &lt;0x01&gt;;
	rx-fifo-depth = &lt;0x06&gt;;
	status = "disabled";
	assigned-clocks = &lt;0x02 0x70&gt;;
	assigned-clock-rates = &lt;0xbebc200&gt;;
};

can@fea60000 {
	compatible = "rockchip,can-2.0";
	reg = &lt;0x00 0xfea60000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0x156 0x04&gt;;
	clocks = &lt;0x02 0x72 0x02 0x71&gt;;
	clock-names = "baudclk\0apb_pclk";
	resets = &lt;0x02 0xbb 0x02 0xba&gt;;
	reset-names = "can\0can-apb";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x13f&gt;;
	tx-fifo-depth = &lt;0x01&gt;;
	rx-fifo-depth = &lt;0x06&gt;;
	status = "okay";
	assigned-clocks = &lt;0x02 0x72&gt;;
	assigned-clock-rates = &lt;0xbebc200&gt;;
};

can@fea70000 {
	compatible = "rockchip,can-2.0";
	reg = &lt;0x00 0xfea70000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0x157 0x04&gt;;
	clocks = &lt;0x02 0x74 0x02 0x73&gt;;
	clock-names = "baudclk\0apb_pclk";
	resets = &lt;0x02 0xbd 0x02 0xbc&gt;;
	reset-names = "can\0can-apb";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x140&gt;;
	tx-fifo-depth = &lt;0x01&gt;;
	rx-fifo-depth = &lt;0x06&gt;;
	status = "disabled";
};

decompress@fea80000 {
	compatible = "rockchip,hw-decompress";
	reg = &lt;0x00 0xfea80000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0x55 0x04&gt;;
	clocks = &lt;0x02 0x75 0x02 0x77 0x02 0x76&gt;;
	clock-names = "aclk\0dclk\0pclk";
	resets = &lt;0x02 0x118&gt;;
	reset-names = "dresetn";
	status = "disabled";
};

i2c@fea90000 {
	compatible = "rockchip,rk3588-i2c\0rockchip,rk3399-i2c";
	reg = &lt;0x00 0xfea90000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x8d 0x02 0x85&gt;;
	clock-names = "i2c\0pclk";
	interrupts = &lt;0x00 0x13e 0x04&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x141&gt;;
	resets = &lt;0x02 0xb0 0x02 0xa8&gt;;
	reset-names = "i2c\0apb";
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	status = "okay";

	rk8602@42 {
		compatible = "rockchip,rk8602";
		reg = &lt;0x42&gt;;
		vin-supply = &lt;0x71&gt;;
		regulator-compatible = "rk860x-reg";
		regulator-name = "vdd_npu_s0";
		regulator-min-microvolt = &lt;0x86470&gt;;
		regulator-max-microvolt = &lt;0xe7ef0&gt;;
		regulator-ramp-delay = &lt;0x8fc&gt;;
		rockchip,suspend-voltage-selector = &lt;0x01&gt;;
		regulator-boot-on;
		regulator-always-on;
		phandle = &lt;0xa9&gt;;

		regulator-state-mem {
			regulator-off-in-suspend;
		};
	};
};

i2c@feaa0000 {
	compatible = "rockchip,rk3588-i2c\0rockchip,rk3399-i2c";
	reg = &lt;0x00 0xfeaa0000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x8e 0x02 0x86&gt;;
	clock-names = "i2c\0pclk";
	interrupts = &lt;0x00 0x13f 0x04&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x142&gt;;
	resets = &lt;0x02 0xb1 0x02 0xa9&gt;;
	reset-names = "i2c\0apb";
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	status = "disabled";
};

i2c@feab0000 {
	compatible = "rockchip,rk3588-i2c\0rockchip,rk3399-i2c";
	reg = &lt;0x00 0xfeab0000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x8f 0x02 0x87&gt;;
	clock-names = "i2c\0pclk";
	interrupts = &lt;0x00 0x140 0x04&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x143&gt;;
	resets = &lt;0x02 0xb2 0x02 0xaa&gt;;
	reset-names = "i2c\0apb";
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	status = "disabled";
};

i2c@feac0000 {
	compatible = "rockchip,rk3588-i2c\0rockchip,rk3399-i2c";
	reg = &lt;0x00 0xfeac0000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x90 0x02 0x88&gt;;
	clock-names = "i2c\0pclk";
	interrupts = &lt;0x00 0x141 0x04&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x144&gt;;
	resets = &lt;0x02 0xb3 0x02 0xab&gt;;
	reset-names = "i2c\0apb";
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	status = "disabled";
};

i2c@fead0000 {
	compatible = "rockchip,rk3588-i2c\0rockchip,rk3399-i2c";
	reg = &lt;0x00 0xfead0000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x91 0x02 0x89&gt;;
	clock-names = "i2c\0pclk";
	interrupts = &lt;0x00 0x142 0x04&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x145&gt;;
	resets = &lt;0x02 0xb4 0x02 0xac&gt;;
	reset-names = "i2c\0apb";
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	status = "okay";
};

timer@feae0000 {
	compatible = "rockchip,rk3588-timer\0rockchip,rk3288-timer";
	reg = &lt;0x00 0xfeae0000 0x00 0x20&gt;;
	interrupts = &lt;0x00 0x121 0x04&gt;;
	clocks = &lt;0x02 0x5c 0x02 0x5f&gt;;
	clock-names = "pclk\0timer";
};

watchdog@feaf0000 {
	compatible = "snps,dw-wdt";
	reg = &lt;0x00 0xfeaf0000 0x00 0x100&gt;;
	clocks = &lt;0x02 0x6c 0x02 0x6b&gt;;
	clock-names = "tclk\0pclk";
	interrupts = &lt;0x00 0x13b 0x04&gt;;
	status = "okay";
};

spi@feb00000 {
	compatible = "rockchip,rk3066-spi";
	reg = &lt;0x00 0xfeb00000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0x146 0x04&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	clocks = &lt;0x02 0xa3 0x02 0x9e&gt;;
	clock-names = "spiclk\0apb_pclk";
	dmas = &lt;0x72 0x0e 0x72 0x0f&gt;;
	dma-names = "tx\0rx";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x146 0x147 0x148&gt;;
	num-cs = &lt;0x02&gt;;
	status = "disabled";
};

spi@feb10000 {
	compatible = "rockchip,rk3066-spi";
	reg = &lt;0x00 0xfeb10000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0x147 0x04&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	clocks = &lt;0x02 0xa4 0x02 0x9f&gt;;
	clock-names = "spiclk\0apb_pclk";
	dmas = &lt;0x72 0x10 0x72 0x11&gt;;
	dma-names = "tx\0rx";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x149 0x14a 0x14b&gt;;
	num-cs = &lt;0x02&gt;;
	status = "disabled";
};

spi@feb20000 {
	compatible = "rockchip,rk3066-spi";
	reg = &lt;0x00 0xfeb20000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0x148 0x04&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	clocks = &lt;0x02 0xa5 0x02 0xa0&gt;;
	clock-names = "spiclk\0apb_pclk";
	dmas = &lt;0xe8 0x0f 0xe8 0x10&gt;;
	dma-names = "tx\0rx";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x14c 0x14d&gt;;
	num-cs = &lt;0x01&gt;;
	status = "okay";
	assigned-clocks = &lt;0x02 0xa5&gt;;
	assigned-clock-rates = &lt;0xbebc200&gt;;

	rk806single@0 {
		compatible = "rockchip,rk806";
		spi-max-frequency = &lt;0xf4240&gt;;
		reg = &lt;0x00&gt;;
		interrupt-parent = &lt;0x14e&gt;;
		interrupts = &lt;0x07 0x08&gt;;
		pinctrl-names = "default\0pmic-power-off";
		pinctrl-0 = &lt;0x14f 0x150 0x151 0x152&gt;;
		pinctrl-1 = &lt;0x153&gt;;
		low_voltage_threshold = &lt;0xbb8&gt;;
		shutdown_voltage_threshold = &lt;0xa8c&gt;;
		shutdown_temperture_threshold = &lt;0xa0&gt;;
		hotdie_temperture_threshold = &lt;0x73&gt;;
		pmic-reset-func = &lt;0x01&gt;;
		vcc1-supply = &lt;0x71&gt;;
		vcc2-supply = &lt;0x71&gt;;
		vcc3-supply = &lt;0x71&gt;;
		vcc4-supply = &lt;0x71&gt;;
		vcc5-supply = &lt;0x71&gt;;
		vcc6-supply = &lt;0x71&gt;;
		vcc7-supply = &lt;0x71&gt;;
		vcc8-supply = &lt;0x71&gt;;
		vcc9-supply = &lt;0x71&gt;;
		vcc10-supply = &lt;0x71&gt;;
		vcc11-supply = &lt;0x154&gt;;
		vcc12-supply = &lt;0x71&gt;;
		vcc13-supply = &lt;0x155&gt;;
		vcc14-supply = &lt;0x155&gt;;
		vcca-supply = &lt;0x71&gt;;

		pwrkey {
			status = "okay";
		};

		pinctrl_rk806 {
			gpio-controller;
			#gpio-cells = &lt;0x02&gt;;

			rk806_dvs1_null {
				pins = "gpio_pwrctrl2";
				function = "pin_fun0";
				phandle = &lt;0x150&gt;;
			};

			rk806_dvs1_slp {
				pins = "gpio_pwrctrl1";
				function = "pin_fun1";
			};

			rk806_dvs1_pwrdn {
				pins = "gpio_pwrctrl1";
				function = "pin_fun2";
				phandle = &lt;0x153&gt;;
			};

			rk806_dvs1_rst {
				pins = "gpio_pwrctrl1";
				function = "pin_fun3";
			};

			rk806_dvs2_null {
				pins = "gpio_pwrctrl2";
				function = "pin_fun0";
				phandle = &lt;0x151&gt;;
			};

			rk806_dvs2_slp {
				pins = "gpio_pwrctrl2";
				function = "pin_fun1";
			};

			rk806_dvs2_pwrdn {
				pins = "gpio_pwrctrl2";
				function = "pin_fun2";
			};

			rk806_dvs2_rst {
				pins = "gpio_pwrctrl2";
				function = "pin_fun3";
			};

			rk806_dvs2_dvs {
				pins = "gpio_pwrctrl2";
				function = "pin_fun4";
			};

			rk806_dvs2_gpio {
				pins = "gpio_pwrctrl2";
				function = "pin_fun5";
			};

			rk806_dvs3_null {
				pins = "gpio_pwrctrl3";
				function = "pin_fun0";
				phandle = &lt;0x152&gt;;
			};

			rk806_dvs3_slp {
				pins = "gpio_pwrctrl3";
				function = "pin_fun1";
			};

			rk806_dvs3_pwrdn {
				pins = "gpio_pwrctrl3";
				function = "pin_fun2";
			};

			rk806_dvs3_rst {
				pins = "gpio_pwrctrl3";
				function = "pin_fun3";
			};

			rk806_dvs3_dvs {
				pins = "gpio_pwrctrl3";
				function = "pin_fun4";
			};

			rk806_dvs3_gpio {
				pins = "gpio_pwrctrl3";
				function = "pin_fun5";
			};
		};

		regulators {

			DCDC_REG1 {
				regulator-boot-on;
				regulator-min-microvolt = &lt;0x86470&gt;;
				regulator-max-microvolt = &lt;0xe7ef0&gt;;
				regulator-ramp-delay = &lt;0x30d4&gt;;
				regulator-name = "vdd_gpu_s0";
				regulator-enable-ramp-delay = &lt;0x190&gt;;
				phandle = &lt;0x5a&gt;;

				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			DCDC_REG2 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0x86470&gt;;
				regulator-max-microvolt = &lt;0xe7ef0&gt;;
				regulator-ramp-delay = &lt;0x30d4&gt;;
				regulator-name = "vdd_cpu_lit_s0";
				phandle = &lt;0x12&gt;;

				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			DCDC_REG3 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0xa4cb8&gt;;
				regulator-max-microvolt = &lt;0xb71b0&gt;;
				regulator-ramp-delay = &lt;0x30d4&gt;;
				regulator-name = "vdd_log_s0";
				phandle = &lt;0x40&gt;;

				regulator-state-mem {
					regulator-off-in-suspend;
					regulator-suspend-microvolt = &lt;0xb71b0&gt;;
				};
			};

			DCDC_REG4 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0x86470&gt;;
				regulator-max-microvolt = &lt;0xe7ef0&gt;;
				regulator-init-microvolt = &lt;0xb71b0&gt;;
				regulator-ramp-delay = &lt;0x30d4&gt;;
				regulator-name = "vdd_vdenc_s0";
				phandle = &lt;0xbb&gt;;

				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			DCDC_REG5 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0xa4cb8&gt;;
				regulator-max-microvolt = &lt;0xdbba0&gt;;
				regulator-ramp-delay = &lt;0x30d4&gt;;
				regulator-name = "vdd_ddr_s0";
				phandle = &lt;0x3f&gt;;

				regulator-state-mem {
					regulator-off-in-suspend;
					regulator-suspend-microvolt = &lt;0xcf850&gt;;
				};
			};

			DCDC_REG6 {
				regulator-always-on;
				regulator-boot-on;
				regulator-name = "vdd2_ddr_s3";

				regulator-state-mem {
					regulator-on-in-suspend;
				};
			};

			DCDC_REG7 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0x1e8480&gt;;
				regulator-max-microvolt = &lt;0x1e8480&gt;;
				regulator-name = "vdd_2v0_pldo_s3";
				phandle = &lt;0x154&gt;;

				regulator-state-mem {
					regulator-on-in-suspend;
					regulator-suspend-microvolt = &lt;0x1e8480&gt;;
				};
			};

			DCDC_REG8 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0x325aa0&gt;;
				regulator-max-microvolt = &lt;0x325aa0&gt;;
				regulator-name = "vcc_3v3_s3";
				phandle = &lt;0x1d1&gt;;

				regulator-state-mem {
					regulator-on-in-suspend;
					regulator-suspend-microvolt = &lt;0x325aa0&gt;;
				};
			};

			DCDC_REG9 {
				regulator-always-on;
				regulator-boot-on;
				regulator-name = "vddq_ddr_s0";

				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			DCDC_REG10 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0x1b7740&gt;;
				regulator-max-microvolt = &lt;0x1b7740&gt;;
				regulator-name = "vcc_1v8_s3";

				regulator-state-mem {
					regulator-on-in-suspend;
					regulator-suspend-microvolt = &lt;0x1b7740&gt;;
				};
			};

			PLDO_REG1 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0x1b7740&gt;;
				regulator-max-microvolt = &lt;0x1b7740&gt;;
				regulator-name = "avcc_1v8_s0";
				phandle = &lt;0x1cb&gt;;

				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			PLDO_REG2 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0x1b7740&gt;;
				regulator-max-microvolt = &lt;0x1b7740&gt;;
				regulator-name = "vcc_1v8_s0";
				phandle = &lt;0x171&gt;;

				regulator-state-mem {
					regulator-off-in-suspend;
					regulator-suspend-microvolt = &lt;0x1b7740&gt;;
				};
			};

			PLDO_REG3 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0x124f80&gt;;
				regulator-max-microvolt = &lt;0x124f80&gt;;
				regulator-name = "avdd_1v2_s0";

				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			PLDO_REG4 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0x325aa0&gt;;
				regulator-max-microvolt = &lt;0x325aa0&gt;;
				regulator-name = "vcc_3v3_s0";

				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			PLDO_REG5 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0x1b7740&gt;;
				regulator-max-microvolt = &lt;0x325aa0&gt;;
				regulator-name = "vccio_sd_s0";
				phandle = &lt;0x10f&gt;;

				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			PLDO_REG6 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0x1b7740&gt;;
				regulator-max-microvolt = &lt;0x1b7740&gt;;
				regulator-name = "pldo6_s3";

				regulator-state-mem {
					regulator-on-in-suspend;
					regulator-suspend-microvolt = &lt;0x1b7740&gt;;
				};
			};

			NLDO_REG1 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0xb71b0&gt;;
				regulator-max-microvolt = &lt;0xb71b0&gt;;
				regulator-name = "vdd_0v75_s3";

				regulator-state-mem {
					regulator-on-in-suspend;
					regulator-suspend-microvolt = &lt;0xb71b0&gt;;
				};
			};

			NLDO_REG2 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0xcf850&gt;;
				regulator-max-microvolt = &lt;0xcf850&gt;;
				regulator-name = "vdd_ddr_pll_s0";

				regulator-state-mem {
					regulator-off-in-suspend;
					regulator-suspend-microvolt = &lt;0xcf850&gt;;
				};
			};

			NLDO_REG3 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0xcc77c&gt;;
				regulator-max-microvolt = &lt;0xcc77c&gt;;
				regulator-name = "avdd_0v75_s0";
				phandle = &lt;0x1cc&gt;;

				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			NLDO_REG4 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0xcf850&gt;;
				regulator-max-microvolt = &lt;0xcf850&gt;;
				regulator-name = "vdd_0v85_s0";
				phandle = &lt;0x1ca&gt;;

				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			NLDO_REG5 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = &lt;0xb71b0&gt;;
				regulator-max-microvolt = &lt;0xb71b0&gt;;
				regulator-name = "vdd_0v75_s0";

				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};
		};
	};
};

spi@feb30000 {
	compatible = "rockchip,rk3066-spi";
	reg = &lt;0x00 0xfeb30000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0x149 0x04&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	clocks = &lt;0x02 0xa6 0x02 0xa1&gt;;
	clock-names = "spiclk\0apb_pclk";
	dmas = &lt;0xe8 0x11 0xe8 0x12&gt;;
	dma-names = "tx\0rx";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x156 0x157 0x158&gt;;
	num-cs = &lt;0x02&gt;;
	status = "disabled";
};

serial@feb40000 {
	compatible = "rockchip,rk3588-uart\0snps,dw-apb-uart";
	reg = &lt;0x00 0xfeb40000 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x14c 0x04&gt;;
	clocks = &lt;0x02 0xb7 0x02 0xab&gt;;
	clock-names = "baudclk\0apb_pclk";
	reg-shift = &lt;0x02&gt;;
	reg-io-width = &lt;0x04&gt;;
	dmas = &lt;0x72 0x08 0x72 0x09&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x159&gt;;
	status = "disabled";
};

serial@feb50000 {
	compatible = "rockchip,rk3588-uart\0snps,dw-apb-uart";
	reg = &lt;0x00 0xfeb50000 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x14d 0x04&gt;;
	clocks = &lt;0x02 0xbb 0x02 0xac&gt;;
	clock-names = "baudclk\0apb_pclk";
	reg-shift = &lt;0x02&gt;;
	reg-io-width = &lt;0x04&gt;;
	dmas = &lt;0x72 0x0a 0x72 0x0b&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x15a&gt;;
	status = "disabled";
};

serial@feb60000 {
	compatible = "rockchip,rk3588-uart\0snps,dw-apb-uart";
	reg = &lt;0x00 0xfeb60000 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x14e 0x04&gt;;
	clocks = &lt;0x02 0xbf 0x02 0xad&gt;;
	clock-names = "baudclk\0apb_pclk";
	reg-shift = &lt;0x02&gt;;
	reg-io-width = &lt;0x04&gt;;
	dmas = &lt;0x72 0x0c 0x72 0x0d&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x15b&gt;;
	status = "okay";
};

serial@feb70000 {
	compatible = "rockchip,rk3588-uart\0snps,dw-apb-uart";
	reg = &lt;0x00 0xfeb70000 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x14f 0x04&gt;;
	clocks = &lt;0x02 0xc3 0x02 0xae&gt;;
	clock-names = "baudclk\0apb_pclk";
	reg-shift = &lt;0x02&gt;;
	reg-io-width = &lt;0x04&gt;;
	dmas = &lt;0xe8 0x09 0xe8 0x0a&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x15c&gt;;
	status = "disabled";
};

serial@feb80000 {
	compatible = "rockchip,rk3588-uart\0snps,dw-apb-uart";
	reg = &lt;0x00 0xfeb80000 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x150 0x04&gt;;
	clocks = &lt;0x02 0xc7 0x02 0xaf&gt;;
	clock-names = "baudclk\0apb_pclk";
	reg-shift = &lt;0x02&gt;;
	reg-io-width = &lt;0x04&gt;;
	dmas = &lt;0xe8 0x0b 0xe8 0x0c&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x15d&gt;;
	status = "disabled";
};

serial@feb90000 {
	compatible = "rockchip,rk3588-uart\0snps,dw-apb-uart";
	reg = &lt;0x00 0xfeb90000 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x151 0x04&gt;;
	clocks = &lt;0x02 0xcb 0x02 0xb0&gt;;
	clock-names = "baudclk\0apb_pclk";
	reg-shift = &lt;0x02&gt;;
	reg-io-width = &lt;0x04&gt;;
	dmas = &lt;0xe8 0x0d 0xe8 0x0e&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x15e&gt;;
	status = "disabled";
};

serial@feba0000 {
	compatible = "rockchip,rk3588-uart\0snps,dw-apb-uart";
	reg = &lt;0x00 0xfeba0000 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x152 0x04&gt;;
	clocks = &lt;0x02 0xcf 0x02 0xb1&gt;;
	clock-names = "baudclk\0apb_pclk";
	reg-shift = &lt;0x02&gt;;
	reg-io-width = &lt;0x04&gt;;
	dmas = &lt;0xe9 0x07 0xe9 0x08&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x15f&gt;;
	status = "okay";
};

serial@febb0000 {
	compatible = "rockchip,rk3588-uart\0snps,dw-apb-uart";
	reg = &lt;0x00 0xfebb0000 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x153 0x04&gt;;
	clocks = &lt;0x02 0xd3 0x02 0xb2&gt;;
	clock-names = "baudclk\0apb_pclk";
	reg-shift = &lt;0x02&gt;;
	reg-io-width = &lt;0x04&gt;;
	dmas = &lt;0xe9 0x09 0xe9 0x0a&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x160&gt;;
	status = "okay";
};

serial@febc0000 {
	compatible = "rockchip,rk3588-uart\0snps,dw-apb-uart";
	reg = &lt;0x00 0xfebc0000 0x00 0x100&gt;;
	interrupts = &lt;0x00 0x154 0x04&gt;;
	clocks = &lt;0x02 0xd7 0x02 0xb3&gt;;
	clock-names = "baudclk\0apb_pclk";
	reg-shift = &lt;0x02&gt;;
	reg-io-width = &lt;0x04&gt;;
	dmas = &lt;0xe9 0x0b 0xe9 0x0c&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x161 0x162&gt;;
	status = "okay";
};

pwm@febd0000 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfebd0000 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x15a 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x163&gt;;
	clocks = &lt;0x02 0x54 0x02 0x53&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@febd0010 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfebd0010 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x15a 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x164&gt;;
	clocks = &lt;0x02 0x54 0x02 0x53&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@febd0020 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfebd0020 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x15a 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x165&gt;;
	clocks = &lt;0x02 0x54 0x02 0x53&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@febd0030 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfebd0030 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x15a 0x04 0x00 0x15b 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x166&gt;;
	clocks = &lt;0x02 0x54 0x02 0x53&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@febe0000 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfebe0000 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x15c 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x167&gt;;
	clocks = &lt;0x02 0x57 0x02 0x56&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@febe0010 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfebe0010 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x15c 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x168&gt;;
	clocks = &lt;0x02 0x57 0x02 0x56&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@febe0020 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfebe0020 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x15c 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x169&gt;;
	clocks = &lt;0x02 0x57 0x02 0x56&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@febe0030 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfebe0030 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x15c 0x04 0x00 0x15d 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x16a&gt;;
	clocks = &lt;0x02 0x57 0x02 0x56&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@febf0000 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfebf0000 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x15e 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x16b&gt;;
	clocks = &lt;0x02 0x5a 0x02 0x59&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@febf0010 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfebf0010 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x15e 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x16c&gt;;
	clocks = &lt;0x02 0x5a 0x02 0x59&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@febf0020 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfebf0020 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x15e 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x16d&gt;;
	clocks = &lt;0x02 0x5a 0x02 0x59&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

pwm@febf0030 {
	compatible = "rockchip,rk3588-pwm\0rockchip,rk3328-pwm";
	reg = &lt;0x00 0xfebf0030 0x00 0x10&gt;;
	interrupts = &lt;0x00 0x15e 0x04 0x00 0x15f 0x04&gt;;
	#pwm-cells = &lt;0x03&gt;;
	pinctrl-names = "active";
	pinctrl-0 = &lt;0x16e&gt;;
	clocks = &lt;0x02 0x5a 0x02 0x59&gt;;
	clock-names = "pwm\0pclk";
	status = "disabled";
};

tsadc@fec00000 {
	compatible = "rockchip,rk3588-tsadc";
	reg = &lt;0x00 0xfec00000 0x00 0x400&gt;;
	interrupts = &lt;0x00 0x18d 0x04&gt;;
	clocks = &lt;0x02 0xaa 0x02 0xa9&gt;;
	clock-names = "tsadc\0apb_pclk";
	assigned-clocks = &lt;0x02 0xaa&gt;;
	assigned-clock-rates = &lt;0x1e8480&gt;;
	resets = &lt;0x02 0xc1 0x02 0xc0&gt;;
	reset-names = "tsadc\0tsadc-apb";
	#thermal-sensor-cells = &lt;0x01&gt;;
	rockchip,hw-tshut-temp = &lt;0x1d4c0&gt;;
	rockchip,hw-tshut-mode = &lt;0x00&gt;;
	rockchip,hw-tshut-polarity = &lt;0x00&gt;;
	pinctrl-names = "gpio\0otpout";
	pinctrl-0 = &lt;0x16f&gt;;
	pinctrl-1 = &lt;0x170&gt;;
	status = "okay";
	phandle = &lt;0x55&gt;;
};

saradc@fec10000 {
	compatible = "rockchip,rk3588-saradc";
	reg = &lt;0x00 0xfec10000 0x00 0x10000&gt;;
	interrupts = &lt;0x00 0x18e 0x04&gt;;
	#io-channel-cells = &lt;0x01&gt;;
	clocks = &lt;0x02 0x9d 0x02 0x9c&gt;;
	clock-names = "saradc\0apb_pclk";
	resets = &lt;0x02 0xbe&gt;;
	reset-names = "saradc-apb";
	status = "okay";
	vref-supply = &lt;0x171&gt;;
	phandle = &lt;0x1b4&gt;;
};

mailbox@fec60000 {
	compatible = "rockchip,rk3588-mailbox\0rockchip,rk3368-mailbox";
	reg = &lt;0x00 0xfec60000 0x00 0x200&gt;;
	interrupts = &lt;0x00 0x3d 0x04 0x00 0x3e 0x04 0x00 0x3f 0x04 0x00 0x40 0x04&gt;;
	clocks = &lt;0x02 0x4c&gt;;
	clock-names = "pclk_mailbox";
	#mbox-cells = &lt;0x01&gt;;
	status = "disabled";
};

mailbox@fec70000 {
	compatible = "rockchip,rk3588-mailbox\0rockchip,rk3368-mailbox";
	reg = &lt;0x00 0xfec70000 0x00 0x200&gt;;
	interrupts = &lt;0x00 0x45 0x04 0x00 0x46 0x04 0x00 0x47 0x04 0x00 0x48 0x04&gt;;
	clocks = &lt;0x02 0x4d&gt;;
	clock-names = "pclk_mailbox";
	#mbox-cells = &lt;0x01&gt;;
	status = "disabled";
};

i2c@fec80000 {
	compatible = "rockchip,rk3588-i2c\0rockchip,rk3399-i2c";
	reg = &lt;0x00 0xfec80000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x92 0x02 0x8a&gt;;
	clock-names = "i2c\0pclk";
	interrupts = &lt;0x00 0x143 0x04&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x172&gt;;
	resets = &lt;0x02 0xb5 0x02 0xad&gt;;
	reset-names = "i2c\0apb";
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	status = "okay";

	pcf8563@51 {
		compatible = "nxp,pcf8563";
		reg = &lt;0x51&gt;;
		status = "okay";
	};
};

i2c@fec90000 {
	compatible = "rockchip,rk3588-i2c\0rockchip,rk3399-i2c";
	reg = &lt;0x00 0xfec90000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x93 0x02 0x8b&gt;;
	clock-names = "i2c\0pclk";
	interrupts = &lt;0x00 0x144 0x04&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x173&gt;;
	resets = &lt;0x02 0xb6 0x02 0xae&gt;;
	reset-names = "i2c\0apb";
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	status = "okay";

	es8388@11 {
		status = "okay";
		#sound-dai-cells = &lt;0x00&gt;;
		compatible = "everest,es8388\0everest,es8323";
		reg = &lt;0x11&gt;;
		clocks = &lt;0x174&gt;;
		clock-names = "mclk";
		assigned-clocks = &lt;0x174&gt;;
		assigned-clock-rates = &lt;0xbb8000&gt;;
		pinctrl-names = "default";
		pinctrl-0 = &lt;0x175&gt;;
		phandle = &lt;0x1c6&gt;;
	};
};

i2c@feca0000 {
	compatible = "rockchip,rk3588-i2c\0rockchip,rk3399-i2c";
	reg = &lt;0x00 0xfeca0000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x94 0x02 0x8c&gt;;
	clock-names = "i2c\0pclk";
	interrupts = &lt;0x00 0x145 0x04&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x176&gt;;
	resets = &lt;0x02 0xb7 0x02 0xaf&gt;;
	reset-names = "i2c\0apb";
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	status = "disabled";
};

spi@fecb0000 {
	compatible = "rockchip,rk3066-spi";
	reg = &lt;0x00 0xfecb0000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0x14a 0x04&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x00&gt;;
	clocks = &lt;0x02 0xa7 0x02 0xa2&gt;;
	clock-names = "spiclk\0apb_pclk";
	dmas = &lt;0xe9 0x0d 0xe9 0x0e&gt;;
	dma-names = "tx\0rx";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x177 0x178 0x179&gt;;
	num-cs = &lt;0x02&gt;;
	status = "disabled";
};

otp@fecc0000 {
	compatible = "rockchip,rk3588-otp";
	reg = &lt;0x00 0xfecc0000 0x00 0x400&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x01&gt;;
	clocks = &lt;0x02 0x96 0x02 0x95 0x02 0x97 0x02 0x99&gt;;
	clock-names = "otpc\0apb\0arb\0phy";
	resets = &lt;0x02 0x12a 0x02 0x129 0x02 0x12b&gt;;
	reset-names = "otpc\0apb\0arb";

	cpu-code@2 {
		reg = &lt;0x02 0x02&gt;;
		phandle = &lt;0x2c&gt;;
	};

	package-serial-number-high@5 {
		reg = &lt;0x05 0x01&gt;;
		bits = &lt;0x00 0x01&gt;;
		phandle = &lt;0xcc&gt;;
	};

	package-serial-number-low@6 {
		reg = &lt;0x06 0x01&gt;;
		bits = &lt;0x05 0x03&gt;;
		phandle = &lt;0xcb&gt;;
	};

	specification-serial-number@6 {
		reg = &lt;0x06 0x01&gt;;
		bits = &lt;0x00 0x05&gt;;
		phandle = &lt;0x21&gt;;
	};

	id@7 {
		reg = &lt;0x07 0x10&gt;;
		phandle = &lt;0x2a&gt;;
	};

	cpu-version@1c {
		reg = &lt;0x1c 0x01&gt;;
		bits = &lt;0x03 0x03&gt;;
		phandle = &lt;0x2b&gt;;
	};

	cpub0-leakage@17 {
		reg = &lt;0x17 0x01&gt;;
		phandle = &lt;0x24&gt;;
	};

	cpub1-leakage@18 {
		reg = &lt;0x18 0x01&gt;;
		phandle = &lt;0x27&gt;;
	};

	cpul-leakage@19 {
		reg = &lt;0x19 0x01&gt;;
		phandle = &lt;0x1f&gt;;
	};

	log-leakage@1a {
		reg = &lt;0x1a 0x01&gt;;
		phandle = &lt;0x41&gt;;
	};

	gpu-leakage@1b {
		reg = &lt;0x1b 0x01&gt;;
		phandle = &lt;0x5b&gt;;
	};

	npu-leakage@28 {
		reg = &lt;0x28 0x01&gt;;
		phandle = &lt;0xaa&gt;;
	};

	codec-leakage@29 {
		reg = &lt;0x29 0x01&gt;;
		phandle = &lt;0xbd&gt;;
	};

	cpul-opp-info@3d {
		reg = &lt;0x3d 0x06&gt;;
		phandle = &lt;0x20&gt;;
	};

	cpub01-opp-info@43 {
		reg = &lt;0x43 0x06&gt;;
		phandle = &lt;0x25&gt;;
	};

	cpub23-opp-info@49 {
		reg = &lt;0x49 0x06&gt;;
		phandle = &lt;0x28&gt;;
	};

	gpu-opp-info@4f {
		reg = &lt;0x4f 0x06&gt;;
		phandle = &lt;0x5c&gt;;
	};

	npu-opp-info@55 {
		reg = &lt;0x55 0x06&gt;;
		phandle = &lt;0xab&gt;;
	};

	dmc-opp-info@5b {
		reg = &lt;0x5b 0x06&gt;;
		phandle = &lt;0x42&gt;;
	};

	vop-opp-info@61 {
		reg = &lt;0x61 0x06&gt;;
	};

	venc-opp-info@67 {
		reg = &lt;0x67 0x06&gt;;
		phandle = &lt;0xbe&gt;;
	};
};

mailbox@fece0000 {
	compatible = "rockchip,rk3588-mailbox\0rockchip,rk3368-mailbox";
	reg = &lt;0x00 0xfece0000 0x00 0x200&gt;;
	interrupts = &lt;0x00 0x4d 0x04 0x00 0x4e 0x04 0x00 0x4f 0x04 0x00 0x50 0x04&gt;;
	clocks = &lt;0x02 0x4e&gt;;
	clock-names = "pclk_mailbox";
	#mbox-cells = &lt;0x01&gt;;
	status = "disabled";
};

dma-controller@fed10000 {
	compatible = "arm,pl330\0arm,primecell";
	reg = &lt;0x00 0xfed10000 0x00 0x4000&gt;;
	interrupts = &lt;0x00 0x5a 0x04 0x00 0x5b 0x04&gt;;
	clocks = &lt;0x02 0x7a&gt;;
	clock-names = "apb_pclk";
	#dma-cells = &lt;0x01&gt;;
	arm,pl330-periph-burst;
	phandle = &lt;0xe9&gt;;
};

phy@fed60000 {
	compatible = "rockchip,rk3588-hdptx-phy";
	reg = &lt;0x00 0xfed60000 0x00 0x2000&gt;;
	clocks = &lt;0x02 0x2b5 0x02 0x267&gt;;
	clock-names = "ref\0apb";
	resets = &lt;0x02 0x485 0x02 0xc003b 0x02 0xc003c 0x02 0xc003d&gt;;
	reset-names = "apb\0init\0cmn\0lane";
	rockchip,grf = &lt;0x17a&gt;;
	#phy-cells = &lt;0x00&gt;;
	status = "disabled";
	phandle = &lt;0xf8&gt;;
};

hdmiphy@fed60000 {
	compatible = "rockchip,rk3588-hdptx-phy-hdmi";
	reg = &lt;0x00 0xfed60000 0x00 0x2000&gt;;
	clocks = &lt;0x02 0x2b5 0x02 0x267&gt;;
	clock-names = "ref\0apb";
	resets = &lt;0x02 0x48e 0x02 0x485 0x02 0xc003b 0x02 0xc003c 0x02 0xc003d 0x02 0x48c 0x02 0x48d&gt;;
	reset-names = "phy\0apb\0init\0cmn\0lane\0ropll\0lcpll";
	rockchip,grf = &lt;0x17a&gt;;
	#phy-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0xf4&gt;;

	clk-port {
		#clock-cells = &lt;0x00&gt;;
		status = "okay";
		phandle = &lt;0x32&gt;;
	};
};

phy@fed80000 {
	compatible = "rockchip,rk3588-usbdp-phy";
	reg = &lt;0x00 0xfed80000 0x00 0x10000&gt;;
	rockchip,u2phy-grf = &lt;0x17b&gt;;
	rockchip,usb-grf = &lt;0x6c&gt;;
	rockchip,usbdpphy-grf = &lt;0x17c&gt;;
	rockchip,vo-grf = &lt;0xec&gt;;
	clocks = &lt;0x02 0x2b6 0x02 0x27f 0x02 0x269 0x60&gt;;
	clock-names = "refclk\0immortal\0pclk\0utmi";
	resets = &lt;0x02 0x28 0x02 0x29 0x02 0x2a 0x02 0x2b 0x02 0x482&gt;;
	reset-names = "init\0cmn\0lane\0pcs_apb\0pma_apb";
	status = "okay";
	rockchip,dp-lane-mux = &lt;0x02 0x03&gt;;

	dp-port {
		#phy-cells = &lt;0x00&gt;;
		status = "disabled";
		phandle = &lt;0xed&gt;;
	};

	u3-port {
		#phy-cells = &lt;0x00&gt;;
		status = "okay";
		phandle = &lt;0x5f&gt;;
	};
};

phy@feda0000 {
	compatible = "rockchip,rk3588-mipi-dcphy";
	reg = &lt;0x00 0xfeda0000 0x00 0x10000&gt;;
	rockchip,grf = &lt;0x17d&gt;;
	clocks = &lt;0x02 0x108 0x02 0x2b6&gt;;
	clock-names = "pclk\0ref";
	resets = &lt;0x02 0xc0043 0x02 0x3e 0x02 0x3f 0x02 0xc0044&gt;;
	reset-names = "m_phy\0apb\0grf\0s_phy";
	#phy-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0x2f&gt;;
};

phy@fedb0000 {
	compatible = "rockchip,rk3588-mipi-dcphy";
	reg = &lt;0x00 0xfedb0000 0x00 0x10000&gt;;
	rockchip,grf = &lt;0x17e&gt;;
	clocks = &lt;0x02 0x109 0x02 0x2b6&gt;;
	clock-names = "pclk\0ref";
	resets = &lt;0x02 0xc0045 0x02 0x43 0x02 0x44 0x02 0xc0046&gt;;
	reset-names = "m_phy\0apb\0grf\0s_phy";
	#phy-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0x30&gt;;
};

csi2-dphy0-hw@fedc0000 {
	compatible = "rockchip,rk3588-csi2-dphy-hw";
	reg = &lt;0x00 0xfedc0000 0x00 0x8000&gt;;
	clocks = &lt;0x02 0x10c&gt;;
	clock-names = "pclk";
	resets = &lt;0x02 0x17 0x02 0x16&gt;;
	reset-names = "srst_csiphy0\0srst_p_csiphy0";
	rockchip,grf = &lt;0x17f&gt;;
	rockchip,sys_grf = &lt;0xbf&gt;;
	status = "okay";
	phandle = &lt;0x2d&gt;;
};

csi2-dphy1-hw@fedc8000 {
	compatible = "rockchip,rk3588-csi2-dphy-hw";
	reg = &lt;0x00 0xfedc8000 0x00 0x8000&gt;;
	clocks = &lt;0x02 0x10d&gt;;
	clock-names = "pclk";
	resets = &lt;0x02 0x19 0x02 0x18&gt;;
	reset-names = "srst_csiphy1\0srst_p_csiphy1";
	rockchip,grf = &lt;0x180&gt;;
	rockchip,sys_grf = &lt;0xbf&gt;;
	status = "okay";
	phandle = &lt;0x2e&gt;;
};

phy@fee00000 {
	compatible = "rockchip,rk3588-naneng-combphy";
	reg = &lt;0x00 0xfee00000 0x00 0x100&gt;;
	#phy-cells = &lt;0x01&gt;;
	clocks = &lt;0x02 0x2bd 0x02 0x185 0x02 0x166&gt;;
	clock-names = "refclk\0apbclk\0phpclk";
	assigned-clocks = &lt;0x02 0x2bd&gt;;
	assigned-clock-rates = &lt;0x5f5e100&gt;;
	resets = &lt;0x02 0x20005 0x02 0x4d6&gt;;
	reset-names = "combphy-apb\0combphy";
	rockchip,pipe-grf = &lt;0x6f&gt;;
	rockchip,pipe-phy-grf = &lt;0x181&gt;;
	status = "okay";
	phandle = &lt;0xff&gt;;
};

phy@fee20000 {
	compatible = "rockchip,rk3588-naneng-combphy";
	reg = &lt;0x00 0xfee20000 0x00 0x100&gt;;
	#phy-cells = &lt;0x01&gt;;
	clocks = &lt;0x02 0x2bf 0x02 0x187 0x02 0x166&gt;;
	clock-names = "refclk\0apbclk\0phpclk";
	assigned-clocks = &lt;0x02 0x2bf&gt;;
	assigned-clock-rates = &lt;0x5f5e100&gt;;
	resets = &lt;0x02 0x20007 0x02 0x4d8&gt;;
	reset-names = "combphy-apb\0combphy";
	rockchip,pipe-grf = &lt;0x6f&gt;;
	rockchip,pipe-phy-grf = &lt;0x182&gt;;
	rockchip,pcie1ln-sel-bits = &lt;0x100 0x01 0x01 0x00&gt;;
	status = "disabled";
	phandle = &lt;0x68&gt;;
};

sram@ff001000 {
	compatible = "mmio-sram";
	reg = &lt;0x00 0xff001000 0x00 0xef000&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x01&gt;;
	ranges = &lt;0x00 0x00 0xff001000 0xef000&gt;;

	rkvdec-sram@0 {
		reg = &lt;0x00 0x78000&gt;;
		phandle = &lt;0xc2&gt;;
	};

	rkvdec-sram@78000 {
		reg = &lt;0x78000 0x77000&gt;;
		phandle = &lt;0xc4&gt;;
	};
};

pinctrl {
	compatible = "rockchip,rk3588-pinctrl";
	rockchip,grf = &lt;0x183&gt;;
	#address-cells = &lt;0x02&gt;;
	#size-cells = &lt;0x02&gt;;
	ranges;
	phandle = &lt;0x184&gt;;

	gpio@fd8a0000 {
		compatible = "rockchip,gpio-bank";
		reg = &lt;0x00 0xfd8a0000 0x00 0x100&gt;;
		interrupts = &lt;0x00 0x115 0x04&gt;;
		clocks = &lt;0x02 0x284 0x02 0x285&gt;;
		gpio-controller;
		#gpio-cells = &lt;0x02&gt;;
		gpio-ranges = &lt;0x184 0x00 0x00 0x20&gt;;
		interrupt-controller;
		#interrupt-cells = &lt;0x02&gt;;
		phandle = &lt;0x14e&gt;;
	};

	gpio@fec20000 {
		compatible = "rockchip,gpio-bank";
		reg = &lt;0x00 0xfec20000 0x00 0x100&gt;;
		interrupts = &lt;0x00 0x116 0x04&gt;;
		clocks = &lt;0x02 0x7d 0x02 0x7e&gt;;
		gpio-controller;
		#gpio-cells = &lt;0x02&gt;;
		gpio-ranges = &lt;0x184 0x00 0x20 0x20&gt;;
		interrupt-controller;
		#interrupt-cells = &lt;0x02&gt;;
		phandle = &lt;0x1a2&gt;;
	};

	gpio@fec30000 {
		compatible = "rockchip,gpio-bank";
		reg = &lt;0x00 0xfec30000 0x00 0x100&gt;;
		interrupts = &lt;0x00 0x117 0x04&gt;;
		clocks = &lt;0x02 0x7f 0x02 0x80&gt;;
		gpio-controller;
		#gpio-cells = &lt;0x02&gt;;
		gpio-ranges = &lt;0x184 0x00 0x40 0x20&gt;;
		interrupt-controller;
		#interrupt-cells = &lt;0x02&gt;;
		phandle = &lt;0x1db&gt;;
	};

	gpio@fec40000 {
		compatible = "rockchip,gpio-bank";
		reg = &lt;0x00 0xfec40000 0x00 0x100&gt;;
		interrupts = &lt;0x00 0x118 0x04&gt;;
		clocks = &lt;0x02 0x81 0x02 0x82&gt;;
		gpio-controller;
		#gpio-cells = &lt;0x02&gt;;
		gpio-ranges = &lt;0x184 0x00 0x60 0x20&gt;;
		interrupt-controller;
		#interrupt-cells = &lt;0x02&gt;;
		phandle = &lt;0x104&gt;;
	};

	gpio@fec50000 {
		compatible = "rockchip,gpio-bank";
		reg = &lt;0x00 0xfec50000 0x00 0x100&gt;;
		interrupts = &lt;0x00 0x119 0x04&gt;;
		clocks = &lt;0x02 0x83 0x02 0x84&gt;;
		gpio-controller;
		#gpio-cells = &lt;0x02&gt;;
		gpio-ranges = &lt;0x184 0x00 0x80 0x20&gt;;
		interrupt-controller;
		#interrupt-cells = &lt;0x02&gt;;
		phandle = &lt;0xf5&gt;;
	};

	pcfg-pull-up {
		bias-pull-up;
		phandle = &lt;0x18a&gt;;
	};

	pcfg-pull-down {
		bias-pull-down;
		phandle = &lt;0x18e&gt;;
	};

	pcfg-pull-none {
		bias-disable;
		phandle = &lt;0x185&gt;;
	};

	pcfg-pull-none-drv-level-2 {
		bias-disable;
		drive-strength = &lt;0x02&gt;;
		phandle = &lt;0x18d&gt;;
	};

	pcfg-pull-up-drv-level-1 {
		bias-pull-up;
		drive-strength = &lt;0x01&gt;;
		phandle = &lt;0x18c&gt;;
	};

	pcfg-pull-up-drv-level-2 {
		bias-pull-up;
		drive-strength = &lt;0x02&gt;;
		phandle = &lt;0x186&gt;;
	};

	pcfg-pull-up-drv-level-6 {
		bias-pull-up;
		drive-strength = &lt;0x06&gt;;
		phandle = &lt;0x18b&gt;;
	};

	pcfg-pull-none-smt {
		bias-disable;
		input-schmitt-enable;
		phandle = &lt;0x189&gt;;
	};

	pcfg-pull-none-drv-level-1-smt {
		bias-disable;
		drive-strength = &lt;0x01&gt;;
		input-schmitt-enable;
		phandle = &lt;0x188&gt;;
	};

	pcfg-pull-none-drv-level-5-smt {
		bias-disable;
		drive-strength = &lt;0x05&gt;;
		input-schmitt-enable;
		phandle = &lt;0x187&gt;;
	};

	auddsm {

		auddsm-pins {
			rockchip,pins = &lt;0x03 0x01 0x04 0x185 0x03 0x02 0x04 0x185 0x03 0x03 0x04 0x185 0x03 0x04 0x04 0x185&gt;;
			phandle = &lt;0x13d&gt;;
		};
	};

	bt1120 {

		bt1120-pins {
			rockchip,pins = &lt;0x04 0x08 0x02 0x185 0x04 0x00 0x02 0x185 0x04 0x01 0x02 0x185 0x04 0x02 0x02 0x185 0x04 0x03 0x02 0x185 0x04 0x04 0x02 0x185 0x04 0x05 0x02 0x185 0x04 0x06 0x02 0x185 0x04 0x07 0x02 0x185 0x04 0x0a 0x02 0x185 0x04 0x0b 0x02 0x185 0x04 0x0c 0x02 0x185 0x04 0x0d 0x02 0x185 0x04 0x0e 0x02 0x185 0x04 0x0f 0x02 0x185 0x04 0x10 0x02 0x185 0x04 0x11 0x02 0x185&gt;;
			phandle = &lt;0x69&gt;;
		};
	};

	can0 {

		can0m1-pins {
			rockchip,pins = &lt;0x04 0x1d 0x09 0x185 0x04 0x1c 0x09 0x185&gt;;
			phandle = &lt;0x13e&gt;;
		};
	};

	can1 {

		can1m1-pins {
			rockchip,pins = &lt;0x04 0x0a 0x0c 0x185 0x04 0x0b 0x0c 0x185&gt;;
			phandle = &lt;0x13f&gt;;
		};
	};

	can2 {

		can2m0-pins {
			rockchip,pins = &lt;0x03 0x14 0x09 0x185 0x03 0x15 0x09 0x185&gt;;
			phandle = &lt;0x140&gt;;
		};
	};

	gmac1 {

		gmac1-miim {
			rockchip,pins = &lt;0x03 0x12 0x01 0x185 0x03 0x13 0x01 0x185&gt;;
			phandle = &lt;0x105&gt;;
		};

		gmac1-rx-bus2 {
			rockchip,pins = &lt;0x03 0x07 0x01 0x185 0x03 0x08 0x01 0x185 0x03 0x09 0x01 0x185&gt;;
			phandle = &lt;0x107&gt;;
		};

		gmac1-tx-bus2 {
			rockchip,pins = &lt;0x03 0x0b 0x01 0x185 0x03 0x0c 0x01 0x185 0x03 0x0d 0x01 0x185&gt;;
			phandle = &lt;0x106&gt;;
		};

		gmac1-rgmii-clk {
			rockchip,pins = &lt;0x03 0x05 0x01 0x185 0x03 0x04 0x01 0x185&gt;;
			phandle = &lt;0x108&gt;;
		};

		gmac1-rgmii-bus {
			rockchip,pins = &lt;0x03 0x02 0x01 0x185 0x03 0x03 0x01 0x185 0x03 0x00 0x01 0x185 0x03 0x01 0x01 0x185&gt;;
			phandle = &lt;0x109&gt;;
		};
	};

	hdmi {

		hdmim0-tx0-cec {
			rockchip,pins = &lt;0x04 0x11 0x05 0x185&gt;;
			phandle = &lt;0xf0&gt;;
		};

		hdmim0-tx0-hpd {
			rockchip,pins = &lt;0x01 0x05 0x05 0x185&gt;;
			phandle = &lt;0xf1&gt;;
		};

		hdmim0-tx0-scl {
			rockchip,pins = &lt;0x04 0x0f 0x05 0x187&gt;;
			phandle = &lt;0xf2&gt;;
		};

		hdmim0-tx0-sda {
			rockchip,pins = &lt;0x04 0x10 0x05 0x188&gt;;
			phandle = &lt;0xf3&gt;;
		};

		hdmim0-tx1-hpd {
			rockchip,pins = &lt;0x01 0x06 0x05 0x185&gt;;
			phandle = &lt;0x196&gt;;
		};

		hdmim1-rx {
			rockchip,pins = &lt;0x03 0x19 0x05 0x185 0x03 0x1a 0x05 0x189 0x03 0x1b 0x05 0x189 0x03 0x1c 0x05 0x185&gt;;
			phandle = &lt;0x1a0&gt;;
		};

		hdmim1-tx1-scl {
			rockchip,pins = &lt;0x03 0x16 0x05 0x187&gt;;
			phandle = &lt;0x197&gt;;
		};

		hdmim1-tx1-sda {
			rockchip,pins = &lt;0x03 0x15 0x05 0x188&gt;;
			phandle = &lt;0x198&gt;;
		};

		hdmirx-det {
			rockchip,pins = &lt;0x01 0x1d 0x00 0x18a&gt;;
			phandle = &lt;0x1a1&gt;;
		};
	};

	i2c0 {

		i2c0m2-xfer {
			rockchip,pins = &lt;0x00 0x19 0x03 0x189 0x00 0x1a 0x03 0x189&gt;;
			phandle = &lt;0x70&gt;;
		};
	};

	i2c1 {

		i2c1m2-xfer {
			rockchip,pins = &lt;0x00 0x1c 0x09 0x189 0x00 0x1d 0x09 0x189&gt;;
			phandle = &lt;0x141&gt;;
		};
	};

	i2c2 {

		i2c2m0-xfer {
			rockchip,pins = &lt;0x00 0x0f 0x09 0x189 0x00 0x10 0x09 0x189&gt;;
			phandle = &lt;0x142&gt;;
		};
	};

	i2c3 {

		i2c3m0-xfer {
			rockchip,pins = &lt;0x01 0x11 0x09 0x189 0x01 0x10 0x09 0x189&gt;;
			phandle = &lt;0x143&gt;;
		};
	};

	i2c4 {

		i2c4m0-xfer {
			rockchip,pins = &lt;0x03 0x06 0x09 0x189 0x03 0x05 0x09 0x189&gt;;
			phandle = &lt;0x144&gt;;
		};
	};

	i2c5 {

		i2c5m0-xfer {
			rockchip,pins = &lt;0x03 0x17 0x09 0x189 0x03 0x18 0x09 0x189&gt;;
			phandle = &lt;0x145&gt;;
		};
	};

	i2c6 {

		i2c6m0-xfer {
			rockchip,pins = &lt;0x00 0x18 0x09 0x189 0x00 0x17 0x09 0x189&gt;;
			phandle = &lt;0x172&gt;;
		};
	};

	i2c7 {

		i2c7m0-xfer {
			rockchip,pins = &lt;0x01 0x18 0x09 0x189 0x01 0x19 0x09 0x189&gt;;
			phandle = &lt;0x173&gt;;
		};
	};

	i2c8 {

		i2c8m0-xfer {
			rockchip,pins = &lt;0x04 0x1a 0x09 0x189 0x04 0x1b 0x09 0x189&gt;;
			phandle = &lt;0x176&gt;;
		};
	};

	i2s0 {

		i2s0-idle {
			rockchip,pins = &lt;0x01 0x15 0x00 0x185 0x01 0x13 0x00 0x185&gt;;
			phandle = &lt;0x118&gt;;
		};

		i2s0-lrck {
			rockchip,pins = &lt;0x01 0x15 0x01 0x189&gt;;
			phandle = &lt;0x114&gt;;
		};

		i2s0-mclk {
			rockchip,pins = &lt;0x01 0x12 0x01 0x189&gt;;
			phandle = &lt;0x175&gt;;
		};

		i2s0-sclk {
			rockchip,pins = &lt;0x01 0x13 0x01 0x189&gt;;
			phandle = &lt;0x115&gt;;
		};

		i2s0-sdi0 {
			rockchip,pins = &lt;0x01 0x1c 0x02 0x185&gt;;
			phandle = &lt;0x116&gt;;
		};

		i2s0-sdo0 {
			rockchip,pins = &lt;0x01 0x17 0x01 0x185&gt;;
			phandle = &lt;0x117&gt;;
		};
	};

	i2s1 {

		i2s1m0-lrck {
			rockchip,pins = &lt;0x04 0x02 0x03 0x189&gt;;
			phandle = &lt;0x119&gt;;
		};

		i2s1m0-sclk {
			rockchip,pins = &lt;0x04 0x01 0x03 0x189&gt;;
			phandle = &lt;0x11a&gt;;
		};

		i2s1m0-sdi0 {
			rockchip,pins = &lt;0x04 0x05 0x03 0x185&gt;;
			phandle = &lt;0x11b&gt;;
		};

		i2s1m0-sdi1 {
			rockchip,pins = &lt;0x04 0x06 0x03 0x185&gt;;
			phandle = &lt;0x11c&gt;;
		};

		i2s1m0-sdi2 {
			rockchip,pins = &lt;0x04 0x07 0x03 0x185&gt;;
			phandle = &lt;0x11d&gt;;
		};

		i2s1m0-sdi3 {
			rockchip,pins = &lt;0x04 0x08 0x03 0x185&gt;;
			phandle = &lt;0x11e&gt;;
		};

		i2s1m0-sdo0 {
			rockchip,pins = &lt;0x04 0x09 0x03 0x185&gt;;
			phandle = &lt;0x11f&gt;;
		};

		i2s1m0-sdo1 {
			rockchip,pins = &lt;0x04 0x0a 0x03 0x185&gt;;
			phandle = &lt;0x120&gt;;
		};

		i2s1m0-sdo2 {
			rockchip,pins = &lt;0x04 0x0b 0x03 0x185&gt;;
			phandle = &lt;0x121&gt;;
		};

		i2s1m0-sdo3 {
			rockchip,pins = &lt;0x04 0x0c 0x03 0x185&gt;;
			phandle = &lt;0x122&gt;;
		};
	};

	i2s2 {

		i2s2m1-idle {
			rockchip,pins = &lt;0x03 0x0e 0x00 0x185 0x03 0x0d 0x00 0x185&gt;;
			phandle = &lt;0x125&gt;;
		};

		i2s2m1-lrck {
			rockchip,pins = &lt;0x03 0x0e 0x03 0x189&gt;;
			phandle = &lt;0x126&gt;;
		};

		i2s2m1-sclk {
			rockchip,pins = &lt;0x03 0x0d 0x03 0x189&gt;;
			phandle = &lt;0x127&gt;;
		};

		i2s2m1-sdi {
			rockchip,pins = &lt;0x03 0x0a 0x03 0x185&gt;;
			phandle = &lt;0x123&gt;;
		};

		i2s2m1-sdo {
			rockchip,pins = &lt;0x03 0x0b 0x03 0x185&gt;;
			phandle = &lt;0x124&gt;;
		};
	};

	i2s3 {

		i2s3-idle {
			rockchip,pins = &lt;0x03 0x02 0x00 0x185 0x03 0x01 0x00 0x185&gt;;
			phandle = &lt;0x12a&gt;;
		};

		i2s3-lrck {
			rockchip,pins = &lt;0x03 0x02 0x03 0x189&gt;;
			phandle = &lt;0x12b&gt;;
		};

		i2s3-sclk {
			rockchip,pins = &lt;0x03 0x01 0x03 0x189&gt;;
			phandle = &lt;0x12c&gt;;
		};

		i2s3-sdi {
			rockchip,pins = &lt;0x03 0x04 0x03 0x185&gt;;
			phandle = &lt;0x128&gt;;
		};

		i2s3-sdo {
			rockchip,pins = &lt;0x03 0x03 0x03 0x185&gt;;
			phandle = &lt;0x129&gt;;
		};
	};

	mipi {

		dsi0-vcc-en {
			rockchip,pins = &lt;0x01 0x0f 0x00 0x185&gt;;
		};

		dsi0-lcd-en {
			rockchip,pins = &lt;0x00 0x14 0x00 0x185&gt;;
		};

		dsi0-lcd-rst {
			rockchip,pins = &lt;0x01 0x0e 0x00 0x185&gt;;
		};
	};

	pdm0 {

		pdm0m0-clk {
			rockchip,pins = &lt;0x01 0x16 0x03 0x185&gt;;
			phandle = &lt;0x132&gt;;
		};

		pdm0m0-clk1 {
			rockchip,pins = &lt;0x01 0x14 0x03 0x185&gt;;
			phandle = &lt;0x133&gt;;
		};

		pdm0m0-idle {
			rockchip,pins = &lt;0x01 0x16 0x00 0x185 0x01 0x14 0x00 0x185&gt;;
			phandle = &lt;0x131&gt;;
		};

		pdm0m0-sdi0 {
			rockchip,pins = &lt;0x01 0x1d 0x03 0x185&gt;;
			phandle = &lt;0x12d&gt;;
		};

		pdm0m0-sdi1 {
			rockchip,pins = &lt;0x01 0x19 0x03 0x185&gt;;
			phandle = &lt;0x12e&gt;;
		};

		pdm0m0-sdi2 {
			rockchip,pins = &lt;0x01 0x1a 0x03 0x185&gt;;
			phandle = &lt;0x12f&gt;;
		};

		pdm0m0-sdi3 {
			rockchip,pins = &lt;0x01 0x1b 0x03 0x185&gt;;
			phandle = &lt;0x130&gt;;
		};
	};

	pdm1 {

		pdm1m0-clk {
			rockchip,pins = &lt;0x04 0x1d 0x02 0x185&gt;;
			phandle = &lt;0x139&gt;;
		};

		pdm1m0-clk1 {
			rockchip,pins = &lt;0x04 0x1c 0x02 0x185&gt;;
			phandle = &lt;0x13a&gt;;
		};

		pdm1m0-idle {
			rockchip,pins = &lt;0x04 0x1d 0x00 0x185 0x04 0x1c 0x00 0x185&gt;;
			phandle = &lt;0x138&gt;;
		};

		pdm1m0-sdi0 {
			rockchip,pins = &lt;0x04 0x1b 0x02 0x185&gt;;
			phandle = &lt;0x134&gt;;
		};

		pdm1m0-sdi1 {
			rockchip,pins = &lt;0x04 0x1a 0x02 0x185&gt;;
			phandle = &lt;0x135&gt;;
		};

		pdm1m0-sdi2 {
			rockchip,pins = &lt;0x04 0x19 0x02 0x185&gt;;
			phandle = &lt;0x136&gt;;
		};

		pdm1m0-sdi3 {
			rockchip,pins = &lt;0x04 0x18 0x02 0x185&gt;;
			phandle = &lt;0x137&gt;;
		};
	};

	pmic {

		pmic-pins {
			rockchip,pins = &lt;0x00 0x07 0x00 0x18a 0x00 0x02 0x01 0x185 0x00 0x03 0x01 0x185 0x00 0x11 0x01 0x185 0x00 0x12 0x01 0x185 0x00 0x13 0x01 0x185 0x00 0x1e 0x01 0x185&gt;;
			phandle = &lt;0x14f&gt;;
		};
	};

	pwm0 {

		pwm0m0-pins {
			rockchip,pins = &lt;0x00 0x0f 0x03 0x185&gt;;
			phandle = &lt;0x74&gt;;
		};
	};

	pwm1 {

		pwm1m0-pins {
			rockchip,pins = &lt;0x00 0x10 0x03 0x185&gt;;
			phandle = &lt;0x75&gt;;
		};
	};

	pwm2 {

		pwm2m0-pins {
			rockchip,pins = &lt;0x00 0x14 0x03 0x185&gt;;
			phandle = &lt;0x76&gt;;
		};
	};

	pwm3 {

		pwm3m0-pins {
			rockchip,pins = &lt;0x00 0x1c 0x03 0x185&gt;;
			phandle = &lt;0x77&gt;;
		};
	};

	pwm4 {

		pwm4m0-pins {
			rockchip,pins = &lt;0x00 0x15 0x0b 0x185&gt;;
			phandle = &lt;0x163&gt;;
		};
	};

	pwm5 {

		pwm5m0-pins {
			rockchip,pins = &lt;0x00 0x09 0x03 0x185&gt;;
			phandle = &lt;0x164&gt;;
		};
	};

	pwm6 {

		pwm6m0-pins {
			rockchip,pins = &lt;0x00 0x17 0x0b 0x185&gt;;
			phandle = &lt;0x165&gt;;
		};
	};

	pwm7 {

		pwm7m0-pins {
			rockchip,pins = &lt;0x00 0x18 0x0b 0x185&gt;;
			phandle = &lt;0x166&gt;;
		};
	};

	pwm8 {

		pwm8m0-pins {
			rockchip,pins = &lt;0x03 0x07 0x0b 0x185&gt;;
			phandle = &lt;0x167&gt;;
		};
	};

	pwm9 {

		pwm9m0-pins {
			rockchip,pins = &lt;0x03 0x08 0x0b 0x185&gt;;
			phandle = &lt;0x168&gt;;
		};
	};

	pwm10 {

		pwm10m0-pins {
			rockchip,pins = &lt;0x03 0x00 0x0b 0x185&gt;;
			phandle = &lt;0x169&gt;;
		};
	};

	pwm11 {

		pwm11m0-pins {
			rockchip,pins = &lt;0x03 0x01 0x0b 0x185&gt;;
			phandle = &lt;0x16a&gt;;
		};
	};

	pwm12 {

		pwm12m0-pins {
			rockchip,pins = &lt;0x03 0x0d 0x0b 0x185&gt;;
			phandle = &lt;0x16b&gt;;
		};
	};

	pwm13 {

		pwm13m0-pins {
			rockchip,pins = &lt;0x03 0x0e 0x0b 0x185&gt;;
			phandle = &lt;0x16c&gt;;
		};
	};

	pwm14 {

		pwm14m0-pins {
			rockchip,pins = &lt;0x03 0x12 0x0b 0x185&gt;;
			phandle = &lt;0x16d&gt;;
		};
	};

	pwm15 {

		pwm15m0-pins {
			rockchip,pins = &lt;0x03 0x13 0x0b 0x185&gt;;
			phandle = &lt;0x16e&gt;;
		};
	};

	sdio {

		sdiom0-pins {
			rockchip,pins = &lt;0x02 0x0b 0x02 0x185 0x02 0x0a 0x02 0x18a 0x02 0x06 0x02 0x18a 0x02 0x07 0x02 0x18a 0x02 0x08 0x02 0x18a 0x02 0x09 0x02 0x18a&gt;;
			phandle = &lt;0x111&gt;;
		};
	};

	sdmmc {

		sdmmc-bus4 {
			rockchip,pins = &lt;0x04 0x18 0x01 0x186 0x04 0x19 0x01 0x186 0x04 0x1a 0x01 0x186 0x04 0x1b 0x01 0x186&gt;;
			phandle = &lt;0x10e&gt;;
		};

		sdmmc-clk {
			rockchip,pins = &lt;0x04 0x1d 0x01 0x186&gt;;
			phandle = &lt;0x10b&gt;;
		};

		sdmmc-cmd {
			rockchip,pins = &lt;0x04 0x1c 0x01 0x186&gt;;
			phandle = &lt;0x10c&gt;;
		};

		sdmmc-det {
			rockchip,pins = &lt;0x00 0x04 0x01 0x18a&gt;;
			phandle = &lt;0x10d&gt;;
		};
	};

	spdif0 {

		spdif0m0-tx {
			rockchip,pins = &lt;0x01 0x0e 0x03 0x185&gt;;
			phandle = &lt;0x13b&gt;;
		};
	};

	spdif1 {

		spdif1m0-tx {
			rockchip,pins = &lt;0x01 0x0f 0x03 0x185&gt;;
			phandle = &lt;0x13c&gt;;
		};
	};

	spi0 {

		spi0m0-pins {
			rockchip,pins = &lt;0x00 0x16 0x08 0x18b 0x00 0x17 0x08 0x18b 0x00 0x10 0x08 0x18b&gt;;
			phandle = &lt;0x148&gt;;
		};

		spi0m0-cs0 {
			rockchip,pins = &lt;0x00 0x19 0x08 0x18b&gt;;
			phandle = &lt;0x146&gt;;
		};

		spi0m0-cs1 {
			rockchip,pins = &lt;0x00 0x0f 0x08 0x18b&gt;;
			phandle = &lt;0x147&gt;;
		};
	};

	spi1 {

		spi1m1-pins {
			rockchip,pins = &lt;0x03 0x11 0x08 0x18b 0x03 0x10 0x08 0x18b 0x03 0x0f 0x08 0x18b&gt;;
			phandle = &lt;0x14b&gt;;
		};

		spi1m1-cs0 {
			rockchip,pins = &lt;0x03 0x12 0x08 0x18b&gt;;
			phandle = &lt;0x149&gt;;
		};

		spi1m1-cs1 {
			rockchip,pins = &lt;0x03 0x13 0x08 0x18b&gt;;
			phandle = &lt;0x14a&gt;;
		};
	};

	spi2 {

		spi2m2-pins {
			rockchip,pins = &lt;0x00 0x05 0x01 0x18c 0x00 0x0b 0x01 0x18c 0x00 0x06 0x01 0x18c&gt;;
			phandle = &lt;0x14d&gt;;
		};

		spi2m2-cs0 {
			rockchip,pins = &lt;0x00 0x09 0x01 0x18c&gt;;
			phandle = &lt;0x14c&gt;;
		};
	};

	spi3 {

		spi3m1-pins {
			rockchip,pins = &lt;0x04 0x0f 0x08 0x18b 0x04 0x0d 0x08 0x18b 0x04 0x0e 0x08 0x18b&gt;;
			phandle = &lt;0x158&gt;;
		};

		spi3m1-cs0 {
			rockchip,pins = &lt;0x04 0x10 0x08 0x18b&gt;;
			phandle = &lt;0x156&gt;;
		};

		spi3m1-cs1 {
			rockchip,pins = &lt;0x04 0x11 0x08 0x18b&gt;;
			phandle = &lt;0x157&gt;;
		};
	};

	spi4 {

		spi4m0-pins {
			rockchip,pins = &lt;0x01 0x12 0x08 0x18b 0x01 0x10 0x08 0x18b 0x01 0x11 0x08 0x18b&gt;;
			phandle = &lt;0x179&gt;;
		};

		spi4m0-cs0 {
			rockchip,pins = &lt;0x01 0x13 0x08 0x18b&gt;;
			phandle = &lt;0x177&gt;;
		};

		spi4m0-cs1 {
			rockchip,pins = &lt;0x01 0x14 0x08 0x18b&gt;;
			phandle = &lt;0x178&gt;;
		};
	};

	tsadc {

		tsadc-shut {
			rockchip,pins = &lt;0x00 0x01 0x02 0x185&gt;;
			phandle = &lt;0x170&gt;;
		};
	};

	uart0 {

		uart0m2-xfer {
			rockchip,pins = &lt;0x04 0x04 0x0a 0x18a 0x04 0x03 0x0a 0x18a&gt;;
			phandle = &lt;0x73&gt;;
		};
	};

	uart1 {

		uart1m1-xfer {
			rockchip,pins = &lt;0x01 0x0f 0x0a 0x18a 0x01 0x0e 0x0a 0x18a&gt;;
			phandle = &lt;0x159&gt;;
		};
	};

	uart2 {

		uart2m0-xfer {
			rockchip,pins = &lt;0x00 0x0e 0x0a 0x18a 0x00 0x0d 0x0a 0x18a&gt;;
			phandle = &lt;0x15a&gt;;
		};
	};

	uart3 {

		uart3m2-xfer {
			rockchip,pins = &lt;0x04 0x06 0x0a 0x18a 0x04 0x05 0x0a 0x18a&gt;;
			phandle = &lt;0x15b&gt;;
		};
	};

	uart4 {

		uart4m1-xfer {
			rockchip,pins = &lt;0x03 0x18 0x0a 0x18a 0x03 0x19 0x0a 0x18a&gt;;
			phandle = &lt;0x15c&gt;;
		};
	};

	uart5 {

		uart5m1-xfer {
			rockchip,pins = &lt;0x03 0x15 0x0a 0x18a 0x03 0x14 0x0a 0x18a&gt;;
			phandle = &lt;0x15d&gt;;
		};
	};

	uart6 {

		uart6m1-xfer {
			rockchip,pins = &lt;0x01 0x00 0x0a 0x18a 0x01 0x01 0x0a 0x18a&gt;;
			phandle = &lt;0x15e&gt;;
		};
	};

	uart7 {

		uart7m1-xfer {
			rockchip,pins = &lt;0x03 0x11 0x0a 0x18a 0x03 0x10 0x0a 0x18a&gt;;
			phandle = &lt;0x15f&gt;;
		};
	};

	uart8 {

		uart8m0-xfer {
			rockchip,pins = &lt;0x04 0x09 0x0a 0x18a 0x04 0x08 0x0a 0x18a&gt;;
			phandle = &lt;0x160&gt;;
		};
	};

	uart9 {

		uart9m0-xfer {
			rockchip,pins = &lt;0x02 0x14 0x0a 0x18a 0x02 0x12 0x0a 0x18a&gt;;
			phandle = &lt;0x161&gt;;
		};

		uart9m0-ctsn {
			rockchip,pins = &lt;0x04 0x15 0x0a 0x185&gt;;
			phandle = &lt;0x162&gt;;
		};

		uart9m0-rtsn {
			rockchip,pins = &lt;0x04 0x14 0x0a 0x185&gt;;
			phandle = &lt;0x1d4&gt;;
		};
	};

	gpio-func {

		tsadc-gpio-func {
			rockchip,pins = &lt;0x00 0x01 0x00 0x185&gt;;
			phandle = &lt;0x16f&gt;;
		};
	};

	headphone {

		hp-det {
			rockchip,pins = &lt;0x01 0x14 0x00 0x185&gt;;
			phandle = &lt;0x1c7&gt;;
		};
	};

	lvds {

		lcd-bl-en {
			rockchip,pins = &lt;0x01 0x02 0x00 0x185&gt;;
		};

		vcc-lvds-en {
			rockchip,pins = &lt;0x00 0x08 0x00 0x185&gt;;
			phandle = &lt;0x1cf&gt;;
		};

		dsi1-cvt-en {
			rockchip,pins = &lt;0x00 0x00 0x00 0x185&gt;;
		};

		dsi1-cvt-rst {
			rockchip,pins = &lt;0x03 0x06 0x00 0x185&gt;;
		};
	};

	edp {

		edp-bl-en {
			rockchip,pins = &lt;0x04 0x02 0x00 0x185&gt;;
		};

		vcc-edp-en {
			rockchip,pins = &lt;0x04 0x12 0x00 0x18e&gt;;
		};
	};

	rtl8111 {

		rtl8111-resetb {
			rockchip,pins = &lt;0x01 0x0c 0x00 0x18a&gt;;
			phandle = &lt;0x1a9&gt;;
		};
	};

	vcc5v0-ext {

		vcc5v0-ext-en {
			rockchip,pins = &lt;0x04 0x00 0x00 0x185&gt;;
			phandle = &lt;0x1c2&gt;;
		};
	};

	usb-typec {

		typec5v-pwren {
			rockchip,pins = &lt;0x01 0x04 0x00 0x185&gt;;
			phandle = &lt;0x1cd&gt;;
		};
	};

	sdio-pwrseq {

		wifi-enable-h {
			rockchip,pins = &lt;0x01 0x08 0x00 0x18a&gt;;
			phandle = &lt;0x1d3&gt;;
		};
	};

	sdmmc-ctrl {

		sd-s0-pwr {
			rockchip,pins = &lt;0x01 0x03 0x00 0x18a&gt;;
			phandle = &lt;0x1d0&gt;;
		};
	};

	wireless-bluetooth {

		uart9-gpios {
			rockchip,pins = &lt;0x04 0x14 0x00 0x185&gt;;
			phandle = &lt;0x1d8&gt;;
		};

		bt-reset-gpio {
			rockchip,pins = &lt;0x01 0x0a 0x00 0x185&gt;;
			phandle = &lt;0x1d5&gt;;
		};

		bt-wake-gpio {
			rockchip,pins = &lt;0x01 0x09 0x00 0x185&gt;;
			phandle = &lt;0x1d6&gt;;
		};

		bt-irq-gpio {
			rockchip,pins = &lt;0x01 0x00 0x00 0x18e&gt;;
			phandle = &lt;0x1d7&gt;;
		};
	};

	wireless-wlan {

		wifi-host-wake-irq {
			rockchip,pins = &lt;0x01 0x01 0x00 0x18e&gt;;
			phandle = &lt;0x1d9&gt;;
		};
	};

	power-hold {

		hold-gpio {
			rockchip,pins = &lt;0x00 0x16 0x00 0x185&gt;;
			phandle = &lt;0x1da&gt;;
		};
	};

	irda-ctl {

		irda-rem {
			rockchip,pins = &lt;0x03 0x0a 0x00 0x185&gt;;
			phandle = &lt;0x1dc&gt;;
		};

		irda-led {
			rockchip,pins = &lt;0x00 0x15 0x00 0x185&gt;;
			phandle = &lt;0x1dd&gt;;
		};

		irda-ion {
			rockchip,pins = &lt;0x02 0x15 0x00 0x185&gt;;
			phandle = &lt;0x1de&gt;;
		};
	};

	kio-keys {

		kio2-pull {
			rockchip,pins = &lt;0x03 0x1d 0x00 0x18a&gt;;
			phandle = &lt;0x1c3&gt;;
		};

		kio3-pull {
			rockchip,pins = &lt;0x04 0x07 0x00 0x18a&gt;;
			phandle = &lt;0x1c4&gt;;
		};
	};

	sdmmc-gpio {

		io4-pd2-pin {
			rockchip,pins = &lt;0x04 0x1a 0x00 0x18a&gt;;
		};

		io4-pd3-pin {
			rockchip,pins = &lt;0x04 0x1b 0x00 0x18a&gt;;
		};
	};
};

rkcif-mipi-lvds4 {
	compatible = "rockchip,rkcif-mipi-lvds";
	rockchip,hw = &lt;0x4a&gt;;
	iommus = &lt;0x4b&gt;;
	status = "disabled";
	phandle = &lt;0x18f&gt;;
};

rkcif-mipi-lvds4-sditf {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x18f&gt;;
	status = "disabled";
};

rkcif-mipi-lvds4-sditf-vir1 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x18f&gt;;
	status = "disabled";
};

rkcif-mipi-lvds4-sditf-vir2 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x18f&gt;;
	status = "disabled";
};

rkcif-mipi-lvds4-sditf-vir3 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x18f&gt;;
	status = "disabled";
};

rkcif-mipi-lvds5 {
	compatible = "rockchip,rkcif-mipi-lvds";
	rockchip,hw = &lt;0x4a&gt;;
	iommus = &lt;0x4b&gt;;
	status = "disabled";
	phandle = &lt;0x190&gt;;
};

rkcif-mipi-lvds5-sditf {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x190&gt;;
	status = "disabled";
};

rkcif-mipi-lvds5-sditf-vir1 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x190&gt;;
	status = "disabled";
};

rkcif-mipi-lvds5-sditf-vir2 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x190&gt;;
	status = "disabled";
};

rkcif-mipi-lvds5-sditf-vir3 {
	compatible = "rockchip,rkcif-sditf";
	rockchip,cif = &lt;0x190&gt;;
	status = "disabled";
};

usbdrd3_1 {
	compatible = "rockchip,rk3588-dwc3\0rockchip,rk3399-dwc3";
	clocks = &lt;0x02 0x1a6 0x02 0x1a5 0x02 0x1a4&gt;;
	clock-names = "ref\0suspend\0bus";
	#address-cells = &lt;0x02&gt;;
	#size-cells = &lt;0x02&gt;;
	ranges;
	status = "okay";

	usb@fc400000 {
		compatible = "snps,dwc3";
		reg = &lt;0x00 0xfc400000 0x00 0x400000&gt;;
		interrupts = &lt;0x00 0xdd 0x04&gt;;
		power-domains = &lt;0x58 0x1f&gt;;
		resets = &lt;0x02 0x2a7&gt;;
		reset-names = "usb3-otg";
		dr_mode = "host";
		phys = &lt;0x191 0x192&gt;;
		phy-names = "usb2-phy\0usb3-phy";
		phy_type = "utmi_wide";
		snps,dis_enblslpm_quirk;
		snps,dis-u1-entry-quirk;
		snps,dis-u2-entry-quirk;
		snps,dis-u2-freeclk-exists-quirk;
		snps,dis-del-phy-power-chg-quirk;
		snps,dis-tx-ipgap-linecheck-quirk;
		snps,parkmode-disable-hs-quirk;
		snps,parkmode-disable-ss-quirk;
		status = "okay";
	};
};

syscon@fd5b8000 {
	compatible = "rockchip,pcie30-phy-grf\0syscon";
	reg = &lt;0x00 0xfd5b8000 0x00 0x10000&gt;;
	phandle = &lt;0x1b3&gt;;
};

syscon@fd5c0000 {
	compatible = "rockchip,pipe-phy-grf\0syscon";
	reg = &lt;0x00 0xfd5c0000 0x00 0x100&gt;;
	phandle = &lt;0x1b2&gt;;
};

syscon@fd5cc000 {
	compatible = "rockchip,rk3588-usbdpphy-grf\0syscon";
	reg = &lt;0x00 0xfd5cc000 0x00 0x4000&gt;;
	phandle = &lt;0x1b0&gt;;
};

syscon@fd5d4000 {
	compatible = "rockchip,rk3588-usb2phy-grf\0syscon\0simple-mfd";
	reg = &lt;0x00 0xfd5d4000 0x00 0x4000&gt;;
	#address-cells = &lt;0x01&gt;;
	#size-cells = &lt;0x01&gt;;
	phandle = &lt;0x1af&gt;;

	usb2-phy@4000 {
		compatible = "rockchip,rk3588-usb2phy";
		reg = &lt;0x4000 0x10&gt;;
		interrupts = &lt;0x00 0x18a 0x04&gt;;
		resets = &lt;0x02 0xc0048 0x02 0x489&gt;;
		reset-names = "phy\0apb";
		clocks = &lt;0x02 0x2b5&gt;;
		clock-names = "phyclk";
		clock-output-names = "usb480m_phy1";
		#clock-cells = &lt;0x00&gt;;
		rockchip,usbctrl-grf = &lt;0x6c&gt;;
		status = "okay";
		phandle = &lt;0x1b1&gt;;

		otg-port {
			#phy-cells = &lt;0x00&gt;;
			status = "okay";
			phy-supply = &lt;0x6e&gt;;
			phandle = &lt;0x191&gt;;
		};
	};
};

syscon@fd5e4000 {
	compatible = "rockchip,rk3588-hdptxphy-grf\0syscon";
	reg = &lt;0x00 0xfd5e4000 0x00 0x100&gt;;
	phandle = &lt;0x1ae&gt;;
};

spdif-tx@fddb8000 {
	compatible = "rockchip,rk3588-spdif\0rockchip,rk3568-spdif";
	reg = &lt;0x00 0xfddb8000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xc6 0x04&gt;;
	dmas = &lt;0xe8 0x16&gt;;
	dma-names = "tx";
	clock-names = "mclk\0hclk";
	clocks = &lt;0x02 0x20f 0x02 0x20a&gt;;
	assigned-clocks = &lt;0x02 0x20b&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	power-domains = &lt;0x58 0x19&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
	phandle = &lt;0x1bb&gt;;
};

i2s@fddc8000 {
	compatible = "rockchip,rk3588-i2s-tdm";
	reg = &lt;0x00 0xfddc8000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xbc 0x04&gt;;
	clocks = &lt;0x02 0x201 0x02 0x1fe&gt;;
	clock-names = "mclk_tx\0hclk";
	assigned-clocks = &lt;0x02 0x1ff&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	dmas = &lt;0xe9 0x16&gt;;
	dma-names = "tx";
	power-domains = &lt;0x58 0x19&gt;;
	resets = &lt;0x02 0x391&gt;;
	reset-names = "tx-m";
	rockchip,playback-only;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

spdif-tx@fdde8000 {
	compatible = "rockchip,rk3588-spdif\0rockchip,rk3568-spdif";
	reg = &lt;0x00 0xfdde8000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xc5 0x04&gt;;
	dmas = &lt;0xe8 0x08&gt;;
	dma-names = "tx";
	clock-names = "mclk\0hclk";
	clocks = &lt;0x02 0x25c 0x02 0x258&gt;;
	assigned-clocks = &lt;0x02 0x259&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	power-domains = &lt;0x58 0x1a&gt;;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

i2s@fddf4000 {
	compatible = "rockchip,rk3588-i2s-tdm";
	reg = &lt;0x00 0xfddf4000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xba 0x04&gt;;
	clocks = &lt;0x02 0x24c 0x02 0x24c 0x02 0x252&gt;;
	clock-names = "mclk_tx\0mclk_rx\0hclk";
	assigned-clocks = &lt;0x02 0x249&gt;;
	assigned-clock-parents = &lt;0x02 0x07&gt;;
	dmas = &lt;0xe9 0x04&gt;;
	dma-names = "tx";
	power-domains = &lt;0x58 0x1a&gt;;
	resets = &lt;0x02 0x3ef&gt;;
	reset-names = "tx-m";
	rockchip,always-on;
	rockchip,hdmi-path;
	rockchip,playback-only;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0x1b7&gt;;
};

i2s@fddf8000 {
	compatible = "rockchip,rk3588-i2s-tdm";
	reg = &lt;0x00 0xfddf8000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xbb 0x04&gt;;
	clocks = &lt;0x02 0x23c 0x02 0x23c 0x02 0x238&gt;;
	clock-names = "mclk_tx\0mclk_rx\0hclk";
	assigned-clocks = &lt;0x02 0x239&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	dmas = &lt;0xe9 0x15&gt;;
	dma-names = "rx";
	power-domains = &lt;0x58 0x1a&gt;;
	resets = &lt;0x02 0x3c3&gt;;
	reset-names = "rx-m";
	rockchip,capture-only;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0x1c9&gt;;
};

i2s@fde00000 {
	compatible = "rockchip,rk3588-i2s-tdm";
	reg = &lt;0x00 0xfde00000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xbe 0x04&gt;;
	clocks = &lt;0x02 0x237 0x02 0x237 0x02 0x233&gt;;
	clock-names = "mclk_tx\0mclk_rx\0hclk";
	assigned-clocks = &lt;0x02 0x234&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	dmas = &lt;0xe9 0x18&gt;;
	dma-names = "rx";
	power-domains = &lt;0x58 0x1a&gt;;
	resets = &lt;0x02 0x417&gt;;
	reset-names = "rx-m";
	rockchip,capture-only;
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

spdif-rx@fde10000 {
	compatible = "rockchip,rk3588-spdifrx\0rockchip,rk3308-spdifrx";
	reg = &lt;0x00 0xfde10000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xc8 0x04&gt;;
	clocks = &lt;0x02 0x260 0x02 0x25f&gt;;
	clock-names = "mclk\0hclk";
	assigned-clocks = &lt;0x02 0x260&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	dmas = &lt;0x72 0x16&gt;;
	dma-names = "rx";
	power-domains = &lt;0x58 0x1a&gt;;
	resets = &lt;0x02 0x3ff&gt;;
	reset-names = "spdifrx-m";
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

spdif-rx@fde18000 {
	compatible = "rockchip,rk3588-spdifrx\0rockchip,rk3308-spdifrx";
	reg = &lt;0x00 0xfde18000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xc9 0x04&gt;;
	clocks = &lt;0x02 0x262 0x02 0x261&gt;;
	clock-names = "mclk\0hclk";
	assigned-clocks = &lt;0x02 0x262&gt;;
	assigned-clock-parents = &lt;0x02 0x05&gt;;
	dmas = &lt;0x72 0x17&gt;;
	dma-names = "rx";
	power-domains = &lt;0x58 0x1a&gt;;
	resets = &lt;0x02 0x401&gt;;
	reset-names = "spdifrx-m";
	#sound-dai-cells = &lt;0x00&gt;;
	status = "disabled";
};

dp@fde60000 {
	compatible = "rockchip,rk3588-dp";
	reg = &lt;0x00 0xfde60000 0x00 0x4000&gt;;
	interrupts = &lt;0x00 0xa2 0x04&gt;;
	clocks = &lt;0x02 0x1e7 0x02 0x2cd 0x02 0x201 0x02 0x20d 0x04 0x02 0x1eb&gt;;
	clock-names = "apb\0aux\0i2s\0spdif\0hclk\0hdcp";
	assigned-clocks = &lt;0x02 0x2cd&gt;;
	assigned-clock-rates = &lt;0xf42400&gt;;
	resets = &lt;0x02 0x389&gt;;
	phys = &lt;0x193&gt;;
	power-domains = &lt;0x58 0x19&gt;;
	#sound-dai-cells = &lt;0x01&gt;;
	status = "disabled";
	phandle = &lt;0x1bc&gt;;

	ports {
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;

		port@0 {
			reg = &lt;0x00&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;

			endpoint@0 {
				reg = &lt;0x00&gt;;
				remote-endpoint = &lt;0x194&gt;;
				status = "disabled";
				phandle = &lt;0xd4&gt;;
			};

			endpoint@1 {
				reg = &lt;0x01&gt;;
				remote-endpoint = &lt;0x3b&gt;;
				status = "disabled";
				phandle = &lt;0xda&gt;;
			};

			endpoint@2 {
				reg = &lt;0x02&gt;;
				remote-endpoint = &lt;0x195&gt;;
				status = "disabled";
				phandle = &lt;0xe2&gt;;
			};
		};

		port@1 {
			reg = &lt;0x01&gt;;

			endpoint {
			};
		};
	};
};

hdmi@fdea0000 {
	compatible = "rockchip,rk3588-dw-hdmi";
	reg = &lt;0x00 0xfdea0000 0x00 0x10000 0x00 0xfdeb0000 0x00 0x10000&gt;;
	interrupts = &lt;0x00 0xad 0x04 0x00 0xae 0x04 0x00 0xaf 0x04 0x00 0xb0 0x04 0x00 0x169 0x04&gt;;
	clocks = &lt;0x02 0x224 0x02 0x266 0x02 0x225 0x02 0x226 0x02 0x24c 0x02 0x274 0x02 0x275 0x02 0x276 0x02 0x277 0x05 0x33&gt;;
	clock-names = "pclk\0hpd\0earc\0hdmitx_ref\0aud\0dclk_vp0\0dclk_vp1\0dclk_vp2\0dclk_vp3\0hclk_vo1\0link_clk";
	resets = &lt;0x02 0x3d7 0x02 0x49d&gt;;
	reset-names = "ref\0hdp";
	power-domains = &lt;0x58 0x1a&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x196 0x197 0x198&gt;;
	reg-io-width = &lt;0x04&gt;;
	rockchip,grf = &lt;0xbf&gt;;
	rockchip,vo1_grf = &lt;0xcf&gt;;
	phys = &lt;0x199&gt;;
	phy-names = "hdmi";
	#sound-dai-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0x1b8&gt;;

	ports {
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;

		port@0 {
			reg = &lt;0x00&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;

			endpoint@0 {
				reg = &lt;0x00&gt;;
				remote-endpoint = &lt;0x19a&gt;;
				status = "disabled";
				phandle = &lt;0xd6&gt;;
			};

			endpoint@1 {
				reg = &lt;0x01&gt;;
				remote-endpoint = &lt;0x3c&gt;;
				status = "okay";
				phandle = &lt;0xdc&gt;;
			};

			endpoint@2 {
				reg = &lt;0x02&gt;;
				remote-endpoint = &lt;0x19b&gt;;
				status = "disabled";
				phandle = &lt;0xe4&gt;;
			};
		};
	};
};

edp@fded0000 {
	compatible = "rockchip,rk3588-edp";
	reg = &lt;0x00 0xfded0000 0x00 0x1000&gt;;
	interrupts = &lt;0x00 0xa4 0x04&gt;;
	clocks = &lt;0x02 0x214 0x02 0x213 0x02 0x215 0x05&gt;;
	clock-names = "dp\0pclk\0spdif\0hclk";
	resets = &lt;0x02 0x3e4 0x02 0x3e3&gt;;
	reset-names = "dp\0apb";
	phys = &lt;0x19c&gt;;
	phy-names = "dp";
	power-domains = &lt;0x58 0x1a&gt;;
	rockchip,grf = &lt;0xcf&gt;;
	status = "disabled";

	ports {
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;

		port@0 {
			reg = &lt;0x00&gt;;
			#address-cells = &lt;0x01&gt;;
			#size-cells = &lt;0x00&gt;;

			endpoint@0 {
				reg = &lt;0x00&gt;;
				remote-endpoint = &lt;0x19d&gt;;
				status = "disabled";
				phandle = &lt;0xd5&gt;;
			};

			endpoint@1 {
				reg = &lt;0x01&gt;;
				remote-endpoint = &lt;0x19e&gt;;
				status = "disabled";
				phandle = &lt;0xdb&gt;;
			};

			endpoint@2 {
				reg = &lt;0x02&gt;;
				remote-endpoint = &lt;0x19f&gt;;
				status = "disabled";
				phandle = &lt;0xe3&gt;;
			};
		};

		port@1 {
			reg = &lt;0x01&gt;;

			endpoint {
			};
		};
	};
};

hdmirx-controller@fdee0000 {
	compatible = "rockchip,rk3588-hdmirx-ctrler\0rockchip,hdmirx-ctrler";
	reg = &lt;0x00 0xfdee0000 0x00 0x6000&gt;;
	reg-names = "hdmirx_regs";
	power-domains = &lt;0x58 0x1a&gt;;
	rockchip,grf = &lt;0xbf&gt;;
	rockchip,vo1_grf = &lt;0xcf&gt;;
	interrupts = &lt;0x00 0xb1 0x04 0x00 0x1b4 0x04 0x00 0xb3 0x04&gt;;
	interrupt-names = "cec\0hdmi\0dma";
	clocks = &lt;0x02 0x21a 0x02 0x21f 0x02 0x2b2 0x02 0x21b 0x02 0x21c 0x02 0x232 0x05&gt;;
	clock-names = "aclk\0audio\0cr_para\0pclk\0ref\0hclk_s_hdmirx\0hclk_vo1";
	resets = &lt;0x02 0x3d9 0x02 0x3da 0x02 0x3db 0x02 0x3b7&gt;;
	reset-names = "rst_a\0rst_p\0rst_ref\0rst_biu";
	pinctrl-0 = &lt;0x1a0 0x1a1&gt;;
	pinctrl-names = "default";
	status = "okay";
	#sound-dai-cells = &lt;0x01&gt;;
	hpd-trigger-level = &lt;0x01&gt;;
	hdmirx-det-gpios = &lt;0x1a2 0x1d 0x01&gt;;
	phandle = &lt;0x1c8&gt;;
};

pcie@fe150000 {
	compatible = "rockchip,rk3588-pcie\0snps,dw-pcie";
	#address-cells = &lt;0x03&gt;;
	#size-cells = &lt;0x02&gt;;
	bus-range = &lt;0x00 0x0f&gt;;
	clocks = &lt;0x02 0x14e 0x02 0x153 0x02 0x149 0x02 0x158 0x02 0x15e 0x02 0x183&gt;;
	clock-names = "aclk_mst\0aclk_slv\0aclk_dbi\0pclk\0aux\0pipe";
	device_type = "pci";
	interrupts = &lt;0x00 0x107 0x04 0x00 0x106 0x04 0x00 0x105 0x04 0x00 0x104 0x04 0x00 0x103 0x04&gt;;
	interrupt-names = "sys\0pmc\0msg\0legacy\0err";
	#interrupt-cells = &lt;0x01&gt;;
	interrupt-map-mask = &lt;0x00 0x00 0x00 0x07&gt;;
	interrupt-map = &lt;0x00 0x00 0x00 0x01 0x1a3 0x00 0x00 0x00 0x00 0x02 0x1a3 0x01 0x00 0x00 0x00 0x03 0x1a3 0x02 0x00 0x00 0x00 0x04 0x1a3 0x03&gt;;
	linux,pci-domain = &lt;0x00&gt;;
	num-ib-windows = &lt;0x10&gt;;
	num-ob-windows = &lt;0x10&gt;;
	num-viewport = &lt;0x08&gt;;
	max-link-speed = &lt;0x03&gt;;
	msi-map = &lt;0x00 0x1a4 0x00 0x1000&gt;;
	num-lanes = &lt;0x04&gt;;
	phys = &lt;0x1a5&gt;;
	phy-names = "pcie-phy";
	power-domains = &lt;0x58 0x22&gt;;
	ranges = &lt;0x800 0x00 0xf0000000 0x00 0xf0000000 0x00 0x100000 0x81000000 0x00 0xf0100000 0x00 0xf0100000 0x00 0x100000 0x82000000 0x00 0xf0200000 0x00 0xf0200000 0x00 0xe00000 0xc3000000 0x09 0x00 0x09 0x00 0x00 0x40000000&gt;;
	reg = &lt;0x00 0xfe150000 0x00 0x10000 0x0a 0x40000000 0x00 0x400000&gt;;
	reg-names = "pcie-apb\0pcie-dbi";
	resets = &lt;0x02 0x20d 0x02 0x21c&gt;;
	reset-names = "pcie\0periph";
	rockchip,pipe-grf = &lt;0x6f&gt;;
	status = "disabled";

	legacy-interrupt-controller {
		interrupt-controller;
		#address-cells = &lt;0x00&gt;;
		#interrupt-cells = &lt;0x01&gt;;
		interrupt-parent = &lt;0x01&gt;;
		interrupts = &lt;0x00 0x104 0x01&gt;;
		phandle = &lt;0x1a3&gt;;
	};
};

pcie@fe160000 {
	compatible = "rockchip,rk3588-pcie\0snps,dw-pcie";
	#address-cells = &lt;0x03&gt;;
	#size-cells = &lt;0x02&gt;;
	bus-range = &lt;0x10 0x1f&gt;;
	clocks = &lt;0x02 0x14f 0x02 0x154 0x02 0x14a 0x02 0x159 0x02 0x15f 0x02 0x184&gt;;
	clock-names = "aclk_mst\0aclk_slv\0aclk_dbi\0pclk\0aux\0pipe";
	device_type = "pci";
	interrupts = &lt;0x00 0x102 0x04 0x00 0x101 0x04 0x00 0x100 0x04 0x00 0xff 0x04 0x00 0xfe 0x04&gt;;
	interrupt-names = "sys\0pmc\0msg\0legacy\0err";
	#interrupt-cells = &lt;0x01&gt;;
	interrupt-map-mask = &lt;0x00 0x00 0x00 0x07&gt;;
	interrupt-map = &lt;0x00 0x00 0x00 0x01 0x1a6 0x00 0x00 0x00 0x00 0x02 0x1a6 0x01 0x00 0x00 0x00 0x03 0x1a6 0x02 0x00 0x00 0x00 0x04 0x1a6 0x03&gt;;
	linux,pci-domain = &lt;0x01&gt;;
	num-ib-windows = &lt;0x10&gt;;
	num-ob-windows = &lt;0x10&gt;;
	num-viewport = &lt;0x08&gt;;
	max-link-speed = &lt;0x03&gt;;
	msi-map = &lt;0x1000 0x1a4 0x1000 0x1000&gt;;
	num-lanes = &lt;0x02&gt;;
	phys = &lt;0x1a5&gt;;
	phy-names = "pcie-phy";
	power-domains = &lt;0x58 0x22&gt;;
	ranges = &lt;0x800 0x00 0xf1000000 0x00 0xf1000000 0x00 0x100000 0x81000000 0x00 0xf1100000 0x00 0xf1100000 0x00 0x100000 0x82000000 0x00 0xf1200000 0x00 0xf1200000 0x00 0xe00000 0xc3000000 0x09 0x40000000 0x09 0x40000000 0x00 0x40000000&gt;;
	reg = &lt;0x00 0xfe160000 0x00 0x10000 0x0a 0x40400000 0x00 0x400000&gt;;
	reg-names = "pcie-apb\0pcie-dbi";
	resets = &lt;0x02 0x20e 0x02 0x21d&gt;;
	reset-names = "pcie\0periph";
	rockchip,pipe-grf = &lt;0x6f&gt;;
	status = "disabled";

	legacy-interrupt-controller {
		interrupt-controller;
		#address-cells = &lt;0x00&gt;;
		#interrupt-cells = &lt;0x01&gt;;
		interrupt-parent = &lt;0x01&gt;;
		interrupts = &lt;0x00 0xff 0x01&gt;;
		phandle = &lt;0x1a6&gt;;
	};
};

pcie@fe170000 {
	compatible = "rockchip,rk3588-pcie\0snps,dw-pcie";
	#address-cells = &lt;0x03&gt;;
	#size-cells = &lt;0x02&gt;;
	bus-range = &lt;0x20 0x2f&gt;;
	clocks = &lt;0x02 0x150 0x02 0x155 0x02 0x14b 0x02 0x15b 0x02 0x160 0x02 0x2c4&gt;;
	clock-names = "aclk_mst\0aclk_slv\0aclk_dbi\0pclk\0aux\0pipe";
	device_type = "pci";
	interrupts = &lt;0x00 0xf3 0x04 0x00 0xf2 0x04 0x00 0xf1 0x04 0x00 0xf0 0x04 0x00 0xef 0x04&gt;;
	interrupt-names = "sys\0pmc\0msg\0legacy\0err";
	#interrupt-cells = &lt;0x01&gt;;
	interrupt-map-mask = &lt;0x00 0x00 0x00 0x07&gt;;
	interrupt-map = &lt;0x00 0x00 0x00 0x01 0x1a7 0x00 0x00 0x00 0x00 0x02 0x1a7 0x01 0x00 0x00 0x00 0x03 0x1a7 0x02 0x00 0x00 0x00 0x04 0x1a7 0x03&gt;;
	linux,pci-domain = &lt;0x02&gt;;
	num-ib-windows = &lt;0x08&gt;;
	num-ob-windows = &lt;0x08&gt;;
	num-viewport = &lt;0x04&gt;;
	max-link-speed = &lt;0x02&gt;;
	msi-map = &lt;0x2000 0xfd 0x2000 0x1000&gt;;
	num-lanes = &lt;0x01&gt;;
	phys = &lt;0x1a8 0x02&gt;;
	phy-names = "pcie-phy";
	ranges = &lt;0x800 0x00 0xf2000000 0x00 0xf2000000 0x00 0x100000 0x81000000 0x00 0xf2100000 0x00 0xf2100000 0x00 0x100000 0x82000000 0x00 0xf2200000 0x00 0xf2200000 0x00 0xe00000 0xc3000000 0x09 0x80000000 0x09 0x80000000 0x00 0x40000000&gt;;
	reg = &lt;0x00 0xfe170000 0x00 0x10000 0x0a 0x40800000 0x00 0x400000&gt;;
	reg-names = "pcie-apb\0pcie-dbi";
	resets = &lt;0x02 0x20f 0x02 0x21e&gt;;
	reset-names = "pcie\0periph";
	rockchip,pipe-grf = &lt;0x6f&gt;;
	status = "okay";
	reset-gpios = &lt;0x1a2 0x0c 0x00&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x1a9&gt;;

	legacy-interrupt-controller {
		interrupt-controller;
		#address-cells = &lt;0x00&gt;;
		#interrupt-cells = &lt;0x01&gt;;
		interrupt-parent = &lt;0x01&gt;;
		interrupts = &lt;0x00 0xf0 0x01&gt;;
		phandle = &lt;0x1a7&gt;;
	};
};

uio@fe1b0000 {
	compatible = "rockchip,uio-gmac";
	reg = &lt;0x00 0xfe1b0000 0x00 0x10000&gt;;
	rockchip,ethernet = &lt;0x1aa&gt;;
	status = "disabled";
};

ethernet@fe1b0000 {
	compatible = "rockchip,rk3588-gmac\0snps,dwmac-4.20a";
	reg = &lt;0x00 0xfe1b0000 0x00 0x10000&gt;;
	interrupts = &lt;0x00 0xe3 0x04 0x00 0xe2 0x04&gt;;
	interrupt-names = "macirq\0eth_wake_irq";
	rockchip,grf = &lt;0xbf&gt;;
	rockchip,php_grf = &lt;0x6f&gt;;
	clocks = &lt;0x02 0x144 0x02 0x145 0x02 0x167 0x02 0x16c 0x02 0x142&gt;;
	clock-names = "stmmaceth\0clk_mac_ref\0pclk_mac\0aclk_mac\0ptp_ref";
	resets = &lt;0x02 0x20a&gt;;
	reset-names = "stmmaceth";
	power-domains = &lt;0x58 0x21&gt;;
	snps,mixed-burst;
	snps,tso;
	snps,axi-config = &lt;0x1ab&gt;;
	snps,mtl-rx-config = &lt;0x1ac&gt;;
	snps,mtl-tx-config = &lt;0x1ad&gt;;
	status = "disabled";
	phandle = &lt;0x1aa&gt;;

	mdio {
		compatible = "snps,dwmac-mdio";
		#address-cells = &lt;0x01&gt;;
		#size-cells = &lt;0x00&gt;;
	};

	stmmac-axi-config {
		snps,wr_osr_lmt = &lt;0x04&gt;;
		snps,rd_osr_lmt = &lt;0x08&gt;;
		snps,blen = &lt;0x00 0x00 0x00 0x00 0x10 0x08 0x04&gt;;
		phandle = &lt;0x1ab&gt;;
	};

	rx-queues-config {
		snps,rx-queues-to-use = &lt;0x01&gt;;
		phandle = &lt;0x1ac&gt;;

		queue0 {
		};
	};

	tx-queues-config {
		snps,tx-queues-to-use = &lt;0x01&gt;;
		phandle = &lt;0x1ad&gt;;

		queue0 {
		};
	};
};

sata@fe220000 {
	compatible = "rockchip,rk-ahci\0snps,dwc-ahci";
	reg = &lt;0x00 0xfe220000 0x00 0x1000&gt;;
	clocks = &lt;0x02 0x172 0x02 0x16f 0x02 0x175 0x02 0x164 0x02 0x17f&gt;;
	clock-names = "sata\0pmalive\0rxoob\0ref\0asic";
	interrupts = &lt;0x00 0x112 0x04&gt;;
	interrupt-names = "hostc";
	phys = &lt;0x1a8 0x01&gt;;
	phy-names = "sata-phy";
	ports-implemented = &lt;0x01&gt;;
	status = "disabled";
};

phy@fed70000 {
	compatible = "rockchip,rk3588-hdptx-phy";
	reg = &lt;0x00 0xfed70000 0x00 0x2000&gt;;
	clocks = &lt;0x02 0x2b5 0x02 0x268&gt;;
	clock-names = "ref\0apb";
	resets = &lt;0x02 0x486 0x02 0xc003f 0x02 0xc0040 0x02 0xc0041&gt;;
	reset-names = "apb\0init\0cmn\0lane";
	rockchip,grf = &lt;0x1ae&gt;;
	#phy-cells = &lt;0x00&gt;;
	status = "disabled";
	phandle = &lt;0x19c&gt;;
};

hdmiphy@fed70000 {
	compatible = "rockchip,rk3588-hdptx-phy-hdmi";
	reg = &lt;0x00 0xfed70000 0x00 0x2000&gt;;
	clocks = &lt;0x02 0x2b5 0x02 0x268&gt;;
	clock-names = "ref\0apb";
	resets = &lt;0x02 0x491 0x02 0x486 0x02 0xc003f 0x02 0xc0040 0x02 0xc0041 0x02 0x48f 0x02 0x490&gt;;
	reset-names = "phy\0apb\0init\0cmn\0lane\0ropll\0lcpll";
	rockchip,grf = &lt;0x1ae&gt;;
	#phy-cells = &lt;0x00&gt;;
	status = "okay";
	phandle = &lt;0x199&gt;;

	clk-port {
		#clock-cells = &lt;0x00&gt;;
		status = "okay";
		phandle = &lt;0x33&gt;;
	};
};

phy@fed90000 {
	compatible = "rockchip,rk3588-usbdp-phy";
	reg = &lt;0x00 0xfed90000 0x00 0x10000&gt;;
	rockchip,u2phy-grf = &lt;0x1af&gt;;
	rockchip,usb-grf = &lt;0x6c&gt;;
	rockchip,usbdpphy-grf = &lt;0x1b0&gt;;
	rockchip,vo-grf = &lt;0xec&gt;;
	clocks = &lt;0x02 0x2b6 0x02 0x280 0x02 0x26a 0x1b1&gt;;
	clock-names = "refclk\0immortal\0pclk\0utmi";
	resets = &lt;0x02 0x2f 0x02 0x30 0x02 0x31 0x02 0x32 0x02 0x484&gt;;
	reset-names = "init\0cmn\0lane\0pcs_apb\0pma_apb";
	status = "okay";
	rockchip,dp-lane-mux = &lt;0x02 0x03&gt;;

	dp-port {
		#phy-cells = &lt;0x00&gt;;
		status = "disabled";
		phandle = &lt;0x193&gt;;
	};

	u3-port {
		#phy-cells = &lt;0x00&gt;;
		status = "okay";
		phandle = &lt;0x192&gt;;
	};
};

phy@fee10000 {
	compatible = "rockchip,rk3588-naneng-combphy";
	reg = &lt;0x00 0xfee10000 0x00 0x100&gt;;
	#phy-cells = &lt;0x01&gt;;
	clocks = &lt;0x02 0x2be 0x02 0x186 0x02 0x166&gt;;
	clock-names = "refclk\0apbclk\0phpclk";
	assigned-clocks = &lt;0x02 0x2be&gt;;
	assigned-clock-rates = &lt;0x5f5e100&gt;;
	resets = &lt;0x02 0x20006 0x02 0x4d7&gt;;
	reset-names = "combphy-apb\0combphy";
	rockchip,pipe-grf = &lt;0x6f&gt;;
	rockchip,pipe-phy-grf = &lt;0x1b2&gt;;
	rockchip,pcie1ln-sel-bits = &lt;0x100 0x00 0x00 0x00&gt;;
	status = "okay";
	phandle = &lt;0x1a8&gt;;
};

phy@fee80000 {
	compatible = "rockchip,rk3588-pcie3-phy";
	reg = &lt;0x00 0xfee80000 0x00 0x20000&gt;;
	#phy-cells = &lt;0x00&gt;;
	clocks = &lt;0x02 0x188&gt;;
	clock-names = "pclk";
	resets = &lt;0x02 0x2000a&gt;;
	reset-names = "phy";
	rockchip,pipe-grf = &lt;0x6f&gt;;
	rockchip,phy-grf = &lt;0x1b3&gt;;
	status = "disabled";
	phandle = &lt;0x1a5&gt;;
};

adc-keys {
	compatible = "adc-keys";
	io-channels = &lt;0x1b4 0x01&gt;;
	io-channel-names = "buttons";
	keyup-threshold-microvolt = &lt;0x1b7740&gt;;
	poll-interval = &lt;0x64&gt;;

	vol-up-key {
		label = "volume up";
		linux,code = &lt;0x73&gt;;
		press-threshold-microvolt = &lt;0x4268&gt;;
	};
};

backlight {
	compatible = "pwm-backlight";
	brightness-levels = &lt;0x00 0x14 0x14 0x15 0x15 0x16 0x16 0x17 0x17 0x18 0x18 0x19 0x19 0x1a 0x1a 0x1b 0x1b 0x1c 0x1c 0x1d 0x1d 0x1e 0x1e 0x1f 0x1f 0x20 0x20 0x21 0x21 0x22 0x22 0x23 0x23 0x24 0x24 0x25 0x25 0x26 0x26 0x27 0x28 0x29 0x2a 0x2b 0x2c 0x2d 0x2e 0x2f 0x30 0x31 0x32 0x33 0x34 0x35 0x36 0x37 0x38 0x39 0x3a 0x3b 0x3c 0x3d 0x3e 0x3f 0x40 0x41 0x42 0x43 0x44 0x45 0x46 0x47 0x48 0x49 0x4a 0x4b 0x4c 0x4d 0x4e 0x4f 0x50 0x51 0x52 0x53 0x54 0x55 0x56 0x57 0x58 0x59 0x5a 0x5b 0x5c 0x5d 0x5e 0x5f 0x60 0x61 0x62 0x63 0x64 0x65 0x66 0x67 0x68 0x69 0x6a 0x6b 0x6c 0x6d 0x6e 0x6f 0x70 0x71 0x72 0x73 0x74 0x75 0x76 0x77 0x78 0x79 0x7a 0x7b 0x7c 0x7d 0x7e 0x7f 0x80 0x81 0x82 0x83 0x84 0x85 0x86 0x87 0x88 0x89 0x8a 0x8b 0x8c 0x8d 0x8e 0x8f 0x90 0x91 0x92 0x93 0x94 0x95 0x96 0x97 0x98 0x99 0x9a 0x9b 0x9c 0x9d 0x9e 0x9f 0xa0 0xa1 0xa2 0xa3 0xa4 0xa5 0xa6 0xa7 0xa8 0xa9 0xaa 0xab 0xac 0xad 0xae 0xaf 0xb0 0xb1 0xb2 0xb3 0xb4 0xb5 0xb6 0xb7 0xb8 0xb9 0xba 0xbb 0xbc 0xbd 0xbe 0xbf 0xc0 0xc1 0xc2 0xc3 0xc4 0xc5 0xc6 0xc7 0xc8 0xc9 0xca 0xcb 0xcc 0xcd 0xce 0xcf 0xd0 0xd1 0xd2 0xd3 0xd4 0xd5 0xd6 0xd7 0xd8 0xd9 0xda 0xdb 0xdc 0xdd 0xde 0xdf 0xe0 0xe1 0xe2 0xe3 0xe4 0xe5 0xe6 0xe7 0xe8 0xe9 0xea 0xeb 0xec 0xed 0xee 0xef 0xf0 0xf1 0xf2 0xf3 0xf4 0xf5 0xf6 0xf7 0xf8 0xf9 0xfa 0xfb 0xfc 0xfd 0xfe 0xff&gt;;
	default-brightness-level = &lt;0xc8&gt;;
};

hdmi0-sound {
	status = "okay";
	compatible = "rockchip,hdmi";
	rockchip,mclk-fs = &lt;0x80&gt;;
	rockchip,card-name = "rockchip-hdmi0";
	rockchip,cpu = &lt;0x1b5&gt;;
	rockchip,codec = &lt;0x1b6&gt;;
	rockchip,jack-det;
};

hdmi1-sound {
	status = "okay";
	compatible = "rockchip,hdmi";
	rockchip,mclk-fs = &lt;0x80&gt;;
	rockchip,card-name = "rockchip-hdmi1";
	rockchip,cpu = &lt;0x1b7&gt;;
	rockchip,codec = &lt;0x1b8&gt;;
	rockchip,jack-det;
};

dp0-sound {
	status = "disabled";
	compatible = "rockchip,hdmi";
	rockchip,card-name = "rockchip-dp0";
	rockchip,mclk-fs = &lt;0x200&gt;;
	rockchip,cpu = &lt;0x1b9&gt;;
	rockchip,codec = &lt;0x1ba 0x01&gt;;
	rockchip,jack-det;
};

dp1-sound {
	status = "disabled";
	compatible = "rockchip,hdmi";
	rockchip,card-name = "rockchip-dp1";
	rockchip,mclk-fs = &lt;0x200&gt;;
	rockchip,cpu = &lt;0x1bb&gt;;
	rockchip,codec = &lt;0x1bc 0x01&gt;;
	rockchip,jack-det;
};

spdif-tx0-dc {
	status = "disabled";
	compatible = "linux,spdif-dit";
	#sound-dai-cells = &lt;0x00&gt;;
	phandle = &lt;0x1be&gt;;
};

spdif-tx0-sound {
	status = "disabled";
	compatible = "simple-audio-card";
	simple-audio-card,mclk-fs = &lt;0x80&gt;;
	simple-audio-card,name = "rockchip,spdif-tx0";

	simple-audio-card,cpu {
		sound-dai = &lt;0x1bd&gt;;
	};

	simple-audio-card,codec {
		sound-dai = &lt;0x1be&gt;;
	};
};

spdif-tx1-dc {
	status = "disabled";
	compatible = "linux,spdif-dit";
	#sound-dai-cells = &lt;0x00&gt;;
	phandle = &lt;0x1c0&gt;;
};

spdif-tx1-sound {
	status = "disabled";
	compatible = "simple-audio-card";
	simple-audio-card,mclk-fs = &lt;0x80&gt;;
	simple-audio-card,name = "rockchip,spdif-tx1";

	simple-audio-card,cpu {
		sound-dai = &lt;0x1bf&gt;;
	};

	simple-audio-card,codec {
		sound-dai = &lt;0x1c0&gt;;
	};
};

vcc12v-dcin {
	compatible = "regulator-fixed";
	regulator-name = "vcc12v_dcin";
	regulator-always-on;
	regulator-boot-on;
	regulator-min-microvolt = &lt;0xb71b00&gt;;
	regulator-max-microvolt = &lt;0xb71b00&gt;;
	phandle = &lt;0x1c1&gt;;
};

vcc5v0-sys {
	compatible = "regulator-fixed";
	regulator-name = "vcc5v0_sys";
	regulator-always-on;
	regulator-boot-on;
	regulator-min-microvolt = &lt;0x4c4b40&gt;;
	regulator-max-microvolt = &lt;0x4c4b40&gt;;
	vin-supply = &lt;0x1c1&gt;;
	phandle = &lt;0x71&gt;;
};

vcc5v0-ext {
	compatible = "regulator-fixed";
	regulator-name = "vcc5v0_ext";
	regulator-boot-on;
	regulator-always-on;
	regulator-min-microvolt = &lt;0x4c4b40&gt;;
	regulator-max-microvolt = &lt;0x4c4b40&gt;;
	enable-active-high;
	gpio = &lt;0xf5 0x00 0x00&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x1c2&gt;;
	vin-supply = &lt;0x1c1&gt;;
	phandle = &lt;0x1ce&gt;;
};

rockchip-keys {
	status = "disabled";
	compatible = "rockchip,keys";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x1c3 0x1c4&gt;;

	vol-up-key {
		gpios = &lt;0xf5 0x07 0x01&gt;;
		linux,code = &lt;0x73&gt;;
		label = "volume up";
		gpio-key,wakeup;
	};

	vol-down-key {
		gpios = &lt;0x14e 0x1b 0x01&gt;;
		linux,code = &lt;0x72&gt;;
		label = "volume down";
		gpio-key,wake-up;
	};
};

leds {
	compatible = "gpio-leds";

	work {
		gpios = &lt;0xf5 0x0e 0x00&gt;;
		linux,default-trigger = "heartbeat";
	};
};

es8388-sound {
	status = "okay";
	compatible = "rockchip,multicodecs-card";
	rockchip,card-name = "rockchip-es8388i";
	hp-det-gpio = &lt;0x1a2 0x14 0x01&gt;;
	keyup-threshold-microvolt = &lt;0x1b7740&gt;;
	poll-interval = &lt;0x64&gt;;
	spk-con-gpio = &lt;0x1a2 0x07 0x01&gt;;
	rockchip,format = "i2s";
	rockchip,mclk-fs = &lt;0x100&gt;;
	rockchip,cpu = &lt;0x1c5&gt;;
	rockchip,codec = &lt;0x1c6&gt;;
	rockchip,audio-routing = "Headphone\0Headphone Power\0Headphone\0Headphone Power\0Speaker\0Speaker Power\0Speaker\0Speaker Power\0LINPUT1\0Main Mic\0LINPUT2\0Main Mic\0RINPUT1\0Headset Mic\0RINPUT2\0Headset Mic";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x1c7&gt;;

	play-pause-key {
		label = "playpause";
		linux,code = &lt;0xa4&gt;;
		press-threshold-microvolt = &lt;0x7d0&gt;;
	};
};

hdmiin-sound {
	status = "okay";
	compatible = "rockchip,hdmi";
	rockchip,mclk-fs = &lt;0x80&gt;;
	rockchip,format = "i2s";
	rockchip,bitclock-master = &lt;0x1c8&gt;;
	rockchip,frame-master = &lt;0x1c8&gt;;
	rockchip,card-name = "rockchip,hdmiin";
	rockchip,cpu = &lt;0x1c9&gt;;
	rockchip,codec = &lt;0x1c8 0x00&gt;;
	rockchip,jack-det;
};

pcie20-avdd0v85 {
	compatible = "regulator-fixed";
	regulator-name = "pcie20_avdd0v85";
	regulator-boot-on;
	regulator-always-on;
	regulator-min-microvolt = &lt;0xcf850&gt;;
	regulator-max-microvolt = &lt;0xcf850&gt;;
	vin-supply = &lt;0x1ca&gt;;
};

pcie20-avdd1v8 {
	compatible = "regulator-fixed";
	regulator-name = "pcie20_avdd1v8";
	regulator-boot-on;
	regulator-always-on;
	regulator-min-microvolt = &lt;0x1b7740&gt;;
	regulator-max-microvolt = &lt;0x1b7740&gt;;
	vin-supply = &lt;0x1cb&gt;;
};

pcie30-avdd0v75 {
	compatible = "regulator-fixed";
	regulator-name = "pcie30_avdd0v75";
	regulator-boot-on;
	regulator-always-on;
	regulator-min-microvolt = &lt;0xb71b0&gt;;
	regulator-max-microvolt = &lt;0xb71b0&gt;;
	vin-supply = &lt;0x1cc&gt;;
};

pcie30-avdd1v8 {
	compatible = "regulator-fixed";
	regulator-name = "pcie30_avdd1v8";
	regulator-boot-on;
	regulator-always-on;
	regulator-min-microvolt = &lt;0x1b7740&gt;;
	regulator-max-microvolt = &lt;0x1b7740&gt;;
	vin-supply = &lt;0x1cb&gt;;
};

rk-headset {
	status = "disabled";
	compatible = "rockchip_headset";
	headset_gpio = &lt;0x1a2 0x14 0x01&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x1c7&gt;;
	io-channels = &lt;0x1b4 0x03&gt;;
};

vcc-1v1-nldo-s3 {
	compatible = "regulator-fixed";
	regulator-name = "vcc_1v1_nldo_s3";
	regulator-always-on;
	regulator-boot-on;
	regulator-min-microvolt = &lt;0x10c8e0&gt;;
	regulator-max-microvolt = &lt;0x10c8e0&gt;;
	vin-supply = &lt;0x71&gt;;
	phandle = &lt;0x155&gt;;
};

vbus5v0-typec {
	compatible = "regulator-fixed";
	regulator-name = "vbus5v0_typec";
	regulator-min-microvolt = &lt;0x4c4b40&gt;;
	regulator-max-microvolt = &lt;0x4c4b40&gt;;
	enable-active-high;
	gpio = &lt;0x1a2 0x04 0x00&gt;;
	vin-supply = &lt;0x6e&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x1cd&gt;;
	phandle = &lt;0x6d&gt;;
};

vcc5v0-host {
	compatible = "regulator-fixed";
	regulator-name = "vcc5v0_host";
	regulator-boot-on;
	regulator-always-on;
	regulator-min-microvolt = &lt;0x4c4b40&gt;;
	regulator-max-microvolt = &lt;0x4c4b40&gt;;
	vin-supply = &lt;0x1ce&gt;;
	phandle = &lt;0x6e&gt;;
};

vcc-lvds-log {
	compatible = "regulator-fixed";
	enable-active-high;
	regulator-boot-on;
	gpio = &lt;0x14e 0x08 0x00&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x1cf&gt;;
	regulator-name = "vcc_lvds_log";
};

vcc-3v3-sd-s0-regulator {
	compatible = "regulator-fixed";
	gpio = &lt;0x1a2 0x03 0x00&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x1d0&gt;;
	regulator-name = "vcc_3v3_sd_s0";
	regulator-min-microvolt = &lt;0x325aa0&gt;;
	regulator-max-microvolt = &lt;0x325aa0&gt;;
	startup-delay-us = &lt;0x186a0&gt;;
	enable-active-high;
	regulator-boot-on;
	vin-supply = &lt;0x1d1&gt;;
	phandle = &lt;0x110&gt;;
};

sdio-pwrseq {
	compatible = "mmc-pwrseq-simple";
	clocks = &lt;0x1d2&gt;;
	clock-names = "ext_clock";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x1d3&gt;;
	post-power-on-delay-ms = &lt;0xc8&gt;;
	reset-gpios = &lt;0x1a2 0x08 0x01&gt;;
	phandle = &lt;0x112&gt;;
};

wireless-bluetooth {
	compatible = "bluetooth-platdata";
	clocks = &lt;0x1d2&gt;;
	clock-names = "ext_clock";
	uart_rts_gpios = &lt;0xf5 0x14 0x01&gt;;
	pinctrl-names = "default\0rts_gpio";
	pinctrl-0 = &lt;0x1d4 0x1d5 0x1d6 0x1d7&gt;;
	pinctrl-1 = &lt;0x1d8&gt;;
	BT,reset_gpio = &lt;0x1a2 0x0a 0x00&gt;;
	BT,wake_gpio = &lt;0x1a2 0x09 0x00&gt;;
	BT,wake_host_irq = &lt;0x1a2 0x00 0x00&gt;;
	status = "okay";
};

wireless-wlan {
	compatible = "wlan-platdata";
	wifi_chip_type = "ap6212";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x1d9&gt;;
	WIFI,host_wake_irq = &lt;0x1a2 0x01 0x00&gt;;
	WIFI,poweren_gpio = &lt;0x1a2 0x08 0x00&gt;;
	status = "okay";
};

powerhold-gpio {
	compatible = "powerhold-platdata";
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x1da&gt;;
	power-hold = &lt;0x14e 0x16 0x00&gt;;
};

remotectl-gpio {
	compatible = "remotectl-platdata";
	auto_repeat = &lt;0x00&gt;;
	status = "okay";
	irda-rem = &lt;0x104 0x0a 0x00&gt;;
	irda-led = &lt;0x14e 0x15 0x00&gt;;
	irda-ion = &lt;0x1db 0x15 0x00&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x1dc 0x1dd 0x1de&gt;;
};

chosen {
	bootargs = "earlycon=uart8250,mmio32,0xfeb50000 console=ttyFIQ0 irqchip.gicv3_pseudo_nmi=0 root=PARTUUID=614e0000-0000 rw rootwait rcupdate.rcu_expedited=1 rcu_nocbs=all nokaslr debug level=10";
};

cspmu@fd10c000 {
	compatible = "rockchip,cspmu";
	reg = &lt;0x00 0xfd10c000 0x00 0x1000 0x00 0xfd10d000 0x00 0x1000 0x00 0xfd10e000 0x00 0x1000 0x00 0xfd10f000 0x00 0x1000 0x00 0xfd12c000 0x00 0x1000 0x00 0xfd12d000 0x00 0x1000 0x00 0xfd12e000 0x00 0x1000 0x00 0xfd12f000 0x00 0x1000&gt;;
};

debug@fd104000 {
	compatible = "rockchip,debug";
	reg = &lt;0x00 0xfd104000 0x00 0x1000 0x00 0xfd105000 0x00 0x1000 0x00 0xfd106000 0x00 0x1000 0x00 0xfd107000 0x00 0x1000 0x00 0xfd124000 0x00 0x1000 0x00 0xfd125000 0x00 0x1000 0x00 0xfd126000 0x00 0x1000 0x00 0xfd127000 0x00 0x1000&gt;;
};

fiq-debugger {
	compatible = "rockchip,fiq-debugger";
	rockchip,serial-id = &lt;0x02&gt;;
	rockchip,wake-irq = &lt;0x00&gt;;
	rockchip,irq-mode-enable = &lt;0x01&gt;;
	rockchip,baudrate = &lt;0x16e360&gt;;
	interrupts = &lt;0x00 0x1a7 0x08&gt;;
	pinctrl-names = "default";
	pinctrl-0 = &lt;0x15a&gt;;
	status = "okay";
};

minidump {
	compatible = "rockchip,minidump";
	smem-region = &lt;0x1df&gt;;
	minidump-region = &lt;0x1e0&gt;;
	status = "disabled";
};

reserved-memory {
	#address-cells = &lt;0x02&gt;;
	#size-cells = &lt;0x02&gt;;
	ranges;

	cma {
		compatible = "shared-dma-pool";
		reusable;
		reg = &lt;0x00 0x10000000 0x00 0x8000000&gt;;
		linux,cma-default;
	};

	drm-logo@00000000 {
		compatible = "rockchip,drm-logo";
		reg = &lt;0x00 0x00 0x00 0x00&gt;;
		phandle = &lt;0x34&gt;;
	};

	drm-cubic-lut@00000000 {
		compatible = "rockchip,drm-cubic-lut";
		reg = &lt;0x00 0x00 0x00 0x00&gt;;
	};

	ramoops@110000 {
		compatible = "ramoops";
		reg = &lt;0x00 0x110000 0x00 0xe0000&gt;;
		boot-log-size = &lt;0x8000&gt;;
		boot-log-count = &lt;0x01&gt;;
		console-size = &lt;0x80000&gt;;
		pmsg-size = &lt;0x30000&gt;;
		ftrace-size = &lt;0x00&gt;;
		record-size = &lt;0x14000&gt;;
	};

	minidump-smem@1f0000 {
		reg = &lt;0x00 0x1f0000 0x00 0x100&gt;;
		no-map;
		status = "disabled";
		phandle = &lt;0x1df&gt;;
	};

	minidump-mem@c000000 {
		reg = &lt;0x00 0xc000000 0x00 0x2000000&gt;;
		no-map;
		status = "disabled";
		phandle = &lt;0x1e0&gt;;
	};
}; };
</code></pre></div></div>]]></content><author><name></name></author><category term="hardware&gt;rockchip" /></entry><entry><title type="html">TreeSheets Debian 11 arm64 build</title><link href="https://ib.bsb.br/treesheets-build/" rel="alternate" type="text/html" title="TreeSheets Debian 11 arm64 build" /><published>2026-01-09T00:00:00+00:00</published><updated>2026-01-09T10:15:07+00:00</updated><id>https://ib.bsb.br/treesheets-build</id><content type="html" xml:base="https://ib.bsb.br/treesheets-build/"><![CDATA[<section class="code-block-container" role="group" aria-label="Bash Code Block" data-filename="bash_code_block.sh" data-code="#!/usr/bin/env bash
#
# TreeSheets local build for Debian 11 (bullseye) on arm64/aarch64.
#
# Key constraints (from your environment):
#   - glibc stays Debian-11-compatible (2.31)
#   - Prefer hardware OpenGL ES via EGL/GLES (Mali-G610) when GLX/OpenGL is llvmpipe
#   - Debian 11 default GCC 10 libstdc++ typically lacks std::from_chars(float/double)
#     which breaks Lobster; we patch Lobster to use strto*() fallback when needed.
#
# What this script does:
#   1) Installs Debian-11-safe deps (idempotent)
#   2) Clones/updates TreeSheets
#   3) Selects a C/C++ toolchain robustly (never captures apt output into CC/CXX)
#        - Uses system gcc/g++ by default
#        - Optionally tries gcc-11/12 if already installed or installable
#        - Never fails just because gcc-11/12 are unavailable
#   4) Configures CMake + prefers EGL/GLES (wxUSE_GLCANVAS_EGL)
#   5) Patches Lobster if float-from_chars is missing
#   6) Builds the CPack &#39;package&#39; target to produce a .deb
#
# Usage:
#   chmod +x ./build-treesheets-debian11-arm64.sh
#   ./build-treesheets-debian11-arm64.sh --clean
#
# Options:
#   --workdir DIR
#   --clean
#   --no-update
#   --no-deps
#   --prefer-gles | --prefer-gl
#   --jobs N
#   --install
#   --no-lobster-patch
#   --try-newer-gcc    (attempt to apt-install gcc-11/12 if available; non-fatal)
#
set -euo pipefail
IFS=$&#39;\n\t&#39;

log(){ printf &#39;\n[treesheets] %s\n&#39; &quot;$*&quot; &gt;&amp;2; }
warn(){ printf &#39;\n[treesheets][WARN] %s\n&#39; &quot;$*&quot; &gt;&amp;2; }
die(){ printf &#39;\n[treesheets][ERROR] %s\n&#39; &quot;$*&quot; &gt;&amp;2; exit 1; }

have(){ command -v &quot;$1&quot; &gt;/dev/null 2&gt;&amp;1; }

sudo_cmd(){
  if [[ &quot;${EUID:-$(id -u)}&quot; -eq 0 ]]; then &quot;$@&quot;; else sudo &quot;$@&quot;; fi
}

# Defaults
REPO_URL=&quot;https://github.com/aardappel/treesheets.git&quot;
BRANCH=&quot;master&quot;
WORKDIR=&quot;&quot;
CLEAN=0
NO_UPDATE=0
NO_DEPS=0
PREFER_GFX=&quot;auto&quot;   # auto|gles|gl
ALLOW_LOBSTER_PATCH=1
JOBS=&quot;$(getconf _NPROCESSORS_ONLN 2&gt;/dev/null || echo 4)&quot;
DO_INSTALL=0
TRY_NEWER_GCC=0

while [[ $# -gt 0 ]]; do
  case &quot;$1&quot; in
    --workdir) WORKDIR=&quot;$2&quot;; shift 2;;
    --clean) CLEAN=1; shift;;
    --no-update) NO_UPDATE=1; shift;;
    --no-deps) NO_DEPS=1; shift;;
    --prefer-gles) PREFER_GFX=&quot;gles&quot;; shift;;
    --prefer-gl) PREFER_GFX=&quot;gl&quot;; shift;;
    --no-lobster-patch) ALLOW_LOBSTER_PATCH=0; shift;;
    --jobs) JOBS=&quot;$2&quot;; shift 2;;
    --install) DO_INSTALL=1; shift;;
    --try-newer-gcc) TRY_NEWER_GCC=1; shift;;
    -h|--help)
      sed -n &#39;1,220p&#39; &quot;$0&quot; | sed &#39;s/^# \{0,1\}//&#39;; exit 0;;
    *) die &quot;Unknown arg: $1&quot;;;
  esac
done

if [[ -z &quot;$WORKDIR&quot; ]]; then
  if [[ -d /mnt/mSATA ]]; then WORKDIR=/mnt/mSATA/treesheets-local; else WORKDIR=&quot;$HOME/treesheets-local&quot;; fi
fi

ARCH=&quot;$(uname -m)&quot;
OS_ID=&quot;$(. /etc/os-release &amp;&amp; echo &quot;${ID:-unknown}&quot;)&quot;
OS_VER=&quot;$(. /etc/os-release &amp;&amp; echo &quot;${VERSION_ID:-unknown}&quot;)&quot;
GLIBC_STR=&quot;$(ldd --version 2&gt;/dev/null | head -n1 || true)&quot;

log &quot;Host: $(hostname) | Arch: $ARCH | OS: $OS_ID $OS_VER&quot;
log &quot;glibc: ${GLIBC_STR:-unknown}&quot;
log &quot;Workdir: $WORKDIR&quot;
log &quot;Jobs: $JOBS&quot;

SRCROOT=&quot;$WORKDIR/src&quot;
REPODIR=&quot;$SRCROOT/treesheets&quot;
BUILDDIR=&quot;$WORKDIR/_build&quot;
DISTDIR=&quot;$WORKDIR/dist&quot;

mkdir -p &quot;$SRCROOT&quot; &quot;$DISTDIR&quot;

has_bullseye_backports(){
  grep -Rqs &quot;bullseye-backports&quot; /etc/apt/sources.list /etc/apt/sources.list.d/*.list 2&gt;/dev/null
}

apt_install(){
  sudo_cmd apt-get -o Acquire::Retries=3 install -y &quot;$@&quot;
}

apt_install_targeted(){
  local target=&quot;$1&quot;; shift
  if has_bullseye_backports; then
    sudo_cmd apt-get -o Acquire::Retries=3 install -y -t &quot;$target&quot; &quot;$@&quot; || return 1
  else
    return 1
  fi
}

install_deps(){
  log &quot;Installing dependencies via apt (Debian 11 compatible)&quot;
  sudo_cmd apt-get -o Acquire::Retries=3 update

  apt_install \
    ca-certificates git curl file zip unzip \
    build-essential pkg-config ninja-build fakeroot dpkg-dev \
    cmake \
    libcurl4-openssl-dev

  apt_install libgtk-3-dev libxext-dev

  # EGL/GLES headers
  apt_install libegl-dev libgles-dev libegl1-mesa-dev mesa-common-dev

  # OpenGL dev package can help FindOpenGL on some setups (even if runtime uses GLES)
  sudo_cmd apt-get -o Acquire::Retries=3 install -y libgl1-mesa-dev || true

  # Optional debug helpers
  sudo_cmd apt-get -o Acquire::Retries=3 install -y mesa-utils mesa-utils-extra || true

  have cmake || die &quot;cmake missing after install&quot;
  have git  || die &quot;git missing after install&quot;
  have gcc  || die &quot;gcc missing after install (build-essential should provide it)&quot;
  have g++  || die &quot;g++ missing after install (build-essential should provide it)&quot;
}

clone_or_update(){
  if [[ ! -d &quot;$REPODIR/.git&quot; ]]; then
    log &quot;Cloning: $REPO_URL ($BRANCH)&quot;
    git clone --branch &quot;$BRANCH&quot; --depth 1 &quot;$REPO_URL&quot; &quot;$REPODIR&quot;
  else
    log &quot;Repo exists: $REPODIR&quot;
    if [[ &quot;$NO_UPDATE&quot; -eq 0 ]]; then
      log &quot;Updating repo (fetch + reset to origin/$BRANCH)&quot;
      (cd &quot;$REPODIR&quot; &amp;&amp; git fetch --depth 1 origin &quot;$BRANCH&quot; &amp;&amp; git reset --hard &quot;origin/$BRANCH&quot;)
    else
      log &quot;Skipping repo update (--no-update)&quot;
    fi
  fi
}

# Does this libstdc++ provide std::from_chars for double?
compiler_has_float_from_chars(){
  local cxx=&quot;$1&quot;
  local tmpd
  tmpd=&quot;$(mktemp -d)&quot;
  cat &gt;&quot;$tmpd/t.cpp&quot; &lt;&lt;&#39;EOF&#39;
#include &lt;charconv&gt;
int main(){
  double x = 0;
  auto r = std::from_chars(&quot;1.25&quot;, &quot;1.25&quot;+4, x);
  (void)r;
}
EOF
  &quot;$cxx&quot; -std=c++17 -c &quot;$tmpd/t.cpp&quot; -o &quot;$tmpd/t.o&quot; &gt;/dev/null 2&gt;&amp;1
  local ok=$?
  rm -rf &quot;$tmpd&quot;
  return $ok
}

# Global outputs from toolchain selection
CC_PATH=&quot;&quot;
CXX_PATH=&quot;&quot;

try_pick_toolchain(){
  local cc=&quot;$1&quot; cxx=&quot;$2&quot;
  local ccpath cxxpath
  ccpath=&quot;$(command -v &quot;$cc&quot; 2&gt;/dev/null || true)&quot;
  cxxpath=&quot;$(command -v &quot;$cxx&quot; 2&gt;/dev/null || true)&quot;
  [[ -n &quot;$ccpath&quot; &amp;&amp; -n &quot;$cxxpath&quot; ]] || return 1
  CC_PATH=&quot;$ccpath&quot;
  CXX_PATH=&quot;$cxxpath&quot;
  return 0
}

select_toolchain(){
  # Always set a working default first.
  try_pick_toolchain gcc g++ || die &quot;Could not find gcc/g++ in PATH&quot;

  local major
  major=&quot;$(g++ -dumpversion 2&gt;/dev/null | cut -d. -f1 || echo unknown)&quot;
  log &quot;Default g++ major: ${major}&quot;

  if compiler_has_float_from_chars &quot;$CXX_PATH&quot;; then
    log &quot;Toolchain OK: system g++ provides float from_chars&quot;
    return 0
  fi

  warn &quot;Current C++ stdlib likely lacks std::from_chars(double). We&#39;ll patch Lobster unless a newer GCC is available.&quot;

  # If user didn&#39;t ask to try installing newer GCC, still prefer an already-installed newer one.
  for v in 12 11; do
    if have &quot;g++-$v&quot;; then
      if compiler_has_float_from_chars &quot;g++-$v&quot;; then
        log &quot;Using already-installed toolchain: gcc-$v / g++-$v&quot;
        try_pick_toolchain &quot;gcc-$v&quot; &quot;g++-$v&quot; || true
        return 0
      fi
    fi
  done

  [[ &quot;$TRY_NEWER_GCC&quot; -eq 1 ]] || return 0

  # Best-effort attempt to install newer GCC. Non-fatal if not available.
  for v in 11 12; do
    # Quick check: is there any candidate?
    if apt-cache policy &quot;g++-$v&quot; 2&gt;/dev/null | grep -q &quot;Candidate:&quot;; then
      log &quot;Attempting to install gcc-$v/g++-$v (best-effort)&quot;

      if apt_install_targeted bullseye-backports &quot;gcc-$v&quot; &quot;g++-$v&quot;; then
        true
      else
        apt_install &quot;gcc-$v&quot; &quot;g++-$v&quot; || true
      fi

      if have &quot;g++-$v&quot; &amp;&amp; compiler_has_float_from_chars &quot;g++-$v&quot;; then
        log &quot;Using toolchain: gcc-$v / g++-$v&quot;
        try_pick_toolchain &quot;gcc-$v&quot; &quot;g++-$v&quot; || true
        return 0
      fi
    fi
  done

  warn &quot;Could not obtain a newer GCC via apt. Continuing with system gcc/g++ and Lobster patch.&quot;
  return 0
}

configure_cmake(){
  [[ -n &quot;$CC_PATH&quot; &amp;&amp; -n &quot;$CXX_PATH&quot; ]] || die &quot;Internal error: empty compiler paths&quot;
  [[ -x &quot;$CC_PATH&quot; &amp;&amp; -x &quot;$CXX_PATH&quot; ]] || die &quot;Compiler not executable: cc=&#39;$CC_PATH&#39; cxx=&#39;$CXX_PATH&#39;&quot;

  if [[ &quot;$CLEAN&quot; -eq 1 ]]; then
    log &quot;Cleaning build directory: $BUILDDIR&quot;
    rm -rf &quot;$BUILDDIR&quot;
  fi
  mkdir -p &quot;$BUILDDIR&quot;

  local gfx=&quot;$PREFER_GFX&quot;
  if [[ &quot;$gfx&quot; == &quot;auto&quot; ]]; then
    if [[ -e /usr/include/EGL/egl.h &amp;&amp; -e /usr/include/GLES2/gl2.h ]]; then gfx=&quot;gles&quot;; else gfx=&quot;gl&quot;; fi
  fi
  log &quot;Graphics intent: $gfx&quot;

  local extra_flags=()
  if [[ &quot;$gfx&quot; == &quot;gles&quot; ]]; then
    extra_flags+=(&quot;-DwxUSE_GLCANVAS_EGL=ON&quot;)
  fi

  log &quot;Using CC=$CC_PATH, CXX=$CXX_PATH&quot;
  log &quot;Configuring CMake (Release)&quot;
  (
    cd &quot;$REPODIR&quot;
    cmake -S . -B &quot;$BUILDDIR&quot; \
      -G Ninja \
      -DCMAKE_BUILD_TYPE=Release \
      -DCMAKE_INSTALL_PREFIX=/usr \
      -DCPACK_PACKAGING_INSTALL_PREFIX=/usr \
      -DCMAKE_C_COMPILER=&quot;$CC_PATH&quot; \
      -DCMAKE_CXX_COMPILER=&quot;$CXX_PATH&quot; \
      -DwxBUILD_SHARED=OFF \
      -DwxBUILD_INSTALL=OFF \
      -DTREESHEETS_VERSION=&quot;$(date +%Y%m%d%H%M)&quot; \
      &quot;${extra_flags[@]}&quot;
  )
}

patch_lobster_if_needed(){
  [[ &quot;$ALLOW_LOBSTER_PATCH&quot; -eq 1 ]] || return 0

  # If compiler supports float from_chars, no patch.
  if compiler_has_float_from_chars &quot;$CXX_PATH&quot;; then
    return 0
  fi

  local f=&quot;$BUILDDIR/_deps/lobster-src/dev/src/lobster/string_tools.h&quot;
  if [[ ! -f &quot;$f&quot; ]]; then
    warn &quot;Lobster header not found yet ($f). If the build fails with from_chars(double), re-run with --clean.&quot;
    return 0
  fi

  if grep -q &quot;TREESHEETS_LOCAL_FLOAT_FROM_CHARS_FALLBACK&quot; &quot;$f&quot;; then
    log &quot;Lobster already patched for float from_chars fallback&quot;
    return 0
  fi

  log &quot;Patching Lobster: replace std::from_chars(float/double) with strto*() fallback&quot;

  # Replace the single line in parse_float() that calls from_chars() with a guarded fallback.
  # This avoids relying on feature-test macros that don&#39;t reliably encode float-from_chars support.
  perl -0777 -i -pe &#39;s/\Qauto res = from_chars(sv.data(), sv.data() + sv.size(), val);\E/
\/\/ TREESHEETS_LOCAL_FLOAT_FROM_CHARS_FALLBACK\n#if defined(__GNUC__) &amp;&amp; (__GNUC__ &gt;= 11)\n        auto res = from_chars(sv.data(), sv.data() + sv.size(), val);\n#else\n        \/\/ GCC\/libstdc++ &lt; 11 often lacks std::from_chars for float\/double.\n        \/\/ Fallback: copy to NUL-terminated buffer and use strto*().\n        std::string _tmp(sv);\n        char* _end = nullptr;\n        if constexpr (std::is_same_v&lt;T, float&gt;) {\n            val = std::strtof(_tmp.c_str(), &amp;_end);\n        } else if constexpr (std::is_same_v&lt;T, double&gt;) {\n            val = std::strtod(_tmp.c_str(), &amp;_end);\n        } else {\n            val = (T)std::strtold(_tmp.c_str(), &amp;_end);\n        }\n        std::from_chars_result res{sv.data(), std::errc{}};\n        if (!_end || _end == _tmp.c_str()) {\n            res.ec = std::errc::invalid_argument;\n            res.ptr = sv.data();\n        } else {\n            res.ptr = sv.data() + (size_t)(_end - _tmp.c_str());\n        }\n#endif\n/smg&#39; &quot;$f&quot;

  # Ensure required headers are present (best-effort, non-fatal).
  if ! grep -q &quot;&lt;cstdlib&gt;&quot; &quot;$f&quot;; then
    perl -i -pe &#39;if($.==1){print &quot;#include &lt;cstdlib&gt;\n&quot;}&#39; &quot;$f&quot; || true
  fi
}

build_and_package(){
  log &quot;Building + packaging (cmake --build ... --target package), jobs=$JOBS&quot;
  cmake --build &quot;$BUILDDIR&quot; --target package -j&quot;$JOBS&quot;
}

collect_artifacts(){
  log &quot;Collecting artifacts to: $DISTDIR&quot;
  shopt -s nullglob
  local debs=(&quot;$BUILDDIR&quot;/treesheets_*.deb)
  [[ ${#debs[@]} -gt 0 ]] || die &quot;No .deb artifacts found in $BUILDDIR (build likely failed).&quot;
  rm -f &quot;$DISTDIR&quot;/*.deb &quot;$DISTDIR&quot;/SHA256SUMS 2&gt;/dev/null || true
  for f in &quot;${debs[@]}&quot;; do cp -av -- &quot;$f&quot; &quot;$DISTDIR/&quot;; done
  (cd &quot;$DISTDIR&quot; &amp;&amp; sha256sum ./*.deb | tee SHA256SUMS)
  ls -lh &quot;$DISTDIR&quot;/*.deb
}

install_artifact(){
  [[ &quot;$DO_INSTALL&quot; -eq 1 ]] || return 0
  shopt -s nullglob
  local newest
  newest=&quot;$(ls -t &quot;$DISTDIR&quot;/*.deb | head -n1)&quot;
  log &quot;Installing: $newest&quot;
  sudo_cmd dpkg -i &quot;$newest&quot; || { warn &quot;dpkg failed; attempting apt-get -f install&quot;; sudo_cmd apt-get -y -f install; }
}

# Run
[[ &quot;$NO_DEPS&quot; -eq 1 ]] || install_deps
clone_or_update

select_toolchain
[[ -n &quot;$CC_PATH&quot; &amp;&amp; -n &quot;$CXX_PATH&quot; ]] || die &quot;Toolchain selection failed&quot;

configure_cmake
patch_lobster_if_needed
build_and_package
collect_artifacts
install_artifact

log &quot;Done.&quot;" data-download-link="" data-download-label="Download Bash">
  <code class="language-bash">#!/usr/bin/env bash
#
# TreeSheets local build for Debian 11 (bullseye) on arm64/aarch64.
#
# Key constraints (from your environment):
#   - glibc stays Debian-11-compatible (2.31)
#   - Prefer hardware OpenGL ES via EGL/GLES (Mali-G610) when GLX/OpenGL is llvmpipe
#   - Debian 11 default GCC 10 libstdc++ typically lacks std::from_chars(float/double)
#     which breaks Lobster; we patch Lobster to use strto*() fallback when needed.
#
# What this script does:
#   1) Installs Debian-11-safe deps (idempotent)
#   2) Clones/updates TreeSheets
#   3) Selects a C/C++ toolchain robustly (never captures apt output into CC/CXX)
#        - Uses system gcc/g++ by default
#        - Optionally tries gcc-11/12 if already installed or installable
#        - Never fails just because gcc-11/12 are unavailable
#   4) Configures CMake + prefers EGL/GLES (wxUSE_GLCANVAS_EGL)
#   5) Patches Lobster if float-from_chars is missing
#   6) Builds the CPack &#39;package&#39; target to produce a .deb
#
# Usage:
#   chmod +x ./build-treesheets-debian11-arm64.sh
#   ./build-treesheets-debian11-arm64.sh --clean
#
# Options:
#   --workdir DIR
#   --clean
#   --no-update
#   --no-deps
#   --prefer-gles | --prefer-gl
#   --jobs N
#   --install
#   --no-lobster-patch
#   --try-newer-gcc    (attempt to apt-install gcc-11/12 if available; non-fatal)
#
set -euo pipefail
IFS=$&#39;\n\t&#39;

log(){ printf &#39;\n[treesheets] %s\n&#39; &quot;$*&quot; &gt;&amp;2; }
warn(){ printf &#39;\n[treesheets][WARN] %s\n&#39; &quot;$*&quot; &gt;&amp;2; }
die(){ printf &#39;\n[treesheets][ERROR] %s\n&#39; &quot;$*&quot; &gt;&amp;2; exit 1; }

have(){ command -v &quot;$1&quot; &gt;/dev/null 2&gt;&amp;1; }

sudo_cmd(){
  if [[ &quot;${EUID:-$(id -u)}&quot; -eq 0 ]]; then &quot;$@&quot;; else sudo &quot;$@&quot;; fi
}

# Defaults
REPO_URL=&quot;https://github.com/aardappel/treesheets.git&quot;
BRANCH=&quot;master&quot;
WORKDIR=&quot;&quot;
CLEAN=0
NO_UPDATE=0
NO_DEPS=0
PREFER_GFX=&quot;auto&quot;   # auto|gles|gl
ALLOW_LOBSTER_PATCH=1
JOBS=&quot;$(getconf _NPROCESSORS_ONLN 2&gt;/dev/null || echo 4)&quot;
DO_INSTALL=0
TRY_NEWER_GCC=0

while [[ $# -gt 0 ]]; do
  case &quot;$1&quot; in
    --workdir) WORKDIR=&quot;$2&quot;; shift 2;;
    --clean) CLEAN=1; shift;;
    --no-update) NO_UPDATE=1; shift;;
    --no-deps) NO_DEPS=1; shift;;
    --prefer-gles) PREFER_GFX=&quot;gles&quot;; shift;;
    --prefer-gl) PREFER_GFX=&quot;gl&quot;; shift;;
    --no-lobster-patch) ALLOW_LOBSTER_PATCH=0; shift;;
    --jobs) JOBS=&quot;$2&quot;; shift 2;;
    --install) DO_INSTALL=1; shift;;
    --try-newer-gcc) TRY_NEWER_GCC=1; shift;;
    -h|--help)
      sed -n &#39;1,220p&#39; &quot;$0&quot; | sed &#39;s/^# \{0,1\}//&#39;; exit 0;;
    *) die &quot;Unknown arg: $1&quot;;;
  esac
done

if [[ -z &quot;$WORKDIR&quot; ]]; then
  if [[ -d /mnt/mSATA ]]; then WORKDIR=/mnt/mSATA/treesheets-local; else WORKDIR=&quot;$HOME/treesheets-local&quot;; fi
fi

ARCH=&quot;$(uname -m)&quot;
OS_ID=&quot;$(. /etc/os-release &amp;&amp; echo &quot;${ID:-unknown}&quot;)&quot;
OS_VER=&quot;$(. /etc/os-release &amp;&amp; echo &quot;${VERSION_ID:-unknown}&quot;)&quot;
GLIBC_STR=&quot;$(ldd --version 2&gt;/dev/null | head -n1 || true)&quot;

log &quot;Host: $(hostname) | Arch: $ARCH | OS: $OS_ID $OS_VER&quot;
log &quot;glibc: ${GLIBC_STR:-unknown}&quot;
log &quot;Workdir: $WORKDIR&quot;
log &quot;Jobs: $JOBS&quot;

SRCROOT=&quot;$WORKDIR/src&quot;
REPODIR=&quot;$SRCROOT/treesheets&quot;
BUILDDIR=&quot;$WORKDIR/_build&quot;
DISTDIR=&quot;$WORKDIR/dist&quot;

mkdir -p &quot;$SRCROOT&quot; &quot;$DISTDIR&quot;

has_bullseye_backports(){
  grep -Rqs &quot;bullseye-backports&quot; /etc/apt/sources.list /etc/apt/sources.list.d/*.list 2&gt;/dev/null
}

apt_install(){
  sudo_cmd apt-get -o Acquire::Retries=3 install -y &quot;$@&quot;
}

apt_install_targeted(){
  local target=&quot;$1&quot;; shift
  if has_bullseye_backports; then
    sudo_cmd apt-get -o Acquire::Retries=3 install -y -t &quot;$target&quot; &quot;$@&quot; || return 1
  else
    return 1
  fi
}

install_deps(){
  log &quot;Installing dependencies via apt (Debian 11 compatible)&quot;
  sudo_cmd apt-get -o Acquire::Retries=3 update

  apt_install \
    ca-certificates git curl file zip unzip \
    build-essential pkg-config ninja-build fakeroot dpkg-dev \
    cmake \
    libcurl4-openssl-dev

  apt_install libgtk-3-dev libxext-dev

  # EGL/GLES headers
  apt_install libegl-dev libgles-dev libegl1-mesa-dev mesa-common-dev

  # OpenGL dev package can help FindOpenGL on some setups (even if runtime uses GLES)
  sudo_cmd apt-get -o Acquire::Retries=3 install -y libgl1-mesa-dev || true

  # Optional debug helpers
  sudo_cmd apt-get -o Acquire::Retries=3 install -y mesa-utils mesa-utils-extra || true

  have cmake || die &quot;cmake missing after install&quot;
  have git  || die &quot;git missing after install&quot;
  have gcc  || die &quot;gcc missing after install (build-essential should provide it)&quot;
  have g++  || die &quot;g++ missing after install (build-essential should provide it)&quot;
}

clone_or_update(){
  if [[ ! -d &quot;$REPODIR/.git&quot; ]]; then
    log &quot;Cloning: $REPO_URL ($BRANCH)&quot;
    git clone --branch &quot;$BRANCH&quot; --depth 1 &quot;$REPO_URL&quot; &quot;$REPODIR&quot;
  else
    log &quot;Repo exists: $REPODIR&quot;
    if [[ &quot;$NO_UPDATE&quot; -eq 0 ]]; then
      log &quot;Updating repo (fetch + reset to origin/$BRANCH)&quot;
      (cd &quot;$REPODIR&quot; &amp;&amp; git fetch --depth 1 origin &quot;$BRANCH&quot; &amp;&amp; git reset --hard &quot;origin/$BRANCH&quot;)
    else
      log &quot;Skipping repo update (--no-update)&quot;
    fi
  fi
}

# Does this libstdc++ provide std::from_chars for double?
compiler_has_float_from_chars(){
  local cxx=&quot;$1&quot;
  local tmpd
  tmpd=&quot;$(mktemp -d)&quot;
  cat &gt;&quot;$tmpd/t.cpp&quot; &lt;&lt;&#39;EOF&#39;
#include &lt;charconv&gt;
int main(){
  double x = 0;
  auto r = std::from_chars(&quot;1.25&quot;, &quot;1.25&quot;+4, x);
  (void)r;
}
EOF
  &quot;$cxx&quot; -std=c++17 -c &quot;$tmpd/t.cpp&quot; -o &quot;$tmpd/t.o&quot; &gt;/dev/null 2&gt;&amp;1
  local ok=$?
  rm -rf &quot;$tmpd&quot;
  return $ok
}

# Global outputs from toolchain selection
CC_PATH=&quot;&quot;
CXX_PATH=&quot;&quot;

try_pick_toolchain(){
  local cc=&quot;$1&quot; cxx=&quot;$2&quot;
  local ccpath cxxpath
  ccpath=&quot;$(command -v &quot;$cc&quot; 2&gt;/dev/null || true)&quot;
  cxxpath=&quot;$(command -v &quot;$cxx&quot; 2&gt;/dev/null || true)&quot;
  [[ -n &quot;$ccpath&quot; &amp;&amp; -n &quot;$cxxpath&quot; ]] || return 1
  CC_PATH=&quot;$ccpath&quot;
  CXX_PATH=&quot;$cxxpath&quot;
  return 0
}

select_toolchain(){
  # Always set a working default first.
  try_pick_toolchain gcc g++ || die &quot;Could not find gcc/g++ in PATH&quot;

  local major
  major=&quot;$(g++ -dumpversion 2&gt;/dev/null | cut -d. -f1 || echo unknown)&quot;
  log &quot;Default g++ major: ${major}&quot;

  if compiler_has_float_from_chars &quot;$CXX_PATH&quot;; then
    log &quot;Toolchain OK: system g++ provides float from_chars&quot;
    return 0
  fi

  warn &quot;Current C++ stdlib likely lacks std::from_chars(double). We&#39;ll patch Lobster unless a newer GCC is available.&quot;

  # If user didn&#39;t ask to try installing newer GCC, still prefer an already-installed newer one.
  for v in 12 11; do
    if have &quot;g++-$v&quot;; then
      if compiler_has_float_from_chars &quot;g++-$v&quot;; then
        log &quot;Using already-installed toolchain: gcc-$v / g++-$v&quot;
        try_pick_toolchain &quot;gcc-$v&quot; &quot;g++-$v&quot; || true
        return 0
      fi
    fi
  done

  [[ &quot;$TRY_NEWER_GCC&quot; -eq 1 ]] || return 0

  # Best-effort attempt to install newer GCC. Non-fatal if not available.
  for v in 11 12; do
    # Quick check: is there any candidate?
    if apt-cache policy &quot;g++-$v&quot; 2&gt;/dev/null | grep -q &quot;Candidate:&quot;; then
      log &quot;Attempting to install gcc-$v/g++-$v (best-effort)&quot;

      if apt_install_targeted bullseye-backports &quot;gcc-$v&quot; &quot;g++-$v&quot;; then
        true
      else
        apt_install &quot;gcc-$v&quot; &quot;g++-$v&quot; || true
      fi

      if have &quot;g++-$v&quot; &amp;&amp; compiler_has_float_from_chars &quot;g++-$v&quot;; then
        log &quot;Using toolchain: gcc-$v / g++-$v&quot;
        try_pick_toolchain &quot;gcc-$v&quot; &quot;g++-$v&quot; || true
        return 0
      fi
    fi
  done

  warn &quot;Could not obtain a newer GCC via apt. Continuing with system gcc/g++ and Lobster patch.&quot;
  return 0
}

configure_cmake(){
  [[ -n &quot;$CC_PATH&quot; &amp;&amp; -n &quot;$CXX_PATH&quot; ]] || die &quot;Internal error: empty compiler paths&quot;
  [[ -x &quot;$CC_PATH&quot; &amp;&amp; -x &quot;$CXX_PATH&quot; ]] || die &quot;Compiler not executable: cc=&#39;$CC_PATH&#39; cxx=&#39;$CXX_PATH&#39;&quot;

  if [[ &quot;$CLEAN&quot; -eq 1 ]]; then
    log &quot;Cleaning build directory: $BUILDDIR&quot;
    rm -rf &quot;$BUILDDIR&quot;
  fi
  mkdir -p &quot;$BUILDDIR&quot;

  local gfx=&quot;$PREFER_GFX&quot;
  if [[ &quot;$gfx&quot; == &quot;auto&quot; ]]; then
    if [[ -e /usr/include/EGL/egl.h &amp;&amp; -e /usr/include/GLES2/gl2.h ]]; then gfx=&quot;gles&quot;; else gfx=&quot;gl&quot;; fi
  fi
  log &quot;Graphics intent: $gfx&quot;

  local extra_flags=()
  if [[ &quot;$gfx&quot; == &quot;gles&quot; ]]; then
    extra_flags+=(&quot;-DwxUSE_GLCANVAS_EGL=ON&quot;)
  fi

  log &quot;Using CC=$CC_PATH, CXX=$CXX_PATH&quot;
  log &quot;Configuring CMake (Release)&quot;
  (
    cd &quot;$REPODIR&quot;
    cmake -S . -B &quot;$BUILDDIR&quot; \
      -G Ninja \
      -DCMAKE_BUILD_TYPE=Release \
      -DCMAKE_INSTALL_PREFIX=/usr \
      -DCPACK_PACKAGING_INSTALL_PREFIX=/usr \
      -DCMAKE_C_COMPILER=&quot;$CC_PATH&quot; \
      -DCMAKE_CXX_COMPILER=&quot;$CXX_PATH&quot; \
      -DwxBUILD_SHARED=OFF \
      -DwxBUILD_INSTALL=OFF \
      -DTREESHEETS_VERSION=&quot;$(date +%Y%m%d%H%M)&quot; \
      &quot;${extra_flags[@]}&quot;
  )
}

patch_lobster_if_needed(){
  [[ &quot;$ALLOW_LOBSTER_PATCH&quot; -eq 1 ]] || return 0

  # If compiler supports float from_chars, no patch.
  if compiler_has_float_from_chars &quot;$CXX_PATH&quot;; then
    return 0
  fi

  local f=&quot;$BUILDDIR/_deps/lobster-src/dev/src/lobster/string_tools.h&quot;
  if [[ ! -f &quot;$f&quot; ]]; then
    warn &quot;Lobster header not found yet ($f). If the build fails with from_chars(double), re-run with --clean.&quot;
    return 0
  fi

  if grep -q &quot;TREESHEETS_LOCAL_FLOAT_FROM_CHARS_FALLBACK&quot; &quot;$f&quot;; then
    log &quot;Lobster already patched for float from_chars fallback&quot;
    return 0
  fi

  log &quot;Patching Lobster: replace std::from_chars(float/double) with strto*() fallback&quot;

  # Replace the single line in parse_float() that calls from_chars() with a guarded fallback.
  # This avoids relying on feature-test macros that don&#39;t reliably encode float-from_chars support.
  perl -0777 -i -pe &#39;s/\Qauto res = from_chars(sv.data(), sv.data() + sv.size(), val);\E/
\/\/ TREESHEETS_LOCAL_FLOAT_FROM_CHARS_FALLBACK\n#if defined(__GNUC__) &amp;&amp; (__GNUC__ &gt;= 11)\n        auto res = from_chars(sv.data(), sv.data() + sv.size(), val);\n#else\n        \/\/ GCC\/libstdc++ &lt; 11 often lacks std::from_chars for float\/double.\n        \/\/ Fallback: copy to NUL-terminated buffer and use strto*().\n        std::string _tmp(sv);\n        char* _end = nullptr;\n        if constexpr (std::is_same_v&lt;T, float&gt;) {\n            val = std::strtof(_tmp.c_str(), &amp;_end);\n        } else if constexpr (std::is_same_v&lt;T, double&gt;) {\n            val = std::strtod(_tmp.c_str(), &amp;_end);\n        } else {\n            val = (T)std::strtold(_tmp.c_str(), &amp;_end);\n        }\n        std::from_chars_result res{sv.data(), std::errc{}};\n        if (!_end || _end == _tmp.c_str()) {\n            res.ec = std::errc::invalid_argument;\n            res.ptr = sv.data();\n        } else {\n            res.ptr = sv.data() + (size_t)(_end - _tmp.c_str());\n        }\n#endif\n/smg&#39; &quot;$f&quot;

  # Ensure required headers are present (best-effort, non-fatal).
  if ! grep -q &quot;&lt;cstdlib&gt;&quot; &quot;$f&quot;; then
    perl -i -pe &#39;if($.==1){print &quot;#include &lt;cstdlib&gt;\n&quot;}&#39; &quot;$f&quot; || true
  fi
}

build_and_package(){
  log &quot;Building + packaging (cmake --build ... --target package), jobs=$JOBS&quot;
  cmake --build &quot;$BUILDDIR&quot; --target package -j&quot;$JOBS&quot;
}

collect_artifacts(){
  log &quot;Collecting artifacts to: $DISTDIR&quot;
  shopt -s nullglob
  local debs=(&quot;$BUILDDIR&quot;/treesheets_*.deb)
  [[ ${#debs[@]} -gt 0 ]] || die &quot;No .deb artifacts found in $BUILDDIR (build likely failed).&quot;
  rm -f &quot;$DISTDIR&quot;/*.deb &quot;$DISTDIR&quot;/SHA256SUMS 2&gt;/dev/null || true
  for f in &quot;${debs[@]}&quot;; do cp -av -- &quot;$f&quot; &quot;$DISTDIR/&quot;; done
  (cd &quot;$DISTDIR&quot; &amp;&amp; sha256sum ./*.deb | tee SHA256SUMS)
  ls -lh &quot;$DISTDIR&quot;/*.deb
}

install_artifact(){
  [[ &quot;$DO_INSTALL&quot; -eq 1 ]] || return 0
  shopt -s nullglob
  local newest
  newest=&quot;$(ls -t &quot;$DISTDIR&quot;/*.deb | head -n1)&quot;
  log &quot;Installing: $newest&quot;
  sudo_cmd dpkg -i &quot;$newest&quot; || { warn &quot;dpkg failed; attempting apt-get -f install&quot;; sudo_cmd apt-get -y -f install; }
}

# Run
[[ &quot;$NO_DEPS&quot; -eq 1 ]] || install_deps
clone_or_update

select_toolchain
[[ -n &quot;$CC_PATH&quot; &amp;&amp; -n &quot;$CXX_PATH&quot; ]] || die &quot;Toolchain selection failed&quot;

configure_cmake
patch_lobster_if_needed
build_and_package
collect_artifacts
install_artifact

log &quot;Done.&quot;</code>
</section>]]></content><author><name></name></author><category term="scratchpad" /></entry></feed>