<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en' }}">
<head>
  <!-- Basic Metadata -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Title with fallback for home or page title -->
  <title>
    {% if page.id == "home" %}
      {{ site.title | escape }}
    {% else %}
      {{ page.title | escape }} - {{ site.title | escape }}
    {% endif %}
  </title>
  <meta name="title" content="{% if page.title %}{{ page.title | escape }} - {% endif %}{{ site.title | escape }}" />
  <!-- Description with fallback and truncation -->
  <meta name="description" content="{{ page.description | default: site.description | strip_html | truncate: 160 | escape }}">
  <!-- Open Graph Tags -->
  <meta property="og:type" content="article">
  <meta property="og:url" content="{{ page.canonical_url | default: page.url | absolute_url }}">
  <meta property="og:title" content="{% if page.title %}{{ page.title | escape }} - {% endif %}{{ site.title | escape }}">
  <meta property="og:description" content="{{ page.description | default: site.description | strip_html | truncate: 160 | escape }}">
  <meta property="og:image" content="{{ site.og_image | default: '/favicon.ico' | relative_url }}">
  <!-- Twitter Cards -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="{{ page.url | absolute_url }}">
  <meta name="twitter:title" content="{% if page.title %}{{ page.title | escape }} - {% endif %}{{ site.title | escape }}">
  <meta name="twitter:description" content="{{ page.description | default: site.description | strip_html | truncate: 160 | escape }}">
  <meta name="twitter:image" content="{{ site.og_image | default: '/favicon.ico' | relative_url }}">
  <!-- Canonical URL -->
  <link rel="canonical" href="{{ page.canonical_url | default: page.url | absolute_url }}">
  <!-- RSS Feed -->
  <link rel="alternate" type="application/rss+xml" title="{{ site.title | escape }}" href="{{ '/rss.xml' | absolute_url }}">
  <!-- Keywords / Tags -->
  {% if page.tags %}
    <meta name="keywords" content="{{ page.tags | join: ',' | escape }}">
    {% for tag in page.tags %}
      <meta property="article:tag" content="{{ tag | escape }}">
    {% endfor %}
  {% endif %}
  <!-- Favicons -->
  <link rel="icon" href="{{ '/favicon.ico' | relative_url }}" type="image/x-icon">
  <link rel="shortcut icon" href="{{ '/favicon.ico' | relative_url }}" type="image/x-icon">
  {% if site.favicons %}
    {% for icon in site.favicons %}
      <link rel="{{ icon.rel }}" sizes="{{ icon.sizes }}" href="{{ icon.href | relative_url }}">
    {% endfor %}
  {% endif %}
  <!-- Main Stylesheet -->
  <link rel="stylesheet" href="{{ '/style.css' | relative_url }}">
</head>
<body class="post-content-body">
  <header class="header-container">
    <nav aria-label="Main navigation" class="header-content">
      <a href="{{ '/' | relative_url }}" aria-label="Home">
        <img src="{{ '/favicon.ico' | relative_url }}" alt="Home" class="favicon search-link" width="45" height="45" loading="lazy">
      </a>
      <a href="{{ '/tags' | relative_url }}" aria-label="Tags">
        <img src="{{ '/assets/Label.gif' | relative_url }}" alt="Tags" class="favicon search-link" width="45" height="45" loading="lazy">
      </a>
      <a href="{{ '/archive' | relative_url }}" aria-label="Archive">
        <img src="{{ '/assets/Loose_Stone_Pile.gif' | relative_url }}" alt="Archive" class="favicon search-link" width="45" height="45" loading="lazy">
      </a>
      <a href="{{ '/events' | relative_url }}" aria-label="Events">
        <img src="{{ '/assets/Paralyse_Rune.gif' | relative_url }}" alt="Events" class="favicon search-link" width="45" height="45" loading="lazy">
      </a>
      <a href="{{ '/archive-created' | relative_url }}" aria-label="Archive created">
          <img src="{{ '/assets/Hole_(Rock).gif' | relative_url }}" alt="Archive created" class="favicon search-link" width="32" height="32" loading="lazy">
      </a>
      <a href="{{ '/rot64' | relative_url }}" aria-label="rot">
          <img src="{{ '/assets/rot.gif' | relative_url }}" alt="rot" class="favicon search-link" width="32" height="32" loading="lazy">
      </a>
    </nav>
    <h5 class="post-title">
      <a href="#bottom-of-page" aria-label="Go to bottom">
        {{ page.title | strip_html | strip }}
      </a>
    </h5>
    <div class="post-meta">
      <time datetime="{{ page.date | date_to_xmlschema }}" class="post-date">
        {{ page.date | date_to_string }}
      </time>
      {% if page.last_modified_at %}
        <span class="post-updated">
          ↣
          <time datetime="{{ page.last_modified_at | date_to_xmlschema }}">{{ page.last_modified_at | date_to_string }}</time>
        </span>
      {% endif %}
      {% if page.slug %}
        <p class="post-slug">
          Slug: <a href="{{ page.slug | absolute_url }}" class="tag">{{ page.slug }}</a>
        </p>
      {% endif %}
      {% if page.tags %}
        <p class="post-tags">
          Tags:
          {% for tag in page.tags %}
            <a href="{{ site.url }}{{ site.baseurl }}/tags/#{{ tag | slugify }}" class="tag">{{ tag }}</a>
          {% endfor %}
        </p>
      {% endif %}
    </div>
    <div class="post-actions">
      <div class="page-stats mt-3" role="status" aria-label="Page statistics">
        <span class="badge bg-primary">
          {{ page.content | size }} characters
        </span>
        <span class="separator mx-2" aria-hidden="true">•</span>
        <span class="badge bg-primary">
          {{ page.content | number_of_words }} words
        </span>
      </div>
      <div class="action-buttons d-flex flex-wrap gap-2">
        {% if page.path %}
          {% if page.info %}
            <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/edit/main/{{ page.path | uri_escape }}"
                  method="GET"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="d-inline-block">
              <button type="submit" class="btn btn-danger" aria-label="Edit page content">
                <span class="button-text">Improve this page?</span>
                <span class="info-text">{{ page.info | strip_html | strip | escape }}</span>
              </button>
            </form>
          {% else %}
            <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/edit/main/{{ page.path | uri_escape }}"
                  method="GET"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="d-inline-block">
              <button type="submit" class="btn btn-danger" aria-label="Edit page content">
                Improve this page
              </button>
            </form>
          {% endif %}
          <form action="https://github.com/ib-bsb-br/ib-bsb-br.github.io/commits/main/{{ page.path | uri_escape }}"
                method="GET"
                target="_blank"
                rel="noopener noreferrer"
                class="d-inline-block">
            <button type="submit" class="btn btn-danger" aria-label="View page revision history">
              View revision history
            </button>
          </form>
        {% else %}
          <div class="alert alert-warning" role="alert">
            Page information unavailable
          </div>
        {% endif %}
      </div>
    </div>
  </header>
  <main class="content">
    <article class="post-wrapper">
      <div class="post-content-body">
        {% include toc.html html=content %}
        {% include anchor_headings.html html=content anchorBody="#" %}
      </div>
      {% if page.slug %}
        URL: {{ page.slug | absolute_url }}
      {% else %}
        URL: {{ page.url | absolute_url }}
      {% endif %}
    </article>
<nav class="post-navigation-combined" aria-label="Post navigation">
  <!-- Manual Chronological Navigation -->
  {% assign sorted_posts = site.posts | sort: 'date' %}
  {% for post in sorted_posts %}
    {% if post.url == page.url %}
      {% assign current_index = forloop.index0 %}
      {% break %}
    {% endif %}
  {% endfor %}
  {% if current_index %}
    {% assign prev_index = current_index | minus: 1 %}
    {% assign next_index = current_index | plus: 1 %}
    {% if prev_index >= 0 %}
      {% assign prev_post = sorted_posts[prev_index] %}
      <div class="nav-arrow chronological prev">
        <a href="{{ prev_post.url | relative_url }}" title="{{ prev_post.title | strip_html | strip }}" rel="prev">
          <img src="data:image/png;base64,[BASE64_DATA]" alt="Previous article" width="45" height="45" loading="lazy">
        </a>
      </div>
    {% endif %}
    {% if next_index < sorted_posts.size %}
      {% assign next_post = sorted_posts[next_index] %}
      <div class="nav-arrow chronological next">
        <a href="{{ next_post.url | relative_url }}" title="{{ next_post.title | strip_html | strip }}" rel="next">
          <img src="data:image/png;base64,[BASE64_DATA]" alt="Next article" width="45" height="45" loading="lazy">
        </a>
      </div>
    {% endif %}
  {% endif %}
  <!-- Tag-based Navigation -->
  {% if page.tags %}
    {% assign chosen_tag = page.tags | split: ',' | map: 'strip' %}
    {% assign tag_posts = "" | split: "" %}
    {% for tag in chosen_tag %}
      {% assign tag_posts = site.posts | where_exp: "p", "p.tags contains tag" %}
      {% assign tag_posts = tag_posts | concat: tag_posts %}
    {% endfor %}
    {% assign tag_posts = tag_posts | uniq | sort: 'date' %}
    {% assign current_index = nil %}
    {% for tpost in tag_posts %}
      {% if tpost.url == page.url %}
        {% assign current_index = forloop.index0 %}
        {% break %}
      {% endif %}
    {% endfor %}
    {% if current_index != nil %}
      {% assign prev_index = current_index | minus: 1 %}
      {% assign next_index = current_index | plus: 1 %}
      {% if prev_index >= 0 %}
        {% assign prev_tag_post = tag_posts[prev_index] %}
        <div class="nav-arrow tags prev">
          <a href="{{ prev_tag_post.url | relative_url }}" title="{{ prev_tag_post.title | strip_html | strip }}" rel="prev">
            <img src="data:image/png;base64,[BASE64_DATA]" alt="Previous in same tag" width="45" height="45" loading="lazy">
          </a>
        </div>
      {% endif %}
      {% if next_index < tag_posts.size %}
        {% assign next_tag_post = tag_posts[next_index] %}
        <div class="nav-arrow tags next">
          <a href="{{ next_tag_post.url | relative_url }}" title="{{ next_tag_post.title | strip_html | strip }}" rel="next">
            <img src="data:image/png;base64,[BASE64_DATA]" alt="Next in same tag" width="45" height="45" loading="lazy">
          </a>
        </div>
      {% endif %}
    {% endif %}
  {% endif %}
</nav>
        {% endif %}
      {% endif %}
      {% if page.comment %}
      <div class="comment-box">
        Ref.
        <a href="{{ page.comment | strip }}" title="{{ page.comment | strip }}">{{ page.comment | strip }}</a>
      </div>
      {% endif %}
    </nav>
  </main>
  <footer id="bottom-of-page" class="site-footer">
    <p>
      <a
        href="#"
        aria-label="Back to top"
        class="back-to-top-link">
        <span class="sr-only">Back to top</span>
      </a>
      {% assign current_time = site.time | date: '%s' %}
      {% assign offset_seconds = 3 | times: 60 | times: 60 %}
      {% assign adjusted_time = current_time | minus: offset_seconds %}
      <a href="https://ib.bsb.br/404" aria-label="404">
        {{ adjusted_time | date: '%Y-%m-%d %H:%M:%S' }}
      </a>
      &hArr;
      <a href="https://github.com/ib-bsb-br/ib-bsb-br.github.io" aria-label="GitHub">&#8505;</a>
      <a href="{{ '/' | relative_url }}" aria-label="Homepage">
        {{ site.title | strip_html | strip }}
      </a>
      <button id="copyAllButton" aria-label="Copy all code">
        &copy;
      </button>
    </p>
  </footer>
  <style>
  .back-to-top-link {
    display: inline-block;
    width: 32px;
    height: 32px;
    background: url("{{ '/assets/Rope_(Old).gif' | relative_url }}") center center no-repeat;
    background-size: contain; /* or cover */
    text-decoration: none;
    vertical-align: middle;
  }
  .sr-only {
    /* Utility class to hide text visually but keep it accessible */
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
  </style>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "{{ page.url | absolute_url }}"
    },
    "headline": "{{ page.title | strip_html | strip | truncate: 110 }}",
    "description": "{{ page.description | default: site.description | strip_html | truncate: 160 }}",
    "datePublished": "{{ page.date | date_to_xmlschema }}",
    "dateModified": "{{ page.last_modified_at | default: page.date | date_to_xmlschema }}",
    "author": {
      "@type": "Person",
      "name": "{{ site.author.name | default: 'Author' | strip_html | strip }}"
    },
    "publisher": {
      "@type": "Organization",
      "name": "{{ site.title | strip_html | strip }}"
      {% if site.logo %}
      ,"logo": {
        "@type": "ImageObject",
      "url": "{{ site.logo | absolute_url }}"
      }
      {% endif %}
    }
    {% if site.social.og_image %}
    ,"image": {
      "@type": "ImageObject",
      "url": "{{ site.social.og_image | absolute_url }}"
    }
    {% endif %}
  }
  </script>
  <script src="{{ '/assets/js/prism.js' | relative_url }}" defer></script>
  <script src="{{ '/assets/js/copy-all-code.js' | relative_url }}"></script>
</body>
</html>
